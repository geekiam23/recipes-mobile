70f07d52108fc672af8291c2980492d5
var colorNames = require('color-name');

var swizzle = require('simple-swizzle');

var reverseNames = {};

for (var name in colorNames) {
  if (colorNames.hasOwnProperty(name)) {
    reverseNames[colorNames[name]] = name;
  }
}

var cs = module.exports = {
  to: {},
  get: {}
};

cs.get = function (string) {
  var prefix = string.substring(0, 3).toLowerCase();
  var val;
  var model;

  switch (prefix) {
    case 'hsl':
      val = cs.get.hsl(string);
      model = 'hsl';
      break;

    case 'hwb':
      val = cs.get.hwb(string);
      model = 'hwb';
      break;

    default:
      val = cs.get.rgb(string);
      model = 'rgb';
      break;
  }

  if (!val) {
    return null;
  }

  return {
    model: model,
    value: val
  };
};

cs.get.rgb = function (string) {
  if (!string) {
    return null;
  }

  var abbr = /^#([a-f0-9]{3,4})$/i;
  var hex = /^#([a-f0-9]{6})([a-f0-9]{2})?$/i;
  var rgba = /^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/;
  var per = /^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/;
  var keyword = /(\D+)/;
  var rgb = [0, 0, 0, 1];
  var match;
  var i;
  var hexAlpha;

  if (match = string.match(hex)) {
    hexAlpha = match[2];
    match = match[1];

    for (i = 0; i < 3; i++) {
      var i2 = i * 2;
      rgb[i] = parseInt(match.slice(i2, i2 + 2), 16);
    }

    if (hexAlpha) {
      rgb[3] = parseInt(hexAlpha, 16) / 255;
    }
  } else if (match = string.match(abbr)) {
    match = match[1];
    hexAlpha = match[3];

    for (i = 0; i < 3; i++) {
      rgb[i] = parseInt(match[i] + match[i], 16);
    }

    if (hexAlpha) {
      rgb[3] = parseInt(hexAlpha + hexAlpha, 16) / 255;
    }
  } else if (match = string.match(rgba)) {
    for (i = 0; i < 3; i++) {
      rgb[i] = parseInt(match[i + 1], 0);
    }

    if (match[4]) {
      rgb[3] = parseFloat(match[4]);
    }
  } else if (match = string.match(per)) {
    for (i = 0; i < 3; i++) {
      rgb[i] = Math.round(parseFloat(match[i + 1]) * 2.55);
    }

    if (match[4]) {
      rgb[3] = parseFloat(match[4]);
    }
  } else if (match = string.match(keyword)) {
    if (match[1] === 'transparent') {
      return [0, 0, 0, 0];
    }

    rgb = colorNames[match[1]];

    if (!rgb) {
      return null;
    }

    rgb[3] = 1;
    return rgb;
  } else {
    return null;
  }

  for (i = 0; i < 3; i++) {
    rgb[i] = clamp(rgb[i], 0, 255);
  }

  rgb[3] = clamp(rgb[3], 0, 1);
  return rgb;
};

cs.get.hsl = function (string) {
  if (!string) {
    return null;
  }

  var hsl = /^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/;
  var match = string.match(hsl);

  if (match) {
    var alpha = parseFloat(match[4]);
    var h = (parseFloat(match[1]) + 360) % 360;
    var s = clamp(parseFloat(match[2]), 0, 100);
    var l = clamp(parseFloat(match[3]), 0, 100);
    var a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);
    return [h, s, l, a];
  }

  return null;
};

cs.get.hwb = function (string) {
  if (!string) {
    return null;
  }

  var hwb = /^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/;
  var match = string.match(hwb);

  if (match) {
    var alpha = parseFloat(match[4]);
    var h = (parseFloat(match[1]) % 360 + 360) % 360;
    var w = clamp(parseFloat(match[2]), 0, 100);
    var b = clamp(parseFloat(match[3]), 0, 100);
    var a = clamp(isNaN(alpha) ? 1 : alpha, 0, 1);
    return [h, w, b, a];
  }

  return null;
};

cs.to.hex = function () {
  var rgba = swizzle(arguments);
  return '#' + hexDouble(rgba[0]) + hexDouble(rgba[1]) + hexDouble(rgba[2]) + (rgba[3] < 1 ? hexDouble(Math.round(rgba[3] * 255)) : '');
};

cs.to.rgb = function () {
  var rgba = swizzle(arguments);
  return rgba.length < 4 || rgba[3] === 1 ? 'rgb(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ')' : 'rgba(' + Math.round(rgba[0]) + ', ' + Math.round(rgba[1]) + ', ' + Math.round(rgba[2]) + ', ' + rgba[3] + ')';
};

cs.to.rgb.percent = function () {
  var rgba = swizzle(arguments);
  var r = Math.round(rgba[0] / 255 * 100);
  var g = Math.round(rgba[1] / 255 * 100);
  var b = Math.round(rgba[2] / 255 * 100);
  return rgba.length < 4 || rgba[3] === 1 ? 'rgb(' + r + '%, ' + g + '%, ' + b + '%)' : 'rgba(' + r + '%, ' + g + '%, ' + b + '%, ' + rgba[3] + ')';
};

cs.to.hsl = function () {
  var hsla = swizzle(arguments);
  return hsla.length < 4 || hsla[3] === 1 ? 'hsl(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%)' : 'hsla(' + hsla[0] + ', ' + hsla[1] + '%, ' + hsla[2] + '%, ' + hsla[3] + ')';
};

cs.to.hwb = function () {
  var hwba = swizzle(arguments);
  var a = '';

  if (hwba.length >= 4 && hwba[3] !== 1) {
    a = ', ' + hwba[3];
  }

  return 'hwb(' + hwba[0] + ', ' + hwba[1] + '%, ' + hwba[2] + '%' + a + ')';
};

cs.to.keyword = function (rgb) {
  return reverseNames[rgb.slice(0, 3)];
};

function clamp(num, min, max) {
  return Math.min(Math.max(min, num), max);
}

function hexDouble(num) {
  var str = num.toString(16).toUpperCase();
  return str.length < 2 ? '0' + str : str;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImNvbG9yTmFtZXMiLCJyZXF1aXJlIiwic3dpenpsZSIsInJldmVyc2VOYW1lcyIsIm5hbWUiLCJoYXNPd25Qcm9wZXJ0eSIsImNzIiwibW9kdWxlIiwiZXhwb3J0cyIsInRvIiwiZ2V0Iiwic3RyaW5nIiwicHJlZml4Iiwic3Vic3RyaW5nIiwidG9Mb3dlckNhc2UiLCJ2YWwiLCJtb2RlbCIsImhzbCIsImh3YiIsInJnYiIsInZhbHVlIiwiYWJiciIsImhleCIsInJnYmEiLCJwZXIiLCJrZXl3b3JkIiwibWF0Y2giLCJpIiwiaGV4QWxwaGEiLCJpMiIsInBhcnNlSW50Iiwic2xpY2UiLCJwYXJzZUZsb2F0IiwiTWF0aCIsInJvdW5kIiwiY2xhbXAiLCJhbHBoYSIsImgiLCJzIiwibCIsImEiLCJpc05hTiIsInciLCJiIiwiYXJndW1lbnRzIiwiaGV4RG91YmxlIiwibGVuZ3RoIiwicGVyY2VudCIsInIiLCJnIiwiaHNsYSIsImh3YmEiLCJudW0iLCJtaW4iLCJtYXgiLCJzdHIiLCJ0b1N0cmluZyIsInRvVXBwZXJDYXNlIl0sIm1hcHBpbmdzIjoiQUFDQSxJQUFJQSxVQUFVLEdBQUdDLE9BQU8sQ0FBQyxZQUFELENBQXhCOztBQUNBLElBQUlDLE9BQU8sR0FBR0QsT0FBTyxDQUFDLGdCQUFELENBQXJCOztBQUVBLElBQUlFLFlBQVksR0FBRyxFQUFuQjs7QUFHQSxLQUFLLElBQUlDLElBQVQsSUFBaUJKLFVBQWpCLEVBQTZCO0FBQzVCLE1BQUlBLFVBQVUsQ0FBQ0ssY0FBWCxDQUEwQkQsSUFBMUIsQ0FBSixFQUFxQztBQUNwQ0QsSUFBQUEsWUFBWSxDQUFDSCxVQUFVLENBQUNJLElBQUQsQ0FBWCxDQUFaLEdBQWlDQSxJQUFqQztBQUNBO0FBQ0Q7O0FBRUQsSUFBSUUsRUFBRSxHQUFHQyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFDekJDLEVBQUFBLEVBQUUsRUFBRSxFQURxQjtBQUV6QkMsRUFBQUEsR0FBRyxFQUFF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QUFMLElBQWUsQ0FBZixJQUFvQkssSUFBSSxDQUFDLENBQUQsQ0FBSixLQUFZLENBQXBDLEVBQXVDO0FBQ3RDWCxJQUFBQSxDQUFDLEdBQUcsT0FBT1csSUFBSSxDQUFDLENBQUQsQ0FBZjtBQUNBOztBQUVELFNBQU8sU0FBU0EsSUFBSSxDQUFDLENBQUQsQ0FBYixHQUFtQixJQUFuQixHQUEwQkEsSUFBSSxDQUFDLENBQUQsQ0FBOUIsR0FBb0MsS0FBcEMsR0FBNENBLElBQUksQ0FBQyxDQUFELENBQWhELEdBQXNELEdBQXRELEdBQTREWCxDQUE1RCxHQUFnRSxHQUF2RTtBQUNBLENBVEQ7O0FBV0FsQyxFQUFFLENBQUNHLEVBQUgsQ0FBTWdCLE9BQU4sR0FBZ0IsVUFBVU4sR0FBVixFQUFlO0FBQzlCLFNBQU9oQixZQUFZLENBQUNnQixHQUFHLENBQUNZLEtBQUosQ0FBVSxDQUFWLEVBQWEsQ0FBYixDQUFELENBQW5CO0FBQ0EsQ0FGRDs7QUFLQSxTQUFTSSxLQUFULENBQWVpQixHQUFmLEVBQW9CQyxHQUFwQixFQUF5QkMsR0FBekIsRUFBOEI7QUFDN0IsU0FBT3JCLElBQUksQ0FBQ29CLEdBQUwsQ0FBU3BCLElBQUksQ0FBQ3FCLEdBQUwsQ0FBU0QsR0FBVCxFQUFjRCxHQUFkLENBQVQsRUFBNkJFLEdBQTdCLENBQVA7QUFDQTs7QUFFRCxTQUFTVCxTQUFULENBQW1CTyxHQUFuQixFQUF3QjtBQUN2QixNQUFJRyxHQUFHLEdBQUdILEdBQUcsQ0FBQ0ksUUFBSixDQUFhLEVBQWIsRUFBaUJDLFdBQWpCLEVBQVY7QUFDQSxTQUFRRixHQUFHLENBQUNULE1BQUosR0FBYSxDQUFkLEdBQW1CLE1BQU1TLEdBQXpCLEdBQStCQSxHQUF0QztBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiLyogTUlUIGxpY2Vuc2UgKi9cbnZhciBjb2xvck5hbWVzID0gcmVxdWlyZSgnY29sb3ItbmFtZScpO1xudmFyIHN3aXp6bGUgPSByZXF1aXJlKCdzaW1wbGUtc3dpenpsZScpO1xuXG52YXIgcmV2ZXJzZU5hbWVzID0ge307XG5cbi8vIGNyZWF0ZSBhIGxpc3Qgb2YgcmV2ZXJzZSBjb2xvciBuYW1lc1xuZm9yICh2YXIgbmFtZSBpbiBjb2xvck5hbWVzKSB7XG5cdGlmIChjb2xvck5hbWVzLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG5cdFx0cmV2ZXJzZU5hbWVzW2NvbG9yTmFtZXNbbmFtZV1dID0gbmFtZTtcblx0fVxufVxuXG52YXIgY3MgPSBtb2R1bGUuZXhwb3J0cyA9IHtcblx0dG86IHt9LFxuXHRnZXQ6IHt9XG59O1xuXG5jcy5nZXQgPSBmdW5jdGlvbiAoc3RyaW5nKSB7XG5cdHZhciBwcmVmaXggPSBzdHJpbmcuc3Vic3RyaW5nKDAsIDMpLnRvTG93ZXJDYXNlKCk7XG5cdHZhciB2YWw7XG5cdHZhciBtb2RlbDtcblx0c3dpdGNoIChwcmVmaXgpIHtcblx0XHRjYXNlICdoc2wnOlxuXHRcdFx0dmFsID0gY3MuZ2V0LmhzbChzdHJpbmcpO1xuXHRcdFx0bW9kZWwgPSAnaHNsJztcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgJ2h3Yic6XG5cdFx0XHR2YWwgPSBjcy5nZXQuaHdiKHN0cmluZyk7XG5cdFx0XHRtb2RlbCA9ICdod2InO1xuXHRcdFx0YnJlYWs7XG5cdFx0ZGVmYXVsdDpcblx0XHRcdHZhbCA9IGNzLmdldC5yZ2Ioc3RyaW5nKTtcblx0XHRcdG1vZGVsID0gJ3JnYic7XG5cdFx0XHRicmVhaztcblx0fVxuXG5cdGlmICghdmFsKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHRyZXR1cm4ge21vZGVsOiBtb2RlbCwgdmFsdWU6IHZhbH07XG59O1xuXG5jcy5nZXQucmdiID0gZnVuY3Rpb24gKHN0cmluZykge1xuXHRpZiAoIXN0cmluZykge1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0dmFyIGFiYnIgPSAvXiMoW2EtZjAtOV17Myw0fSkkL2k7XG5cdHZhciBoZXggPSAvXiMoW2EtZjAtOV17Nn0pKFthLWYwLTldezJ9KT8kL2k7XG5cdHZhciByZ2JhID0gL15yZ2JhP1xcKFxccyooWystXT9cXGQrKVxccyosXFxzKihbKy1dP1xcZCspXFxzKixcXHMqKFsrLV0/XFxkKylcXHMqKD86LFxccyooWystXT9bXFxkXFwuXSspXFxzKik/XFwpJC87XG5cdHZhciBwZXIgPSAvXnJnYmE/XFwoXFxzKihbKy1dP1tcXGRcXC5dKylcXCVcXHMqLFxccyooWystXT9bXFxkXFwuXSspXFwlXFxzKixcXHMqKFsrLV0/W1xcZFxcLl0rKVxcJVxccyooPzosXFxzKihbKy1dP1tcXGRcXC5dKylcXHMqKT9cXCkkLztcblx0dmFyIGtleXdvcmQgPSAvKFxcRCspLztcblxuXHR2YXIgcmdiID0gWzAsIDAsIDAsIDFdO1xuXHR2YXIgbWF0Y2g7XG5cdHZhciBpO1xuXHR2YXIgaGV4QWxwaGE7XG5cblx0aWYgKG1hdGNoID0gc3RyaW5nLm1hdGNoKGhleCkpIHtcblx0XHRoZXhBbHBoYSA9IG1hdGNoWzJdO1xuXHRcdG1hdGNoID0gbWF0Y2hbMV07XG5cblx0XHRmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7XG5cdFx0XHQvLyBodHRwczovL2pzcGVyZi5jb20vc2xpY2UtdnMtc3Vic3RyLXZzLXN1YnN0cmluZy1tZXRob2RzLWxvbmctc3RyaW5nLzE5XG5cdFx0XHR2YXIgaTIgPSBpICogMjtcblx0XHRcdHJnYltpXSA9IHBhcnNlSW50KG1hdGNoLnNsaWNlKGkyLCBpMiArIDIpLCAxNik7XG5cdFx0fVxuXG5cdFx0aWYgKGhleEFscGhhKSB7XG5cdFx0XHRyZ2JbM10gPSBwYXJzZUludChoZXhBbHBoYSwgMTYpIC8gMjU1O1xuXHRcdH1cblx0fSBlbHNlIGlmIChtYXRjaCA9IHN0cmluZy5tYXRjaChhYmJyKSkge1xuXHRcdG1hdGNoID0gbWF0Y2hbMV07XG5cdFx0aGV4QWxwaGEgPSBtYXRjaFszXTtcblxuXHRcdGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHtcblx0XHRcdHJnYltpXSA9IHBhcnNlSW50KG1hdGNoW2ldICsgbWF0Y2hbaV0sIDE2KTtcblx0XHR9XG5cblx0XHRpZiAoaGV4QWxwaGEpIHtcblx0XHRcdHJnYlszXSA9IHBhcnNlSW50KGhleEFscGhhICsgaGV4QWxwaGEsIDE2KSAvIDI1NTtcblx0XHR9XG5cdH0gZWxzZSBpZiAobWF0Y2ggPSBzdHJpbmcubWF0Y2gocmdiYSkpIHtcblx0XHRmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7XG5cdFx0XHRyZ2JbaV0gPSBwYXJzZUludChtYXRjaFtpICsgMV0sIDApO1xuXHRcdH1cblxuXHRcdGlmIChtYXRjaFs0XSkge1xuXHRcdFx0cmdiWzNdID0gcGFyc2VGbG9hdChtYXRjaFs0XSk7XG5cdFx0fVxuXHR9IGVsc2UgaWYgKG1hdGNoID0gc3RyaW5nLm1hdGNoKHBlcikpIHtcblx0XHRmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7XG5cdFx0XHRyZ2JbaV0gPSBNYXRoLnJvdW5kKHBhcnNlRmxvYXQobWF0Y2hbaSArIDFdKSAqIDIuNTUpO1xuXHRcdH1cblxuXHRcdGlmIChtYXRjaFs0XSkge1xuXHRcdFx0cmdiWzNdID0gcGFyc2VGbG9hdChtYXRjaFs0XSk7XG5cdFx0fVxuXHR9IGVsc2UgaWYgKG1hdGNoID0gc3RyaW5nLm1hdGNoKGtleXdvcmQpKSB7XG5cdFx0aWYgKG1hdGNoWzFdID09PSAndHJhbnNwYXJlbnQnKSB7XG5cdFx0XHRyZXR1cm4gWzAsIDAsIDAsIDBdO1xuXHRcdH1cblxuXHRcdHJnYiA9IGNvbG9yTmFtZXNbbWF0Y2hbMV1dO1xuXG5cdFx0aWYgKCFyZ2IpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdHJnYlszXSA9IDE7XG5cblx0XHRyZXR1cm4gcmdiO1xuXHR9IGVsc2Uge1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0Zm9yIChpID0gMDsgaSA8IDM7IGkrKykge1xuXHRcdHJnYltpXSA9IGNsYW1wKHJnYltpXSwgMCwgMjU1KTtcblx0fVxuXHRyZ2JbM10gPSBjbGFtcChyZ2JbM10sIDAsIDEpO1xuXG5cdHJldHVybiByZ2I7XG59O1xuXG5jcy5nZXQuaHNsID0gZnVuY3Rpb24gKHN0cmluZykge1xuXHRpZiAoIXN0cmluZykge1xuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0dmFyIGhzbCA9IC9eaHNsYT9cXChcXHMqKFsrLV0/KD86XFxkezAsM31cXC4pP1xcZCspKD86ZGVnKT9cXHMqLFxccyooWystXT9bXFxkXFwuXSspJVxccyosXFxzKihbKy1dP1tcXGRcXC5dKyklXFxzKig/OixcXHMqKFsrLV0/W1xcZFxcLl0rKVxccyopP1xcKSQvO1xuXHR2YXIgbWF0Y2ggPSBzdHJpbmcubWF0Y2goaHNsKTtcblxuXHRpZiAobWF0Y2gpIHtcblx0XHR2YXIgYWxwaGEgPSBwYXJzZUZsb2F0KG1hdGNoWzRdKTtcblx0XHR2YXIgaCA9IChwYXJzZUZsb2F0KG1hdGNoWzFdKSArIDM2MCkgJSAzNjA7XG5cdFx0dmFyIHMgPSBjbGFtcChwYXJzZUZsb2F0KG1hdGNoWzJdKSwgMCwgMTAwKTtcblx0XHR2YXIgbCA9IGNsYW1wKHBhcnNlRmxvYXQobWF0Y2hbM10pLCAwLCAxMDApO1xuXHRcdHZhciBhID0gY2xhbXAoaXNOYU4oYWxwaGEpID8gMSA6IGFscGhhLCAwLCAxKTtcblxuXHRcdHJldHVybiBbaCwgcywgbCwgYV07XG5cdH1cblxuXHRyZXR1cm4gbnVsbDtcbn07XG5cbmNzLmdldC5od2IgPSBmdW5jdGlvbiAoc3RyaW5nKSB7XG5cdGlmICghc3RyaW5nKSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblxuXHR2YXIgaHdiID0gL15od2JcXChcXHMqKFsrLV0/XFxkezAsM30oPzpcXC5cXGQrKT8pKD86ZGVnKT9cXHMqLFxccyooWystXT9bXFxkXFwuXSspJVxccyosXFxzKihbKy1dP1tcXGRcXC5dKyklXFxzKig/OixcXHMqKFsrLV0/W1xcZFxcLl0rKVxccyopP1xcKSQvO1xuXHR2YXIgbWF0Y2ggPSBzdHJpbmcubWF0Y2goaHdiKTtcblxuXHRpZiAobWF0Y2gpIHtcblx0XHR2YXIgYWxwaGEgPSBwYXJzZUZsb2F0KG1hdGNoWzRdKTtcblx0XHR2YXIgaCA9ICgocGFyc2VGbG9hdChtYXRjaFsxXSkgJSAzNjApICsgMzYwKSAlIDM2MDtcblx0XHR2YXIgdyA9IGNsYW1wKHBhcnNlRmxvYXQobWF0Y2hbMl0pLCAwLCAxMDApO1xuXHRcdHZhciBiID0gY2xhbXAocGFyc2VGbG9hdChtYXRjaFszXSksIDAsIDEwMCk7XG5cdFx0dmFyIGEgPSBjbGFtcChpc05hTihhbHBoYSkgPyAxIDogYWxwaGEsIDAsIDEpO1xuXHRcdHJldHVybiBbaCwgdywgYiwgYV07XG5cdH1cblxuXHRyZXR1cm4gbnVsbDtcbn07XG5cbmNzLnRvLmhleCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHJnYmEgPSBzd2l6emxlKGFyZ3VtZW50cyk7XG5cblx0cmV0dXJuIChcblx0XHQnIycgK1xuXHRcdGhleERvdWJsZShyZ2JhWzBdKSArXG5cdFx0aGV4RG91YmxlKHJnYmFbMV0pICtcblx0XHRoZXhEb3VibGUocmdiYVsyXSkgK1xuXHRcdChyZ2JhWzNdIDwgMVxuXHRcdFx0PyAoaGV4RG91YmxlKE1hdGgucm91bmQocmdiYVszXSAqIDI1NSkpKVxuXHRcdFx0OiAnJylcblx0KTtcbn07XG5cbmNzLnRvLnJnYiA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHJnYmEgPSBzd2l6emxlKGFyZ3VtZW50cyk7XG5cblx0cmV0dXJuIHJnYmEubGVuZ3RoIDwgNCB8fCByZ2JhWzNdID09PSAxXG5cdFx0PyAncmdiKCcgKyBNYXRoLnJvdW5kKHJnYmFbMF0pICsgJywgJyArIE1hdGgucm91bmQocmdiYVsxXSkgKyAnLCAnICsgTWF0aC5yb3VuZChyZ2JhWzJdKSArICcpJ1xuXHRcdDogJ3JnYmEoJyArIE1hdGgucm91bmQocmdiYVswXSkgKyAnLCAnICsgTWF0aC5yb3VuZChyZ2JhWzFdKSArICcsICcgKyBNYXRoLnJvdW5kKHJnYmFbMl0pICsgJywgJyArIHJnYmFbM10gKyAnKSc7XG59O1xuXG5jcy50by5yZ2IucGVyY2VudCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIHJnYmEgPSBzd2l6emxlKGFyZ3VtZW50cyk7XG5cblx0dmFyIHIgPSBNYXRoLnJvdW5kKHJnYmFbMF0gLyAyNTUgKiAxMDApO1xuXHR2YXIgZyA9IE1hdGgucm91bmQocmdiYVsxXSAvIDI1NSAqIDEwMCk7XG5cdHZhciBiID0gTWF0aC5yb3VuZChyZ2JhWzJdIC8gMjU1ICogMTAwKTtcblxuXHRyZXR1cm4gcmdiYS5sZW5ndGggPCA0IHx8IHJnYmFbM10gPT09IDFcblx0XHQ/ICdyZ2IoJyArIHIgKyAnJSwgJyArIGcgKyAnJSwgJyArIGIgKyAnJSknXG5cdFx0OiAncmdiYSgnICsgciArICclLCAnICsgZyArICclLCAnICsgYiArICclLCAnICsgcmdiYVszXSArICcpJztcbn07XG5cbmNzLnRvLmhzbCA9IGZ1bmN0aW9uICgpIHtcblx0dmFyIGhzbGEgPSBzd2l6emxlKGFyZ3VtZW50cyk7XG5cdHJldHVybiBoc2xhLmxlbmd0aCA8IDQgfHwgaHNsYVszXSA9PT0gMVxuXHRcdD8gJ2hzbCgnICsgaHNsYVswXSArICcsICcgKyBoc2xhWzFdICsgJyUsICcgKyBoc2xhWzJdICsgJyUpJ1xuXHRcdDogJ2hzbGEoJyArIGhzbGFbMF0gKyAnLCAnICsgaHNsYVsxXSArICclLCAnICsgaHNsYVsyXSArICclLCAnICsgaHNsYVszXSArICcpJztcbn07XG5cbi8vIGh3YiBpcyBhIGJpdCBkaWZmZXJlbnQgdGhhbiByZ2IoYSkgJiBoc2woYSkgc2luY2UgdGhlcmUgaXMgbm8gYWxwaGEgc3BlY2lmaWMgc3ludGF4XG4vLyAoaHdiIGhhdmUgYWxwaGEgb3B0aW9uYWwgJiAxIGlzIGRlZmF1bHQgdmFsdWUpXG5jcy50by5od2IgPSBmdW5jdGlvbiAoKSB7XG5cdHZhciBod2JhID0gc3dpenpsZShhcmd1bWVudHMpO1xuXG5cdHZhciBhID0gJyc7XG5cdGlmIChod2JhLmxlbmd0aCA+PSA0ICYmIGh3YmFbM10gIT09IDEpIHtcblx0XHRhID0gJywgJyArIGh3YmFbM107XG5cdH1cblxuXHRyZXR1cm4gJ2h3YignICsgaHdiYVswXSArICcsICcgKyBod2JhWzFdICsgJyUsICcgKyBod2JhWzJdICsgJyUnICsgYSArICcpJztcbn07XG5cbmNzLnRvLmtleXdvcmQgPSBmdW5jdGlvbiAocmdiKSB7XG5cdHJldHVybiByZXZlcnNlTmFtZXNbcmdiLnNsaWNlKDAsIDMpXTtcbn07XG5cbi8vIGhlbHBlcnNcbmZ1bmN0aW9uIGNsYW1wKG51bSwgbWluLCBtYXgpIHtcblx0cmV0dXJuIE1hdGgubWluKE1hdGgubWF4KG1pbiwgbnVtKSwgbWF4KTtcbn1cblxuZnVuY3Rpb24gaGV4RG91YmxlKG51bSkge1xuXHR2YXIgc3RyID0gbnVtLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpO1xuXHRyZXR1cm4gKHN0ci5sZW5ndGggPCAyKSA/ICcwJyArIHN0ciA6IHN0cjtcbn1cbiJdfQ==