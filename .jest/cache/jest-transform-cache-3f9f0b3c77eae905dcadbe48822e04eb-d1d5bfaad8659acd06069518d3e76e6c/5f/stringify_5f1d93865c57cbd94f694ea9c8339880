ad02b99f76558f132f03fd5498f26c38
exports = module.exports = stringify;
exports.getSerialize = serializer;

function stringify(obj, replacer, spaces, cycleReplacer) {
  return JSON.stringify(obj, serializer(replacer, cycleReplacer), spaces);
}

function serializer(replacer, cycleReplacer) {
  var stack = [],
      keys = [];
  if (cycleReplacer == null) cycleReplacer = function cycleReplacer(key, value) {
    if (stack[0] === value) return "[Circular ~]";
    return "[Circular ~." + keys.slice(0, stack.indexOf(value)).join(".") + "]";
  };
  return function (key, value) {
    if (stack.length > 0) {
      var thisPos = stack.indexOf(this);
      ~thisPos ? stack.splice(thisPos + 1) : stack.push(this);
      ~thisPos ? keys.splice(thisPos, Infinity, key) : keys.push(key);
      if (~stack.indexOf(value)) value = cycleReplacer.call(this, key, value);
    } else stack.push(value);

    return replacer == null ? value : replacer.call(this, key, value);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN0cmluZ2lmeS5qcyJdLCJuYW1lcyI6WyJleHBvcnRzIiwibW9kdWxlIiwic3RyaW5naWZ5IiwiZ2V0U2VyaWFsaXplIiwic2VyaWFsaXplciIsIm9iaiIsInJlcGxhY2VyIiwic3BhY2VzIiwiY3ljbGVSZXBsYWNlciIsIkpTT04iLCJzdGFjayIsImtleXMiLCJrZXkiLCJ2YWx1ZSIsInNsaWNlIiwiaW5kZXhPZiIsImpvaW4iLCJsZW5ndGgiLCJ0aGlzUG9zIiwic3BsaWNlIiwicHVzaCIsIkluZmluaXR5IiwiY2FsbCJdLCJtYXBwaW5ncyI6IkFBQUFBLE9BQU8sR0FBR0MsTUFBTSxDQUFDRCxPQUFQLEdBQWlCRSxTQUEzQjtBQUNBRixPQUFPLENBQUNHLFlBQVIsR0FBdUJDLFVBQXZCOztBQUVBLFNBQVNGLFNBQVQsQ0FBbUJHLEdBQW5CLEVBQXdCQyxRQUF4QixFQUFrQ0MsTUFBbEMsRUFBMENDLGFBQTFDLEVBQXlEO0FBQ3ZELFNBQU9DLElBQUksQ0FBQ1AsU0FBTCxDQUFlRyxHQUFmLEVBQW9CRCxVQUFVLENBQUNFLFFBQUQsRUFBV0UsYUFBWCxDQUE5QixFQUF5REQsTUFBekQsQ0FBUDtBQUNEOztBQUVELFNBQVNILFVBQVQsQ0FBb0JFLFFBQXBCLEVBQThCRSxhQUE5QixFQUE2QztBQUMzQyxNQUFJRSxLQUFLLEdBQUcsRUFBWjtBQUFBLE1BQWdCQyxJQUFJLEdBQUcsRUFBdkI7QUFFQSxNQUFJSCxhQUFhLElBQUksSUFBckIsRUFBMkJBLGFBQWEsR0FBRyx1QkFBU0ksR0FBVCxFQUFjQyxLQUFkLEVBQXFCO0FBQzlELFFBQUlILEtBQUssQ0FBQyxDQUFELENBQUwsS0FBYUcsS0FBakIsRUFBd0IsT0FBTyxjQUFQO0FBQ3hCLFdBQU8saUJBQWlCRixJQUFJLENBQUNHLEtBQUwsQ0FBVyxDQUFYLEVBQWNKLEtBQUssQ0FBQ0ssT0FBTixDQUFjRixLQUFkLENBQWQsRUFBb0NHLElBQXBDLENBQXlDLEdBQXpDLENBQWpCLEdBQWlFLEdBQXhFO0FBQ0QsR0FIMEI7QUFLM0IsU0FBTyxVQUFTSixHQUFULEVBQWNDLEtBQWQsRUFBcUI7QUFDMUIsUUFBSUgsS0FBSyxDQUFDTyxNQUFOLEdBQWUsQ0FBbkIsRUFBc0I7QUFDcEIsVUFBSUMsT0FBTyxHQUFHUixLQUFLLENBQUNLLE9BQU4sQ0FBYyxJQUFkLENBQWQ7QUFDQSxPQUFDRyxPQUFELEdBQVdSLEtBQUssQ0FBQ1MsTUFBTixDQUFhRCxPQUFPLEdBQUcsQ0FBdkIsQ0FBWCxHQUF1Q1IsS0FBSyxDQUFDVSxJQUFOLENBQVcsSUFBWCxDQUF2QztBQUNBLE9BQUNGLE9BQUQsR0FBV1AsSUFBSSxDQUFDUSxNQUFMLENBQVlELE9BQVosRUFBcUJHLFFBQXJCLEVBQStCVCxHQUEvQixDQUFYLEdBQWlERCxJQUFJLENBQUNTLElBQUwsQ0FBVVIsR0FBVixDQUFqRDtBQUNBLFVBQUksQ0FBQ0YsS0FBSyxDQUFDSyxPQUFOLENBQWNGLEtBQWQsQ0FBTCxFQUEyQkEsS0FBSyxHQUFHTCxhQUFhLENBQUNjLElBQWQsQ0FBbUIsSUFBbkIsRUFBeUJWLEdBQXpCLEVBQThCQyxLQUE5QixDQUFSO0FBQzVCLEtBTEQsTUFNS0gsS0FBSyxDQUFDVSxJQUFOLENBQVdQLEtBQVg7O0FBRUwsV0FBT1AsUUFBUSxJQUFJLElBQVosR0FBbUJPLEtBQW5CLEdBQTJCUCxRQUFRLENBQUNnQixJQUFULENBQWMsSUFBZCxFQUFvQlYsR0FBcEIsRUFBeUJDLEtBQXpCLENBQWxDO0FBQ0QsR0FWRDtBQVdEIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0cyA9IG1vZHVsZS5leHBvcnRzID0gc3RyaW5naWZ5XG5leHBvcnRzLmdldFNlcmlhbGl6ZSA9IHNlcmlhbGl6ZXJcblxuZnVuY3Rpb24gc3RyaW5naWZ5KG9iaiwgcmVwbGFjZXIsIHNwYWNlcywgY3ljbGVSZXBsYWNlcikge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqLCBzZXJpYWxpemVyKHJlcGxhY2VyLCBjeWNsZVJlcGxhY2VyKSwgc3BhY2VzKVxufVxuXG5mdW5jdGlvbiBzZXJpYWxpemVyKHJlcGxhY2VyLCBjeWNsZVJlcGxhY2VyKSB7XG4gIHZhciBzdGFjayA9IFtdLCBrZXlzID0gW11cblxuICBpZiAoY3ljbGVSZXBsYWNlciA9PSBudWxsKSBjeWNsZVJlcGxhY2VyID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgIGlmIChzdGFja1swXSA9PT0gdmFsdWUpIHJldHVybiBcIltDaXJjdWxhciB+XVwiXG4gICAgcmV0dXJuIFwiW0NpcmN1bGFyIH4uXCIgKyBrZXlzLnNsaWNlKDAsIHN0YWNrLmluZGV4T2YodmFsdWUpKS5qb2luKFwiLlwiKSArIFwiXVwiXG4gIH1cblxuICByZXR1cm4gZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuICAgIGlmIChzdGFjay5sZW5ndGggPiAwKSB7XG4gICAgICB2YXIgdGhpc1BvcyA9IHN0YWNrLmluZGV4T2YodGhpcylcbiAgICAgIH50aGlzUG9zID8gc3RhY2suc3BsaWNlKHRoaXNQb3MgKyAxKSA6IHN0YWNrLnB1c2godGhpcylcbiAgICAgIH50aGlzUG9zID8ga2V5cy5zcGxpY2UodGhpc1BvcywgSW5maW5pdHksIGtleSkgOiBrZXlzLnB1c2goa2V5KVxuICAgICAgaWYgKH5zdGFjay5pbmRleE9mKHZhbHVlKSkgdmFsdWUgPSBjeWNsZVJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSlcbiAgICB9XG4gICAgZWxzZSBzdGFjay5wdXNoKHZhbHVlKVxuXG4gICAgcmV0dXJuIHJlcGxhY2VyID09IG51bGwgPyB2YWx1ZSA6IHJlcGxhY2VyLmNhbGwodGhpcywga2V5LCB2YWx1ZSlcbiAgfVxufVxuIl19