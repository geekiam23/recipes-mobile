9d4f80d2d7d3a248d79908a6840db022
"use strict";

exports.__esModule = true;
exports.computeTextAlternative = computeTextAlternative;

var _array = _interopRequireDefault(require("./polyfills/array.from"));

var _SetLike = _interopRequireDefault(require("./polyfills/SetLike"));

var _util = require("./util");

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function asFlatString(s) {
  return s.trim().replace(/\s\s+/g, " ");
}

function isHidden(node, getComputedStyleImplementation) {
  if (!(0, _util.isElement)(node)) {
    return false;
  }

  if (node.hasAttribute("hidden") || node.getAttribute("aria-hidden") === "true") {
    return true;
  }

  var style = getComputedStyleImplementation(node);
  return style.getPropertyValue("display") === "none" || style.getPropertyValue("visibility") === "hidden";
}

function isControl(node) {
  return (0, _util.hasAnyConcreteRoles)(node, ["button", "combobox", "listbox", "textbox"]) || hasAbstractRole(node, "range");
}

function hasAbstractRole(node, role) {
  if (!(0, _util.isElement)(node)) {
    return false;
  }

  switch (role) {
    case "range":
      return (0, _util.hasAnyConcreteRoles)(node, ["meter", "progressbar", "scrollbar", "slider", "spinbutton"]);

    default:
      throw new TypeError("No knowledge about abstract role '".concat(role, "'. This is likely a bug :("));
  }
}

function querySelectorAllSubtree(element, selectors) {
  var elements = (0, _array.default)(element.querySelectorAll(selectors));
  (0, _util.queryIdRefs)(element, "aria-owns").forEach(function (root) {
    elements.push.apply(elements, (0, _array.default)(root.querySelectorAll(selectors)));
  });
  return elements;
}

function querySelectedOptions(listbox) {
  if ((0, _util.isHTMLSelectElement)(listbox)) {
    return listbox.selectedOptions || querySelectorAllSubtree(listbox, "[selected]");
  }

  return querySelectorAllSubtree(listbox, '[aria-selected="true"]');
}

function isMarkedPresentational(node) {
  return (0, _util.hasAnyConcreteRoles)(node, ["none", "presentation"]);
}

function isNativeHostLanguageTextAlternativeElement(node) {
  return (0, _util.isHTMLTableCaptionElement)(node);
}

function allowsNameFromContent(node) {
  return (0, _util.hasAnyConcreteRoles)(node, ["button", "cell", "checkbox", "columnheader", "gridcell", "heading", "label", "legend", "link", "menuitem", "menuitemcheckbox", "menuitemradio", "option", "radio", "row", "rowheader", "switch", "tab", "tooltip", "treeitem"]);
}

function isDescendantOfNativeHostLanguageTextAlternativeElement(node) {
  return false;
}

function computeTooltipAttributeValue(node) {
  return null;
}

function getValueOfTextbox(element) {
  if ((0, _util.isHTMLInputElement)(element) || (0, _util.isHTMLTextAreaElement)(element)) {
    return element.value;
  }

  return element.textContent || "";
}

function getTextualContent(declaration) {
  var content = declaration.getPropertyValue("content");

  if (/^["'].*["']$/.test(content)) {
    return content.slice(1, -1);
  }

  return "";
}

function isLabelableElement(element) {
  var localName = (0, _util.getLocalName)(element);
  return localName === "button" || localName === "input" && element.getAttribute("type") !== "hidden" || localName === "meter" || localName === "output" || localName === "progress" || localName === "select" || localName === "textarea";
}

function findLabelableElement(element) {
  if (isLabelableElement(element)) {
    return element;
  }

  var labelableElement = null;
  element.childNodes.forEach(function (childNode) {
    if (labelableElement === null && (0, _util.isElement)(childNode)) {
      var descendantLabelableElement = findLabelableElement(childNode);

      if (descendantLabelableElement !== null) {
        labelableElement = descendantLabelableElement;
      }
    }
  });
  return labelableElement;
}

function getControlOfLabel(label) {
  if (label.control !== undefined) {
    return label.control;
  }

  var htmlFor = label.getAttribute("for");

  if (htmlFor !== null) {
    return label.ownerDocument.getElementById(htmlFor);
  }

  return findLabelableElement(label);
}

function getLabels(element) {
  var labelsProperty = element.labels;

  if (labelsProperty === null) {
    return labelsProperty;
  }

  if (labelsProperty !== undefined) {
    return (0, _array.default)(labelsProperty);
  }

  if (!isLabelableElement(element)) {
    return null;
  }

  var document = element.ownerDocument;
  return (0, _array.default)(document.querySelectorAll("label")).filter(function (label) {
    return getControlOfLabel(label) === element;
  });
}

function getSlotContents(slot) {
  var assignedNodes = slot.assignedNodes();

  if (assignedNodes.length === 0) {
    return (0, _array.default)(slot.childNodes);
  }

  return assignedNodes;
}

function computeTextAlternative(root) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var consultedNodes = new _SetLike.default();
  var window = (0, _util.safeWindow)(root);
  var _options$compute = options.compute,
      compute = _options$compute === void 0 ? "name" : _options$compute,
      _options$computedStyl = options.computedStyleSupportsPseudoElements,
      computedStyleSupportsPseudoElements = _options$computedStyl === void 0 ? options.getComputedStyle !== undefined : _options$computedStyl,
      _options$getComputedS = options.getComputedStyle,
      getComputedStyle = _options$getComputedS === void 0 ? window.getComputedStyle.bind(window) : _options$getComputedS;

  function computeMiscTextAlternative(node, context) {
    var accumulatedText = "";

    if ((0, _util.isElement)(node) && computedStyleSupportsPseudoElements) {
      var pseudoBefore = getComputedStyle(node, "::before");
      var beforeContent = getTextualContent(pseudoBefore);
      accumulatedText = "".concat(beforeContent, " ").concat(accumulatedText);
    }

    var childNodes = (0, _util.isHTMLSlotElement)(node) ? getSlotContents(node) : (0, _array.default)(node.childNodes).concat((0, _util.queryIdRefs)(node, "aria-owns"));
    childNodes.forEach(function (child) {
      var result = computeTextAlternative(child, {
        isEmbeddedInLabel: context.isEmbeddedInLabel,
        isReferenced: false,
        recursion: true
      });
      var display = (0, _util.isElement)(child) ? getComputedStyle(child).getPropertyValue("display") : "inline";
      var separator = display !== "inline" ? " " : "";
      accumulatedText += "".concat(separator).concat(result).concat(separator);
    });

    if ((0, _util.isElement)(node) && computedStyleSupportsPseudoElements) {
      var pseudoAfter = getComputedStyle(node, "::after");
      var afterContent = getTextualContent(pseudoAfter);
      accumulatedText = "".concat(accumulatedText, " ").concat(afterContent);
    }

    return accumulatedText;
  }

  function computeElementTextAlternative(node) {
    if (!(0, _util.isElement)(node)) {
      return null;
    }

    function useAttribute(element, attributeName) {
      var attribute = element.getAttributeNode(attributeName);

      if (attribute !== null && !consultedNodes.has(attribute) && attribute.value.trim() !== "") {
        consultedNodes.add(attribute);
        return attribute.value;
      }

      return null;
    }

    if ((0, _util.isHTMLFieldSetElement)(node)) {
      consultedNodes.add(node);
      var children = (0, _array.default)(node.childNodes);

      for (var i = 0; i < children.length; i += 1) {
        var child = children[i];

        if ((0, _util.isHTMLLegendElement)(child)) {
          return computeTextAlternative(child, {
            isEmbeddedInLabel: false,
            isReferenced: false,
            recursion: false
          });
        }
      }
    } else if ((0, _util.isHTMLTableElement)(node)) {
      consultedNodes.add(node);

      var _children = (0, _array.default)(node.childNodes);

      for (var _i = 0; _i < _children.length; _i += 1) {
        var _child = _children[_i];

        if ((0, _util.isHTMLTableCaptionElement)(_child)) {
          return computeTextAlternative(_child, {
            isEmbeddedInLabel: false,
            isReferenced: false,
            recursion: false
          });
        }
      }
    } else if ((0, _util.isSVGSVGElement)(node)) {
      consultedNodes.add(node);

      var _children2 = (0, _array.default)(node.childNodes);

      for (var _i2 = 0; _i2 < _children2.length; _i2 += 1) {
        var _child2 = _children2[_i2];

        if ((0, _util.isSVGTitleElement)(_child2)) {
          return _child2.textContent;
        }
      }

      return null;
    } else if ((0, _util.getLocalName)(node) === "img" || (0, _util.getLocalName)(node) === "area") {
      var nameFromAlt = useAttribute(node, "alt");

      if (nameFromAlt !== null) {
        return nameFromAlt;
      }
    } else if ((0, _util.isHTMLOptGroupElement)(node)) {
      var nameFromLabel = useAttribute(node, "label");

      if (nameFromLabel !== null) {
        return nameFromLabel;
      }
    }

    if ((0, _util.isHTMLInputElement)(node) && (node.type === "button" || node.type === "submit" || node.type === "reset")) {
      var nameFromValue = useAttribute(node, "value");

      if (nameFromValue !== null) {
        return nameFromValue;
      }

      if (node.type === "submit") {
        return "Submit";
      }

      if (node.type === "reset") {
        return "Reset";
      }
    }

    var labels = getLabels(node);

    if (labels !== null && labels.length !== 0) {
      consultedNodes.add(node);
      return (0, _array.default)(labels).map(function (element) {
        return computeTextAlternative(element, {
          isEmbeddedInLabel: true,
          isReferenced: false,
          recursion: true
        });
      }).filter(function (label) {
        return label.length > 0;
      }).join(" ");
    }

    if ((0, _util.isHTMLInputElement)(node) && node.type === "image") {
      var _nameFromAlt = useAttribute(node, "alt");

      if (_nameFromAlt !== null) {
        return _nameFromAlt;
      }

      var nameFromTitle = useAttribute(node, "title");

      if (nameFromTitle !== null) {
        return nameFromTitle;
      }

      return "Submit Query";
    }

    return useAttribute(node, "title");
  }

  function computeTextAlternative(current, context) {
    if (consultedNodes.has(current)) {
      return "";
    }

    if ((0, _util.hasAnyConcreteRoles)(current, ["menu"])) {
      consultedNodes.add(current);
      return "";
    }

    if (isHidden(current, getComputedStyle) && !context.isReferenced) {
      consultedNodes.add(current);
      return "";
    }

    var labelElements = (0, _util.queryIdRefs)(current, "aria-labelledby");

    if (compute === "name" && !context.isReferenced && labelElements.length > 0) {
      return labelElements.map(function (element) {
        return computeTextAlternative(element, {
          isEmbeddedInLabel: context.isEmbeddedInLabel,
          isReferenced: true,
          recursion: false
        });
      }).join(" ");
    }

    var skipToStep2E = context.recursion && isControl(current) && compute === "name";

    if (!skipToStep2E) {
      var ariaLabel = ((0, _util.isElement)(current) && current.getAttribute("aria-label") || "").trim();

      if (ariaLabel !== "" && compute === "name") {
        consultedNodes.add(current);
        return ariaLabel;
      }

      if (!isMarkedPresentational(current)) {
        var elementTextAlternative = computeElementTextAlternative(current);

        if (elementTextAlternative !== null) {
          consultedNodes.add(current);
          return elementTextAlternative;
        }
      }
    }

    if (skipToStep2E || context.isEmbeddedInLabel || context.isReferenced) {
      if ((0, _util.hasAnyConcreteRoles)(current, ["combobox", "listbox"])) {
        consultedNodes.add(current);
        var selectedOptions = querySelectedOptions(current);

        if (selectedOptions.length === 0) {
          return (0, _util.isHTMLInputElement)(current) ? current.value : "";
        }

        return (0, _array.default)(selectedOptions).map(function (selectedOption) {
          return computeTextAlternative(selectedOption, {
            isEmbeddedInLabel: context.isEmbeddedInLabel,
            isReferenced: false,
            recursion: true
          });
        }).join(" ");
      }

      if (hasAbstractRole(current, "range")) {
        consultedNodes.add(current);

        if (current.hasAttribute("aria-valuetext")) {
          return current.getAttribute("aria-valuetext");
        }

        if (current.hasAttribute("aria-valuenow")) {
          return current.getAttribute("aria-valuenow");
        }

        return current.getAttribute("value") || "";
      }

      if ((0, _util.hasAnyConcreteRoles)(current, ["textbox"])) {
        consultedNodes.add(current);
        return getValueOfTextbox(current);
      }
    }

    if (allowsNameFromContent(current) || (0, _util.isElement)(current) && context.isReferenced || isNativeHostLanguageTextAlternativeElement(current) || isDescendantOfNativeHostLanguageTextAlternativeElement(current)) {
      consultedNodes.add(current);
      return computeMiscTextAlternative(current, {
        isEmbeddedInLabel: context.isEmbeddedInLabel,
        isReferenced: false
      });
    }

    if (current.nodeType === current.TEXT_NODE) {
      consultedNodes.add(current);
      return current.textContent || "";
    }

    if (context.recursion) {
      consultedNodes.add(current);
      return computeMiscTextAlternative(current, {
        isEmbeddedInLabel: context.isEmbeddedInLabel,
        isReferenced: false
      });
    }

    var tooltipAttributeValue = computeTooltipAttributeValue(current);

    if (tooltipAttributeValue !== null) {
      consultedNodes.add(current);
      return tooltipAttributeValue;
    }

    consultedNodes.add(current);
    return "";
  }

  return asFlatString(computeTextAlternative(root, {
    isEmbeddedInLabel: false,
    isReferenced: compute === "description",
    recursion: false
  }));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NvdXJjZXMvYWNjZXNzaWJsZS1uYW1lLWFuZC1kZXNjcmlwdGlvbi50cyJdLCJuYW1lcyI6WyJzIiwibm9kZSIsInN0eWxlIiwiZ2V0Q29tcHV0ZWRTdHlsZUltcGxlbWVudGF0aW9uIiwiaGFzQWJzdHJhY3RSb2xlIiwiZWxlbWVudHMiLCJlbGVtZW50Iiwicm9vdCIsImxpc3Rib3giLCJxdWVyeVNlbGVjdG9yQWxsU3VidHJlZSIsImNvbnRlbnQiLCJkZWNsYXJhdGlvbiIsImxvY2FsTmFtZSIsImlzTGFiZWxhYmxlRWxlbWVudCIsImxhYmVsYWJsZUVsZW1lbnQiLCJkZXNjZW5kYW50TGFiZWxhYmxlRWxlbWVudCIsImZpbmRMYWJlbGFibGVFbGVtZW50IiwibGFiZWwiLCJodG1sRm9yIiwibGFiZWxzUHJvcGVydHkiLCJkb2N1bWVudCIsImdldENvbnRyb2xPZkxhYmVsIiwiYXNzaWduZWROb2RlcyIsInNsb3QiLCJvcHRpb25zIiwiY29uc3VsdGVkTm9kZXMiLCJTZXRMaWtlIiwid2luZG93IiwiY29tcHV0ZSIsImNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzIiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImFjY3VtdWxhdGVkVGV4dCIsInBzZXVkb0JlZm9yZSIsImJlZm9yZUNvbnRlbnQiLCJnZXRUZXh0dWFsQ29udGVudCIsImNoaWxkTm9kZXMiLCJnZXRTbG90Q29udGVudHMiLCJyZXN1bHQiLCJjb21wdXRlVGV4dEFsdGVybmF0aXZlIiwiaXNFbWJlZGRlZEluTGFiZWwiLCJjb250ZXh0IiwiaXNSZWZlcmVuY2VkIiwicmVjdXJzaW9uIiwiZGlzcGxheSIsInNlcGFyYXRvciIsInBzZXVkb0FmdGVyIiwiYWZ0ZXJDb250ZW50IiwiYXR0cmlidXRlIiwiY2hpbGRyZW4iLCJpIiwiY2hpbGQiLCJuYW1lRnJvbUFsdCIsInVzZUF0dHJpYnV0ZSIsIm5hbWVGcm9tTGFiZWwiLCJuYW1lRnJvbVZhbHVlIiwibGFiZWxzIiwiZ2V0TGFiZWxzIiwibmFtZUZyb21UaXRsZSIsImlzSGlkZGVuIiwibGFiZWxFbGVtZW50cyIsInNraXBUb1N0ZXAyRSIsImlzQ29udHJvbCIsImFyaWFMYWJlbCIsImN1cnJlbnQiLCJpc01hcmtlZFByZXNlbnRhdGlvbmFsIiwiZWxlbWVudFRleHRBbHRlcm5hdGl2ZSIsImNvbXB1dGVFbGVtZW50VGV4dEFsdGVybmF0aXZlIiwic2VsZWN0ZWRPcHRpb25zIiwicXVlcnlTZWxlY3RlZE9wdGlvbnMiLCJnZXRWYWx1ZU9mVGV4dGJveCIsImFsbG93c05hbWVGcm9tQ29udGVudCIsImlzTmF0aXZlSG9zdExhbmd1YWdlVGV4dEFsdGVybmF0aXZlRWxlbWVudCIsImlzRGVzY2VuZGFudE9mTmF0aXZlSG9zdExhbmd1YWdlVGV4dEFsdGVybmF0aXZlRWxlbWVudCIsImNvbXB1dGVNaXNjVGV4dEFsdGVybmF0aXZlIiwidG9vbHRpcEF0dHJpYnV0ZVZhbHVlIiwiY29tcHV0ZVRvb2x0aXBBdHRyaWJ1dGVWYWx1ZSIsImFzRmxhdFN0cmluZyJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFHQSxJQUFBLE1BQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsMEJBQUEsQ0FBQTs7QUFDQSxJQUFBLFFBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsdUJBQUEsQ0FBQTs7QUFDQSxJQUFBLEtBQUEsR0FBQSxPQUFBLFVBQUE7Ozs7Ozs7O0FBNENBLFNBQUEsWUFBQSxDQUFBLENBQUEsRUFBNkM7QUFDNUMsU0FBT0EsQ0FBQyxDQUFEQSxJQUFBQSxHQUFBQSxPQUFBQSxDQUFBQSxRQUFBQSxFQUFQLEdBQU9BLENBQVA7QUFDQTs7QUFRRCxTQUFBLFFBQUEsQ0FBQSxJQUFBLEVBQUEsOEJBQUEsRUFHbUI7QUFDbEIsTUFBSSxDQUFDLENBQUEsR0FBQSxLQUFBLENBQUEsU0FBQSxFQUFMLElBQUssQ0FBTCxFQUFzQjtBQUNyQixXQUFBLEtBQUE7QUFDQTs7QUFFRCxNQUNDQyxJQUFJLENBQUpBLFlBQUFBLENBQUFBLFFBQUFBLEtBQ0FBLElBQUksQ0FBSkEsWUFBQUEsQ0FBQUEsYUFBQUEsTUFGRCxNQUFBLEVBR0U7QUFDRCxXQUFBLElBQUE7QUFDQTs7QUFFRCxNQUFNQyxLQUFLLEdBQUdDLDhCQUE4QixDQUE1QyxJQUE0QyxDQUE1QztBQUNBLFNBQ0NELEtBQUssQ0FBTEEsZ0JBQUFBLENBQUFBLFNBQUFBLE1BQUFBLE1BQUFBLElBQ0FBLEtBQUssQ0FBTEEsZ0JBQUFBLENBQUFBLFlBQUFBLE1BRkQsUUFBQTtBQUlBOztBQU1ELFNBQUEsU0FBQSxDQUFBLElBQUEsRUFBd0M7QUFDdkMsU0FDQyxDQUFBLEdBQUEsS0FBQSxDQUFBLG1CQUFBLEVBQUEsSUFBQSxFQUEwQixDQUFBLFFBQUEsRUFBQSxVQUFBLEVBQUEsU0FBQSxFQUExQixTQUEwQixDQUExQixLQUNBRSxlQUFlLENBQUEsSUFBQSxFQUZoQixPQUVnQixDQUZoQjtBQUlBOztBQUVELFNBQUEsZUFBQSxDQUFBLElBQUEsRUFBQSxJQUFBLEVBQW9FO0FBQ25FLE1BQUksQ0FBQyxDQUFBLEdBQUEsS0FBQSxDQUFBLFNBQUEsRUFBTCxJQUFLLENBQUwsRUFBc0I7QUFDckIsV0FBQSxLQUFBO0FBQ0E7O0FBRUQsVUFBQSxJQUFBO0FBQ0MsU0FBQSxPQUFBO0FBQ0MsYUFBTyxDQUFBLEdBQUEsS0FBQSxDQUFBLG1CQUFBLEVBQUEsSUFBQSxFQUEwQixDQUFBLE9BQUEsRUFBQSxhQUFBLEVBQUEsV0FBQSxFQUFBLFFBQUEsRUFBakMsWUFBaUMsQ0FBMUIsQ0FBUDs7QUFPRDtBQUNDLFlBQU0sSUFBQSxTQUFBLENBQUEscUNBQUEsTUFBQSxDQUFBLElBQUEsRUFBTiw0QkFBTSxDQUFBLENBQU47QUFWRjtBQWNBOztBQU9ELFNBQUEsdUJBQUEsQ0FBQSxPQUFBLEVBQUEsU0FBQSxFQUdhO0FBQ1osTUFBTUMsUUFBUSxHQUFHLENBQUEsR0FBQSxNQUFBLENBQUEsT0FBQSxFQUFVQyxPQUFPLENBQVBBLGdCQUFBQSxDQUEzQixTQUEyQkEsQ0FBVixDQUFqQjtBQUVBLEdBQUEsR0FBQSxLQUFBLENBQUEsV0FBQSxFQUFBLE9BQUEsRUFBQSxXQUFBLEVBQUEsT0FBQSxDQUEwQyxVQUFBLElBQUEsRUFBVTtBQUVuREQsSUFBQUEsUUFBUSxDQUFSQSxJQUFBQSxDQUFBQSxLQUFBQSxDQUFBQSxRQUFBQSxFQUE4QixDQUFBLEdBQUEsTUFBQSxDQUFBLE9BQUEsRUFBVUUsSUFBSSxDQUFKQSxnQkFBQUEsQ0FBeENGLFNBQXdDRSxDQUFWLENBQTlCRjtBQUZELEdBQUE7QUFLQSxTQUFBLFFBQUE7QUFDQTs7QUFFRCxTQUFBLG9CQUFBLENBQUEsT0FBQSxFQUFvRTtBQUNuRSxNQUFJLENBQUEsR0FBQSxLQUFBLENBQUEsbUJBQUEsRUFBSixPQUFJLENBQUosRUFBa0M7QUFFakMsV0FDQ0csT0FBTyxDQUFQQSxlQUFBQSxJQUEyQkMsdUJBQXVCLENBQUEsT0FBQSxFQURuRCxZQUNtRCxDQURuRDtBQUdBOztBQUNELFNBQU9BLHVCQUF1QixDQUFBLE9BQUEsRUFBOUIsd0JBQThCLENBQTlCO0FBQ0E7O0FBRUQsU0FBQSxzQkFBQSxDQUFBLElBQUEsRUFBNkQ7QUFDNUQsU0FBTyxDQUFBLEdBQUEsS0FBQSxDQUFBLG1CQUFBLEVBQUEsSUFBQSxFQUEwQixDQUFBLE1BQUEsRUFBakMsY0FBaUMsQ0FBMUIsQ0FBUDtBQUNBOztBQVlELFNBQUEsMENBQUEsQ0FBQSxJQUFBLEVBRW1CO0FBQ2xCLFNBQU8sQ0FBQSxHQUFBLEtBQUEsQ0FBQSx5QkFBQSxFQUFQLElBQU8sQ0FBUDtBQUNBOztBQUtELFNBQUEscUJBQUEsQ0FBQSxJQUFBLEVBQW9EO0FBQ25ELFNBQU8sQ0FBQSxHQUFBLEtBQUEsQ0FBQSxtQkFBQSxFQUFBLElBQUEsRUFBMEIsQ0FBQSxRQUFBLEVBQUEsTUFBQSxFQUFBLFVBQUEsRUFBQSxjQUFBLEVBQUEsVUFBQSxFQUFBLFNBQUEsRUFBQSxPQUFBLEVBQUEsUUFBQSxFQUFBLE1BQUEsRUFBQSxVQUFBLEVBQUEsa0JBQUEsRUFBQSxlQUFBLEVBQUEsUUFBQSxFQUFBLE9BQUEsRUFBQSxLQUFBLEVBQUEsV0FBQSxFQUFBLFFBQUEsRUFBQSxLQUFBLEVBQUEsU0FBQSxFQUFqQyxVQUFpQyxDQUExQixDQUFQO0FBc0JBOztBQUtELFNBQUEsc0RBQUEsQ0FBQSxJQUFBLEVBR1c7QUFDVixTQUFBLEtBQUE7QUFDQTs7QUFNRCxTQUFBLDRCQUFBLENBQUEsSUFBQSxFQUFpRTtBQUNoRSxTQUFBLElBQUE7QUFDQTs7QUFFRCxTQUFBLGlCQUFBLENBQUEsT0FBQSxFQUFxRDtBQUNwRCxNQUFJLENBQUEsR0FBQSxLQUFBLENBQUEsa0JBQUEsRUFBQSxPQUFBLEtBQStCLENBQUEsR0FBQSxLQUFBLENBQUEscUJBQUEsRUFBbkMsT0FBbUMsQ0FBbkMsRUFBbUU7QUFDbEUsV0FBT0gsT0FBTyxDQUFkLEtBQUE7QUFGbUQ7O0FBS3BELFNBQU9BLE9BQU8sQ0FBUEEsV0FBQUEsSUFBUCxFQUFBO0FBQ0E7O0FBRUQsU0FBQSxpQkFBQSxDQUFBLFdBQUEsRUFBcUU7QUFDcEUsTUFBTUksT0FBTyxHQUFHQyxXQUFXLENBQVhBLGdCQUFBQSxDQUFoQixTQUFnQkEsQ0FBaEI7O0FBQ0EsTUFBSSxlQUFBLElBQUEsQ0FBSixPQUFJLENBQUosRUFBa0M7QUFDakMsV0FBT0QsT0FBTyxDQUFQQSxLQUFBQSxDQUFBQSxDQUFBQSxFQUFpQixDQUF4QixDQUFPQSxDQUFQO0FBQ0E7O0FBQ0QsU0FBQSxFQUFBO0FBQ0E7O0FBT0QsU0FBQSxrQkFBQSxDQUFBLE9BQUEsRUFBdUQ7QUFDdEQsTUFBTUUsU0FBUyxHQUFHLENBQUEsR0FBQSxLQUFBLENBQUEsWUFBQSxFQUFsQixPQUFrQixDQUFsQjtBQUVBLFNBQ0NBLFNBQVMsS0FBVEEsUUFBQUEsSUFDQ0EsU0FBUyxLQUFUQSxPQUFBQSxJQUF5Qk4sT0FBTyxDQUFQQSxZQUFBQSxDQUFBQSxNQUFBQSxNQUQxQk0sUUFBQUEsSUFFQUEsU0FBUyxLQUZUQSxPQUFBQSxJQUdBQSxTQUFTLEtBSFRBLFFBQUFBLElBSUFBLFNBQVMsS0FKVEEsVUFBQUEsSUFLQUEsU0FBUyxLQUxUQSxRQUFBQSxJQU1BQSxTQUFTLEtBUFYsVUFBQTtBQVNBOztBQU9ELFNBQUEsb0JBQUEsQ0FBQSxPQUFBLEVBQWdFO0FBQy9ELE1BQUlDLGtCQUFrQixDQUF0QixPQUFzQixDQUF0QixFQUFpQztBQUNoQyxXQUFBLE9BQUE7QUFDQTs7QUFDRCxNQUFJQyxnQkFBZ0MsR0FBcEMsSUFBQTtBQUNBUixFQUFBQSxPQUFPLENBQVBBLFVBQUFBLENBQUFBLE9BQUFBLENBQTJCLFVBQUEsU0FBQSxFQUFlO0FBQ3pDLFFBQUlRLGdCQUFnQixLQUFoQkEsSUFBQUEsSUFBNkIsQ0FBQSxHQUFBLEtBQUEsQ0FBQSxTQUFBLEVBQWpDLFNBQWlDLENBQWpDLEVBQXVEO0FBQ3RELFVBQU1DLDBCQUEwQixHQUFHQyxvQkFBb0IsQ0FBdkQsU0FBdUQsQ0FBdkQ7O0FBQ0EsVUFBSUQsMEJBQTBCLEtBQTlCLElBQUEsRUFBeUM7QUFDeENELFFBQUFBLGdCQUFnQixHQUFoQkEsMEJBQUFBO0FBQ0E7QUFDRDtBQU5GUixHQUFBQTtBQVNBLFNBQUEsZ0JBQUE7QUFDQTs7QUFPRCxTQUFBLGlCQUFBLENBQUEsS0FBQSxFQUFvRTtBQUNuRSxNQUFJVyxLQUFLLENBQUxBLE9BQUFBLEtBQUosU0FBQSxFQUFpQztBQUNoQyxXQUFPQSxLQUFLLENBQVosT0FBQTtBQUNBOztBQUVELE1BQU1DLE9BQU8sR0FBR0QsS0FBSyxDQUFMQSxZQUFBQSxDQUFoQixLQUFnQkEsQ0FBaEI7O0FBQ0EsTUFBSUMsT0FBTyxLQUFYLElBQUEsRUFBc0I7QUFDckIsV0FBT0QsS0FBSyxDQUFMQSxhQUFBQSxDQUFBQSxjQUFBQSxDQUFQLE9BQU9BLENBQVA7QUFDQTs7QUFFRCxTQUFPRCxvQkFBb0IsQ0FBM0IsS0FBMkIsQ0FBM0I7QUFDQTs7QUFPRCxTQUFBLFNBQUEsQ0FBQSxPQUFBLEVBQWdFO0FBQy9ELE1BQU1HLGNBQWMsR0FBSWIsT0FBRCxDQUF2QixNQUFBOztBQUlBLE1BQUlhLGNBQWMsS0FBbEIsSUFBQSxFQUE2QjtBQUM1QixXQUFBLGNBQUE7QUFDQTs7QUFDRCxNQUFJQSxjQUFjLEtBQWxCLFNBQUEsRUFBa0M7QUFDakMsV0FBTyxDQUFBLEdBQUEsTUFBQSxDQUFBLE9BQUEsRUFBUCxjQUFPLENBQVA7QUFUOEQ7O0FBYS9ELE1BQUksQ0FBQ04sa0JBQWtCLENBQXZCLE9BQXVCLENBQXZCLEVBQWtDO0FBQ2pDLFdBQUEsSUFBQTtBQUNBOztBQUNELE1BQU1PLFFBQVEsR0FBR2QsT0FBTyxDQUF4QixhQUFBO0FBRUEsU0FBTyxDQUFBLEdBQUEsTUFBQSxDQUFBLE9BQUEsRUFBVWMsUUFBUSxDQUFSQSxnQkFBQUEsQ0FBVixPQUFVQSxDQUFWLEVBQUEsTUFBQSxDQUFxRCxVQUFBLEtBQUEsRUFBVztBQUN0RSxXQUFPQyxpQkFBaUIsQ0FBakJBLEtBQWlCLENBQWpCQSxLQUFQLE9BQUE7QUFERCxHQUFPLENBQVA7QUFHQTs7QUFNRCxTQUFBLGVBQUEsQ0FBQSxJQUFBLEVBQXdEO0FBSXZELE1BQU1DLGFBQWEsR0FBR0MsSUFBSSxDQUExQixhQUFzQkEsRUFBdEI7O0FBQ0EsTUFBSUQsYUFBYSxDQUFiQSxNQUFBQSxLQUFKLENBQUEsRUFBZ0M7QUFFL0IsV0FBTyxDQUFBLEdBQUEsTUFBQSxDQUFBLE9BQUEsRUFBVUMsSUFBSSxDQUFyQixVQUFPLENBQVA7QUFDQTs7QUFDRCxTQUFBLGFBQUE7QUFDQTs7QUFRTSxTQUFBLHNCQUFBLENBQUEsSUFBQSxFQUdHO0FBQUEsTUFEVEMsT0FDUyxHQUFBLFNBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxJQUFBLFNBQUEsQ0FBQSxDQUFBLENBQUEsS0FBQSxTQUFBLEdBQUEsU0FBQSxDQUFBLENBQUEsQ0FBQSxHQURnQyxFQUNoQztBQUNULE1BQU1DLGNBQWMsR0FBRyxJQUFJQyxRQUFBQSxDQUEzQixPQUF1QixFQUF2QjtBQUVBLE1BQU1DLE1BQU0sR0FBRyxDQUFBLEdBQUEsS0FBQSxDQUFBLFVBQUEsRUFBZixJQUFlLENBQWY7QUFDQSxNQUFBLGdCQUFBLEdBU0lILE9BVEosQ0FBQSxPQUFBO0FBQUEsTUFDQ0ksT0FERCxHQUFBLGdCQUFBLEtBQUEsS0FBQSxDQUFBLEdBQUEsTUFBQSxHQUFBLGdCQUFBO0FBQUEsTUFBQSxxQkFBQSxHQVNJSixPQVRKLENBQUEsbUNBQUE7QUFBQSxNQUVDSyxtQ0FGRCxHQUFBLHFCQUFBLEtBQUEsS0FBQSxDQUFBLEdBRXVDTCxPQUFPLENBQVBBLGdCQUFBQSxLQUZ2QyxTQUFBLEdBQUEscUJBQUE7QUFBQSxNQUFBLHFCQUFBLEdBU0lBLE9BVEosQ0FBQSxnQkFBQTtBQUFBLE1BUUNNLGdCQVJELEdBQUEscUJBQUEsS0FBQSxLQUFBLENBQUEsR0FRb0JILE1BQU0sQ0FBTkEsZ0JBQUFBLENBQUFBLElBQUFBLENBUnBCLE1BUW9CQSxDQVJwQixHQUpTLHFCQUlUOztBQVlBLFdBQUEsMEJBQUEsQ0FBQSxJQUFBLEVBQUEsT0FBQSxFQUdVO0FBQ1QsUUFBSUksZUFBZSxHQUFuQixFQUFBOztBQUNBLFFBQUksQ0FBQSxHQUFBLEtBQUEsQ0FBQSxTQUFBLEVBQUEsSUFBQSxLQUFKLG1DQUFBLEVBQTREO0FBQzNELFVBQU1DLFlBQVksR0FBR0YsZ0JBQWdCLENBQUEsSUFBQSxFQUFyQyxVQUFxQyxDQUFyQztBQUNBLFVBQU1HLGFBQWEsR0FBR0MsaUJBQWlCLENBQXZDLFlBQXVDLENBQXZDO0FBQ0FILE1BQUFBLGVBQWUsR0FBQSxHQUFBLE1BQUEsQ0FBQSxhQUFBLEVBQUEsR0FBQSxFQUFBLE1BQUEsQ0FBZkEsZUFBZSxDQUFmQTtBQUxROztBQVVULFFBQU1JLFVBQVUsR0FBRyxDQUFBLEdBQUEsS0FBQSxDQUFBLGlCQUFBLEVBQUEsSUFBQSxJQUNoQkMsZUFBZSxDQURDLElBQ0QsQ0FEQyxHQUVoQixDQUFBLEdBQUEsTUFBQSxDQUFBLE9BQUEsRUFBVW5DLElBQUksQ0FBZCxVQUFBLEVBQUEsTUFBQSxDQUFrQyxDQUFBLEdBQUEsS0FBQSxDQUFBLFdBQUEsRUFBQSxJQUFBLEVBRnJDLFdBRXFDLENBQWxDLENBRkg7QUFHQWtDLElBQUFBLFVBQVUsQ0FBVkEsT0FBQUEsQ0FBbUIsVUFBQSxLQUFBLEVBQVc7QUFDN0IsVUFBTUUsTUFBTSxHQUFHQyxzQkFBc0IsQ0FBQSxLQUFBLEVBQVE7QUFDNUNDLFFBQUFBLGlCQUFpQixFQUFFQyxPQUFPLENBRGtCLGlCQUFBO0FBRTVDQyxRQUFBQSxZQUFZLEVBRmdDLEtBQUE7QUFHNUNDLFFBQUFBLFNBQVMsRUFBRTtBQUhpQyxPQUFSLENBQXJDO0FBT0EsVUFBTUMsT0FBTyxHQUFHLENBQUEsR0FBQSxLQUFBLENBQUEsU0FBQSxFQUFBLEtBQUEsSUFDYmIsZ0JBQWdCLENBQWhCQSxLQUFnQixDQUFoQkEsQ0FBQUEsZ0JBQUFBLENBRGEsU0FDYkEsQ0FEYSxHQUFoQixRQUFBO0FBR0EsVUFBTWMsU0FBUyxHQUFHRCxPQUFPLEtBQVBBLFFBQUFBLEdBQUFBLEdBQUFBLEdBWFcsRUFXN0I7QUFFQVosTUFBQUEsZUFBZSxJQUFBLEdBQUEsTUFBQSxDQUFBLFNBQUEsRUFBQSxNQUFBLENBQUEsTUFBQSxFQUFBLE1BQUEsQ0FBZkEsU0FBZSxDQUFmQTtBQWJESSxLQUFBQTs7QUFnQkEsUUFBSSxDQUFBLEdBQUEsS0FBQSxDQUFBLFNBQUEsRUFBQSxJQUFBLEtBQUosbUNBQUEsRUFBNEQ7QUFDM0QsVUFBTVUsV0FBVyxHQUFHZixnQkFBZ0IsQ0FBQSxJQUFBLEVBQXBDLFNBQW9DLENBQXBDO0FBQ0EsVUFBTWdCLFlBQVksR0FBR1osaUJBQWlCLENBQXRDLFdBQXNDLENBQXRDO0FBQ0FILE1BQUFBLGVBQWUsR0FBQSxHQUFBLE1BQUEsQ0FBQSxlQUFBLEVBQUEsR0FBQSxFQUFBLE1BQUEsQ0FBZkEsWUFBZSxDQUFmQTtBQUNBOztBQUVELFdBQUEsZUFBQTtBQUNBOztBQUVELFdBQUEsNkJBQUEsQ0FBQSxJQUFBLEVBQWtFO0FBQ2pFLFFBQUksQ0FBQyxDQUFBLEdBQUEsS0FBQSxDQUFBLFNBQUEsRUFBTCxJQUFLLENBQUwsRUFBc0I7QUFDckIsYUFBQSxJQUFBO0FBQ0E7O0FBUUQsYUFBQSxZQUFBLENBQUEsT0FBQSxFQUFBLGFBQUEsRUFHaUI7QUFDaEIsVUFBTWdCLFNBQVMsR0FBR3pDLE9BQU8sQ0FBUEEsZ0JBQUFBLENBQWxCLGFBQWtCQSxDQUFsQjs7QUFDQSxVQUNDeUMsU0FBUyxLQUFUQSxJQUFBQSxJQUNBLENBQUN0QixjQUFjLENBQWRBLEdBQUFBLENBRERzQixTQUNDdEIsQ0FERHNCLElBRUFBLFNBQVMsQ0FBVEEsS0FBQUEsQ0FBQUEsSUFBQUEsT0FIRCxFQUFBLEVBSUU7QUFDRHRCLFFBQUFBLGNBQWMsQ0FBZEEsR0FBQUEsQ0FBQUEsU0FBQUE7QUFDQSxlQUFPc0IsU0FBUyxDQUFoQixLQUFBO0FBQ0E7O0FBQ0QsYUFBQSxJQUFBO0FBeEJnRTs7QUE0QmpFLFFBQUksQ0FBQSxHQUFBLEtBQUEsQ0FBQSxxQkFBQSxFQUFKLElBQUksQ0FBSixFQUFpQztBQUNoQ3RCLE1BQUFBLGNBQWMsQ0FBZEEsR0FBQUEsQ0FBQUEsSUFBQUE7QUFDQSxVQUFNdUIsUUFBUSxHQUFHLENBQUEsR0FBQSxNQUFBLENBQUEsT0FBQSxFQUFVL0MsSUFBSSxDQUEvQixVQUFpQixDQUFqQjs7QUFDQSxXQUFLLElBQUlnRCxDQUFDLEdBQVYsQ0FBQSxFQUFnQkEsQ0FBQyxHQUFHRCxRQUFRLENBQTVCLE1BQUEsRUFBcUNDLENBQUMsSUFBdEMsQ0FBQSxFQUE2QztBQUM1QyxZQUFNQyxLQUFLLEdBQUdGLFFBQVEsQ0FBdEIsQ0FBc0IsQ0FBdEI7O0FBQ0EsWUFBSSxDQUFBLEdBQUEsS0FBQSxDQUFBLG1CQUFBLEVBQUosS0FBSSxDQUFKLEVBQWdDO0FBQy9CLGlCQUFPVixzQkFBc0IsQ0FBQSxLQUFBLEVBQVE7QUFDcENDLFlBQUFBLGlCQUFpQixFQURtQixLQUFBO0FBRXBDRSxZQUFBQSxZQUFZLEVBRndCLEtBQUE7QUFHcENDLFlBQUFBLFNBQVMsRUFBRTtBQUh5QixXQUFSLENBQTdCO0FBS0E7QUFDRDtBQVpGLEtBQUEsTUFhTyxJQUFJLENBQUEsR0FBQSxLQUFBLENBQUEsa0JBQUEsRUFBSixJQUFJLENBQUosRUFBOEI7QUFFcENqQixNQUFBQSxjQUFjLENBQWRBLEdBQUFBLENBQUFBLElBQUFBOztBQUNBLFVBQU11QixTQUFRLEdBQUcsQ0FBQSxHQUFBLE1BQUEsQ0FBQSxPQUFBLEVBQVUvQyxJQUFJLENBQS9CLFVBQWlCLENBQWpCOztBQUNBLFdBQUssSUFBSWdELEVBQUMsR0FBVixDQUFBLEVBQWdCQSxFQUFDLEdBQUdELFNBQVEsQ0FBNUIsTUFBQSxFQUFxQ0MsRUFBQyxJQUF0QyxDQUFBLEVBQTZDO0FBQzVDLFlBQU1DLE1BQUssR0FBR0YsU0FBUSxDQUF0QixFQUFzQixDQUF0Qjs7QUFDQSxZQUFJLENBQUEsR0FBQSxLQUFBLENBQUEseUJBQUEsRUFBSixNQUFJLENBQUosRUFBc0M7QUFDckMsaUJBQU9WLHNCQUFzQixDQUFBLE1BQUEsRUFBUTtBQUNwQ0MsWUFBQUEsaUJBQWlCLEVBRG1CLEtBQUE7QUFFcENFLFlBQUFBLFlBQVksRUFGd0IsS0FBQTtBQUdwQ0MsWUFBQUEsU0FBUyxFQUFFO0FBSHlCLFdBQVIsQ0FBN0I7QUFLQTtBQUNEO0FBYkssS0FBQSxNQWNBLElBQUksQ0FBQSxHQUFBLEtBQUEsQ0FBQSxlQUFBLEVBQUosSUFBSSxDQUFKLEVBQTJCO0FBRWpDakIsTUFBQUEsY0FBYyxDQUFkQSxHQUFBQSxDQUFBQSxJQUFBQTs7QUFDQSxVQUFNdUIsVUFBUSxHQUFHLENBQUEsR0FBQSxNQUFBLENBQUEsT0FBQSxFQUFVL0MsSUFBSSxDQUEvQixVQUFpQixDQUFqQjs7QUFDQSxXQUFLLElBQUlnRCxHQUFDLEdBQVYsQ0FBQSxFQUFnQkEsR0FBQyxHQUFHRCxVQUFRLENBQTVCLE1BQUEsRUFBcUNDLEdBQUMsSUFBdEMsQ0FBQSxFQUE2QztBQUM1QyxZQUFNQyxPQUFLLEdBQUdGLFVBQVEsQ0FBdEIsR0FBc0IsQ0FBdEI7O0FBQ0EsWUFBSSxDQUFBLEdBQUEsS0FBQSxDQUFBLGlCQUFBLEVBQUosT0FBSSxDQUFKLEVBQThCO0FBQzdCLGlCQUFPRSxPQUFLLENBQVosV0FBQTtBQUNBO0FBQ0Q7O0FBQ0QsYUFBQSxJQUFBO0FBVk0sS0FBQSxNQVdBLElBQUksQ0FBQSxHQUFBLEtBQUEsQ0FBQSxZQUFBLEVBQUEsSUFBQSxNQUFBLEtBQUEsSUFBZ0MsQ0FBQSxHQUFBLEtBQUEsQ0FBQSxZQUFBLEVBQUEsSUFBQSxNQUFwQyxNQUFBLEVBQW1FO0FBR3pFLFVBQU1DLFdBQVcsR0FBR0MsWUFBWSxDQUFBLElBQUEsRUFBaEMsS0FBZ0MsQ0FBaEM7O0FBQ0EsVUFBSUQsV0FBVyxLQUFmLElBQUEsRUFBMEI7QUFDekIsZUFBQSxXQUFBO0FBQ0E7QUFOSyxLQUFBLE1BT0EsSUFBSSxDQUFBLEdBQUEsS0FBQSxDQUFBLHFCQUFBLEVBQUosSUFBSSxDQUFKLEVBQWlDO0FBQ3ZDLFVBQU1FLGFBQWEsR0FBR0QsWUFBWSxDQUFBLElBQUEsRUFBbEMsT0FBa0MsQ0FBbEM7O0FBQ0EsVUFBSUMsYUFBYSxLQUFqQixJQUFBLEVBQTRCO0FBQzNCLGVBQUEsYUFBQTtBQUNBO0FBQ0Q7O0FBRUQsUUFDQyxDQUFBLEdBQUEsS0FBQSxDQUFBLGtCQUFBLEVBQUEsSUFBQSxNQUNDcEQsSUFBSSxDQUFKQSxJQUFBQSxLQUFBQSxRQUFBQSxJQUNBQSxJQUFJLENBQUpBLElBQUFBLEtBREFBLFFBQUFBLElBRUFBLElBQUksQ0FBSkEsSUFBQUEsS0FKRixPQUNDLENBREQsRUFLRTtBQUVELFVBQU1xRCxhQUFhLEdBQUdGLFlBQVksQ0FBQSxJQUFBLEVBQWxDLE9BQWtDLENBQWxDOztBQUNBLFVBQUlFLGFBQWEsS0FBakIsSUFBQSxFQUE0QjtBQUMzQixlQUFBLGFBQUE7QUFKQTs7QUFRRCxVQUFJckQsSUFBSSxDQUFKQSxJQUFBQSxLQUFKLFFBQUEsRUFBNEI7QUFDM0IsZUFBQSxRQUFBO0FBVEE7O0FBWUQsVUFBSUEsSUFBSSxDQUFKQSxJQUFBQSxLQUFKLE9BQUEsRUFBMkI7QUFDMUIsZUFBQSxPQUFBO0FBQ0E7QUFDRDs7QUFFRCxRQUFNc0QsTUFBTSxHQUFHQyxTQUFTLENBQXhCLElBQXdCLENBQXhCOztBQUNBLFFBQUlELE1BQU0sS0FBTkEsSUFBQUEsSUFBbUJBLE1BQU0sQ0FBTkEsTUFBQUEsS0FBdkIsQ0FBQSxFQUE0QztBQUMzQzlCLE1BQUFBLGNBQWMsQ0FBZEEsR0FBQUEsQ0FBQUEsSUFBQUE7QUFDQSxhQUFPLENBQUEsR0FBQSxNQUFBLENBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQSxHQUFBLENBQ0QsVUFBQSxPQUFBLEVBQWE7QUFDakIsZUFBT2Esc0JBQXNCLENBQUEsT0FBQSxFQUFVO0FBQ3RDQyxVQUFBQSxpQkFBaUIsRUFEcUIsSUFBQTtBQUV0Q0UsVUFBQUEsWUFBWSxFQUYwQixLQUFBO0FBR3RDQyxVQUFBQSxTQUFTLEVBQUU7QUFIMkIsU0FBVixDQUE3QjtBQUZLLE9BQUEsRUFBQSxNQUFBLENBUUUsVUFBQSxLQUFBLEVBQVc7QUFDbEIsZUFBT3pCLEtBQUssQ0FBTEEsTUFBQUEsR0FBUCxDQUFBO0FBVEssT0FBQSxFQUFBLElBQUEsQ0FBUCxHQUFPLENBQVA7QUF6R2dFOztBQTBIakUsUUFBSSxDQUFBLEdBQUEsS0FBQSxDQUFBLGtCQUFBLEVBQUEsSUFBQSxLQUE0QmhCLElBQUksQ0FBSkEsSUFBQUEsS0FBaEMsT0FBQSxFQUF1RDtBQUN0RCxVQUFNa0QsWUFBVyxHQUFHQyxZQUFZLENBQUEsSUFBQSxFQUFoQyxLQUFnQyxDQUFoQzs7QUFDQSxVQUFJRCxZQUFXLEtBQWYsSUFBQSxFQUEwQjtBQUN6QixlQUFBLFlBQUE7QUFDQTs7QUFFRCxVQUFNTSxhQUFhLEdBQUdMLFlBQVksQ0FBQSxJQUFBLEVBQWxDLE9BQWtDLENBQWxDOztBQUNBLFVBQUlLLGFBQWEsS0FBakIsSUFBQSxFQUE0QjtBQUMzQixlQUFBLGFBQUE7QUFScUQ7O0FBWXRELGFBQUEsY0FBQTtBQUNBOztBQUVELFdBQU9MLFlBQVksQ0FBQSxJQUFBLEVBQW5CLE9BQW1CLENBQW5CO0FBQ0E7O0FBRUQsV0FBQSxzQkFBQSxDQUFBLE9BQUEsRUFBQSxPQUFBLEVBT1U7QUFDVCxRQUFJM0IsY0FBYyxDQUFkQSxHQUFBQSxDQUFKLE9BQUlBLENBQUosRUFBaUM7QUFDaEMsYUFBQSxFQUFBO0FBRlE7O0FBT1QsUUFBSSxDQUFBLEdBQUEsS0FBQSxDQUFBLG1CQUFBLEVBQUEsT0FBQSxFQUE2QixDQUFqQyxNQUFpQyxDQUE3QixDQUFKLEVBQTRDO0FBQzNDQSxNQUFBQSxjQUFjLENBQWRBLEdBQUFBLENBQUFBLE9BQUFBO0FBQ0EsYUFBQSxFQUFBO0FBVFE7O0FBYVQsUUFBSWlDLFFBQVEsQ0FBQSxPQUFBLEVBQVJBLGdCQUFRLENBQVJBLElBQXVDLENBQUNsQixPQUFPLENBQW5ELFlBQUEsRUFBa0U7QUFDakVmLE1BQUFBLGNBQWMsQ0FBZEEsR0FBQUEsQ0FBQUEsT0FBQUE7QUFDQSxhQUFBLEVBQUE7QUFmUTs7QUFtQlQsUUFBTWtDLGFBQWEsR0FBRyxDQUFBLEdBQUEsS0FBQSxDQUFBLFdBQUEsRUFBQSxPQUFBLEVBQXRCLGlCQUFzQixDQUF0Qjs7QUFDQSxRQUNDL0IsT0FBTyxLQUFQQSxNQUFBQSxJQUNBLENBQUNZLE9BQU8sQ0FEUlosWUFBQUEsSUFFQStCLGFBQWEsQ0FBYkEsTUFBQUEsR0FIRCxDQUFBLEVBSUU7QUFDRCxhQUFPLGFBQWEsQ0FBYixHQUFBLENBQ0QsVUFBQSxPQUFBLEVBQUE7QUFBQSxlQUNKckIsc0JBQXNCLENBQUEsT0FBQSxFQUFVO0FBQy9CQyxVQUFBQSxpQkFBaUIsRUFBRUMsT0FBTyxDQURLLGlCQUFBO0FBRS9CQyxVQUFBQSxZQUFZLEVBRm1CLElBQUE7QUFNL0JDLFVBQUFBLFNBQVMsRUFBRTtBQU5vQixTQUFWLENBRGxCO0FBREMsT0FBQSxFQUFBLElBQUEsQ0FBUCxHQUFPLENBQVA7QUF6QlE7O0FBMENULFFBQU1rQixZQUFZLEdBQ2pCcEIsT0FBTyxDQUFQQSxTQUFBQSxJQUFxQnFCLFNBQVMsQ0FBOUJyQixPQUE4QixDQUE5QkEsSUFBMkNaLE9BQU8sS0FEbkQsTUFBQTs7QUFFQSxRQUFJLENBQUosWUFBQSxFQUFtQjtBQUNsQixVQUFNa0MsU0FBUyxHQUFHLENBQ2hCLENBQUEsR0FBQSxLQUFBLENBQUEsU0FBQSxFQUFBLE9BQUEsS0FBc0JDLE9BQU8sQ0FBUEEsWUFBQUEsQ0FBdkIsWUFBdUJBLENBQXRCLElBRGdCLEVBQUEsRUFBbEIsSUFBa0IsRUFBbEI7O0FBSUEsVUFBSUQsU0FBUyxLQUFUQSxFQUFBQSxJQUFvQmxDLE9BQU8sS0FBL0IsTUFBQSxFQUE0QztBQUMzQ0gsUUFBQUEsY0FBYyxDQUFkQSxHQUFBQSxDQUFBQSxPQUFBQTtBQUNBLGVBQUEsU0FBQTtBQVBpQjs7QUFXbEIsVUFBSSxDQUFDdUMsc0JBQXNCLENBQTNCLE9BQTJCLENBQTNCLEVBQXNDO0FBQ3JDLFlBQU1DLHNCQUFzQixHQUFHQyw2QkFBNkIsQ0FBNUQsT0FBNEQsQ0FBNUQ7O0FBQ0EsWUFBSUQsc0JBQXNCLEtBQTFCLElBQUEsRUFBcUM7QUFDcEN4QyxVQUFBQSxjQUFjLENBQWRBLEdBQUFBLENBQUFBLE9BQUFBO0FBQ0EsaUJBQUEsc0JBQUE7QUFDQTtBQUNEO0FBN0RPOztBQWlFVCxRQUFJbUMsWUFBWSxJQUFJcEIsT0FBTyxDQUF2Qm9CLGlCQUFBQSxJQUE2Q3BCLE9BQU8sQ0FBeEQsWUFBQSxFQUF1RTtBQUN0RSxVQUFJLENBQUEsR0FBQSxLQUFBLENBQUEsbUJBQUEsRUFBQSxPQUFBLEVBQTZCLENBQUEsVUFBQSxFQUFqQyxTQUFpQyxDQUE3QixDQUFKLEVBQTJEO0FBQzFEZixRQUFBQSxjQUFjLENBQWRBLEdBQUFBLENBQUFBLE9BQUFBO0FBQ0EsWUFBTTBDLGVBQWUsR0FBR0Msb0JBQW9CLENBQTVDLE9BQTRDLENBQTVDOztBQUNBLFlBQUlELGVBQWUsQ0FBZkEsTUFBQUEsS0FBSixDQUFBLEVBQWtDO0FBRWpDLGlCQUFPLENBQUEsR0FBQSxLQUFBLENBQUEsa0JBQUEsRUFBQSxPQUFBLElBQThCSixPQUFPLENBQXJDLEtBQUEsR0FBUCxFQUFBO0FBQ0E7O0FBQ0QsZUFBTyxDQUFBLEdBQUEsTUFBQSxDQUFBLE9BQUEsRUFBQSxlQUFBLEVBQUEsR0FBQSxDQUNELFVBQUEsY0FBQSxFQUFvQjtBQUN4QixpQkFBT3pCLHNCQUFzQixDQUFBLGNBQUEsRUFBaUI7QUFDN0NDLFlBQUFBLGlCQUFpQixFQUFFQyxPQUFPLENBRG1CLGlCQUFBO0FBRTdDQyxZQUFBQSxZQUFZLEVBRmlDLEtBQUE7QUFHN0NDLFlBQUFBLFNBQVMsRUFBRTtBQUhrQyxXQUFqQixDQUE3QjtBQUZLLFNBQUEsRUFBQSxJQUFBLENBQVAsR0FBTyxDQUFQO0FBU0E7O0FBQ0QsVUFBSXRDLGVBQWUsQ0FBQSxPQUFBLEVBQW5CLE9BQW1CLENBQW5CLEVBQXVDO0FBQ3RDcUIsUUFBQUEsY0FBYyxDQUFkQSxHQUFBQSxDQUFBQSxPQUFBQTs7QUFDQSxZQUFJc0MsT0FBTyxDQUFQQSxZQUFBQSxDQUFKLGdCQUFJQSxDQUFKLEVBQTRDO0FBRTNDLGlCQUFPQSxPQUFPLENBQVBBLFlBQUFBLENBQVAsZ0JBQU9BLENBQVA7QUFDQTs7QUFDRCxZQUFJQSxPQUFPLENBQVBBLFlBQUFBLENBQUosZUFBSUEsQ0FBSixFQUEyQztBQUUxQyxpQkFBT0EsT0FBTyxDQUFQQSxZQUFBQSxDQUFQLGVBQU9BLENBQVA7QUFScUM7O0FBV3RDLGVBQU9BLE9BQU8sQ0FBUEEsWUFBQUEsQ0FBQUEsT0FBQUEsS0FBUCxFQUFBO0FBQ0E7O0FBQ0QsVUFBSSxDQUFBLEdBQUEsS0FBQSxDQUFBLG1CQUFBLEVBQUEsT0FBQSxFQUE2QixDQUFqQyxTQUFpQyxDQUE3QixDQUFKLEVBQStDO0FBQzlDdEMsUUFBQUEsY0FBYyxDQUFkQSxHQUFBQSxDQUFBQSxPQUFBQTtBQUNBLGVBQU80QyxpQkFBaUIsQ0FBeEIsT0FBd0IsQ0FBeEI7QUFDQTtBQW5HTzs7QUF1R1QsUUFDQ0MscUJBQXFCLENBQXJCQSxPQUFxQixDQUFyQkEsSUFDQyxDQUFBLEdBQUEsS0FBQSxDQUFBLFNBQUEsRUFBQSxPQUFBLEtBQXNCOUIsT0FBTyxDQUQ5QjhCLFlBQUFBLElBRUFDLDBDQUEwQyxDQUYxQ0QsT0FFMEMsQ0FGMUNBLElBR0FFLHNEQUFzRCxDQUp2RCxPQUl1RCxDQUp2RCxFQUtFO0FBQ0QvQyxNQUFBQSxjQUFjLENBQWRBLEdBQUFBLENBQUFBLE9BQUFBO0FBQ0EsYUFBT2dELDBCQUEwQixDQUFBLE9BQUEsRUFBVTtBQUMxQ2xDLFFBQUFBLGlCQUFpQixFQUFFQyxPQUFPLENBRGdCLGlCQUFBO0FBRTFDQyxRQUFBQSxZQUFZLEVBQUU7QUFGNEIsT0FBVixDQUFqQztBQUlBOztBQUVELFFBQUlzQixPQUFPLENBQVBBLFFBQUFBLEtBQXFCQSxPQUFPLENBQWhDLFNBQUEsRUFBNEM7QUFDM0N0QyxNQUFBQSxjQUFjLENBQWRBLEdBQUFBLENBQUFBLE9BQUFBO0FBQ0EsYUFBT3NDLE9BQU8sQ0FBUEEsV0FBQUEsSUFBUCxFQUFBO0FBQ0E7O0FBRUQsUUFBSXZCLE9BQU8sQ0FBWCxTQUFBLEVBQXVCO0FBQ3RCZixNQUFBQSxjQUFjLENBQWRBLEdBQUFBLENBQUFBLE9BQUFBO0FBQ0EsYUFBT2dELDBCQUEwQixDQUFBLE9BQUEsRUFBVTtBQUMxQ2xDLFFBQUFBLGlCQUFpQixFQUFFQyxPQUFPLENBRGdCLGlCQUFBO0FBRTFDQyxRQUFBQSxZQUFZLEVBQUU7QUFGNEIsT0FBVixDQUFqQztBQUlBOztBQUVELFFBQU1pQyxxQkFBcUIsR0FBR0MsNEJBQTRCLENBQTFELE9BQTBELENBQTFEOztBQUNBLFFBQUlELHFCQUFxQixLQUF6QixJQUFBLEVBQW9DO0FBQ25DakQsTUFBQUEsY0FBYyxDQUFkQSxHQUFBQSxDQUFBQSxPQUFBQTtBQUNBLGFBQUEscUJBQUE7QUFwSVE7O0FBd0lUQSxJQUFBQSxjQUFjLENBQWRBLEdBQUFBLENBQUFBLE9BQUFBO0FBQ0EsV0FBQSxFQUFBO0FBQ0E7O0FBRUQsU0FBT21ELFlBQVksQ0FDbEJ0QyxzQkFBc0IsQ0FBQSxJQUFBLEVBQU87QUFDNUJDLElBQUFBLGlCQUFpQixFQURXLEtBQUE7QUFHNUJFLElBQUFBLFlBQVksRUFBRWIsT0FBTyxLQUhPLGFBQUE7QUFJNUJjLElBQUFBLFNBQVMsRUFBRTtBQUppQixHQUFQLENBREosQ0FBbkI7QUFRQSIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogaW1wbGVtZW50cyBodHRwczovL3czYy5naXRodWIuaW8vYWNjbmFtZS9cbiAqL1xuaW1wb3J0IEFycmF5RnJvbSBmcm9tIFwiLi9wb2x5ZmlsbHMvYXJyYXkuZnJvbVwiO1xuaW1wb3J0IFNldExpa2UgZnJvbSBcIi4vcG9seWZpbGxzL1NldExpa2VcIjtcbmltcG9ydCB7XG5cdGhhc0FueUNvbmNyZXRlUm9sZXMsXG5cdGlzRWxlbWVudCxcblx0aXNIVE1MVGFibGVDYXB0aW9uRWxlbWVudCxcblx0aXNIVE1MSW5wdXRFbGVtZW50LFxuXHRpc0hUTUxTZWxlY3RFbGVtZW50LFxuXHRpc0hUTUxUZXh0QXJlYUVsZW1lbnQsXG5cdHNhZmVXaW5kb3csXG5cdGlzSFRNTEZpZWxkU2V0RWxlbWVudCxcblx0aXNIVE1MTGVnZW5kRWxlbWVudCxcblx0aXNIVE1MT3B0R3JvdXBFbGVtZW50LFxuXHRpc0hUTUxUYWJsZUVsZW1lbnQsXG5cdGlzSFRNTFNsb3RFbGVtZW50LFxuXHRpc1NWR1NWR0VsZW1lbnQsXG5cdGlzU1ZHVGl0bGVFbGVtZW50LFxuXHRxdWVyeUlkUmVmcyxcblx0Z2V0TG9jYWxOYW1lLFxufSBmcm9tIFwiLi91dGlsXCI7XG5cbi8qKlxuICogIEEgc3RyaW5nIG9mIGNoYXJhY3RlcnMgd2hlcmUgYWxsIGNhcnJpYWdlIHJldHVybnMsIG5ld2xpbmVzLCB0YWJzLCBhbmQgZm9ybS1mZWVkcyBhcmUgcmVwbGFjZWQgd2l0aCBhIHNpbmdsZSBzcGFjZSwgYW5kIG11bHRpcGxlIHNwYWNlcyBhcmUgcmVkdWNlZCB0byBhIHNpbmdsZSBzcGFjZS4gVGhlIHN0cmluZyBjb250YWlucyBvbmx5IGNoYXJhY3RlciBkYXRhOyBpdCBkb2VzIG5vdCBjb250YWluIGFueSBtYXJrdXAuXG4gKi9cbnR5cGUgRmxhdFN0cmluZyA9IHN0cmluZyAmIHtcblx0X19mbGF0OiB0cnVlO1xufTtcblxuLyoqXG4gKiBpbnRlcmZhY2UgZm9yIGFuIG9wdGlvbnMtYmFnIHdoZXJlIGB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZWAgY2FuIGJlIG1vY2tlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIENvbXB1dGVUZXh0QWx0ZXJuYXRpdmVPcHRpb25zIHtcblx0Y29tcHV0ZT86IFwiZGVzY3JpcHRpb25cIiB8IFwibmFtZVwiO1xuXHQvKipcblx0ICogU2V0IHRvIHRydWUgaWYgd2luZG93LmNvbXB1dGVkU3R5bGUgc3VwcG9ydHMgdGhlIHNlY29uZCBhcmd1bWVudC5cblx0ICogVGhpcyBzaG91bGQgYmUgZmFsc2UgaW4gSlNET00uIE90aGVyd2lzZSBKU0RPTSB3aWxsIGxvZyBjb25zb2xlIGVycm9ycy5cblx0ICovXG5cdGNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzPzogYm9vbGVhbjtcblx0Z2V0Q29tcHV0ZWRTdHlsZT86IHR5cGVvZiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZTtcbn1cblxuLyoqXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHN0cmluZyAtXG4gKiBAcmV0dXJucyB7RmxhdFN0cmluZ30gLVxuICovXG5mdW5jdGlvbiBhc0ZsYXRTdHJpbmcoczogc3RyaW5nKTogRmxhdFN0cmluZyB7XG5cdHJldHVybiBzLnRyaW0oKS5yZXBsYWNlKC9cXHNcXHMrL2csIFwiIFwiKSBhcyBGbGF0U3RyaW5nO1xufVxuXG4vKipcbiAqXG4gKiBAcGFyYW0gbm9kZSAtXG4gKiBAcGFyYW0gb3B0aW9ucyAtIFRoZXNlIGFyZSBub3Qgb3B0aW9uYWwgdG8gcHJldmVudCBhY2NpZGVudGFsbHkgY2FsbGluZyBpdCB3aXRob3V0IG9wdGlvbnMgaW4gYGNvbXB1dGVBY2Nlc3NpYmxlTmFtZWBcbiAqIEByZXR1cm5zIHtib29sZWFufSAtXG4gKi9cbmZ1bmN0aW9uIGlzSGlkZGVuKFxuXHRub2RlOiBOb2RlLFxuXHRnZXRDb21wdXRlZFN0eWxlSW1wbGVtZW50YXRpb246IHR5cGVvZiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZVxuKTogbm9kZSBpcyBFbGVtZW50IHtcblx0aWYgKCFpc0VsZW1lbnQobm9kZSkpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRpZiAoXG5cdFx0bm9kZS5oYXNBdHRyaWJ1dGUoXCJoaWRkZW5cIikgfHxcblx0XHRub2RlLmdldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIpID09PSBcInRydWVcIlxuXHQpIHtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdGNvbnN0IHN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZUltcGxlbWVudGF0aW9uKG5vZGUpO1xuXHRyZXR1cm4gKFxuXHRcdHN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJkaXNwbGF5XCIpID09PSBcIm5vbmVcIiB8fFxuXHRcdHN0eWxlLmdldFByb3BlcnR5VmFsdWUoXCJ2aXNpYmlsaXR5XCIpID09PSBcImhpZGRlblwiXG5cdCk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtOb2RlfSBub2RlIC1cbiAqIEByZXR1cm5zIHtib29sZWFufSAtIEFzIGRlZmluZWQgaW4gc3RlcCAyRSBvZiBodHRwczovL3czYy5naXRodWIuaW8vYWNjbmFtZS8jbWFwcGluZ19hZGRpdGlvbmFsX25kX3RlXG4gKi9cbmZ1bmN0aW9uIGlzQ29udHJvbChub2RlOiBOb2RlKTogYm9vbGVhbiB7XG5cdHJldHVybiAoXG5cdFx0aGFzQW55Q29uY3JldGVSb2xlcyhub2RlLCBbXCJidXR0b25cIiwgXCJjb21ib2JveFwiLCBcImxpc3Rib3hcIiwgXCJ0ZXh0Ym94XCJdKSB8fFxuXHRcdGhhc0Fic3RyYWN0Um9sZShub2RlLCBcInJhbmdlXCIpXG5cdCk7XG59XG5cbmZ1bmN0aW9uIGhhc0Fic3RyYWN0Um9sZShub2RlOiBOb2RlLCByb2xlOiBzdHJpbmcpOiBub2RlIGlzIEVsZW1lbnQge1xuXHRpZiAoIWlzRWxlbWVudChub2RlKSkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHN3aXRjaCAocm9sZSkge1xuXHRcdGNhc2UgXCJyYW5nZVwiOlxuXHRcdFx0cmV0dXJuIGhhc0FueUNvbmNyZXRlUm9sZXMobm9kZSwgW1xuXHRcdFx0XHRcIm1ldGVyXCIsXG5cdFx0XHRcdFwicHJvZ3Jlc3NiYXJcIixcblx0XHRcdFx0XCJzY3JvbGxiYXJcIixcblx0XHRcdFx0XCJzbGlkZXJcIixcblx0XHRcdFx0XCJzcGluYnV0dG9uXCIsXG5cdFx0XHRdKTtcblx0XHRkZWZhdWx0OlxuXHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcihcblx0XHRcdFx0YE5vIGtub3dsZWRnZSBhYm91dCBhYnN0cmFjdCByb2xlICcke3JvbGV9Jy4gVGhpcyBpcyBsaWtlbHkgYSBidWcgOihgXG5cdFx0XHQpO1xuXHR9XG59XG5cbi8qKlxuICogZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsIGJ1dCBhbHNvIGNvbnNpZGVycyBvd25lZCB0cmVlXG4gKiBAcGFyYW0gZWxlbWVudFxuICogQHBhcmFtIHNlbGVjdG9yc1xuICovXG5mdW5jdGlvbiBxdWVyeVNlbGVjdG9yQWxsU3VidHJlZShcblx0ZWxlbWVudDogRWxlbWVudCxcblx0c2VsZWN0b3JzOiBzdHJpbmdcbik6IEVsZW1lbnRbXSB7XG5cdGNvbnN0IGVsZW1lbnRzID0gQXJyYXlGcm9tKGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMpKTtcblxuXHRxdWVyeUlkUmVmcyhlbGVtZW50LCBcImFyaWEtb3duc1wiKS5mb3JFYWNoKChyb290KSA9PiB7XG5cdFx0Ly8gYmFiZWwgdHJhbnNwaWxlcyB0aGlzIGFzc3VtaW5nIGFuIGl0ZXJhdG9yXG5cdFx0ZWxlbWVudHMucHVzaC5hcHBseShlbGVtZW50cywgQXJyYXlGcm9tKHJvb3QucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcnMpKSk7XG5cdH0pO1xuXG5cdHJldHVybiBlbGVtZW50cztcbn1cblxuZnVuY3Rpb24gcXVlcnlTZWxlY3RlZE9wdGlvbnMobGlzdGJveDogRWxlbWVudCk6IEFycmF5TGlrZTxFbGVtZW50PiB7XG5cdGlmIChpc0hUTUxTZWxlY3RFbGVtZW50KGxpc3Rib3gpKSB7XG5cdFx0Ly8gSUUxMSBwb2x5ZmlsbFxuXHRcdHJldHVybiAoXG5cdFx0XHRsaXN0Ym94LnNlbGVjdGVkT3B0aW9ucyB8fCBxdWVyeVNlbGVjdG9yQWxsU3VidHJlZShsaXN0Ym94LCBcIltzZWxlY3RlZF1cIilcblx0XHQpO1xuXHR9XG5cdHJldHVybiBxdWVyeVNlbGVjdG9yQWxsU3VidHJlZShsaXN0Ym94LCAnW2FyaWEtc2VsZWN0ZWQ9XCJ0cnVlXCJdJyk7XG59XG5cbmZ1bmN0aW9uIGlzTWFya2VkUHJlc2VudGF0aW9uYWwobm9kZTogTm9kZSk6IG5vZGUgaXMgRWxlbWVudCB7XG5cdHJldHVybiBoYXNBbnlDb25jcmV0ZVJvbGVzKG5vZGUsIFtcIm5vbmVcIiwgXCJwcmVzZW50YXRpb25cIl0pO1xufVxuXG4vKipcbiAqIEVsZW1lbnRzIHNwZWNpZmljYWxseSBsaXN0ZWQgaW4gaHRtbC1hYW1cbiAqXG4gKiBXZSBkb24ndCBuZWVkIHRoaXMgZm9yIGBsYWJlbGAgb3IgYGxlZ2VuZGAgZWxlbWVudHMuXG4gKiBUaGVpciBpbXBsaWNpdCByb2xlcyBhbHJlYWR5IGFsbG93IFwibmFtaW5nIGZyb20gY29udGVudFwiLlxuICpcbiAqIHNvdXJjZXM6XG4gKlxuICogLSBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hYW0vI3RhYmxlLWVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gaXNOYXRpdmVIb3N0TGFuZ3VhZ2VUZXh0QWx0ZXJuYXRpdmVFbGVtZW50KFxuXHRub2RlOiBOb2RlXG4pOiBub2RlIGlzIEVsZW1lbnQge1xuXHRyZXR1cm4gaXNIVE1MVGFibGVDYXB0aW9uRWxlbWVudChub2RlKTtcbn1cblxuLyoqXG4gKiBodHRwczovL3czYy5naXRodWIuaW8vYXJpYS8jbmFtZWZyb21jb250ZW50XG4gKi9cbmZ1bmN0aW9uIGFsbG93c05hbWVGcm9tQ29udGVudChub2RlOiBOb2RlKTogYm9vbGVhbiB7XG5cdHJldHVybiBoYXNBbnlDb25jcmV0ZVJvbGVzKG5vZGUsIFtcblx0XHRcImJ1dHRvblwiLFxuXHRcdFwiY2VsbFwiLFxuXHRcdFwiY2hlY2tib3hcIixcblx0XHRcImNvbHVtbmhlYWRlclwiLFxuXHRcdFwiZ3JpZGNlbGxcIixcblx0XHRcImhlYWRpbmdcIixcblx0XHRcImxhYmVsXCIsXG5cdFx0XCJsZWdlbmRcIixcblx0XHRcImxpbmtcIixcblx0XHRcIm1lbnVpdGVtXCIsXG5cdFx0XCJtZW51aXRlbWNoZWNrYm94XCIsXG5cdFx0XCJtZW51aXRlbXJhZGlvXCIsXG5cdFx0XCJvcHRpb25cIixcblx0XHRcInJhZGlvXCIsXG5cdFx0XCJyb3dcIixcblx0XHRcInJvd2hlYWRlclwiLFxuXHRcdFwic3dpdGNoXCIsXG5cdFx0XCJ0YWJcIixcblx0XHRcInRvb2x0aXBcIixcblx0XHRcInRyZWVpdGVtXCIsXG5cdF0pO1xufVxuXG4vKipcbiAqIFRPRE8gaHR0cHM6Ly9naXRodWIuY29tL2VwczFsb24vZG9tLWFjY2Vzc2liaWxpdHktYXBpL2lzc3Vlcy8xMDBcbiAqL1xuZnVuY3Rpb24gaXNEZXNjZW5kYW50T2ZOYXRpdmVIb3N0TGFuZ3VhZ2VUZXh0QWx0ZXJuYXRpdmVFbGVtZW50KFxuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzIC0tIG5vdCBpbXBsZW1lbnRlZCB5ZXRcblx0bm9kZTogTm9kZVxuKTogYm9vbGVhbiB7XG5cdHJldHVybiBmYWxzZTtcbn1cblxuLyoqXG4gKiBUT0RPIGh0dHBzOi8vZ2l0aHViLmNvbS9lcHMxbG9uL2RvbS1hY2Nlc3NpYmlsaXR5LWFwaS9pc3N1ZXMvMTAxXG4gKi9cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnMgLS0gbm90IGltcGxlbWVudGVkIHlldFxuZnVuY3Rpb24gY29tcHV0ZVRvb2x0aXBBdHRyaWJ1dGVWYWx1ZShub2RlOiBOb2RlKTogc3RyaW5nIHwgbnVsbCB7XG5cdHJldHVybiBudWxsO1xufVxuXG5mdW5jdGlvbiBnZXRWYWx1ZU9mVGV4dGJveChlbGVtZW50OiBFbGVtZW50KTogc3RyaW5nIHtcblx0aWYgKGlzSFRNTElucHV0RWxlbWVudChlbGVtZW50KSB8fCBpc0hUTUxUZXh0QXJlYUVsZW1lbnQoZWxlbWVudCkpIHtcblx0XHRyZXR1cm4gZWxlbWVudC52YWx1ZTtcblx0fVxuXHQvLyBodHRwczovL2dpdGh1Yi5jb20vZXBzMWxvbi9kb20tYWNjZXNzaWJpbGl0eS1hcGkvaXNzdWVzLzRcblx0cmV0dXJuIGVsZW1lbnQudGV4dENvbnRlbnQgfHwgXCJcIjtcbn1cblxuZnVuY3Rpb24gZ2V0VGV4dHVhbENvbnRlbnQoZGVjbGFyYXRpb246IENTU1N0eWxlRGVjbGFyYXRpb24pOiBzdHJpbmcge1xuXHRjb25zdCBjb250ZW50ID0gZGVjbGFyYXRpb24uZ2V0UHJvcGVydHlWYWx1ZShcImNvbnRlbnRcIik7XG5cdGlmICgvXltcIiddLipbXCInXSQvLnRlc3QoY29udGVudCkpIHtcblx0XHRyZXR1cm4gY29udGVudC5zbGljZSgxLCAtMSk7XG5cdH1cblx0cmV0dXJuIFwiXCI7XG59XG5cbi8qKlxuICogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvZm9ybXMuaHRtbCNjYXRlZ29yeS1sYWJlbFxuICogVE9ETzogZm9ybS1hc3NvY2lhdGVkIGN1c3RvbSBlbGVtZW50c1xuICogQHBhcmFtIGVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gaXNMYWJlbGFibGVFbGVtZW50KGVsZW1lbnQ6IEVsZW1lbnQpOiBib29sZWFuIHtcblx0Y29uc3QgbG9jYWxOYW1lID0gZ2V0TG9jYWxOYW1lKGVsZW1lbnQpO1xuXG5cdHJldHVybiAoXG5cdFx0bG9jYWxOYW1lID09PSBcImJ1dHRvblwiIHx8XG5cdFx0KGxvY2FsTmFtZSA9PT0gXCJpbnB1dFwiICYmIGVsZW1lbnQuZ2V0QXR0cmlidXRlKFwidHlwZVwiKSAhPT0gXCJoaWRkZW5cIikgfHxcblx0XHRsb2NhbE5hbWUgPT09IFwibWV0ZXJcIiB8fFxuXHRcdGxvY2FsTmFtZSA9PT0gXCJvdXRwdXRcIiB8fFxuXHRcdGxvY2FsTmFtZSA9PT0gXCJwcm9ncmVzc1wiIHx8XG5cdFx0bG9jYWxOYW1lID09PSBcInNlbGVjdFwiIHx8XG5cdFx0bG9jYWxOYW1lID09PSBcInRleHRhcmVhXCJcblx0KTtcbn1cblxuLyoqXG4gKiA+IFsuLi5dLCB0aGVuIHRoZSBmaXJzdCBzdWNoIGRlc2NlbmRhbnQgaW4gdHJlZSBvcmRlciBpcyB0aGUgbGFiZWwgZWxlbWVudCdzIGxhYmVsZWQgY29udHJvbC5cbiAqIC0tIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL2Zvcm1zLmh0bWwjbGFiZWxlZC1jb250cm9sXG4gKiBAcGFyYW0gZWxlbWVudFxuICovXG5mdW5jdGlvbiBmaW5kTGFiZWxhYmxlRWxlbWVudChlbGVtZW50OiBFbGVtZW50KTogRWxlbWVudCB8IG51bGwge1xuXHRpZiAoaXNMYWJlbGFibGVFbGVtZW50KGVsZW1lbnQpKSB7XG5cdFx0cmV0dXJuIGVsZW1lbnQ7XG5cdH1cblx0bGV0IGxhYmVsYWJsZUVsZW1lbnQ6IEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0ZWxlbWVudC5jaGlsZE5vZGVzLmZvckVhY2goKGNoaWxkTm9kZSkgPT4ge1xuXHRcdGlmIChsYWJlbGFibGVFbGVtZW50ID09PSBudWxsICYmIGlzRWxlbWVudChjaGlsZE5vZGUpKSB7XG5cdFx0XHRjb25zdCBkZXNjZW5kYW50TGFiZWxhYmxlRWxlbWVudCA9IGZpbmRMYWJlbGFibGVFbGVtZW50KGNoaWxkTm9kZSk7XG5cdFx0XHRpZiAoZGVzY2VuZGFudExhYmVsYWJsZUVsZW1lbnQgIT09IG51bGwpIHtcblx0XHRcdFx0bGFiZWxhYmxlRWxlbWVudCA9IGRlc2NlbmRhbnRMYWJlbGFibGVFbGVtZW50O1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cblx0cmV0dXJuIGxhYmVsYWJsZUVsZW1lbnQ7XG59XG5cbi8qKlxuICogUG9seWZpbGwgb2YgSFRNTExhYmVsRWxlbWVudC5jb250cm9sXG4gKiBodHRwczovL2h0bWwuc3BlYy53aGF0d2cub3JnL211bHRpcGFnZS9mb3Jtcy5odG1sI2xhYmVsZWQtY29udHJvbFxuICogQHBhcmFtIGxhYmVsXG4gKi9cbmZ1bmN0aW9uIGdldENvbnRyb2xPZkxhYmVsKGxhYmVsOiBIVE1MTGFiZWxFbGVtZW50KTogRWxlbWVudCB8IG51bGwge1xuXHRpZiAobGFiZWwuY29udHJvbCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGxhYmVsLmNvbnRyb2w7XG5cdH1cblxuXHRjb25zdCBodG1sRm9yID0gbGFiZWwuZ2V0QXR0cmlidXRlKFwiZm9yXCIpO1xuXHRpZiAoaHRtbEZvciAhPT0gbnVsbCkge1xuXHRcdHJldHVybiBsYWJlbC5vd25lckRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGh0bWxGb3IpO1xuXHR9XG5cblx0cmV0dXJuIGZpbmRMYWJlbGFibGVFbGVtZW50KGxhYmVsKTtcbn1cblxuLyoqXG4gKiBQb2x5ZmlsbCBvZiBIVE1MSW5wdXRFbGVtZW50LmxhYmVsc1xuICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxJbnB1dEVsZW1lbnQvbGFiZWxzXG4gKiBAcGFyYW0gZWxlbWVudFxuICovXG5mdW5jdGlvbiBnZXRMYWJlbHMoZWxlbWVudDogRWxlbWVudCk6IEhUTUxMYWJlbEVsZW1lbnRbXSB8IG51bGwge1xuXHRjb25zdCBsYWJlbHNQcm9wZXJ0eSA9IChlbGVtZW50IGFzIGFueSkubGFiZWxzIGFzXG5cdFx0fCB1bmRlZmluZWRcblx0XHR8IG51bGxcblx0XHR8IE5vZGVMaXN0T2Y8SFRNTExhYmVsRWxlbWVudD47XG5cdGlmIChsYWJlbHNQcm9wZXJ0eSA9PT0gbnVsbCkge1xuXHRcdHJldHVybiBsYWJlbHNQcm9wZXJ0eTtcblx0fVxuXHRpZiAobGFiZWxzUHJvcGVydHkgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBBcnJheUZyb20obGFiZWxzUHJvcGVydHkpO1xuXHR9XG5cblx0Ly8gcG9seWZpbGxcblx0aWYgKCFpc0xhYmVsYWJsZUVsZW1lbnQoZWxlbWVudCkpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXHRjb25zdCBkb2N1bWVudCA9IGVsZW1lbnQub3duZXJEb2N1bWVudDtcblxuXHRyZXR1cm4gQXJyYXlGcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJsYWJlbFwiKSkuZmlsdGVyKChsYWJlbCkgPT4ge1xuXHRcdHJldHVybiBnZXRDb250cm9sT2ZMYWJlbChsYWJlbCkgPT09IGVsZW1lbnQ7XG5cdH0pO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIGNvbnRlbnRzIG9mIGEgc2xvdCB1c2VkIGZvciBjb21wdXRpbmcgdGhlIGFjY25hbWVcbiAqIEBwYXJhbSBzbG90XG4gKi9cbmZ1bmN0aW9uIGdldFNsb3RDb250ZW50cyhzbG90OiBIVE1MU2xvdEVsZW1lbnQpOiBOb2RlW10ge1xuXHQvLyBDb21wdXRpbmcgdGhlIGFjY2Vzc2libGUgbmFtZSBmb3IgZWxlbWVudHMgY29udGFpbmluZyBzbG90cyBpcyBub3Rcblx0Ly8gY3VycmVudGx5IGRlZmluZWQgaW4gdGhlIHNwZWMuIFRoaXMgaW1wbGVtZW50YXRpb24gcmVmbGVjdHMgdGhlXG5cdC8vIGJlaGF2aW9yIG9mIE5WREEgMjAyMC4yL0ZpcmVmb3ggODEgYW5kIGlPUyBWb2ljZU92ZXIvU2FmYXJpIDEzLjYuXG5cdGNvbnN0IGFzc2lnbmVkTm9kZXMgPSBzbG90LmFzc2lnbmVkTm9kZXMoKTtcblx0aWYgKGFzc2lnbmVkTm9kZXMubGVuZ3RoID09PSAwKSB7XG5cdFx0Ly8gaWYgbm8gbm9kZXMgYXJlIGFzc2lnbmVkIHRvIHRoZSBzbG90LCBpdCBkaXNwbGF5cyB0aGUgZGVmYXVsdCBjb250ZW50XG5cdFx0cmV0dXJuIEFycmF5RnJvbShzbG90LmNoaWxkTm9kZXMpO1xuXHR9XG5cdHJldHVybiBhc3NpZ25lZE5vZGVzO1xufVxuXG4vKipcbiAqIGltcGxlbWVudHMgaHR0cHM6Ly93M2MuZ2l0aHViLmlvL2FjY25hbWUvI21hcHBpbmdfYWRkaXRpb25hbF9uZF90ZVxuICogQHBhcmFtIHJvb3RcbiAqIEBwYXJhbSBbb3B0aW9uc11cbiAqIEBwYXJhbSBbb3B0aW9ucy5nZXRDb21wdXRlZFN0eWxlXSAtIG1vY2sgd2luZG93LmdldENvbXB1dGVkU3R5bGUuIE5lZWRzIGBjb250ZW50YCwgYGRpc3BsYXlgIGFuZCBgdmlzaWJpbGl0eWBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUoXG5cdHJvb3Q6IEVsZW1lbnQsXG5cdG9wdGlvbnM6IENvbXB1dGVUZXh0QWx0ZXJuYXRpdmVPcHRpb25zID0ge31cbik6IHN0cmluZyB7XG5cdGNvbnN0IGNvbnN1bHRlZE5vZGVzID0gbmV3IFNldExpa2U8Tm9kZT4oKTtcblxuXHRjb25zdCB3aW5kb3cgPSBzYWZlV2luZG93KHJvb3QpO1xuXHRjb25zdCB7XG5cdFx0Y29tcHV0ZSA9IFwibmFtZVwiLFxuXHRcdGNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzID0gb3B0aW9ucy5nZXRDb21wdXRlZFN0eWxlICE9PVxuXHRcdFx0dW5kZWZpbmVkLFxuXHRcdC8vIFRoaXMgbWlnaHQgYmUgb3ZlcmVuZ2luZWVyZWQuIEkgZG9uJ3Qga25vdyB3aGF0IGhhcHBlbnMgaWYgSSBjYWxsXG5cdFx0Ly8gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbWVudEZyb21Bbm90aGVyV2luZG93KSBvciBpZiBJIGRvbid0IGJpbmQgaXRcblx0XHQvLyB0aGUgdHlwZSBkZWNsYXJhdGlvbnMgZG9uJ3QgcmVxdWlyZSBhIGB0aGlzYFxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXByb3BlcnRpZXNcblx0XHRnZXRDb21wdXRlZFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUuYmluZCh3aW5kb3cpLFxuXHR9ID0gb3B0aW9ucztcblxuXHQvLyAyRi5pXG5cdGZ1bmN0aW9uIGNvbXB1dGVNaXNjVGV4dEFsdGVybmF0aXZlKFxuXHRcdG5vZGU6IE5vZGUsXG5cdFx0Y29udGV4dDogeyBpc0VtYmVkZGVkSW5MYWJlbDogYm9vbGVhbjsgaXNSZWZlcmVuY2VkOiBib29sZWFuIH1cblx0KTogc3RyaW5nIHtcblx0XHRsZXQgYWNjdW11bGF0ZWRUZXh0ID0gXCJcIjtcblx0XHRpZiAoaXNFbGVtZW50KG5vZGUpICYmIGNvbXB1dGVkU3R5bGVTdXBwb3J0c1BzZXVkb0VsZW1lbnRzKSB7XG5cdFx0XHRjb25zdCBwc2V1ZG9CZWZvcmUgPSBnZXRDb21wdXRlZFN0eWxlKG5vZGUsIFwiOjpiZWZvcmVcIik7XG5cdFx0XHRjb25zdCBiZWZvcmVDb250ZW50ID0gZ2V0VGV4dHVhbENvbnRlbnQocHNldWRvQmVmb3JlKTtcblx0XHRcdGFjY3VtdWxhdGVkVGV4dCA9IGAke2JlZm9yZUNvbnRlbnR9ICR7YWNjdW11bGF0ZWRUZXh0fWA7XG5cdFx0fVxuXG5cdFx0Ly8gRklYTUU6IEluY2x1ZGluZyBhcmlhLW93bnMgaXMgbm90IGRlZmluZWQgaW4gdGhlIHNwZWNcblx0XHQvLyBCdXQgaXQgaXMgcmVxdWlyZWQgaW4gdGhlIHdlYi1wbGF0Zm9ybS10ZXN0XG5cdFx0Y29uc3QgY2hpbGROb2RlcyA9IGlzSFRNTFNsb3RFbGVtZW50KG5vZGUpXG5cdFx0XHQ/IGdldFNsb3RDb250ZW50cyhub2RlKVxuXHRcdFx0OiBBcnJheUZyb20obm9kZS5jaGlsZE5vZGVzKS5jb25jYXQocXVlcnlJZFJlZnMobm9kZSwgXCJhcmlhLW93bnNcIikpO1xuXHRcdGNoaWxkTm9kZXMuZm9yRWFjaCgoY2hpbGQpID0+IHtcblx0XHRcdGNvbnN0IHJlc3VsdCA9IGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUoY2hpbGQsIHtcblx0XHRcdFx0aXNFbWJlZGRlZEluTGFiZWw6IGNvbnRleHQuaXNFbWJlZGRlZEluTGFiZWwsXG5cdFx0XHRcdGlzUmVmZXJlbmNlZDogZmFsc2UsXG5cdFx0XHRcdHJlY3Vyc2lvbjogdHJ1ZSxcblx0XHRcdH0pO1xuXHRcdFx0Ly8gVE9ETzogVW5jbGVhciB3aHkgZGlzcGxheSBhZmZlY3RzIGRlbGltaXRlclxuXHRcdFx0Ly8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93M2MvYWNjbmFtZS9pc3N1ZXMvM1xuXHRcdFx0Y29uc3QgZGlzcGxheSA9IGlzRWxlbWVudChjaGlsZClcblx0XHRcdFx0PyBnZXRDb21wdXRlZFN0eWxlKGNoaWxkKS5nZXRQcm9wZXJ0eVZhbHVlKFwiZGlzcGxheVwiKVxuXHRcdFx0XHQ6IFwiaW5saW5lXCI7XG5cdFx0XHRjb25zdCBzZXBhcmF0b3IgPSBkaXNwbGF5ICE9PSBcImlubGluZVwiID8gXCIgXCIgOiBcIlwiO1xuXHRcdFx0Ly8gdHJhaWxpbmcgc2VwYXJhdG9yIGZvciB3cHQgdGVzdHNcblx0XHRcdGFjY3VtdWxhdGVkVGV4dCArPSBgJHtzZXBhcmF0b3J9JHtyZXN1bHR9JHtzZXBhcmF0b3J9YDtcblx0XHR9KTtcblxuXHRcdGlmIChpc0VsZW1lbnQobm9kZSkgJiYgY29tcHV0ZWRTdHlsZVN1cHBvcnRzUHNldWRvRWxlbWVudHMpIHtcblx0XHRcdGNvbnN0IHBzZXVkb0FmdGVyID0gZ2V0Q29tcHV0ZWRTdHlsZShub2RlLCBcIjo6YWZ0ZXJcIik7XG5cdFx0XHRjb25zdCBhZnRlckNvbnRlbnQgPSBnZXRUZXh0dWFsQ29udGVudChwc2V1ZG9BZnRlcik7XG5cdFx0XHRhY2N1bXVsYXRlZFRleHQgPSBgJHthY2N1bXVsYXRlZFRleHR9ICR7YWZ0ZXJDb250ZW50fWA7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGFjY3VtdWxhdGVkVGV4dDtcblx0fVxuXG5cdGZ1bmN0aW9uIGNvbXB1dGVFbGVtZW50VGV4dEFsdGVybmF0aXZlKG5vZGU6IE5vZGUpOiBzdHJpbmcgfCBudWxsIHtcblx0XHRpZiAoIWlzRWxlbWVudChub2RlKSkge1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0LyoqXG5cdFx0ICpcblx0XHQgKiBAcGFyYW0gZWxlbWVudFxuXHRcdCAqIEBwYXJhbSBhdHRyaWJ1dGVOYW1lXG5cdFx0ICogQHJldHVybnMgQSBzdHJpbmcgbm9uLWVtcHR5IHN0cmluZyBvciBgbnVsbGBcblx0XHQgKi9cblx0XHRmdW5jdGlvbiB1c2VBdHRyaWJ1dGUoXG5cdFx0XHRlbGVtZW50OiBFbGVtZW50LFxuXHRcdFx0YXR0cmlidXRlTmFtZTogc3RyaW5nXG5cdFx0KTogc3RyaW5nIHwgbnVsbCB7XG5cdFx0XHRjb25zdCBhdHRyaWJ1dGUgPSBlbGVtZW50LmdldEF0dHJpYnV0ZU5vZGUoYXR0cmlidXRlTmFtZSk7XG5cdFx0XHRpZiAoXG5cdFx0XHRcdGF0dHJpYnV0ZSAhPT0gbnVsbCAmJlxuXHRcdFx0XHQhY29uc3VsdGVkTm9kZXMuaGFzKGF0dHJpYnV0ZSkgJiZcblx0XHRcdFx0YXR0cmlidXRlLnZhbHVlLnRyaW0oKSAhPT0gXCJcIlxuXHRcdFx0KSB7XG5cdFx0XHRcdGNvbnN1bHRlZE5vZGVzLmFkZChhdHRyaWJ1dGUpO1xuXHRcdFx0XHRyZXR1cm4gYXR0cmlidXRlLnZhbHVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gaHR0cHM6Ly93M2MuZ2l0aHViLmlvL2h0bWwtYWFtLyNmaWVsZHNldC1hbmQtbGVnZW5kLWVsZW1lbnRzXG5cdFx0aWYgKGlzSFRNTEZpZWxkU2V0RWxlbWVudChub2RlKSkge1xuXHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKG5vZGUpO1xuXHRcdFx0Y29uc3QgY2hpbGRyZW4gPSBBcnJheUZyb20obm9kZS5jaGlsZE5vZGVzKTtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0Y29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTtcblx0XHRcdFx0aWYgKGlzSFRNTExlZ2VuZEVsZW1lbnQoY2hpbGQpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUoY2hpbGQsIHtcblx0XHRcdFx0XHRcdGlzRW1iZWRkZWRJbkxhYmVsOiBmYWxzZSxcblx0XHRcdFx0XHRcdGlzUmVmZXJlbmNlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWN1cnNpb246IGZhbHNlLFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChpc0hUTUxUYWJsZUVsZW1lbnQobm9kZSkpIHtcblx0XHRcdC8vIGh0dHBzOi8vdzNjLmdpdGh1Yi5pby9odG1sLWFhbS8jdGFibGUtZWxlbWVudFxuXHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKG5vZGUpO1xuXHRcdFx0Y29uc3QgY2hpbGRyZW4gPSBBcnJheUZyb20obm9kZS5jaGlsZE5vZGVzKTtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY2hpbGRyZW4ubGVuZ3RoOyBpICs9IDEpIHtcblx0XHRcdFx0Y29uc3QgY2hpbGQgPSBjaGlsZHJlbltpXTtcblx0XHRcdFx0aWYgKGlzSFRNTFRhYmxlQ2FwdGlvbkVsZW1lbnQoY2hpbGQpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUoY2hpbGQsIHtcblx0XHRcdFx0XHRcdGlzRW1iZWRkZWRJbkxhYmVsOiBmYWxzZSxcblx0XHRcdFx0XHRcdGlzUmVmZXJlbmNlZDogZmFsc2UsXG5cdFx0XHRcdFx0XHRyZWN1cnNpb246IGZhbHNlLFxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChpc1NWR1NWR0VsZW1lbnQobm9kZSkpIHtcblx0XHRcdC8vIGh0dHBzOi8vd3d3LnczLm9yZy9UUi9zdmctYWFtLTEuMC9cblx0XHRcdGNvbnN1bHRlZE5vZGVzLmFkZChub2RlKTtcblx0XHRcdGNvbnN0IGNoaWxkcmVuID0gQXJyYXlGcm9tKG5vZGUuY2hpbGROb2Rlcyk7XG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkcmVuLmxlbmd0aDsgaSArPSAxKSB7XG5cdFx0XHRcdGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XG5cdFx0XHRcdGlmIChpc1NWR1RpdGxlRWxlbWVudChjaGlsZCkpIHtcblx0XHRcdFx0XHRyZXR1cm4gY2hpbGQudGV4dENvbnRlbnQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH0gZWxzZSBpZiAoZ2V0TG9jYWxOYW1lKG5vZGUpID09PSBcImltZ1wiIHx8IGdldExvY2FsTmFtZShub2RlKSA9PT0gXCJhcmVhXCIpIHtcblx0XHRcdC8vIGh0dHBzOi8vdzNjLmdpdGh1Yi5pby9odG1sLWFhbS8jYXJlYS1lbGVtZW50XG5cdFx0XHQvLyBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hYW0vI2ltZy1lbGVtZW50XG5cdFx0XHRjb25zdCBuYW1lRnJvbUFsdCA9IHVzZUF0dHJpYnV0ZShub2RlLCBcImFsdFwiKTtcblx0XHRcdGlmIChuYW1lRnJvbUFsdCAhPT0gbnVsbCkge1xuXHRcdFx0XHRyZXR1cm4gbmFtZUZyb21BbHQ7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChpc0hUTUxPcHRHcm91cEVsZW1lbnQobm9kZSkpIHtcblx0XHRcdGNvbnN0IG5hbWVGcm9tTGFiZWwgPSB1c2VBdHRyaWJ1dGUobm9kZSwgXCJsYWJlbFwiKTtcblx0XHRcdGlmIChuYW1lRnJvbUxhYmVsICE9PSBudWxsKSB7XG5cdFx0XHRcdHJldHVybiBuYW1lRnJvbUxhYmVsO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChcblx0XHRcdGlzSFRNTElucHV0RWxlbWVudChub2RlKSAmJlxuXHRcdFx0KG5vZGUudHlwZSA9PT0gXCJidXR0b25cIiB8fFxuXHRcdFx0XHRub2RlLnR5cGUgPT09IFwic3VibWl0XCIgfHxcblx0XHRcdFx0bm9kZS50eXBlID09PSBcInJlc2V0XCIpXG5cdFx0KSB7XG5cdFx0XHQvLyBodHRwczovL3czYy5naXRodWIuaW8vaHRtbC1hYW0vI2lucHV0LXR5cGUtdGV4dC1pbnB1dC10eXBlLXBhc3N3b3JkLWlucHV0LXR5cGUtc2VhcmNoLWlucHV0LXR5cGUtdGVsLWlucHV0LXR5cGUtZW1haWwtaW5wdXQtdHlwZS11cmwtYW5kLXRleHRhcmVhLWVsZW1lbnQtYWNjZXNzaWJsZS1kZXNjcmlwdGlvbi1jb21wdXRhdGlvblxuXHRcdFx0Y29uc3QgbmFtZUZyb21WYWx1ZSA9IHVzZUF0dHJpYnV0ZShub2RlLCBcInZhbHVlXCIpO1xuXHRcdFx0aWYgKG5hbWVGcm9tVmFsdWUgIT09IG51bGwpIHtcblx0XHRcdFx0cmV0dXJuIG5hbWVGcm9tVmFsdWU7XG5cdFx0XHR9XG5cblx0XHRcdC8vIFRPRE86IGwxMG5cblx0XHRcdGlmIChub2RlLnR5cGUgPT09IFwic3VibWl0XCIpIHtcblx0XHRcdFx0cmV0dXJuIFwiU3VibWl0XCI7XG5cdFx0XHR9XG5cdFx0XHQvLyBUT0RPOiBsMTBuXG5cdFx0XHRpZiAobm9kZS50eXBlID09PSBcInJlc2V0XCIpIHtcblx0XHRcdFx0cmV0dXJuIFwiUmVzZXRcIjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRjb25zdCBsYWJlbHMgPSBnZXRMYWJlbHMobm9kZSk7XG5cdFx0aWYgKGxhYmVscyAhPT0gbnVsbCAmJiBsYWJlbHMubGVuZ3RoICE9PSAwKSB7XG5cdFx0XHRjb25zdWx0ZWROb2Rlcy5hZGQobm9kZSk7XG5cdFx0XHRyZXR1cm4gQXJyYXlGcm9tKGxhYmVscylcblx0XHRcdFx0Lm1hcCgoZWxlbWVudCkgPT4ge1xuXHRcdFx0XHRcdHJldHVybiBjb21wdXRlVGV4dEFsdGVybmF0aXZlKGVsZW1lbnQsIHtcblx0XHRcdFx0XHRcdGlzRW1iZWRkZWRJbkxhYmVsOiB0cnVlLFxuXHRcdFx0XHRcdFx0aXNSZWZlcmVuY2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdHJlY3Vyc2lvbjogdHJ1ZSxcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSlcblx0XHRcdFx0LmZpbHRlcigobGFiZWwpID0+IHtcblx0XHRcdFx0XHRyZXR1cm4gbGFiZWwubGVuZ3RoID4gMDtcblx0XHRcdFx0fSlcblx0XHRcdFx0LmpvaW4oXCIgXCIpO1xuXHRcdH1cblxuXHRcdC8vIGh0dHBzOi8vdzNjLmdpdGh1Yi5pby9odG1sLWFhbS8jaW5wdXQtdHlwZS1pbWFnZS1hY2Nlc3NpYmxlLW5hbWUtY29tcHV0YXRpb25cblx0XHQvLyBUT0RPOiB3cHQgdGVzdCBjb25zaWRlciBsYWJlbCBlbGVtZW50cyBidXQgaHRtbC1hYW0gZG9lcyBub3QgbWVudGlvbiB0aGVtXG5cdFx0Ly8gV2UgZm9sbG93IGV4aXN0aW5nIGltcGxlbWVudGF0aW9ucyBvdmVyIHNwZWNcblx0XHRpZiAoaXNIVE1MSW5wdXRFbGVtZW50KG5vZGUpICYmIG5vZGUudHlwZSA9PT0gXCJpbWFnZVwiKSB7XG5cdFx0XHRjb25zdCBuYW1lRnJvbUFsdCA9IHVzZUF0dHJpYnV0ZShub2RlLCBcImFsdFwiKTtcblx0XHRcdGlmIChuYW1lRnJvbUFsdCAhPT0gbnVsbCkge1xuXHRcdFx0XHRyZXR1cm4gbmFtZUZyb21BbHQ7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IG5hbWVGcm9tVGl0bGUgPSB1c2VBdHRyaWJ1dGUobm9kZSwgXCJ0aXRsZVwiKTtcblx0XHRcdGlmIChuYW1lRnJvbVRpdGxlICE9PSBudWxsKSB7XG5cdFx0XHRcdHJldHVybiBuYW1lRnJvbVRpdGxlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBUT0RPOiBsMTBuXG5cdFx0XHRyZXR1cm4gXCJTdWJtaXQgUXVlcnlcIjtcblx0XHR9XG5cblx0XHRyZXR1cm4gdXNlQXR0cmlidXRlKG5vZGUsIFwidGl0bGVcIik7XG5cdH1cblxuXHRmdW5jdGlvbiBjb21wdXRlVGV4dEFsdGVybmF0aXZlKFxuXHRcdGN1cnJlbnQ6IE5vZGUsXG5cdFx0Y29udGV4dDoge1xuXHRcdFx0aXNFbWJlZGRlZEluTGFiZWw6IGJvb2xlYW47XG5cdFx0XHRpc1JlZmVyZW5jZWQ6IGJvb2xlYW47XG5cdFx0XHRyZWN1cnNpb246IGJvb2xlYW47XG5cdFx0fVxuXHQpOiBzdHJpbmcge1xuXHRcdGlmIChjb25zdWx0ZWROb2Rlcy5oYXMoY3VycmVudCkpIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdC8vIHNwZWNpYWwgY2FzaW5nLCBjaGVhdGluZyB0byBtYWtlIHRlc3RzIHBhc3Ncblx0XHQvLyBodHRwczovL2dpdGh1Yi5jb20vdzNjL2FjY25hbWUvaXNzdWVzLzY3XG5cdFx0aWYgKGhhc0FueUNvbmNyZXRlUm9sZXMoY3VycmVudCwgW1wibWVudVwiXSkpIHtcblx0XHRcdGNvbnN1bHRlZE5vZGVzLmFkZChjdXJyZW50KTtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdC8vIDJBXG5cdFx0aWYgKGlzSGlkZGVuKGN1cnJlbnQsIGdldENvbXB1dGVkU3R5bGUpICYmICFjb250ZXh0LmlzUmVmZXJlbmNlZCkge1xuXHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuXHRcdFx0cmV0dXJuIFwiXCIgYXMgRmxhdFN0cmluZztcblx0XHR9XG5cblx0XHQvLyAyQlxuXHRcdGNvbnN0IGxhYmVsRWxlbWVudHMgPSBxdWVyeUlkUmVmcyhjdXJyZW50LCBcImFyaWEtbGFiZWxsZWRieVwiKTtcblx0XHRpZiAoXG5cdFx0XHRjb21wdXRlID09PSBcIm5hbWVcIiAmJlxuXHRcdFx0IWNvbnRleHQuaXNSZWZlcmVuY2VkICYmXG5cdFx0XHRsYWJlbEVsZW1lbnRzLmxlbmd0aCA+IDBcblx0XHQpIHtcblx0XHRcdHJldHVybiBsYWJlbEVsZW1lbnRzXG5cdFx0XHRcdC5tYXAoKGVsZW1lbnQpID0+XG5cdFx0XHRcdFx0Y29tcHV0ZVRleHRBbHRlcm5hdGl2ZShlbGVtZW50LCB7XG5cdFx0XHRcdFx0XHRpc0VtYmVkZGVkSW5MYWJlbDogY29udGV4dC5pc0VtYmVkZGVkSW5MYWJlbCxcblx0XHRcdFx0XHRcdGlzUmVmZXJlbmNlZDogdHJ1ZSxcblx0XHRcdFx0XHRcdC8vIHRoYWlzIGlzbid0IHJlY3Vyc2lvbiBhcyBzcGVjaWZpZWQsIG90aGVyd2lzZSB3ZSB3b3VsZCBza2lwXG5cdFx0XHRcdFx0XHQvLyBgYXJpYS1sYWJlbGAgaW5cblx0XHRcdFx0XHRcdC8vIDxpbnB1dCBpZD1cIm15c2VsZlwiIGFyaWEtbGFiZWw9XCJmb29cIiBhcmlhLWxhYmVsbGVkYnk9XCJteXNlbGZcIlxuXHRcdFx0XHRcdFx0cmVjdXJzaW9uOiBmYWxzZSxcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHQpXG5cdFx0XHRcdC5qb2luKFwiIFwiKTtcblx0XHR9XG5cblx0XHQvLyAyQ1xuXHRcdC8vIENoYW5nZWQgZnJvbSB0aGUgc3BlYyBpbiBhbnRpY2lwYXRpb24gb2YgaHR0cHM6Ly9naXRodWIuY29tL3czYy9hY2NuYW1lL2lzc3Vlcy82NFxuXHRcdC8vIHNwZWMgc2F5cyB3ZSBzaG91bGQgb25seSBjb25zaWRlciBza2lwcGluZyBpZiB3ZSBoYXZlIGEgbm9uLWVtcHR5IGxhYmVsXG5cdFx0Y29uc3Qgc2tpcFRvU3RlcDJFID1cblx0XHRcdGNvbnRleHQucmVjdXJzaW9uICYmIGlzQ29udHJvbChjdXJyZW50KSAmJiBjb21wdXRlID09PSBcIm5hbWVcIjtcblx0XHRpZiAoIXNraXBUb1N0ZXAyRSkge1xuXHRcdFx0Y29uc3QgYXJpYUxhYmVsID0gKFxuXHRcdFx0XHQoaXNFbGVtZW50KGN1cnJlbnQpICYmIGN1cnJlbnQuZ2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiKSkgfHxcblx0XHRcdFx0XCJcIlxuXHRcdFx0KS50cmltKCk7XG5cdFx0XHRpZiAoYXJpYUxhYmVsICE9PSBcIlwiICYmIGNvbXB1dGUgPT09IFwibmFtZVwiKSB7XG5cdFx0XHRcdGNvbnN1bHRlZE5vZGVzLmFkZChjdXJyZW50KTtcblx0XHRcdFx0cmV0dXJuIGFyaWFMYWJlbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gMkRcblx0XHRcdGlmICghaXNNYXJrZWRQcmVzZW50YXRpb25hbChjdXJyZW50KSkge1xuXHRcdFx0XHRjb25zdCBlbGVtZW50VGV4dEFsdGVybmF0aXZlID0gY29tcHV0ZUVsZW1lbnRUZXh0QWx0ZXJuYXRpdmUoY3VycmVudCk7XG5cdFx0XHRcdGlmIChlbGVtZW50VGV4dEFsdGVybmF0aXZlICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuXHRcdFx0XHRcdHJldHVybiBlbGVtZW50VGV4dEFsdGVybmF0aXZlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gMkVcblx0XHRpZiAoc2tpcFRvU3RlcDJFIHx8IGNvbnRleHQuaXNFbWJlZGRlZEluTGFiZWwgfHwgY29udGV4dC5pc1JlZmVyZW5jZWQpIHtcblx0XHRcdGlmIChoYXNBbnlDb25jcmV0ZVJvbGVzKGN1cnJlbnQsIFtcImNvbWJvYm94XCIsIFwibGlzdGJveFwiXSkpIHtcblx0XHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuXHRcdFx0XHRjb25zdCBzZWxlY3RlZE9wdGlvbnMgPSBxdWVyeVNlbGVjdGVkT3B0aW9ucyhjdXJyZW50KTtcblx0XHRcdFx0aWYgKHNlbGVjdGVkT3B0aW9ucy5sZW5ndGggPT09IDApIHtcblx0XHRcdFx0XHQvLyBkZWZpbmVkIHBlciB0ZXN0IGBuYW1lX2hlYWRpbmdfY29tYm9ib3hgXG5cdFx0XHRcdFx0cmV0dXJuIGlzSFRNTElucHV0RWxlbWVudChjdXJyZW50KSA/IGN1cnJlbnQudmFsdWUgOiBcIlwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBBcnJheUZyb20oc2VsZWN0ZWRPcHRpb25zKVxuXHRcdFx0XHRcdC5tYXAoKHNlbGVjdGVkT3B0aW9uKSA9PiB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gY29tcHV0ZVRleHRBbHRlcm5hdGl2ZShzZWxlY3RlZE9wdGlvbiwge1xuXHRcdFx0XHRcdFx0XHRpc0VtYmVkZGVkSW5MYWJlbDogY29udGV4dC5pc0VtYmVkZGVkSW5MYWJlbCxcblx0XHRcdFx0XHRcdFx0aXNSZWZlcmVuY2VkOiBmYWxzZSxcblx0XHRcdFx0XHRcdFx0cmVjdXJzaW9uOiB0cnVlLFxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0XHQuam9pbihcIiBcIik7XG5cdFx0XHR9XG5cdFx0XHRpZiAoaGFzQWJzdHJhY3RSb2xlKGN1cnJlbnQsIFwicmFuZ2VcIikpIHtcblx0XHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuXHRcdFx0XHRpZiAoY3VycmVudC5oYXNBdHRyaWJ1dGUoXCJhcmlhLXZhbHVldGV4dFwiKSkge1xuXHRcdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tbm9uLW51bGwtYXNzZXJ0aW9uIC0tIHNhZmUgZHVlIHRvIGhhc0F0dHJpYnV0ZSBndWFyZFxuXHRcdFx0XHRcdHJldHVybiBjdXJyZW50LmdldEF0dHJpYnV0ZShcImFyaWEtdmFsdWV0ZXh0XCIpITtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoY3VycmVudC5oYXNBdHRyaWJ1dGUoXCJhcmlhLXZhbHVlbm93XCIpKSB7XG5cdFx0XHRcdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1ub24tbnVsbC1hc3NlcnRpb24gLS0gc2FmZSBkdWUgdG8gaGFzQXR0cmlidXRlIGd1YXJkXG5cdFx0XHRcdFx0cmV0dXJuIGN1cnJlbnQuZ2V0QXR0cmlidXRlKFwiYXJpYS12YWx1ZW5vd1wiKSE7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gT3RoZXJ3aXNlLCB1c2UgdGhlIHZhbHVlIGFzIHNwZWNpZmllZCBieSBhIGhvc3QgbGFuZ3VhZ2UgYXR0cmlidXRlLlxuXHRcdFx0XHRyZXR1cm4gY3VycmVudC5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKSB8fCBcIlwiO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGhhc0FueUNvbmNyZXRlUm9sZXMoY3VycmVudCwgW1widGV4dGJveFwiXSkpIHtcblx0XHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuXHRcdFx0XHRyZXR1cm4gZ2V0VmFsdWVPZlRleHRib3goY3VycmVudCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gMkY6IGh0dHBzOi8vdzNjLmdpdGh1Yi5pby9hY2NuYW1lLyNzdGVwMkZcblx0XHRpZiAoXG5cdFx0XHRhbGxvd3NOYW1lRnJvbUNvbnRlbnQoY3VycmVudCkgfHxcblx0XHRcdChpc0VsZW1lbnQoY3VycmVudCkgJiYgY29udGV4dC5pc1JlZmVyZW5jZWQpIHx8XG5cdFx0XHRpc05hdGl2ZUhvc3RMYW5ndWFnZVRleHRBbHRlcm5hdGl2ZUVsZW1lbnQoY3VycmVudCkgfHxcblx0XHRcdGlzRGVzY2VuZGFudE9mTmF0aXZlSG9zdExhbmd1YWdlVGV4dEFsdGVybmF0aXZlRWxlbWVudChjdXJyZW50KVxuXHRcdCkge1xuXHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuXHRcdFx0cmV0dXJuIGNvbXB1dGVNaXNjVGV4dEFsdGVybmF0aXZlKGN1cnJlbnQsIHtcblx0XHRcdFx0aXNFbWJlZGRlZEluTGFiZWw6IGNvbnRleHQuaXNFbWJlZGRlZEluTGFiZWwsXG5cdFx0XHRcdGlzUmVmZXJlbmNlZDogZmFsc2UsXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRpZiAoY3VycmVudC5ub2RlVHlwZSA9PT0gY3VycmVudC5URVhUX05PREUpIHtcblx0XHRcdGNvbnN1bHRlZE5vZGVzLmFkZChjdXJyZW50KTtcblx0XHRcdHJldHVybiBjdXJyZW50LnRleHRDb250ZW50IHx8IFwiXCI7XG5cdFx0fVxuXG5cdFx0aWYgKGNvbnRleHQucmVjdXJzaW9uKSB7XG5cdFx0XHRjb25zdWx0ZWROb2Rlcy5hZGQoY3VycmVudCk7XG5cdFx0XHRyZXR1cm4gY29tcHV0ZU1pc2NUZXh0QWx0ZXJuYXRpdmUoY3VycmVudCwge1xuXHRcdFx0XHRpc0VtYmVkZGVkSW5MYWJlbDogY29udGV4dC5pc0VtYmVkZGVkSW5MYWJlbCxcblx0XHRcdFx0aXNSZWZlcmVuY2VkOiBmYWxzZSxcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IHRvb2x0aXBBdHRyaWJ1dGVWYWx1ZSA9IGNvbXB1dGVUb29sdGlwQXR0cmlidXRlVmFsdWUoY3VycmVudCk7XG5cdFx0aWYgKHRvb2x0aXBBdHRyaWJ1dGVWYWx1ZSAhPT0gbnVsbCkge1xuXHRcdFx0Y29uc3VsdGVkTm9kZXMuYWRkKGN1cnJlbnQpO1xuXHRcdFx0cmV0dXJuIHRvb2x0aXBBdHRyaWJ1dGVWYWx1ZTtcblx0XHR9XG5cblx0XHQvLyBUT0RPIHNob3VsZCB0aGlzIGJlIHJlYWNoYWJsZT9cblx0XHRjb25zdWx0ZWROb2Rlcy5hZGQoY3VycmVudCk7XG5cdFx0cmV0dXJuIFwiXCI7XG5cdH1cblxuXHRyZXR1cm4gYXNGbGF0U3RyaW5nKFxuXHRcdGNvbXB1dGVUZXh0QWx0ZXJuYXRpdmUocm9vdCwge1xuXHRcdFx0aXNFbWJlZGRlZEluTGFiZWw6IGZhbHNlLFxuXHRcdFx0Ly8gYnkgc3BlYyBjb21wdXRlQWNjZXNzaWJsZURlc2NyaXB0aW9uIHN0YXJ0cyB3aXRoIHRoZSByZWZlcmVuY2VkIGVsZW1lbnRzIGFzIHJvb3RzXG5cdFx0XHRpc1JlZmVyZW5jZWQ6IGNvbXB1dGUgPT09IFwiZGVzY3JpcHRpb25cIixcblx0XHRcdHJlY3Vyc2lvbjogZmFsc2UsXG5cdFx0fSlcblx0KTtcbn1cbiJdfQ==