3bbc06ece6498d75293ecb26b55b741c
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.checkReactElement = checkReactElement;
exports.getType = getType;
exports.getMessage = getMessage;
exports.matches = matches;
exports.normalize = normalize;
exports.printElement = printElement;
exports.ReactElementTypeError = void 0;

var _construct2 = _interopRequireDefault(require("@babel/runtime/helpers/construct"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _wrapNativeSuper2 = _interopRequireDefault(require("@babel/runtime/helpers/wrapNativeSuper"));

var _redent = _interopRequireDefault(require("redent"));

var _jestMatcherUtils = require("jest-matcher-utils");

var _prettyFormat = _interopRequireDefault(require("pretty-format"));

function _createSuper(Derived) {
  var hasNativeReflectConstruct = _isNativeReflectConstruct();

  return function _createSuperInternal() {
    var Super = (0, _getPrototypeOf2.default)(Derived),
        result;

    if (hasNativeReflectConstruct) {
      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;
      result = Reflect.construct(Super, arguments, NewTarget);
    } else {
      result = Super.apply(this, arguments);
    }

    return (0, _possibleConstructorReturn2.default)(this, result);
  };
}

function _isNativeReflectConstruct() {
  if (typeof Reflect === "undefined" || !Reflect.construct) return false;
  if (Reflect.construct.sham) return false;
  if (typeof Proxy === "function") return true;

  try {
    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));
    return true;
  } catch (e) {
    return false;
  }
}

var _prettyFormat$plugins = _prettyFormat.default.plugins,
    ReactTestComponent = _prettyFormat$plugins.ReactTestComponent,
    ReactElement = _prettyFormat$plugins.ReactElement;
var VALID_ELEMENTS = ['Image', 'Text', 'TextInput', 'Modal', 'View', 'RefreshControl', 'ScrollView', 'ActivityIndicator', 'ListView', 'ListViewDataSource'];

var ReactElementTypeError = function (_Error) {
  (0, _inherits2.default)(ReactElementTypeError, _Error);

  var _super = _createSuper(ReactElementTypeError);

  function ReactElementTypeError(received, matcherFn, context) {
    var _this;

    (0, _classCallCheck2.default)(this, ReactElementTypeError);
    _this = _super.call(this);

    if (Error.captureStackTrace) {
      Error.captureStackTrace((0, _assertThisInitialized2.default)(_this), matcherFn);
    }

    var withType = '';

    try {
      withType = (0, _jestMatcherUtils.printWithType)('Received', received, _jestMatcherUtils.printReceived);
    } catch (e) {}

    _this.message = [(0, _jestMatcherUtils.matcherHint)((context.isNot ? '.not' : '') + "." + matcherFn.name, 'received', ''), '', (0, _jestMatcherUtils.RECEIVED_COLOR)('received') + " value must be an React Element.", withType].join('\n');
    return _this;
  }

  return ReactElementTypeError;
}((0, _wrapNativeSuper2.default)(Error));

exports.ReactElementTypeError = ReactElementTypeError;

function checkReactElement(element) {
  if (!VALID_ELEMENTS.includes(element.type) && !element._fiber) {
    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    throw (0, _construct2.default)(ReactElementTypeError, [element].concat(args));
  }
}

function getType(_ref) {
  var type = _ref.type;
  return type.displayName || type.name || type;
}

function printElement(_ref2) {
  var props = _ref2.props;
  return "  " + (0, _prettyFormat.default)({
    props: props
  }, {
    plugins: [ReactTestComponent, ReactElement],
    printFunctionName: false,
    highlight: true
  });
}

function display(value) {
  return typeof value === 'string' ? value : (0, _jestMatcherUtils.stringify)(value);
}

function getMessage(matcher, expectedLabel, expectedValue, receivedLabel, receivedValue) {
  return [matcher + "\n", expectedLabel + ":\n" + (0, _jestMatcherUtils.EXPECTED_COLOR)((0, _redent.default)(display(expectedValue), 2)), receivedLabel + ":\n" + (0, _jestMatcherUtils.RECEIVED_COLOR)((0, _redent.default)(display(receivedValue), 2))].join('\n');
}

function matches(textToMatch, matcher) {
  if (matcher instanceof RegExp) {
    return matcher.test(textToMatch);
  } else {
    return textToMatch.includes(String(matcher));
  }
}

function normalize(text) {
  return text.replace(/\s+/g, ' ').trim();
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIl0sIm5hbWVzIjpbIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJjaGVja1JlYWN0RWxlbWVudCIsImdldFR5cGUiLCJnZXRNZXNzYWdlIiwibWF0Y2hlcyIsIm5vcm1hbGl6ZSIsInByaW50RWxlbWVudCIsIlJlYWN0RWxlbWVudFR5cGVFcnJvciIsIl9jb25zdHJ1Y3QyIiwiX2NsYXNzQ2FsbENoZWNrMiIsIl9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyIiwiX2luaGVyaXRzMiIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuMiIsIl9nZXRQcm90b3R5cGVPZjIiLCJfd3JhcE5hdGl2ZVN1cGVyMiIsIl9yZWRlbnQiLCJfamVzdE1hdGNoZXJVdGlscyIsIl9wcmV0dHlGb3JtYXQiLCJfY3JlYXRlU3VwZXIiLCJEZXJpdmVkIiwiaGFzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCIsIl9pc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QiLCJfY3JlYXRlU3VwZXJJbnRlcm5hbCIsIlN1cGVyIiwiZGVmYXVsdCIsInJlc3VsdCIsIk5ld1RhcmdldCIsImNvbnN0cnVjdG9yIiwiUmVmbGVjdCIsImNvbnN0cnVjdCIsImFyZ3VtZW50cyIsImFwcGx5Iiwic2hhbSIsIlByb3h5IiwiQm9vbGVhbiIsInByb3RvdHlwZSIsInZhbHVlT2YiLCJjYWxsIiwiZSIsIl9wcmV0dHlGb3JtYXQkcGx1Z2lucyIsInBsdWdpbnMiLCJSZWFjdFRlc3RDb21wb25lbnQiLCJSZWFjdEVsZW1lbnQiLCJWQUxJRF9FTEVNRU5UUyIsIl9FcnJvciIsIl9zdXBlciIsInJlY2VpdmVkIiwibWF0Y2hlckZuIiwiY29udGV4dCIsIl90aGlzIiwiRXJyb3IiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIndpdGhUeXBlIiwicHJpbnRXaXRoVHlwZSIsInByaW50UmVjZWl2ZWQiLCJtZXNzYWdlIiwibWF0Y2hlckhpbnQiLCJpc05vdCIsIm5hbWUiLCJSRUNFSVZFRF9DT0xPUiIsImpvaW4iLCJlbGVtZW50IiwiaW5jbHVkZXMiLCJ0eXBlIiwiX2ZpYmVyIiwiX2xlbiIsImxlbmd0aCIsImFyZ3MiLCJBcnJheSIsIl9rZXkiLCJjb25jYXQiLCJfcmVmIiwiZGlzcGxheU5hbWUiLCJfcmVmMiIsInByb3BzIiwicHJpbnRGdW5jdGlvbk5hbWUiLCJoaWdobGlnaHQiLCJkaXNwbGF5Iiwic3RyaW5naWZ5IiwibWF0Y2hlciIsImV4cGVjdGVkTGFiZWwiLCJleHBlY3RlZFZhbHVlIiwicmVjZWl2ZWRMYWJlbCIsInJlY2VpdmVkVmFsdWUiLCJFWFBFQ1RFRF9DT0xPUiIsInRleHRUb01hdGNoIiwiUmVnRXhwIiwidGVzdCIsIlN0cmluZyIsInRleHQiLCJyZXBsYWNlIiwidHJpbSJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsc0JBQXNCLEdBQUdDLE9BQU8sQ0FBQyw4Q0FBRCxDQUFwQzs7QUFFQUMsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztBQUMzQ0MsRUFBQUEsS0FBSyxFQUFFO0FBRG9DLENBQTdDO0FBR0FELE9BQU8sQ0FBQ0UsaUJBQVIsR0FBNEJBLGlCQUE1QjtBQUNBRixPQUFPLENBQUNHLE9BQVIsR0FBa0JBLE9BQWxCO0FBQ0FILE9BQU8sQ0FBQ0ksVUFBUixHQUFxQkEsVUFBckI7QUFDQUosT0FBTyxDQUFDSyxPQUFSLEdBQWtCQSxPQUFsQjtBQUNBTCxPQUFPLENBQUNNLFNBQVIsR0FBb0JBLFNBQXBCO0FBQ0FOLE9BQU8sQ0FBQ08sWUFBUixHQUF1QkEsWUFBdkI7QUFDQVAsT0FBTyxDQUFDUSxxQkFBUixHQUFnQyxLQUFLLENBQXJDOztBQUVBLElBQUlDLFdBQVcsR0FBR2Isc0JBQXNCLENBQUNDLE9BQU8sQ0FBQyxrQ0FBRCxDQUFSLENBQXhDOztBQUVBLElBQUlhLGdCQUFnQixHQUFHZCxzQkFBc0IsQ0FBQ0MsT0FBTyxDQUFDLHVDQUFELENB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SUFBdFAsQ0FBUDtBQUNEOztBQUVELFNBQVN4RCxPQUFULENBQWlCaUYsV0FBakIsRUFBOEJOLE9BQTlCLEVBQXVDO0FBQ3JDLE1BQUlBLE9BQU8sWUFBWU8sTUFBdkIsRUFBK0I7QUFDN0IsV0FBT1AsT0FBTyxDQUFDUSxJQUFSLENBQWFGLFdBQWIsQ0FBUDtBQUNELEdBRkQsTUFFTztBQUNMLFdBQU9BLFdBQVcsQ0FBQ3ZCLFFBQVosQ0FBcUIwQixNQUFNLENBQUNULE9BQUQsQ0FBM0IsQ0FBUDtBQUNEO0FBQ0Y7O0FBRUQsU0FBUzFFLFNBQVQsQ0FBbUJvRixJQUFuQixFQUF5QjtBQUN2QixTQUFPQSxJQUFJLENBQUNDLE9BQUwsQ0FBYSxNQUFiLEVBQXFCLEdBQXJCLEVBQTBCQyxJQUExQixFQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgX2ludGVyb3BSZXF1aXJlRGVmYXVsdCA9IHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdFwiKTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuY2hlY2tSZWFjdEVsZW1lbnQgPSBjaGVja1JlYWN0RWxlbWVudDtcbmV4cG9ydHMuZ2V0VHlwZSA9IGdldFR5cGU7XG5leHBvcnRzLmdldE1lc3NhZ2UgPSBnZXRNZXNzYWdlO1xuZXhwb3J0cy5tYXRjaGVzID0gbWF0Y2hlcztcbmV4cG9ydHMubm9ybWFsaXplID0gbm9ybWFsaXplO1xuZXhwb3J0cy5wcmludEVsZW1lbnQgPSBwcmludEVsZW1lbnQ7XG5leHBvcnRzLlJlYWN0RWxlbWVudFR5cGVFcnJvciA9IHZvaWQgMDtcblxudmFyIF9jb25zdHJ1Y3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jb25zdHJ1Y3RcIikpO1xuXG52YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvY2xhc3NDYWxsQ2hlY2tcIikpO1xuXG52YXIgX2Fzc2VydFRoaXNJbml0aWFsaXplZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2Fzc2VydFRoaXNJbml0aWFsaXplZFwiKSk7XG5cbnZhciBfaW5oZXJpdHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbmhlcml0c1wiKSk7XG5cbnZhciBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm5cIikpO1xuXG52YXIgX2dldFByb3RvdHlwZU9mMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIkBiYWJlbC9ydW50aW1lL2hlbHBlcnMvZ2V0UHJvdG90eXBlT2ZcIikpO1xuXG52YXIgX3dyYXBOYXRpdmVTdXBlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL3dyYXBOYXRpdmVTdXBlclwiKSk7XG5cbnZhciBfcmVkZW50ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwicmVkZW50XCIpKTtcblxudmFyIF9qZXN0TWF0Y2hlclV0aWxzID0gcmVxdWlyZShcImplc3QtbWF0Y2hlci11dGlsc1wiKTtcblxudmFyIF9wcmV0dHlGb3JtYXQgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJwcmV0dHktZm9ybWF0XCIpKTtcblxuZnVuY3Rpb24gX2NyZWF0ZVN1cGVyKERlcml2ZWQpIHsgdmFyIGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QgPSBfaXNOYXRpdmVSZWZsZWN0Q29uc3RydWN0KCk7IHJldHVybiBmdW5jdGlvbiBfY3JlYXRlU3VwZXJJbnRlcm5hbCgpIHsgdmFyIFN1cGVyID0gKDAsIF9nZXRQcm90b3R5cGVPZjIuZGVmYXVsdCkoRGVyaXZlZCksIHJlc3VsdDsgaWYgKGhhc05hdGl2ZVJlZmxlY3RDb25zdHJ1Y3QpIHsgdmFyIE5ld1RhcmdldCA9ICgwLCBfZ2V0UHJvdG90eXBlT2YyLmRlZmF1bHQpKHRoaXMpLmNvbnN0cnVjdG9yOyByZXN1bHQgPSBSZWZsZWN0LmNvbnN0cnVjdChTdXBlciwgYXJndW1lbnRzLCBOZXdUYXJnZXQpOyB9IGVsc2UgeyByZXN1bHQgPSBTdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB9IHJldHVybiAoMCwgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4yLmRlZmF1bHQpKHRoaXMsIHJlc3VsdCk7IH07IH1cblxuZnVuY3Rpb24gX2lzTmF0aXZlUmVmbGVjdENvbnN0cnVjdCgpIHsgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcInVuZGVmaW5lZFwiIHx8ICFSZWZsZWN0LmNvbnN0cnVjdCkgcmV0dXJuIGZhbHNlOyBpZiAoUmVmbGVjdC5jb25zdHJ1Y3Quc2hhbSkgcmV0dXJuIGZhbHNlOyBpZiAodHlwZW9mIFByb3h5ID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiB0cnVlOyB0cnkgeyBCb29sZWFuLnByb3RvdHlwZS52YWx1ZU9mLmNhbGwoUmVmbGVjdC5jb25zdHJ1Y3QoQm9vbGVhbiwgW10sIGZ1bmN0aW9uICgpIHt9KSk7IHJldHVybiB0cnVlOyB9IGNhdGNoIChlKSB7IHJldHVybiBmYWxzZTsgfSB9XG5cbnZhciBfcHJldHR5Rm9ybWF0JHBsdWdpbnMgPSBfcHJldHR5Rm9ybWF0LmRlZmF1bHQucGx1Z2lucyxcbiAgICBSZWFjdFRlc3RDb21wb25lbnQgPSBfcHJldHR5Rm9ybWF0JHBsdWdpbnMuUmVhY3RUZXN0Q29tcG9uZW50LFxuICAgIFJlYWN0RWxlbWVudCA9IF9wcmV0dHlGb3JtYXQkcGx1Z2lucy5SZWFjdEVsZW1lbnQ7XG52YXIgVkFMSURfRUxFTUVOVFMgPSBbJ0ltYWdlJywgJ1RleHQnLCAnVGV4dElucHV0JywgJ01vZGFsJywgJ1ZpZXcnLCAnUmVmcmVzaENvbnRyb2wnLCAnU2Nyb2xsVmlldycsICdBY3Rpdml0eUluZGljYXRvcicsICdMaXN0VmlldycsICdMaXN0Vmlld0RhdGFTb3VyY2UnXTtcblxudmFyIFJlYWN0RWxlbWVudFR5cGVFcnJvciA9IGZ1bmN0aW9uIChfRXJyb3IpIHtcbiAgKDAsIF9pbmhlcml0czIuZGVmYXVsdCkoUmVhY3RFbGVtZW50VHlwZUVycm9yLCBfRXJyb3IpO1xuXG4gIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoUmVhY3RFbGVtZW50VHlwZUVycm9yKTtcblxuICBmdW5jdGlvbiBSZWFjdEVsZW1lbnRUeXBlRXJyb3IocmVjZWl2ZWQsIG1hdGNoZXJGbiwgY29udGV4dCkge1xuICAgIHZhciBfdGhpcztcblxuICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIFJlYWN0RWxlbWVudFR5cGVFcnJvcik7XG4gICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKTtcblxuICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UoKDAsIF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQyLmRlZmF1bHQpKF90aGlzKSwgbWF0Y2hlckZuKTtcbiAgICB9XG5cbiAgICB2YXIgd2l0aFR5cGUgPSAnJztcblxuICAgIHRyeSB7XG4gICAgICB3aXRoVHlwZSA9ICgwLCBfamVzdE1hdGNoZXJVdGlscy5wcmludFdpdGhUeXBlKSgnUmVjZWl2ZWQnLCByZWNlaXZlZCwgX2plc3RNYXRjaGVyVXRpbHMucHJpbnRSZWNlaXZlZCk7XG4gICAgfSBjYXRjaCAoZSkge31cblxuICAgIF90aGlzLm1lc3NhZ2UgPSBbKDAsIF9qZXN0TWF0Y2hlclV0aWxzLm1hdGNoZXJIaW50KSgoY29udGV4dC5pc05vdCA/ICcubm90JyA6ICcnKSArIFwiLlwiICsgbWF0Y2hlckZuLm5hbWUsICdyZWNlaXZlZCcsICcnKSwgJycsICgwLCBfamVzdE1hdGNoZXJVdGlscy5SRUNFSVZFRF9DT0xPUikoJ3JlY2VpdmVkJykgKyBcIiB2YWx1ZSBtdXN0IGJlIGFuIFJlYWN0IEVsZW1lbnQuXCIsIHdpdGhUeXBlXS5qb2luKCdcXG4nKTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICByZXR1cm4gUmVhY3RFbGVtZW50VHlwZUVycm9yO1xufSgoMCwgX3dyYXBOYXRpdmVTdXBlcjIuZGVmYXVsdCkoRXJyb3IpKTtcblxuZXhwb3J0cy5SZWFjdEVsZW1lbnRUeXBlRXJyb3IgPSBSZWFjdEVsZW1lbnRUeXBlRXJyb3I7XG5cbmZ1bmN0aW9uIGNoZWNrUmVhY3RFbGVtZW50KGVsZW1lbnQpIHtcbiAgaWYgKCFWQUxJRF9FTEVNRU5UUy5pbmNsdWRlcyhlbGVtZW50LnR5cGUpICYmICFlbGVtZW50Ll9maWJlcikge1xuICAgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcbiAgICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuICAgIH1cblxuICAgIHRocm93ICgwLCBfY29uc3RydWN0Mi5kZWZhdWx0KShSZWFjdEVsZW1lbnRUeXBlRXJyb3IsIFtlbGVtZW50XS5jb25jYXQoYXJncykpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldFR5cGUoX3JlZikge1xuICB2YXIgdHlwZSA9IF9yZWYudHlwZTtcbiAgcmV0dXJuIHR5cGUuZGlzcGxheU5hbWUgfHwgdHlwZS5uYW1lIHx8IHR5cGU7XG59XG5cbmZ1bmN0aW9uIHByaW50RWxlbWVudChfcmVmMikge1xuICB2YXIgcHJvcHMgPSBfcmVmMi5wcm9wcztcbiAgcmV0dXJuIFwiICBcIiArICgwLCBfcHJldHR5Rm9ybWF0LmRlZmF1bHQpKHtcbiAgICBwcm9wczogcHJvcHNcbiAgfSwge1xuICAgIHBsdWdpbnM6IFtSZWFjdFRlc3RDb21wb25lbnQsIFJlYWN0RWxlbWVudF0sXG4gICAgcHJpbnRGdW5jdGlvbk5hbWU6IGZhbHNlLFxuICAgIGhpZ2hsaWdodDogdHJ1ZVxuICB9KTtcbn1cblxuZnVuY3Rpb24gZGlzcGxheSh2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogKDAsIF9qZXN0TWF0Y2hlclV0aWxzLnN0cmluZ2lmeSkodmFsdWUpO1xufVxuXG5mdW5jdGlvbiBnZXRNZXNzYWdlKG1hdGNoZXIsIGV4cGVjdGVkTGFiZWwsIGV4cGVjdGVkVmFsdWUsIHJlY2VpdmVkTGFiZWwsIHJlY2VpdmVkVmFsdWUpIHtcbiAgcmV0dXJuIFttYXRjaGVyICsgXCJcXG5cIiwgZXhwZWN0ZWRMYWJlbCArIFwiOlxcblwiICsgKDAsIF9qZXN0TWF0Y2hlclV0aWxzLkVYUEVDVEVEX0NPTE9SKSgoMCwgX3JlZGVudC5kZWZhdWx0KShkaXNwbGF5KGV4cGVjdGVkVmFsdWUpLCAyKSksIHJlY2VpdmVkTGFiZWwgKyBcIjpcXG5cIiArICgwLCBfamVzdE1hdGNoZXJVdGlscy5SRUNFSVZFRF9DT0xPUikoKDAsIF9yZWRlbnQuZGVmYXVsdCkoZGlzcGxheShyZWNlaXZlZFZhbHVlKSwgMikpXS5qb2luKCdcXG4nKTtcbn1cblxuZnVuY3Rpb24gbWF0Y2hlcyh0ZXh0VG9NYXRjaCwgbWF0Y2hlcikge1xuICBpZiAobWF0Y2hlciBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgIHJldHVybiBtYXRjaGVyLnRlc3QodGV4dFRvTWF0Y2gpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB0ZXh0VG9NYXRjaC5pbmNsdWRlcyhTdHJpbmcobWF0Y2hlcikpO1xuICB9XG59XG5cbmZ1bmN0aW9uIG5vcm1hbGl6ZSh0ZXh0KSB7XG4gIHJldHVybiB0ZXh0LnJlcGxhY2UoL1xccysvZywgJyAnKS50cmltKCk7XG59Il19