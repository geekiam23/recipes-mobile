5d19d8ab428cf5cfd55601d816bcecb4
'use strict';

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = exports.test = exports.serialize = void 0;

var ReactIs = _interopRequireWildcard(require('react-is'));

var _markup = require("./lib/markup");

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};

    if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key)) {
          var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};

          if (desc.get || desc.set) {
            Object.defineProperty(newObj, key, desc);
          } else {
            newObj[key] = obj[key];
          }
        }
      }
    }

    newObj.default = obj;
    return newObj;
  }
}

var getChildren = function getChildren(arg) {
  var children = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

  if (Array.isArray(arg)) {
    arg.forEach(function (item) {
      getChildren(item, children);
    });
  } else if (arg != null && arg !== false) {
    children.push(arg);
  }

  return children;
};

var getType = function getType(element) {
  var type = element.type;

  if (typeof type === 'string') {
    return type;
  }

  if (typeof type === 'function') {
    return type.displayName || type.name || 'Unknown';
  }

  if (ReactIs.isFragment(element)) {
    return 'React.Fragment';
  }

  if (ReactIs.isSuspense(element)) {
    return 'React.Suspense';
  }

  if (typeof type === 'object' && type !== null) {
    if (ReactIs.isContextProvider(element)) {
      return 'Context.Provider';
    }

    if (ReactIs.isContextConsumer(element)) {
      return 'Context.Consumer';
    }

    if (ReactIs.isForwardRef(element)) {
      var functionName = type.render.displayName || type.render.name || '';
      return functionName !== '' ? 'ForwardRef(' + functionName + ')' : 'ForwardRef';
    }

    if (ReactIs.isMemo(type)) {
      var _functionName = type.displayName || type.type.displayName || type.type.name || '';

      return _functionName !== '' ? 'Memo(' + _functionName + ')' : 'Memo';
    }
  }

  return 'UNDEFINED';
};

var getPropKeys = function getPropKeys(element) {
  var props = element.props;
  return Object.keys(props).filter(function (key) {
    return key !== 'children' && props[key] !== undefined;
  }).sort();
};

var serialize = function serialize(element, config, indentation, depth, refs, printer) {
  return ++depth > config.maxDepth ? (0, _markup.printElementAsLeaf)(getType(element), config) : (0, _markup.printElement)(getType(element), (0, _markup.printProps)(getPropKeys(element), element.props, config, indentation + config.indent, depth, refs, printer), (0, _markup.printChildren)(getChildren(element.props.children), config, indentation + config.indent, depth, refs, printer), config, indentation);
};

exports.serialize = serialize;

var test = function test(val) {
  return val && ReactIs.isElement(val);
};

exports.test = test;
var plugin = {
  serialize: serialize,
  test: test
};
var _default = plugin;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlJlYWN0RWxlbWVudC5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImRlZmF1bHQiLCJ0ZXN0Iiwic2VyaWFsaXplIiwiUmVhY3RJcyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwicmVxdWlyZSIsIl9tYXJrdXAiLCJvYmoiLCJfX2VzTW9kdWxlIiwibmV3T2JqIiwia2V5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZGVzYyIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImdldCIsInNldCIsImdldENoaWxkcmVuIiwiYXJnIiwiY2hpbGRyZW4iLCJBcnJheSIsImlzQXJyYXkiLCJmb3JFYWNoIiwiaXRlbSIsInB1c2giLCJnZXRUeXBlIiwiZWxlbWVudCIsInR5cGUiLCJkaXNwbGF5TmFtZSIsIm5hbWUiLCJpc0ZyYWdtZW50IiwiaXNTdXNwZW5zZSIsImlzQ29udGV4dFByb3ZpZGVyIiwiaXNDb250ZXh0Q29uc3VtZXIiLCJpc0ZvcndhcmRSZWYiLCJmdW5jdGlvbk5hbWUiLCJyZW5kZXIiLCJpc01lbW8iLCJnZXRQcm9wS2V5cyIsInByb3BzIiwia2V5cyIsImZpbHRlciIsInVuZGVmaW5lZCIsInNvcnQiLCJjb25maWciLCJpbmRlbnRhdGlvbiIsImRlcHRoIiwicmVmcyIsInByaW50ZXIiLCJtYXhEZXB0aCIsInByaW50RWxlbWVudEFzTGVhZiIsInByaW50RWxlbWVudCIsInByaW50UHJvcHMiLCJpbmRlbnQiLCJwcmludENoaWxkcmVuIiwidmFsIiwiaXNFbGVtZW50IiwicGx1Z2luIiwiX2RlZmF1bHQiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQzNDQyxFQUFBQSxLQUFLLEVBQUU7QUFEb0MsQ0FBN0M7QUFHQUQsT0FBTyxDQUFDRSxPQUFSLEdBQWtCRixPQUFP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RCxRQUFRLEdBQUdELE1BQWY7QUFDQTVELE9BQU8sQ0FBQ0UsT0FBUixHQUFrQjJELFFBQWxCIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuZGVmYXVsdCA9IGV4cG9ydHMudGVzdCA9IGV4cG9ydHMuc2VyaWFsaXplID0gdm9pZCAwO1xuXG52YXIgUmVhY3RJcyA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoJ3JlYWN0LWlzJykpO1xuXG52YXIgX21hcmt1cCA9IHJlcXVpcmUoJy4vbGliL21hcmt1cCcpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHtcbiAgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkge1xuICAgIHJldHVybiBvYmo7XG4gIH0gZWxzZSB7XG4gICAgdmFyIG5ld09iaiA9IHt9O1xuICAgIGlmIChvYmogIT0gbnVsbCkge1xuICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xuICAgICAgICAgIHZhciBkZXNjID1cbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSAmJiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yXG4gICAgICAgICAgICAgID8gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmosIGtleSlcbiAgICAgICAgICAgICAgOiB7fTtcbiAgICAgICAgICBpZiAoZGVzYy5nZXQgfHwgZGVzYy5zZXQpIHtcbiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZXdPYmosIGtleSwgZGVzYyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIG5ld09iai5kZWZhdWx0ID0gb2JqO1xuICAgIHJldHVybiBuZXdPYmo7XG4gIH1cbn1cblxuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuLy8gR2l2ZW4gZWxlbWVudC5wcm9wcy5jaGlsZHJlbiwgb3Igc3VidHJlZSBkdXJpbmcgcmVjdXJzaXZlIHRyYXZlcnNhbCxcbi8vIHJldHVybiBmbGF0dGVuZWQgYXJyYXkgb2YgY2hpbGRyZW4uXG5jb25zdCBnZXRDaGlsZHJlbiA9IChhcmcsIGNoaWxkcmVuID0gW10pID0+IHtcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJnKSkge1xuICAgIGFyZy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgZ2V0Q2hpbGRyZW4oaXRlbSwgY2hpbGRyZW4pO1xuICAgIH0pO1xuICB9IGVsc2UgaWYgKGFyZyAhPSBudWxsICYmIGFyZyAhPT0gZmFsc2UpIHtcbiAgICBjaGlsZHJlbi5wdXNoKGFyZyk7XG4gIH1cblxuICByZXR1cm4gY2hpbGRyZW47XG59O1xuXG5jb25zdCBnZXRUeXBlID0gZWxlbWVudCA9PiB7XG4gIGNvbnN0IHR5cGUgPSBlbGVtZW50LnR5cGU7XG5cbiAgaWYgKHR5cGVvZiB0eXBlID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiB0eXBlO1xuICB9XG5cbiAgaWYgKHR5cGVvZiB0eXBlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgcmV0dXJuIHR5cGUuZGlzcGxheU5hbWUgfHwgdHlwZS5uYW1lIHx8ICdVbmtub3duJztcbiAgfVxuXG4gIGlmIChSZWFjdElzLmlzRnJhZ21lbnQoZWxlbWVudCkpIHtcbiAgICByZXR1cm4gJ1JlYWN0LkZyYWdtZW50JztcbiAgfVxuXG4gIGlmIChSZWFjdElzLmlzU3VzcGVuc2UoZWxlbWVudCkpIHtcbiAgICByZXR1cm4gJ1JlYWN0LlN1c3BlbnNlJztcbiAgfVxuXG4gIGlmICh0eXBlb2YgdHlwZSA9PT0gJ29iamVjdCcgJiYgdHlwZSAhPT0gbnVsbCkge1xuICAgIGlmIChSZWFjdElzLmlzQ29udGV4dFByb3ZpZGVyKGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm4gJ0NvbnRleHQuUHJvdmlkZXInO1xuICAgIH1cblxuICAgIGlmIChSZWFjdElzLmlzQ29udGV4dENvbnN1bWVyKGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm4gJ0NvbnRleHQuQ29uc3VtZXInO1xuICAgIH1cblxuICAgIGlmIChSZWFjdElzLmlzRm9yd2FyZFJlZihlbGVtZW50KSkge1xuICAgICAgY29uc3QgZnVuY3Rpb25OYW1lID0gdHlwZS5yZW5kZXIuZGlzcGxheU5hbWUgfHwgdHlwZS5yZW5kZXIubmFtZSB8fCAnJztcbiAgICAgIHJldHVybiBmdW5jdGlvbk5hbWUgIT09ICcnXG4gICAgICAgID8gJ0ZvcndhcmRSZWYoJyArIGZ1bmN0aW9uTmFtZSArICcpJ1xuICAgICAgICA6ICdGb3J3YXJkUmVmJztcbiAgICB9XG5cbiAgICBpZiAoUmVhY3RJcy5pc01lbW8odHlwZSkpIHtcbiAgICAgIGNvbnN0IGZ1bmN0aW9uTmFtZSA9XG4gICAgICAgIHR5cGUuZGlzcGxheU5hbWUgfHwgdHlwZS50eXBlLmRpc3BsYXlOYW1lIHx8IHR5cGUudHlwZS5uYW1lIHx8ICcnO1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uTmFtZSAhPT0gJycgPyAnTWVtbygnICsgZnVuY3Rpb25OYW1lICsgJyknIDogJ01lbW8nO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiAnVU5ERUZJTkVEJztcbn07XG5cbmNvbnN0IGdldFByb3BLZXlzID0gZWxlbWVudCA9PiB7XG4gIGNvbnN0IHByb3BzID0gZWxlbWVudC5wcm9wcztcbiAgcmV0dXJuIE9iamVjdC5rZXlzKHByb3BzKVxuICAgIC5maWx0ZXIoa2V5ID0+IGtleSAhPT0gJ2NoaWxkcmVuJyAmJiBwcm9wc1trZXldICE9PSB1bmRlZmluZWQpXG4gICAgLnNvcnQoKTtcbn07XG5cbmNvbnN0IHNlcmlhbGl6ZSA9IChlbGVtZW50LCBjb25maWcsIGluZGVudGF0aW9uLCBkZXB0aCwgcmVmcywgcHJpbnRlcikgPT5cbiAgKytkZXB0aCA+IGNvbmZpZy5tYXhEZXB0aFxuICAgID8gKDAsIF9tYXJrdXAucHJpbnRFbGVtZW50QXNMZWFmKShnZXRUeXBlKGVsZW1lbnQpLCBjb25maWcpXG4gICAgOiAoMCwgX21hcmt1cC5wcmludEVsZW1lbnQpKFxuICAgICAgICBnZXRUeXBlKGVsZW1lbnQpLFxuICAgICAgICAoMCwgX21hcmt1cC5wcmludFByb3BzKShcbiAgICAgICAgICBnZXRQcm9wS2V5cyhlbGVtZW50KSxcbiAgICAgICAgICBlbGVtZW50LnByb3BzLFxuICAgICAgICAgIGNvbmZpZyxcbiAgICAgICAgICBpbmRlbnRhdGlvbiArIGNvbmZpZy5pbmRlbnQsXG4gICAgICAgICAgZGVwdGgsXG4gICAgICAgICAgcmVmcyxcbiAgICAgICAgICBwcmludGVyXG4gICAgICAgICksXG4gICAgICAgICgwLCBfbWFya3VwLnByaW50Q2hpbGRyZW4pKFxuICAgICAgICAgIGdldENoaWxkcmVuKGVsZW1lbnQucHJvcHMuY2hpbGRyZW4pLFxuICAgICAgICAgIGNvbmZpZyxcbiAgICAgICAgICBpbmRlbnRhdGlvbiArIGNvbmZpZy5pbmRlbnQsXG4gICAgICAgICAgZGVwdGgsXG4gICAgICAgICAgcmVmcyxcbiAgICAgICAgICBwcmludGVyXG4gICAgICAgICksXG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgaW5kZW50YXRpb25cbiAgICAgICk7XG5cbmV4cG9ydHMuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuXG5jb25zdCB0ZXN0ID0gdmFsID0+IHZhbCAmJiBSZWFjdElzLmlzRWxlbWVudCh2YWwpO1xuXG5leHBvcnRzLnRlc3QgPSB0ZXN0O1xuY29uc3QgcGx1Z2luID0ge1xuICBzZXJpYWxpemUsXG4gIHRlc3Rcbn07XG52YXIgX2RlZmF1bHQgPSBwbHVnaW47XG5leHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDtcbiJdfQ==