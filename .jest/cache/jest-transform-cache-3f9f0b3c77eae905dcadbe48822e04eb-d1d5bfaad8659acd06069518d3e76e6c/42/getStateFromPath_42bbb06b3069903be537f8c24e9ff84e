e91eb9616c4ef6146057cbb2dc1b0e9c
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _defineProperty2 = _interopRequireDefault2(require("@babel/runtime/helpers/defineProperty"));

var _extends4 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

var _toConsumableArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/toConsumableArray"));

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getStateFromPath;

var _escapeStringRegexp = _interopRequireDefault(require("escape-string-regexp"));

var queryString = _interopRequireWildcard(require("query-string"));

var _checkLegacyPathConfig = _interopRequireDefault(require("./checkLegacyPathConfig"));

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function getStateFromPath(path, options) {
  var _ref3;

  var _ref = (0, _checkLegacyPathConfig.default)(options),
      _ref2 = (0, _slicedToArray2.default)(_ref, 2),
      legacy = _ref2[0],
      compatOptions = _ref2[1];

  var initialRoutes = [];

  if (compatOptions !== null && compatOptions !== void 0 && compatOptions.initialRouteName) {
    initialRoutes.push({
      initialRouteName: compatOptions.initialRouteName,
      parentScreens: []
    });
  }

  var screens = compatOptions === null || compatOptions === void 0 ? void 0 : compatOptions.screens;
  var remaining = path.replace(/\/+/g, '/').replace(/^\//, '').replace(/\?.*$/, '');
  remaining = remaining.endsWith('/') ? remaining : "".concat(remaining, "/");

  if (screens === undefined) {
    var routes = remaining.split('/').filter(Boolean).map(function (segment, i, self) {
      var name = decodeURIComponent(segment);

      if (i === self.length - 1) {
        return {
          name: name,
          params: parseQueryParams(path)
        };
      }

      return {
        name: name
      };
    });

    if (routes.length) {
      return createNestedStateObject(routes, initialRoutes);
    }

    return undefined;
  }

  var configs = (_ref3 = []).concat.apply(_ref3, (0, _toConsumableArray2.default)(Object.keys(screens).map(function (key) {
    return createNormalizedConfigs(legacy, key, screens, [], initialRoutes, []);
  }))).sort(function (a, b) {
    if (a.pattern === b.pattern) {
      return b.routeNames.join('>').localeCompare(a.routeNames.join('>'));
    }

    if (a.pattern.startsWith(b.pattern)) {
      return -1;
    }

    if (b.pattern.startsWith(a.pattern)) {
      return 1;
    }

    var aParts = a.pattern.split('/');
    var bParts = b.pattern.split('/');
    var aWildcardIndex = aParts.indexOf('*');
    var bWildcardIndex = bParts.indexOf('*');

    if (aWildcardIndex === -1 && bWildcardIndex !== -1) {
      return -1;
    }

    if (aWildcardIndex !== -1 && bWildcardIndex === -1) {
      return 1;
    }

    if (aWildcardIndex === bWildcardIndex) {
      return bParts.length - aParts.length;
    }

    return bWildcardIndex - aWildcardIndex;
  });

  configs.reduce(function (acc, config) {
    if (acc[config.pattern]) {
      var a = acc[config.pattern].routeNames;
      var b = config.routeNames;
      var intersects = a.length > b.length ? b.every(function (it, i) {
        return a[i] === it;
      }) : a.every(function (it, i) {
        return b[i] === it;
      });

      if (!intersects) {
        throw new Error("Found conflicting screens with the same pattern. The pattern '".concat(config.pattern, "' resolves to both '").concat(a.join(' > '), "' and '").concat(b.join(' > '), "'. Patterns must be unique and cannot resolve to more than one screen."));
      }
    }

    return (0, _extends4.default)(acc, (0, _defineProperty2.default)({}, config.pattern, config));
  }, {});

  if (remaining === '/') {
    var match = configs.find(function (config) {
      return config.path === '' && config.routeNames.every(function (name) {
        var _configs$find;

        return !((_configs$find = configs.find(function (c) {
          return c.screen === name;
        })) !== null && _configs$find !== void 0 && _configs$find.path);
      });
    });

    if (match) {
      return createNestedStateObject(match.routeNames.map(function (name, i, self) {
        if (i === self.length - 1) {
          return {
            name: name,
            params: parseQueryParams(path, match.parse)
          };
        }

        return {
          name: name
        };
      }), initialRoutes);
    }

    return undefined;
  }

  var result;
  var current;

  if (legacy === false) {
    var _matchAgainstConfigs = matchAgainstConfigs(remaining, configs.map(function (c) {
      return (0, _extends4.default)({}, c, {
        regex: c.regex ? new RegExp(c.regex.source + '$') : undefined
      });
    })),
        _routes = _matchAgainstConfigs.routes,
        remainingPath = _matchAgainstConfigs.remainingPath;

    if (_routes !== undefined) {
      current = createNestedStateObject(_routes, initialRoutes);
      remaining = remainingPath;
      result = current;
    }
  } else {
    while (remaining) {
      var _matchAgainstConfigs2 = matchAgainstConfigs(remaining, configs),
          _routes2 = _matchAgainstConfigs2.routes,
          _remainingPath = _matchAgainstConfigs2.remainingPath;

      remaining = _remainingPath;

      if (_routes2 === undefined) {
        var segments = remaining.split('/');
        _routes2 = [{
          name: decodeURIComponent(segments[0])
        }];
        segments.shift();
        remaining = segments.join('/');
      }

      var state = createNestedStateObject(_routes2, initialRoutes);

      if (current) {
        var _current2;

        while ((_current = current) !== null && _current !== void 0 && _current.routes[current.index || 0].state) {
          var _current;

          current = current.routes[current.index || 0].state;
        }

        current.routes[((_current2 = current) === null || _current2 === void 0 ? void 0 : _current2.index) || 0].state = state;
      } else {
        result = state;
      }

      current = state;
    }
  }

  if (current == null || result == null) {
    return undefined;
  }

  var route = findFocusedRoute(current);
  var params = parseQueryParams(path, findParseConfigForRoute(route.name, configs));

  if (params) {
    route.params = (0, _extends4.default)({}, route.params, params);
  }

  return result;
}

var joinPaths = function joinPaths() {
  var _ref4;

  for (var _len = arguments.length, paths = new Array(_len), _key = 0; _key < _len; _key++) {
    paths[_key] = arguments[_key];
  }

  return (_ref4 = []).concat.apply(_ref4, (0, _toConsumableArray2.default)(paths.map(function (p) {
    return p.split('/');
  }))).filter(Boolean).join('/');
};

var matchAgainstConfigs = function matchAgainstConfigs(remaining, configs) {
  var routes;
  var remainingPath = remaining;

  var _loop = function _loop(config) {
    if (!config.regex) {
      return "continue";
    }

    var match = remainingPath.match(config.regex);

    if (match) {
      var matchedParams = (_config$pattern = config.pattern) === null || _config$pattern === void 0 ? void 0 : _config$pattern.split('/').filter(function (p) {
        return p.startsWith(':');
      }).reduce(function (acc, p, i) {
        return (0, _extends4.default)(acc, (0, _defineProperty2.default)({}, p, match[(i + 1) * 2].replace(/\//, '')));
      }, {});
      routes = config.routeNames.map(function (name) {
        var _config$path;

        var config = configs.find(function (c) {
          return c.screen === name;
        });
        var params = config === null || config === void 0 ? void 0 : (_config$path = config.path) === null || _config$path === void 0 ? void 0 : _config$path.split('/').filter(function (p) {
          return p.startsWith(':');
        }).reduce(function (acc, p) {
          var value = matchedParams[p];

          if (value) {
            var _config$parse;

            var key = p.replace(/^:/, '').replace(/\?$/, '');
            acc[key] = (_config$parse = config.parse) !== null && _config$parse !== void 0 && _config$parse[key] ? config.parse[key](value) : value;
          }

          return acc;
        }, {});

        if (params && Object.keys(params).length) {
          return {
            name: name,
            params: params
          };
        }

        return {
          name: name
        };
      });
      remainingPath = remainingPath.replace(match[1], '');
      return "break";
    }
  };

  for (var _iterator = _createForOfIteratorHelperLoose(configs), _step; !(_step = _iterator()).done;) {
    var config = _step.value;

    var _config$pattern;

    var _ret = _loop(config);

    if (_ret === "continue") continue;
    if (_ret === "break") break;
  }

  return {
    routes: routes,
    remainingPath: remainingPath
  };
};

var createNormalizedConfigs = function createNormalizedConfigs(legacy, screen, routeConfig) {
  var routeNames = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
  var initials = arguments.length > 4 ? arguments[4] : undefined;
  var parentScreens = arguments.length > 5 ? arguments[5] : undefined;
  var parentPattern = arguments.length > 6 ? arguments[6] : undefined;
  var configs = [];
  routeNames.push(screen);
  parentScreens.push(screen);
  var config = routeConfig[screen];

  if (typeof config === 'string') {
    var pattern = parentPattern ? joinPaths(parentPattern, config) : config;
    configs.push(createConfigItem(legacy, screen, routeNames, pattern, config));
  } else if (typeof config === 'object') {
    var _pattern2;

    if (typeof config.path === 'string') {
      if (legacy) {
        _pattern2 = config.exact !== true && parentPattern ? joinPaths(parentPattern, config.path) : config.path;
      } else {
        if (config.exact && config.path === undefined) {
          throw new Error("A 'path' needs to be specified when specifying 'exact: true'. If you don't want this screen in the URL, specify it as empty string, e.g. `path: ''`.");
        }

        _pattern2 = config.exact !== true ? joinPaths(parentPattern || '', config.path || '') : config.path || '';
      }

      configs.push(createConfigItem(legacy, screen, routeNames, _pattern2, config.path, config.parse));
    }

    if (config.screens) {
      if (config.initialRouteName) {
        initials.push({
          initialRouteName: config.initialRouteName,
          parentScreens: parentScreens
        });
      }

      Object.keys(config.screens).forEach(function (nestedConfig) {
        var _pattern;

        var result = createNormalizedConfigs(legacy, nestedConfig, config.screens, routeNames, initials, (0, _toConsumableArray2.default)(parentScreens), (_pattern = _pattern2) !== null && _pattern !== void 0 ? _pattern : parentPattern);
        configs.push.apply(configs, (0, _toConsumableArray2.default)(result));
      });
    }
  }

  routeNames.pop();
  return configs;
};

var createConfigItem = function createConfigItem(legacy, screen, routeNames, pattern, path, parse) {
  pattern = pattern.split('/').filter(Boolean).join('/');
  var regex = pattern ? new RegExp("^(".concat(pattern.split('/').map(function (it) {
    if (legacy && it === '*') {
      throw new Error("Please update your config to the new format to use wildcard pattern ('*'). https://reactnavigation.org/docs/configuring-links/#updating-config");
    }

    if (it.startsWith(':')) {
      return "(([^/]+\\/)".concat(it.endsWith('?') ? '?' : '', ")");
    }

    return "".concat(it === '*' ? '.*' : (0, _escapeStringRegexp.default)(it), "\\/");
  }).join(''), ")")) : undefined;
  return {
    screen: screen,
    regex: regex,
    pattern: pattern,
    path: path,
    routeNames: (0, _toConsumableArray2.default)(routeNames),
    parse: parse
  };
};

var findParseConfigForRoute = function findParseConfigForRoute(routeName, flatConfig) {
  for (var _iterator2 = _createForOfIteratorHelperLoose(flatConfig), _step2; !(_step2 = _iterator2()).done;) {
    var config = _step2.value;

    if (routeName === config.routeNames[config.routeNames.length - 1]) {
      return config.parse;
    }
  }

  return undefined;
};

var findInitialRoute = function findInitialRoute(routeName, parentScreens, initialRoutes) {
  for (var _iterator3 = _createForOfIteratorHelperLoose(initialRoutes), _step3; !(_step3 = _iterator3()).done;) {
    var config = _step3.value;

    if (parentScreens.length === config.parentScreens.length) {
      var sameParents = true;

      for (var i = 0; i < parentScreens.length; i++) {
        if (parentScreens[i].localeCompare(config.parentScreens[i]) !== 0) {
          sameParents = false;
          break;
        }
      }

      if (sameParents) {
        return routeName !== config.initialRouteName ? config.initialRouteName : undefined;
      }
    }
  }

  return undefined;
};

var createStateObject = function createStateObject(initialRoute, route, isEmpty) {
  if (isEmpty) {
    if (initialRoute) {
      return {
        index: 1,
        routes: [{
          name: initialRoute
        }, route]
      };
    } else {
      return {
        routes: [route]
      };
    }
  } else {
    if (initialRoute) {
      return {
        index: 1,
        routes: [{
          name: initialRoute
        }, (0, _extends4.default)({}, route, {
          state: {
            routes: []
          }
        })]
      };
    } else {
      return {
        routes: [(0, _extends4.default)({}, route, {
          state: {
            routes: []
          }
        })]
      };
    }
  }
};

var createNestedStateObject = function createNestedStateObject(routes, initialRoutes) {
  var state;
  var route = routes.shift();
  var parentScreens = [];
  var initialRoute = findInitialRoute(route.name, parentScreens, initialRoutes);
  parentScreens.push(route.name);
  state = createStateObject(initialRoute, route, routes.length === 0);

  if (routes.length > 0) {
    var nestedState = state;

    while (route = routes.shift()) {
      initialRoute = findInitialRoute(route.name, parentScreens, initialRoutes);
      var nestedStateIndex = nestedState.index || nestedState.routes.length - 1;
      nestedState.routes[nestedStateIndex].state = createStateObject(initialRoute, route, routes.length === 0);

      if (routes.length > 0) {
        nestedState = nestedState.routes[nestedStateIndex].state;
      }

      parentScreens.push(route.name);
    }
  }

  return state;
};

var findFocusedRoute = function findFocusedRoute(state) {
  var _current4;

  var current = state;

  while ((_current3 = current) !== null && _current3 !== void 0 && _current3.routes[current.index || 0].state) {
    var _current3;

    current = current.routes[current.index || 0].state;
  }

  var route = current.routes[((_current4 = current) === null || _current4 === void 0 ? void 0 : _current4.index) || 0];
  return route;
};

var parseQueryParams = function parseQueryParams(path, parseConfig) {
  var query = path.split('?')[1];
  var params = queryString.parse(query);

  if (parseConfig) {
    Object.keys(params).forEach(function (name) {
      if (parseConfig[name] && typeof params[name] === 'string') {
        params[name] = parseConfig[name](params[name]);
      }
    });
  }

  return Object.keys(params).length ? params : undefined;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldFN0YXRlRnJvbVBhdGgudHN4Il0sIm5hbWVzIjpbImluaXRpYWxSb3V0ZXMiLCJjb21wYXRPcHRpb25zIiwiaW5pdGlhbFJvdXRlTmFtZSIsInBhcmVudFNjcmVlbnMiLCJzY3JlZW5zIiwicmVtYWluaW5nIiwicm91dGVzIiwibmFtZSIsImRlY29kZVVSSUNvbXBvbmVudCIsImkiLCJzZWxmIiwicGFyYW1zIiwicGFyc2VRdWVyeVBhcmFtcyIsImNyZWF0ZU5lc3RlZFN0YXRlT2JqZWN0IiwiY29uZmlncyIsIk9iamVjdCIsImtleSIsImNyZWF0ZU5vcm1hbGl6ZWRDb25maWdzIiwiYSIsImIiLCJhUGFydHMiLCJiUGFydHMiLCJhV2lsZGNhcmRJbmRleCIsImJXaWxkY2FyZEluZGV4IiwiYWNjIiwiY29uZmlnIiwiaW50ZXJzZWN0cyIsIm1hdGNoIiwiYyIsImxlZ2FjeSIsInJlbWFpbmluZ1BhdGgiLCJtYXRjaEFnYWluc3RDb25maWdzIiwicmVnZXgiLCJ1bmRlZmluZWQiLCJjdXJyZW50IiwicmVzdWx0Iiwic2VnbWVudHMiLCJzdGF0ZSIsInJvdXRlIiwiZmluZEZvY3VzZWRSb3V0ZSIsImZpbmRQYXJzZUNvbmZpZ0ZvclJvdXRlIiwiam9pblBhdGhzIiwicGF0aHMiLCJwIiwibWF0Y2hlZFBhcmFtcyIsInZhbHVlIiwicm91dGVOYW1lcyIsInJvdXRlQ29uZmlnIiwicGF0dGVybiIsInBhcmVudFBhdHRlcm4iLCJjcmVhdGVDb25maWdJdGVtIiwiaW5pdGlhbHMiLCJuZXN0ZWRDb25maWciLCJpdCIsInNjcmVlbiIsInBhdGgiLCJwYXJzZSIsInJvdXRlTmFtZSIsImZpbmRJbml0aWFsUm91dGUiLCJzYW1lUGFyZW50cyIsImNyZWF0ZVN0YXRlT2JqZWN0IiwiaW5kZXgiLCJpbml0aWFsUm91dGUiLCJuZXN0ZWRTdGF0ZSIsIm5lc3RlZFN0YXRlSW5kZXgiLCJxdWVyeSIsInF1ZXJ5U3RyaW5nIiwicGFyc2VDb25maWciXSwibWFwcGluZ3Mi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QSxDQUFBQSxFQUFWQSxLQUFBQTtBQUNEOztBQUVELE1BQU1JLEtBQUssR0FBSUosT0FBRCxDQUFBLE1BQUNBLENBQ2IsQ0FBQSxDQUFBLFNBQUEsR0FBQSxPQUFBLE1BQUEsSUFBQSxJQUFBLFNBQUEsS0FBQSxLQUFBLENBQUEsR0FBQSxLQUFBLENBQUEsR0FBQSxTQUFBLENBQUEsS0FBQSxLQURGLENBQWVBLENBQWY7QUFJQSxTQUFBLEtBQUE7QUFaRixDQUFBOztBQWVBLElBQU10QixnQkFBZ0IsR0FBRyxTQUFuQkEsZ0JBQW1CLENBQUEsSUFBQSxFQUFBLFdBQUEsRUFHcEI7QUFDSCxNQUFNcUQsS0FBSyxHQUFHVixJQUFJLENBQUpBLEtBQUFBLENBQUFBLEdBQUFBLEVBQWQsQ0FBY0EsQ0FBZDtBQUNBLE1BQU01QyxNQUFNLEdBQUd1RCxXQUFXLENBQVhBLEtBQUFBLENBQWYsS0FBZUEsQ0FBZjs7QUFFQSxNQUFBLFdBQUEsRUFBaUI7QUFDZm5ELElBQUFBLE1BQU0sQ0FBTkEsSUFBQUEsQ0FBQUEsTUFBQUEsRUFBQUEsT0FBQUEsQ0FBNkJSLFVBQUFBLElBQUQsRUFBVTtBQUNwQyxVQUFJNEQsV0FBVyxDQUFYQSxJQUFXLENBQVhBLElBQXFCLE9BQU94RCxNQUFNLENBQWIsSUFBYSxDQUFiLEtBQXpCLFFBQUEsRUFBMkQ7QUFDekRBLFFBQUFBLE1BQU0sQ0FBTkEsSUFBTSxDQUFOQSxHQUFld0QsV0FBVyxDQUFYQSxJQUFXLENBQVhBLENBQWtCeEQsTUFBTSxDQUF2Q0EsSUFBdUMsQ0FBeEJ3RCxDQUFmeEQ7QUFDRDtBQUhISSxLQUFBQTtBQUtEOztBQUVELFNBQU9BLE1BQU0sQ0FBTkEsSUFBQUEsQ0FBQUEsTUFBQUEsRUFBQUEsTUFBQUEsR0FBQUEsTUFBQUEsR0FBUCxTQUFBO0FBZkYsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBlc2NhcGUgZnJvbSAnZXNjYXBlLXN0cmluZy1yZWdleHAnO1xuaW1wb3J0ICogYXMgcXVlcnlTdHJpbmcgZnJvbSAncXVlcnktc3RyaW5nJztcbmltcG9ydCB0eXBlIHtcbiAgTmF2aWdhdGlvblN0YXRlLFxuICBQYXJ0aWFsU3RhdGUsXG4gIEluaXRpYWxTdGF0ZSxcbn0gZnJvbSAnQHJlYWN0LW5hdmlnYXRpb24vcm91dGVycyc7XG5pbXBvcnQgY2hlY2tMZWdhY3lQYXRoQ29uZmlnIGZyb20gJy4vY2hlY2tMZWdhY3lQYXRoQ29uZmlnJztcbmltcG9ydCB0eXBlIHsgUGF0aENvbmZpZ01hcCB9IGZyb20gJy4vdHlwZXMnO1xuXG50eXBlIE9wdGlvbnMgPSB7XG4gIGluaXRpYWxSb3V0ZU5hbWU/OiBzdHJpbmc7XG4gIHNjcmVlbnM6IFBhdGhDb25maWdNYXA7XG59O1xuXG50eXBlIFBhcnNlQ29uZmlnID0gUmVjb3JkPHN0cmluZywgKHZhbHVlOiBzdHJpbmcpID0+IGFueT47XG5cbnR5cGUgUm91dGVDb25maWcgPSB7XG4gIHNjcmVlbjogc3RyaW5nO1xuICByZWdleD86IFJlZ0V4cDtcbiAgcGF0aDogc3RyaW5nO1xuICBwYXR0ZXJuOiBzdHJpbmc7XG4gIHJvdXRlTmFtZXM6IHN0cmluZ1tdO1xuICBwYXJzZT86IFBhcnNlQ29uZmlnO1xufTtcblxudHlwZSBJbml0aWFsUm91dGVDb25maWcgPSB7XG4gIGluaXRpYWxSb3V0ZU5hbWU6IHN0cmluZztcbiAgcGFyZW50U2NyZWVuczogc3RyaW5nW107XG59O1xuXG50eXBlIFJlc3VsdFN0YXRlID0gUGFydGlhbFN0YXRlPE5hdmlnYXRpb25TdGF0ZT4gJiB7XG4gIHN0YXRlPzogUmVzdWx0U3RhdGU7XG59O1xuXG50eXBlIFBhcnNlZFJvdXRlID0ge1xuICBuYW1lOiBzdHJpbmc7XG4gIHBhcmFtcz86IFJlY29yZDxzdHJpbmcsIGFueT4gfCB1bmRlZmluZWQ7XG59O1xuXG4vKipcbiAqIFV0aWxpdHkgdG8gcGFyc2UgYSBwYXRoIHN0cmluZyB0byBpbml0aWFsIHN0YXRlIG9iamVjdCBhY2NlcHRlZCBieSB0aGUgY29udGFpbmVyLlxuICogVGhpcyBpcyB1c2VmdWwgZm9yIGRlZXAgbGlua2luZyB3aGVuIHdlIG5lZWQgdG8gaGFuZGxlIHRoZSBpbmNvbWluZyBVUkwuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGpzXG4gKiBnZXRTdGF0ZUZyb21QYXRoKFxuICogICAnL2NoYXQvamFuZS80MicsXG4gKiAgIHtcbiAqICAgICBzY3JlZW5zOiB7XG4gKiAgICAgICBDaGF0OiB7XG4gKiAgICAgICAgIHBhdGg6ICdjaGF0LzphdXRob3IvOmlkJyxcbiAqICAgICAgICAgcGFyc2U6IHsgaWQ6IE51bWJlciB9XG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICB9XG4gKiApXG4gKiBgYGBcbiAqIEBwYXJhbSBwYXRoIFBhdGggc3RyaW5nIHRvIHBhcnNlIGFuZCBjb252ZXJ0LCBlLmcuIC9mb28vYmFyP2NvdW50PTQyLlxuICogQHBhcmFtIG9wdGlvbnMgRXh0cmEgb3B0aW9ucyB0byBmaW5lLXR1bmUgaG93IHRvIHBhcnNlIHRoZSBwYXRoLlxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRTdGF0ZUZyb21QYXRoKFxuICBwYXRoOiBzdHJpbmcsXG4gIG9wdGlvbnM/OiBPcHRpb25zXG4pOiBSZXN1bHRTdGF0ZSB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IFtsZWdhY3ksIGNvbXBhdE9wdGlvbnNdID0gY2hlY2tMZWdhY3lQYXRoQ29uZmlnKG9wdGlvbnMpO1xuXG4gIGxldCBpbml0aWFsUm91dGVzOiBJbml0aWFsUm91dGVDb25maWdbXSA9IFtdO1xuXG4gIGlmIChjb21wYXRPcHRpb25zPy5pbml0aWFsUm91dGVOYW1lKSB7XG4gICAgaW5pdGlhbFJvdXRlcy5wdXNoKHtcbiAgICAgIGluaXRpYWxSb3V0ZU5hbWU6IGNvbXBhdE9wdGlvbnMuaW5pdGlhbFJvdXRlTmFtZSxcbiAgICAgIHBhcmVudFNjcmVlbnM6IFtdLFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3Qgc2NyZWVucyA9IGNvbXBhdE9wdGlvbnM/LnNjcmVlbnM7XG5cbiAgbGV0IHJlbWFpbmluZyA9IHBhdGhcbiAgICAucmVwbGFjZSgvXFwvKy9nLCAnLycpIC8vIFJlcGxhY2UgbXVsdGlwbGUgc2xhc2ggKC8vKSB3aXRoIHNpbmdsZSBvbmVzXG4gICAgLnJlcGxhY2UoL15cXC8vLCAnJykgLy8gUmVtb3ZlIGV4dHJhIGxlYWRpbmcgc2xhc2hcbiAgICAucmVwbGFjZSgvXFw/LiokLywgJycpOyAvLyBSZW1vdmUgcXVlcnkgcGFyYW1zIHdoaWNoIHdlIHdpbGwgaGFuZGxlIGxhdGVyXG5cbiAgLy8gTWFrZSBzdXJlIHRoZXJlIGlzIGEgdHJhaWxpbmcgc2xhc2hcbiAgcmVtYWluaW5nID0gcmVtYWluaW5nLmVuZHNXaXRoKCcvJykgPyByZW1haW5pbmcgOiBgJHtyZW1haW5pbmd9L2A7XG5cbiAgaWYgKHNjcmVlbnMgPT09IHVuZGVmaW5lZCkge1xuICAgIC8vIFdoZW4gbm8gY29uZmlnIGlzIHNwZWNpZmllZCwgdXNlIHRoZSBwYXRoIHNlZ21lbnRzIGFzIHJvdXRlIG5hbWVzXG4gICAgY29uc3Qgcm91dGVzID0gcmVtYWluaW5nXG4gICAgICAuc3BsaXQoJy8nKVxuICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgLm1hcCgoc2VnbWVudCwgaSwgc2VsZikgPT4ge1xuICAgICAgICBjb25zdCBuYW1lID0gZGVjb2RlVVJJQ29tcG9uZW50KHNlZ21lbnQpO1xuXG4gICAgICAgIGlmIChpID09PSBzZWxmLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICByZXR1cm4geyBuYW1lLCBwYXJhbXM6IHBhcnNlUXVlcnlQYXJhbXMocGF0aCkgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7IG5hbWUgfTtcbiAgICAgIH0pO1xuXG4gICAgaWYgKHJvdXRlcy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBjcmVhdGVOZXN0ZWRTdGF0ZU9iamVjdChyb3V0ZXMsIGluaXRpYWxSb3V0ZXMpO1xuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICAvLyBDcmVhdGUgYSBub3JtYWxpemVkIGNvbmZpZ3MgYXJyYXkgd2hpY2ggd2lsbCBiZSBlYXNpZXIgdG8gdXNlXG4gIGNvbnN0IGNvbmZpZ3MgPSAoW10gYXMgUm91dGVDb25maWdbXSlcbiAgICAuY29uY2F0KFxuICAgICAgLi4uT2JqZWN0LmtleXMoc2NyZWVucykubWFwKChrZXkpID0+XG4gICAgICAgIGNyZWF0ZU5vcm1hbGl6ZWRDb25maWdzKFxuICAgICAgICAgIGxlZ2FjeSxcbiAgICAgICAgICBrZXksXG4gICAgICAgICAgc2NyZWVucyBhcyBQYXRoQ29uZmlnTWFwLFxuICAgICAgICAgIFtdLFxuICAgICAgICAgIGluaXRpYWxSb3V0ZXMsXG4gICAgICAgICAgW11cbiAgICAgICAgKVxuICAgICAgKVxuICAgIClcbiAgICAuc29ydCgoYSwgYikgPT4ge1xuICAgICAgLy8gU29ydCBjb25maWcgc28gdGhhdDpcbiAgICAgIC8vIC0gdGhlIG1vc3QgZXhoYXVzdGl2ZSBvbmVzIGFyZSBhbHdheXMgYXQgdGhlIGJlZ2lubmluZ1xuICAgICAgLy8gLSBwYXR0ZXJucyB3aXRoIHdpbGRjYXJkIGFyZSBhbHdheXMgYXQgdGhlIGVuZFxuXG4gICAgICAvLyBJZiAyIHBhdHRlcm5zIGFyZSBzYW1lLCBtb3ZlIHRoZSBvbmUgd2l0aCBsZXNzIHJvdXRlIG5hbWVzIHVwXG4gICAgICAvLyBUaGlzIGlzIGFuIGVycm9yIHN0YXRlLCBzbyBpdCdzIG9ubHkgdXNlZnVsIGZvciBjb25zaXN0ZW50IGVycm9yIG1lc3NhZ2VzXG4gICAgICBpZiAoYS5wYXR0ZXJuID09PSBiLnBhdHRlcm4pIHtcbiAgICAgICAgcmV0dXJuIGIucm91dGVOYW1lcy5qb2luKCc+JykubG9jYWxlQ29tcGFyZShhLnJvdXRlTmFtZXMuam9pbignPicpKTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgb25lIG9mIHRoZSBwYXR0ZXJucyBzdGFydHMgd2l0aCB0aGUgb3RoZXIsIGl0J3MgbW9yZSBleGhhdXN0aXZlXG4gICAgICAvLyBTbyBtb3ZlIGl0IHVwXG4gICAgICBpZiAoYS5wYXR0ZXJuLnN0YXJ0c1dpdGgoYi5wYXR0ZXJuKSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9XG5cbiAgICAgIGlmIChiLnBhdHRlcm4uc3RhcnRzV2l0aChhLnBhdHRlcm4pKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhUGFydHMgPSBhLnBhdHRlcm4uc3BsaXQoJy8nKTtcbiAgICAgIGNvbnN0IGJQYXJ0cyA9IGIucGF0dGVybi5zcGxpdCgnLycpO1xuXG4gICAgICBjb25zdCBhV2lsZGNhcmRJbmRleCA9IGFQYXJ0cy5pbmRleE9mKCcqJyk7XG4gICAgICBjb25zdCBiV2lsZGNhcmRJbmRleCA9IGJQYXJ0cy5pbmRleE9mKCcqJyk7XG5cbiAgICAgIC8vIElmIG9ubHkgb25lIG9mIHRoZSBwYXR0ZXJucyBoYXMgYSB3aWxkY2FyZCwgbW92ZSBpdCBkb3duIGluIHRoZSBsaXN0XG4gICAgICBpZiAoYVdpbGRjYXJkSW5kZXggPT09IC0xICYmIGJXaWxkY2FyZEluZGV4ICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9XG5cbiAgICAgIGlmIChhV2lsZGNhcmRJbmRleCAhPT0gLTEgJiYgYldpbGRjYXJkSW5kZXggPT09IC0xKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfVxuXG4gICAgICBpZiAoYVdpbGRjYXJkSW5kZXggPT09IGJXaWxkY2FyZEluZGV4KSB7XG4gICAgICAgIC8vIElmIGBiYCBoYXMgbW9yZSBgL2AsIGl0J3MgbW9yZSBleGhhdXN0aXZlXG4gICAgICAgIC8vIFNvIHdlIG1vdmUgaXQgdXAgaW4gdGhlIGxpc3RcbiAgICAgICAgcmV0dXJuIGJQYXJ0cy5sZW5ndGggLSBhUGFydHMubGVuZ3RoO1xuICAgICAgfVxuXG4gICAgICAvLyBJZiB0aGUgd2lsZGNhcmQgYXBwZWFycyBsYXRlciBpbiB0aGUgcGF0dGVybiAoaGFzIGhpZ2hlciBpbmRleCksIGl0J3MgbW9yZSBzcGVjaWZpY1xuICAgICAgLy8gU28gd2UgbW92ZSBpdCB1cCBpbiB0aGUgbGlzdFxuICAgICAgcmV0dXJuIGJXaWxkY2FyZEluZGV4IC0gYVdpbGRjYXJkSW5kZXg7XG4gICAgfSk7XG5cbiAgLy8gQ2hlY2sgZm9yIGR1cGxpY2F0ZSBwYXR0ZXJucyBpbiB0aGUgY29uZmlnXG4gIGNvbmZpZ3MucmVkdWNlPFJlY29yZDxzdHJpbmcsIFJvdXRlQ29uZmlnPj4oKGFjYywgY29uZmlnKSA9PiB7XG4gICAgaWYgKGFjY1tjb25maWcucGF0dGVybl0pIHtcbiAgICAgIGNvbnN0IGEgPSBhY2NbY29uZmlnLnBhdHRlcm5dLnJvdXRlTmFtZXM7XG4gICAgICBjb25zdCBiID0gY29uZmlnLnJvdXRlTmFtZXM7XG5cbiAgICAgIC8vIEl0J3Mgbm90IGEgcHJvYmxlbSBpZiB0aGUgcGF0aCBzdHJpbmcgb21pdHRlZCBmcm9tIGEgaW5uZXIgbW9zdCBzY3JlZW5cbiAgICAgIC8vIEZvciBleGFtcGxlLCBpdCdzIG9rIGlmIGEgcGF0aCByZXNvbHZlcyB0byBgQSA+IEIgPiBDYCBvciBgQSA+IEJgXG4gICAgICBjb25zdCBpbnRlcnNlY3RzID1cbiAgICAgICAgYS5sZW5ndGggPiBiLmxlbmd0aFxuICAgICAgICAgID8gYi5ldmVyeSgoaXQsIGkpID0+IGFbaV0gPT09IGl0KVxuICAgICAgICAgIDogYS5ldmVyeSgoaXQsIGkpID0+IGJbaV0gPT09IGl0KTtcblxuICAgICAgaWYgKCFpbnRlcnNlY3RzKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBgRm91bmQgY29uZmxpY3Rpbmcgc2NyZWVucyB3aXRoIHRoZSBzYW1lIHBhdHRlcm4uIFRoZSBwYXR0ZXJuICcke1xuICAgICAgICAgICAgY29uZmlnLnBhdHRlcm5cbiAgICAgICAgICB9JyByZXNvbHZlcyB0byBib3RoICcke2Euam9pbignID4gJyl9JyBhbmQgJyR7Yi5qb2luKFxuICAgICAgICAgICAgJyA+ICdcbiAgICAgICAgICApfScuIFBhdHRlcm5zIG11c3QgYmUgdW5pcXVlIGFuZCBjYW5ub3QgcmVzb2x2ZSB0byBtb3JlIHRoYW4gb25lIHNjcmVlbi5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oYWNjLCB7XG4gICAgICBbY29uZmlnLnBhdHRlcm5dOiBjb25maWcsXG4gICAgfSk7XG4gIH0sIHt9KTtcblxuICBpZiAocmVtYWluaW5nID09PSAnLycpIHtcbiAgICAvLyBXZSBuZWVkIHRvIGFkZCBzcGVjaWFsIGhhbmRsaW5nIG9mIGVtcHR5IHBhdGggc28gbmF2aWdhdGlvbiB0byBlbXB0eSBwYXRoIGFsc28gd29ya3NcbiAgICAvLyBXaGVuIGhhbmRsaW5nIGVtcHR5IHBhdGgsIHdlIHNob3VsZCBvbmx5IGxvb2sgYXQgdGhlIHJvb3QgbGV2ZWwgY29uZmlnXG4gICAgY29uc3QgbWF0Y2ggPSBjb25maWdzLmZpbmQoXG4gICAgICAoY29uZmlnKSA9PlxuICAgICAgICBjb25maWcucGF0aCA9PT0gJycgJiZcbiAgICAgICAgY29uZmlnLnJvdXRlTmFtZXMuZXZlcnkoXG4gICAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgbm9uZSBvZiB0aGUgcGFyZW50IGNvbmZpZ3MgaGF2ZSBhIG5vbi1lbXB0eSBwYXRoIGRlZmluZWRcbiAgICAgICAgICAobmFtZSkgPT4gIWNvbmZpZ3MuZmluZCgoYykgPT4gYy5zY3JlZW4gPT09IG5hbWUpPy5wYXRoXG4gICAgICAgIClcbiAgICApO1xuXG4gICAgaWYgKG1hdGNoKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTmVzdGVkU3RhdGVPYmplY3QoXG4gICAgICAgIG1hdGNoLnJvdXRlTmFtZXMubWFwKChuYW1lLCBpLCBzZWxmKSA9PiB7XG4gICAgICAgICAgaWYgKGkgPT09IHNlbGYubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgcmV0dXJuIHsgbmFtZSwgcGFyYW1zOiBwYXJzZVF1ZXJ5UGFyYW1zKHBhdGgsIG1hdGNoLnBhcnNlKSB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7IG5hbWUgfTtcbiAgICAgICAgfSksXG4gICAgICAgIGluaXRpYWxSb3V0ZXNcbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGxldCByZXN1bHQ6IFBhcnRpYWxTdGF0ZTxOYXZpZ2F0aW9uU3RhdGU+IHwgdW5kZWZpbmVkO1xuICBsZXQgY3VycmVudDogUGFydGlhbFN0YXRlPE5hdmlnYXRpb25TdGF0ZT4gfCB1bmRlZmluZWQ7XG5cbiAgaWYgKGxlZ2FjeSA9PT0gZmFsc2UpIHtcbiAgICAvLyBJZiB3ZSdyZSBub3QgaW4gbGVnYWN5IG1vZGUsLCB3ZSBtYXRjaCB0aGUgd2hvbGUgcGF0aCBhZ2FpbnN0IHRoZSByZWdleCBpbnN0ZWFkIG9mIHNlZ21lbnRzXG4gICAgLy8gVGhpcyBtYWtlcyBzdXJlIG1hdGNoZXMgc3VjaCBhcyB3aWxkY2FyZCB3aWxsIGNhdGNoIGFueSB1bm1hdGNoZWQgcm91dGVzLCBldmVuIGlmIG5lc3RlZFxuICAgIGNvbnN0IHsgcm91dGVzLCByZW1haW5pbmdQYXRoIH0gPSBtYXRjaEFnYWluc3RDb25maWdzKFxuICAgICAgcmVtYWluaW5nLFxuICAgICAgY29uZmlncy5tYXAoKGMpID0+ICh7XG4gICAgICAgIC4uLmMsXG4gICAgICAgIC8vIEFkZCBgJGAgdG8gdGhlIHJlZ2V4IHRvIG1ha2Ugc3VyZSBpdCBtYXRjaGVzIHRpbGwgZW5kIG9mIHRoZSBwYXRoIGFuZCBub3QganVzdCBiZWdpbm5pbmdcbiAgICAgICAgcmVnZXg6IGMucmVnZXggPyBuZXcgUmVnRXhwKGMucmVnZXguc291cmNlICsgJyQnKSA6IHVuZGVmaW5lZCxcbiAgICAgIH0pKVxuICAgICk7XG5cbiAgICBpZiAocm91dGVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIC8vIFRoaXMgd2lsbCBhbHdheXMgYmUgZW1wdHkgaWYgZnVsbCBwYXRoIG1hdGNoZWRcbiAgICAgIGN1cnJlbnQgPSBjcmVhdGVOZXN0ZWRTdGF0ZU9iamVjdChyb3V0ZXMsIGluaXRpYWxSb3V0ZXMpO1xuICAgICAgcmVtYWluaW5nID0gcmVtYWluaW5nUGF0aDtcbiAgICAgIHJlc3VsdCA9IGN1cnJlbnQ7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIEluIGxlZ2FjeSBtb2RlLCB3ZSBkaXZpZGUgdGhlIHBhdGggaW50byBzZWdtZW50cyBhbmQgbWF0Y2ggcGllY2UgYnkgcGllY2VcbiAgICAvLyBUaGlzIHByZXNlcnZlcyB0aGUgbGVnYWN5IGJlaGF2aW91ciwgYnV0IHdlIHNob3VsZCByZW1vdmUgaXQgaW4gbmV4dCBtYWpvclxuICAgIHdoaWxlIChyZW1haW5pbmcpIHtcbiAgICAgIGxldCB7IHJvdXRlcywgcmVtYWluaW5nUGF0aCB9ID0gbWF0Y2hBZ2FpbnN0Q29uZmlncyhyZW1haW5pbmcsIGNvbmZpZ3MpO1xuXG4gICAgICByZW1haW5pbmcgPSByZW1haW5pbmdQYXRoO1xuXG4gICAgICAvLyBJZiB3ZSBoYWRuJ3QgbWF0Y2hlZCBhbnkgc2VnbWVudHMgZWFybGllciwgdXNlIHRoZSBwYXRoIGFzIHJvdXRlIG5hbWVcbiAgICAgIGlmIChyb3V0ZXMgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zdCBzZWdtZW50cyA9IHJlbWFpbmluZy5zcGxpdCgnLycpO1xuXG4gICAgICAgIHJvdXRlcyA9IFt7IG5hbWU6IGRlY29kZVVSSUNvbXBvbmVudChzZWdtZW50c1swXSkgfV07XG4gICAgICAgIHNlZ21lbnRzLnNoaWZ0KCk7XG4gICAgICAgIHJlbWFpbmluZyA9IHNlZ21lbnRzLmpvaW4oJy8nKTtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc3RhdGUgPSBjcmVhdGVOZXN0ZWRTdGF0ZU9iamVjdChyb3V0ZXMsIGluaXRpYWxSb3V0ZXMpO1xuXG4gICAgICBpZiAoY3VycmVudCkge1xuICAgICAgICAvLyBUaGUgc3RhdGUgc2hvdWxkIGJlIG5lc3RlZCBpbnNpZGUgdGhlIGRlZXBlc3Qgcm91dGUgd2UgcGFyc2VkIGJlZm9yZVxuICAgICAgICB3aGlsZSAoY3VycmVudD8ucm91dGVzW2N1cnJlbnQuaW5kZXggfHwgMF0uc3RhdGUpIHtcbiAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5yb3V0ZXNbY3VycmVudC5pbmRleCB8fCAwXS5zdGF0ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIChjdXJyZW50IGFzIFBhcnRpYWxTdGF0ZTxOYXZpZ2F0aW9uU3RhdGU+KS5yb3V0ZXNbXG4gICAgICAgICAgY3VycmVudD8uaW5kZXggfHwgMFxuICAgICAgICBdLnN0YXRlID0gc3RhdGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBzdGF0ZTtcbiAgICAgIH1cblxuICAgICAgY3VycmVudCA9IHN0YXRlO1xuICAgIH1cbiAgfVxuXG4gIGlmIChjdXJyZW50ID09IG51bGwgfHwgcmVzdWx0ID09IG51bGwpIHtcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgY29uc3Qgcm91dGUgPSBmaW5kRm9jdXNlZFJvdXRlKGN1cnJlbnQpO1xuICBjb25zdCBwYXJhbXMgPSBwYXJzZVF1ZXJ5UGFyYW1zKFxuICAgIHBhdGgsXG4gICAgZmluZFBhcnNlQ29uZmlnRm9yUm91dGUocm91dGUubmFtZSwgY29uZmlncylcbiAgKTtcblxuICBpZiAocGFyYW1zKSB7XG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvcjogcGFyYW1zIHNob3VsZCBiZSB0cmVhdGVkIGFzIHJlYWQtb25seSwgYnV0IHdlJ3JlIGNyZWF0aW5nIHRoZSBzdGF0ZSBoZXJlIHNvIGl0IGRvZXNuJ3QgbWF0dGVyXG4gICAgcm91dGUucGFyYW1zID0geyAuLi5yb3V0ZS5wYXJhbXMsIC4uLnBhcmFtcyB9O1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuY29uc3Qgam9pblBhdGhzID0gKC4uLnBhdGhzOiBzdHJpbmdbXSk6IHN0cmluZyA9PlxuICAoW10gYXMgc3RyaW5nW10pXG4gICAgLmNvbmNhdCguLi5wYXRocy5tYXAoKHApID0+IHAuc3BsaXQoJy8nKSkpXG4gICAgLmZpbHRlcihCb29sZWFuKVxuICAgIC5qb2luKCcvJyk7XG5cbmNvbnN0IG1hdGNoQWdhaW5zdENvbmZpZ3MgPSAocmVtYWluaW5nOiBzdHJpbmcsIGNvbmZpZ3M6IFJvdXRlQ29uZmlnW10pID0+IHtcbiAgbGV0IHJvdXRlczogUGFyc2VkUm91dGVbXSB8IHVuZGVmaW5lZDtcbiAgbGV0IHJlbWFpbmluZ1BhdGggPSByZW1haW5pbmc7XG5cbiAgLy8gR28gdGhyb3VnaCBhbGwgY29uZmlncywgYW5kIHNlZSBpZiB0aGUgbmV4dCBwYXRoIHNlZ21lbnQgbWF0Y2hlcyBvdXIgcmVnZXhcbiAgZm9yIChjb25zdCBjb25maWcgb2YgY29uZmlncykge1xuICAgIGlmICghY29uZmlnLnJlZ2V4KSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb25zdCBtYXRjaCA9IHJlbWFpbmluZ1BhdGgubWF0Y2goY29uZmlnLnJlZ2V4KTtcblxuICAgIC8vIElmIG91ciByZWdleCBtYXRjaGVzLCB3ZSBuZWVkIHRvIGV4dHJhY3QgcGFyYW1zIGZyb20gdGhlIHBhdGhcbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgIGNvbnN0IG1hdGNoZWRQYXJhbXMgPSBjb25maWcucGF0dGVyblxuICAgICAgICA/LnNwbGl0KCcvJylcbiAgICAgICAgLmZpbHRlcigocCkgPT4gcC5zdGFydHNXaXRoKCc6JykpXG4gICAgICAgIC5yZWR1Y2U8UmVjb3JkPHN0cmluZywgYW55Pj4oXG4gICAgICAgICAgKGFjYywgcCwgaSkgPT5cbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYWNjLCB7XG4gICAgICAgICAgICAgIC8vIFRoZSBwYXJhbSBzZWdtZW50cyBhcHBlYXIgZXZlcnkgc2Vjb25kIGl0ZW0gc3RhcnRpbmcgZnJvbSAyIGluIHRoZSByZWdleCBtYXRjaCByZXN1bHRcbiAgICAgICAgICAgICAgW3BdOiBtYXRjaCFbKGkgKyAxKSAqIDJdLnJlcGxhY2UoL1xcLy8sICcnKSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgIHt9XG4gICAgICAgICk7XG5cbiAgICAgIHJvdXRlcyA9IGNvbmZpZy5yb3V0ZU5hbWVzLm1hcCgobmFtZSkgPT4ge1xuICAgICAgICBjb25zdCBjb25maWcgPSBjb25maWdzLmZpbmQoKGMpID0+IGMuc2NyZWVuID09PSBuYW1lKTtcbiAgICAgICAgY29uc3QgcGFyYW1zID0gY29uZmlnPy5wYXRoXG4gICAgICAgICAgPy5zcGxpdCgnLycpXG4gICAgICAgICAgLmZpbHRlcigocCkgPT4gcC5zdGFydHNXaXRoKCc6JykpXG4gICAgICAgICAgLnJlZHVjZTxSZWNvcmQ8c3RyaW5nLCBhbnk+PigoYWNjLCBwKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IG1hdGNoZWRQYXJhbXNbcF07XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICBjb25zdCBrZXkgPSBwLnJlcGxhY2UoL146LywgJycpLnJlcGxhY2UoL1xcPyQvLCAnJyk7XG4gICAgICAgICAgICAgIGFjY1trZXldID0gY29uZmlnLnBhcnNlPy5ba2V5XSA/IGNvbmZpZy5wYXJzZVtrZXldKHZhbHVlKSA6IHZhbHVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgICAgIH0sIHt9KTtcblxuICAgICAgICBpZiAocGFyYW1zICYmIE9iamVjdC5rZXlzKHBhcmFtcykubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIHsgbmFtZSwgcGFyYW1zIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyBuYW1lIH07XG4gICAgICB9KTtcblxuICAgICAgcmVtYWluaW5nUGF0aCA9IHJlbWFpbmluZ1BhdGgucmVwbGFjZShtYXRjaFsxXSwgJycpO1xuXG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4geyByb3V0ZXMsIHJlbWFpbmluZ1BhdGggfTtcbn07XG5cbmNvbnN0IGNyZWF0ZU5vcm1hbGl6ZWRDb25maWdzID0gKFxuICBsZWdhY3k6IGJvb2xlYW4sXG4gIHNjcmVlbjogc3RyaW5nLFxuICByb3V0ZUNvbmZpZzogUGF0aENvbmZpZ01hcCxcbiAgcm91dGVOYW1lczogc3RyaW5nW10gPSBbXSxcbiAgaW5pdGlhbHM6IEluaXRpYWxSb3V0ZUNvbmZpZ1tdLFxuICBwYXJlbnRTY3JlZW5zOiBzdHJpbmdbXSxcbiAgcGFyZW50UGF0dGVybj86IHN0cmluZ1xuKTogUm91dGVDb25maWdbXSA9PiB7XG4gIGNvbnN0IGNvbmZpZ3M6IFJvdXRlQ29uZmlnW10gPSBbXTtcblxuICByb3V0ZU5hbWVzLnB1c2goc2NyZWVuKTtcblxuICBwYXJlbnRTY3JlZW5zLnB1c2goc2NyZWVuKTtcblxuICBjb25zdCBjb25maWcgPSByb3V0ZUNvbmZpZ1tzY3JlZW5dO1xuXG4gIGlmICh0eXBlb2YgY29uZmlnID09PSAnc3RyaW5nJykge1xuICAgIC8vIElmIGEgc3RyaW5nIGlzIHNwZWNpZmllZCBhcyB0aGUgdmFsdWUgb2YgdGhlIGtleShlLmcuIEZvbzogJy9wYXRoJyksIHVzZSBpdCBhcyB0aGUgcGF0dGVyblxuICAgIGNvbnN0IHBhdHRlcm4gPSBwYXJlbnRQYXR0ZXJuID8gam9pblBhdGhzKHBhcmVudFBhdHRlcm4sIGNvbmZpZykgOiBjb25maWc7XG5cbiAgICBjb25maWdzLnB1c2goY3JlYXRlQ29uZmlnSXRlbShsZWdhY3ksIHNjcmVlbiwgcm91dGVOYW1lcywgcGF0dGVybiwgY29uZmlnKSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ29iamVjdCcpIHtcbiAgICBsZXQgcGF0dGVybjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gICAgLy8gaWYgYW4gb2JqZWN0IGlzIHNwZWNpZmllZCBhcyB0aGUgdmFsdWUgKGUuZy4gRm9vOiB7IC4uLiB9KSxcbiAgICAvLyBpdCBjYW4gaGF2ZSBgcGF0aGAgcHJvcGVydHkgYW5kXG4gICAgLy8gaXQgY291bGQgaGF2ZSBgc2NyZWVuc2AgcHJvcCB3aGljaCBoYXMgbmVzdGVkIGNvbmZpZ3NcbiAgICBpZiAodHlwZW9mIGNvbmZpZy5wYXRoID09PSAnc3RyaW5nJykge1xuICAgICAgaWYgKGxlZ2FjeSkge1xuICAgICAgICBwYXR0ZXJuID1cbiAgICAgICAgICBjb25maWcuZXhhY3QgIT09IHRydWUgJiYgcGFyZW50UGF0dGVyblxuICAgICAgICAgICAgPyBqb2luUGF0aHMocGFyZW50UGF0dGVybiwgY29uZmlnLnBhdGgpXG4gICAgICAgICAgICA6IGNvbmZpZy5wYXRoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvbmZpZy5leGFjdCAmJiBjb25maWcucGF0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgXCJBICdwYXRoJyBuZWVkcyB0byBiZSBzcGVjaWZpZWQgd2hlbiBzcGVjaWZ5aW5nICdleGFjdDogdHJ1ZScuIElmIHlvdSBkb24ndCB3YW50IHRoaXMgc2NyZWVuIGluIHRoZSBVUkwsIHNwZWNpZnkgaXQgYXMgZW1wdHkgc3RyaW5nLCBlLmcuIGBwYXRoOiAnJ2AuXCJcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcGF0dGVybiA9XG4gICAgICAgICAgY29uZmlnLmV4YWN0ICE9PSB0cnVlXG4gICAgICAgICAgICA/IGpvaW5QYXRocyhwYXJlbnRQYXR0ZXJuIHx8ICcnLCBjb25maWcucGF0aCB8fCAnJylcbiAgICAgICAgICAgIDogY29uZmlnLnBhdGggfHwgJyc7XG4gICAgICB9XG5cbiAgICAgIGNvbmZpZ3MucHVzaChcbiAgICAgICAgY3JlYXRlQ29uZmlnSXRlbShcbiAgICAgICAgICBsZWdhY3ksXG4gICAgICAgICAgc2NyZWVuLFxuICAgICAgICAgIHJvdXRlTmFtZXMsXG4gICAgICAgICAgcGF0dGVybixcbiAgICAgICAgICBjb25maWcucGF0aCxcbiAgICAgICAgICBjb25maWcucGFyc2VcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLnNjcmVlbnMpIHtcbiAgICAgIC8vIHByb3BlcnR5IGBpbml0aWFsUm91dGVOYW1lYCB3aXRob3V0IGBzY3JlZW5zYCBoYXMgbm8gcHVycG9zZVxuICAgICAgaWYgKGNvbmZpZy5pbml0aWFsUm91dGVOYW1lKSB7XG4gICAgICAgIGluaXRpYWxzLnB1c2goe1xuICAgICAgICAgIGluaXRpYWxSb3V0ZU5hbWU6IGNvbmZpZy5pbml0aWFsUm91dGVOYW1lLFxuICAgICAgICAgIHBhcmVudFNjcmVlbnMsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBPYmplY3Qua2V5cyhjb25maWcuc2NyZWVucykuZm9yRWFjaCgobmVzdGVkQ29uZmlnKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGNyZWF0ZU5vcm1hbGl6ZWRDb25maWdzKFxuICAgICAgICAgIGxlZ2FjeSxcbiAgICAgICAgICBuZXN0ZWRDb25maWcsXG4gICAgICAgICAgY29uZmlnLnNjcmVlbnMgYXMgUGF0aENvbmZpZ01hcCxcbiAgICAgICAgICByb3V0ZU5hbWVzLFxuICAgICAgICAgIGluaXRpYWxzLFxuICAgICAgICAgIFsuLi5wYXJlbnRTY3JlZW5zXSxcbiAgICAgICAgICBwYXR0ZXJuID8/IHBhcmVudFBhdHRlcm5cbiAgICAgICAgKTtcblxuICAgICAgICBjb25maWdzLnB1c2goLi4ucmVzdWx0KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJvdXRlTmFtZXMucG9wKCk7XG5cbiAgcmV0dXJuIGNvbmZpZ3M7XG59O1xuXG5jb25zdCBjcmVhdGVDb25maWdJdGVtID0gKFxuICBsZWdhY3k6IGJvb2xlYW4sXG4gIHNjcmVlbjogc3RyaW5nLFxuICByb3V0ZU5hbWVzOiBzdHJpbmdbXSxcbiAgcGF0dGVybjogc3RyaW5nLFxuICBwYXRoOiBzdHJpbmcsXG4gIHBhcnNlPzogUGFyc2VDb25maWdcbik6IFJvdXRlQ29uZmlnID0+IHtcbiAgLy8gTm9ybWFsaXplIHBhdHRlcm4gdG8gcmVtb3ZlIGFueSBsZWFkaW5nLCB0cmFpbGluZyBzbGFzaGVzLCBkdXBsaWNhdGUgc2xhc2hlcyBldGMuXG4gIHBhdHRlcm4gPSBwYXR0ZXJuLnNwbGl0KCcvJykuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJy8nKTtcblxuICBjb25zdCByZWdleCA9IHBhdHRlcm5cbiAgICA/IG5ldyBSZWdFeHAoXG4gICAgICAgIGBeKCR7cGF0dGVyblxuICAgICAgICAgIC5zcGxpdCgnLycpXG4gICAgICAgICAgLm1hcCgoaXQpID0+IHtcbiAgICAgICAgICAgIGlmIChsZWdhY3kgJiYgaXQgPT09ICcqJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICAgXCJQbGVhc2UgdXBkYXRlIHlvdXIgY29uZmlnIHRvIHRoZSBuZXcgZm9ybWF0IHRvIHVzZSB3aWxkY2FyZCBwYXR0ZXJuICgnKicpLiBodHRwczovL3JlYWN0bmF2aWdhdGlvbi5vcmcvZG9jcy9jb25maWd1cmluZy1saW5rcy8jdXBkYXRpbmctY29uZmlnXCJcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGl0LnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgICAgICAgICByZXR1cm4gYCgoW14vXStcXFxcLykke2l0LmVuZHNXaXRoKCc/JykgPyAnPycgOiAnJ30pYDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGAke2l0ID09PSAnKicgPyAnLionIDogZXNjYXBlKGl0KX1cXFxcL2A7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuam9pbignJyl9KWBcbiAgICAgIClcbiAgICA6IHVuZGVmaW5lZDtcblxuICByZXR1cm4ge1xuICAgIHNjcmVlbixcbiAgICByZWdleCxcbiAgICBwYXR0ZXJuLFxuICAgIHBhdGgsXG4gICAgLy8gVGhlIHJvdXRlTmFtZXMgYXJyYXkgaXMgbXV0YXRlZCwgc28gY29weSBpdCB0byBrZWVwIHRoZSBjdXJyZW50IHN0YXRlXG4gICAgcm91dGVOYW1lczogWy4uLnJvdXRlTmFtZXNdLFxuICAgIHBhcnNlLFxuICB9O1xufTtcblxuY29uc3QgZmluZFBhcnNlQ29uZmlnRm9yUm91dGUgPSAoXG4gIHJvdXRlTmFtZTogc3RyaW5nLFxuICBmbGF0Q29uZmlnOiBSb3V0ZUNvbmZpZ1tdXG4pOiBQYXJzZUNvbmZpZyB8IHVuZGVmaW5lZCA9PiB7XG4gIGZvciAoY29uc3QgY29uZmlnIG9mIGZsYXRDb25maWcpIHtcbiAgICBpZiAocm91dGVOYW1lID09PSBjb25maWcucm91dGVOYW1lc1tjb25maWcucm91dGVOYW1lcy5sZW5ndGggLSAxXSkge1xuICAgICAgcmV0dXJuIGNvbmZpZy5wYXJzZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuLy8gVHJ5IHRvIGZpbmQgYW4gaW5pdGlhbCByb3V0ZSBjb25uZWN0ZWQgd2l0aCB0aGUgb25lIHBhc3NlZFxuY29uc3QgZmluZEluaXRpYWxSb3V0ZSA9IChcbiAgcm91dGVOYW1lOiBzdHJpbmcsXG4gIHBhcmVudFNjcmVlbnM6IHN0cmluZ1tdLFxuICBpbml0aWFsUm91dGVzOiBJbml0aWFsUm91dGVDb25maWdbXVxuKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IHtcbiAgZm9yIChjb25zdCBjb25maWcgb2YgaW5pdGlhbFJvdXRlcykge1xuICAgIGlmIChwYXJlbnRTY3JlZW5zLmxlbmd0aCA9PT0gY29uZmlnLnBhcmVudFNjcmVlbnMubGVuZ3RoKSB7XG4gICAgICBsZXQgc2FtZVBhcmVudHMgPSB0cnVlO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJlbnRTY3JlZW5zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChwYXJlbnRTY3JlZW5zW2ldLmxvY2FsZUNvbXBhcmUoY29uZmlnLnBhcmVudFNjcmVlbnNbaV0pICE9PSAwKSB7XG4gICAgICAgICAgc2FtZVBhcmVudHMgPSBmYWxzZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHNhbWVQYXJlbnRzKSB7XG4gICAgICAgIHJldHVybiByb3V0ZU5hbWUgIT09IGNvbmZpZy5pbml0aWFsUm91dGVOYW1lXG4gICAgICAgICAgPyBjb25maWcuaW5pdGlhbFJvdXRlTmFtZVxuICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuLy8gcmV0dXJucyBzdGF0ZSBvYmplY3Qgd2l0aCB2YWx1ZXMgZGVwZW5kaW5nIG9uIHdoZXRoZXJcbi8vIGl0IGlzIHRoZSBlbmQgb2Ygc3RhdGUgYW5kIGlmIHRoZXJlIGlzIGluaXRpYWxSb3V0ZSBmb3IgdGhpcyBsZXZlbFxuY29uc3QgY3JlYXRlU3RhdGVPYmplY3QgPSAoXG4gIGluaXRpYWxSb3V0ZTogc3RyaW5nIHwgdW5kZWZpbmVkLFxuICByb3V0ZTogUGFyc2VkUm91dGUsXG4gIGlzRW1wdHk6IGJvb2xlYW5cbik6IEluaXRpYWxTdGF0ZSA9PiB7XG4gIGlmIChpc0VtcHR5KSB7XG4gICAgaWYgKGluaXRpYWxSb3V0ZSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaW5kZXg6IDEsXG4gICAgICAgIHJvdXRlczogW3sgbmFtZTogaW5pdGlhbFJvdXRlIH0sIHJvdXRlXSxcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHJvdXRlczogW3JvdXRlXSxcbiAgICAgIH07XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChpbml0aWFsUm91dGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluZGV4OiAxLFxuICAgICAgICByb3V0ZXM6IFt7IG5hbWU6IGluaXRpYWxSb3V0ZSB9LCB7IC4uLnJvdXRlLCBzdGF0ZTogeyByb3V0ZXM6IFtdIH0gfV0sXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByb3V0ZXM6IFt7IC4uLnJvdXRlLCBzdGF0ZTogeyByb3V0ZXM6IFtdIH0gfV0sXG4gICAgICB9O1xuICAgIH1cbiAgfVxufTtcblxuY29uc3QgY3JlYXRlTmVzdGVkU3RhdGVPYmplY3QgPSAoXG4gIHJvdXRlczogUGFyc2VkUm91dGVbXSxcbiAgaW5pdGlhbFJvdXRlczogSW5pdGlhbFJvdXRlQ29uZmlnW11cbikgPT4ge1xuICBsZXQgc3RhdGU6IEluaXRpYWxTdGF0ZTtcbiAgbGV0IHJvdXRlID0gcm91dGVzLnNoaWZ0KCkgYXMgUGFyc2VkUm91dGU7XG4gIGNvbnN0IHBhcmVudFNjcmVlbnM6IHN0cmluZ1tdID0gW107XG5cbiAgbGV0IGluaXRpYWxSb3V0ZSA9IGZpbmRJbml0aWFsUm91dGUocm91dGUubmFtZSwgcGFyZW50U2NyZWVucywgaW5pdGlhbFJvdXRlcyk7XG5cbiAgcGFyZW50U2NyZWVucy5wdXNoKHJvdXRlLm5hbWUpO1xuXG4gIHN0YXRlID0gY3JlYXRlU3RhdGVPYmplY3QoaW5pdGlhbFJvdXRlLCByb3V0ZSwgcm91dGVzLmxlbmd0aCA9PT0gMCk7XG5cbiAgaWYgKHJvdXRlcy5sZW5ndGggPiAwKSB7XG4gICAgbGV0IG5lc3RlZFN0YXRlID0gc3RhdGU7XG5cbiAgICB3aGlsZSAoKHJvdXRlID0gcm91dGVzLnNoaWZ0KCkgYXMgUGFyc2VkUm91dGUpKSB7XG4gICAgICBpbml0aWFsUm91dGUgPSBmaW5kSW5pdGlhbFJvdXRlKHJvdXRlLm5hbWUsIHBhcmVudFNjcmVlbnMsIGluaXRpYWxSb3V0ZXMpO1xuXG4gICAgICBjb25zdCBuZXN0ZWRTdGF0ZUluZGV4ID1cbiAgICAgICAgbmVzdGVkU3RhdGUuaW5kZXggfHwgbmVzdGVkU3RhdGUucm91dGVzLmxlbmd0aCAtIDE7XG5cbiAgICAgIG5lc3RlZFN0YXRlLnJvdXRlc1tuZXN0ZWRTdGF0ZUluZGV4XS5zdGF0ZSA9IGNyZWF0ZVN0YXRlT2JqZWN0KFxuICAgICAgICBpbml0aWFsUm91dGUsXG4gICAgICAgIHJvdXRlLFxuICAgICAgICByb3V0ZXMubGVuZ3RoID09PSAwXG4gICAgICApO1xuXG4gICAgICBpZiAocm91dGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgbmVzdGVkU3RhdGUgPSBuZXN0ZWRTdGF0ZS5yb3V0ZXNbbmVzdGVkU3RhdGVJbmRleF1cbiAgICAgICAgICAuc3RhdGUgYXMgSW5pdGlhbFN0YXRlO1xuICAgICAgfVxuXG4gICAgICBwYXJlbnRTY3JlZW5zLnB1c2gocm91dGUubmFtZSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHN0YXRlO1xufTtcblxuY29uc3QgZmluZEZvY3VzZWRSb3V0ZSA9IChzdGF0ZTogSW5pdGlhbFN0YXRlKSA9PiB7XG4gIGxldCBjdXJyZW50OiBJbml0aWFsU3RhdGUgfCB1bmRlZmluZWQgPSBzdGF0ZTtcblxuICB3aGlsZSAoY3VycmVudD8ucm91dGVzW2N1cnJlbnQuaW5kZXggfHwgMF0uc3RhdGUpIHtcbiAgICAvLyBUaGUgcXVlcnkgcGFyYW1zIGFwcGx5IHRvIHRoZSBkZWVwZXN0IHJvdXRlXG4gICAgY3VycmVudCA9IGN1cnJlbnQucm91dGVzW2N1cnJlbnQuaW5kZXggfHwgMF0uc3RhdGU7XG4gIH1cblxuICBjb25zdCByb3V0ZSA9IChjdXJyZW50IGFzIFBhcnRpYWxTdGF0ZTxOYXZpZ2F0aW9uU3RhdGU+KS5yb3V0ZXNbXG4gICAgY3VycmVudD8uaW5kZXggfHwgMFxuICBdO1xuXG4gIHJldHVybiByb3V0ZTtcbn07XG5cbmNvbnN0IHBhcnNlUXVlcnlQYXJhbXMgPSAoXG4gIHBhdGg6IHN0cmluZyxcbiAgcGFyc2VDb25maWc/OiBSZWNvcmQ8c3RyaW5nLCAodmFsdWU6IHN0cmluZykgPT4gYW55PlxuKSA9PiB7XG4gIGNvbnN0IHF1ZXJ5ID0gcGF0aC5zcGxpdCgnPycpWzFdO1xuICBjb25zdCBwYXJhbXMgPSBxdWVyeVN0cmluZy5wYXJzZShxdWVyeSk7XG5cbiAgaWYgKHBhcnNlQ29uZmlnKSB7XG4gICAgT2JqZWN0LmtleXMocGFyYW1zKS5mb3JFYWNoKChuYW1lKSA9PiB7XG4gICAgICBpZiAocGFyc2VDb25maWdbbmFtZV0gJiYgdHlwZW9mIHBhcmFtc1tuYW1lXSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcGFyYW1zW25hbWVdID0gcGFyc2VDb25maWdbbmFtZV0ocGFyYW1zW25hbWVdIGFzIHN0cmluZyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gT2JqZWN0LmtleXMocGFyYW1zKS5sZW5ndGggPyBwYXJhbXMgOiB1bmRlZmluZWQ7XG59O1xuIl19