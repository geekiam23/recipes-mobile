{"version":3,"sources":["../sources/accessible-name-and-description.ts"],"names":["s","node","style","getComputedStyleImplementation","hasAbstractRole","elements","element","root","listbox","querySelectorAllSubtree","content","declaration","localName","isLabelableElement","labelableElement","descendantLabelableElement","findLabelableElement","label","htmlFor","labelsProperty","document","getControlOfLabel","assignedNodes","slot","options","consultedNodes","SetLike","window","compute","computedStyleSupportsPseudoElements","getComputedStyle","accumulatedText","pseudoBefore","beforeContent","getTextualContent","childNodes","getSlotContents","result","computeTextAlternative","isEmbeddedInLabel","context","isReferenced","recursion","display","separator","pseudoAfter","afterContent","attribute","children","i","child","nameFromAlt","useAttribute","nameFromLabel","nameFromValue","labels","getLabels","nameFromTitle","isHidden","labelElements","skipToStep2E","isControl","ariaLabel","current","isMarkedPresentational","elementTextAlternative","computeElementTextAlternative","selectedOptions","querySelectedOptions","getValueOfTextbox","allowsNameFromContent","isNativeHostLanguageTextAlternativeElement","isDescendantOfNativeHostLanguageTextAlternativeElement","computeMiscTextAlternative","tooltipAttributeValue","computeTooltipAttributeValue","asFlatString"],"mappings":"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","sourcesContent":["/**\n * implements https://w3c.github.io/accname/\n */\nimport ArrayFrom from \"./polyfills/array.from\";\nimport SetLike from \"./polyfills/SetLike\";\nimport {\n\thasAnyConcreteRoles,\n\tisElement,\n\tisHTMLTableCaptionElement,\n\tisHTMLInputElement,\n\tisHTMLSelectElement,\n\tisHTMLTextAreaElement,\n\tsafeWindow,\n\tisHTMLFieldSetElement,\n\tisHTMLLegendElement,\n\tisHTMLOptGroupElement,\n\tisHTMLTableElement,\n\tisHTMLSlotElement,\n\tisSVGSVGElement,\n\tisSVGTitleElement,\n\tqueryIdRefs,\n\tgetLocalName,\n} from \"./util\";\n\n/**\n *  A string of characters where all carriage returns, newlines, tabs, and form-feeds are replaced with a single space, and multiple spaces are reduced to a single space. The string contains only character data; it does not contain any markup.\n */\ntype FlatString = string & {\n\t__flat: true;\n};\n\n/**\n * interface for an options-bag where `window.getComputedStyle` can be mocked\n */\nexport interface ComputeTextAlternativeOptions {\n\tcompute?: \"description\" | \"name\";\n\t/**\n\t * Set to true if window.computedStyle supports the second argument.\n\t * This should be false in JSDOM. Otherwise JSDOM will log console errors.\n\t */\n\tcomputedStyleSupportsPseudoElements?: boolean;\n\tgetComputedStyle?: typeof window.getComputedStyle;\n}\n\n/**\n *\n * @param {string} string -\n * @returns {FlatString} -\n */\nfunction asFlatString(s: string): FlatString {\n\treturn s.trim().replace(/\\s\\s+/g, \" \") as FlatString;\n}\n\n/**\n *\n * @param node -\n * @param options - These are not optional to prevent accidentally calling it without options in `computeAccessibleName`\n * @returns {boolean} -\n */\nfunction isHidden(\n\tnode: Node,\n\tgetComputedStyleImplementation: typeof window.getComputedStyle\n): node is Element {\n\tif (!isElement(node)) {\n\t\treturn false;\n\t}\n\n\tif (\n\t\tnode.hasAttribute(\"hidden\") ||\n\t\tnode.getAttribute(\"aria-hidden\") === \"true\"\n\t) {\n\t\treturn true;\n\t}\n\n\tconst style = getComputedStyleImplementation(node);\n\treturn (\n\t\tstyle.getPropertyValue(\"display\") === \"none\" ||\n\t\tstyle.getPropertyValue(\"visibility\") === \"hidden\"\n\t);\n}\n\n/**\n * @param {Node} node -\n * @returns {boolean} - As defined in step 2E of https://w3c.github.io/accname/#mapping_additional_nd_te\n */\nfunction isControl(node: Node): boolean {\n\treturn (\n\t\thasAnyConcreteRoles(node, [\"button\", \"combobox\", \"listbox\", \"textbox\"]) ||\n\t\thasAbstractRole(node, \"range\")\n\t);\n}\n\nfunction hasAbstractRole(node: Node, role: string): node is Element {\n\tif (!isElement(node)) {\n\t\treturn false;\n\t}\n\n\tswitch (role) {\n\t\tcase \"range\":\n\t\t\treturn hasAnyConcreteRoles(node, [\n\t\t\t\t\"meter\",\n\t\t\t\t\"progressbar\",\n\t\t\t\t\"scrollbar\",\n\t\t\t\t\"slider\",\n\t\t\t\t\"spinbutton\",\n\t\t\t]);\n\t\tdefault:\n\t\t\tthrow new TypeError(\n\t\t\t\t`No knowledge about abstract role '${role}'. This is likely a bug :(`\n\t\t\t);\n\t}\n}\n\n/**\n * element.querySelectorAll but also considers owned tree\n * @param element\n * @param selectors\n */\nfunction querySelectorAllSubtree(\n\telement: Element,\n\tselectors: string\n): Element[] {\n\tconst elements = ArrayFrom(element.querySelectorAll(selectors));\n\n\tqueryIdRefs(element, \"aria-owns\").forEach((root) => {\n\t\t// babel transpiles this assuming an iterator\n\t\telements.push.apply(elements, ArrayFrom(root.querySelectorAll(selectors)));\n\t});\n\n\treturn elements;\n}\n\nfunction querySelectedOptions(listbox: Element): ArrayLike<Element> {\n\tif (isHTMLSelectElement(listbox)) {\n\t\t// IE11 polyfill\n\t\treturn (\n\t\t\tlistbox.selectedOptions || querySelectorAllSubtree(listbox, \"[selected]\")\n\t\t);\n\t}\n\treturn querySelectorAllSubtree(listbox, '[aria-selected=\"true\"]');\n}\n\nfunction isMarkedPresentational(node: Node): node is Element {\n\treturn hasAnyConcreteRoles(node, [\"none\", \"presentation\"]);\n}\n\n/**\n * Elements specifically listed in html-aam\n *\n * We don't need this for `label` or `legend` elements.\n * Their implicit roles already allow \"naming from content\".\n *\n * sources:\n *\n * - https://w3c.github.io/html-aam/#table-element\n */\nfunction isNativeHostLanguageTextAlternativeElement(\n\tnode: Node\n): node is Element {\n\treturn isHTMLTableCaptionElement(node);\n}\n\n/**\n * https://w3c.github.io/aria/#namefromcontent\n */\nfunction allowsNameFromContent(node: Node): boolean {\n\treturn hasAnyConcreteRoles(node, [\n\t\t\"button\",\n\t\t\"cell\",\n\t\t\"checkbox\",\n\t\t\"columnheader\",\n\t\t\"gridcell\",\n\t\t\"heading\",\n\t\t\"label\",\n\t\t\"legend\",\n\t\t\"link\",\n\t\t\"menuitem\",\n\t\t\"menuitemcheckbox\",\n\t\t\"menuitemradio\",\n\t\t\"option\",\n\t\t\"radio\",\n\t\t\"row\",\n\t\t\"rowheader\",\n\t\t\"switch\",\n\t\t\"tab\",\n\t\t\"tooltip\",\n\t\t\"treeitem\",\n\t]);\n}\n\n/**\n * TODO https://github.com/eps1lon/dom-accessibility-api/issues/100\n */\nfunction isDescendantOfNativeHostLanguageTextAlternativeElement(\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars -- not implemented yet\n\tnode: Node\n): boolean {\n\treturn false;\n}\n\n/**\n * TODO https://github.com/eps1lon/dom-accessibility-api/issues/101\n */\n// eslint-disable-next-line @typescript-eslint/no-unused-vars -- not implemented yet\nfunction computeTooltipAttributeValue(node: Node): string | null {\n\treturn null;\n}\n\nfunction getValueOfTextbox(element: Element): string {\n\tif (isHTMLInputElement(element) || isHTMLTextAreaElement(element)) {\n\t\treturn element.value;\n\t}\n\t// https://github.com/eps1lon/dom-accessibility-api/issues/4\n\treturn element.textContent || \"\";\n}\n\nfunction getTextualContent(declaration: CSSStyleDeclaration): string {\n\tconst content = declaration.getPropertyValue(\"content\");\n\tif (/^[\"'].*[\"']$/.test(content)) {\n\t\treturn content.slice(1, -1);\n\t}\n\treturn \"\";\n}\n\n/**\n * https://html.spec.whatwg.org/multipage/forms.html#category-label\n * TODO: form-associated custom elements\n * @param element\n */\nfunction isLabelableElement(element: Element): boolean {\n\tconst localName = getLocalName(element);\n\n\treturn (\n\t\tlocalName === \"button\" ||\n\t\t(localName === \"input\" && element.getAttribute(\"type\") !== \"hidden\") ||\n\t\tlocalName === \"meter\" ||\n\t\tlocalName === \"output\" ||\n\t\tlocalName === \"progress\" ||\n\t\tlocalName === \"select\" ||\n\t\tlocalName === \"textarea\"\n\t);\n}\n\n/**\n * > [...], then the first such descendant in tree order is the label element's labeled control.\n * -- https://html.spec.whatwg.org/multipage/forms.html#labeled-control\n * @param element\n */\nfunction findLabelableElement(element: Element): Element | null {\n\tif (isLabelableElement(element)) {\n\t\treturn element;\n\t}\n\tlet labelableElement: Element | null = null;\n\telement.childNodes.forEach((childNode) => {\n\t\tif (labelableElement === null && isElement(childNode)) {\n\t\t\tconst descendantLabelableElement = findLabelableElement(childNode);\n\t\t\tif (descendantLabelableElement !== null) {\n\t\t\t\tlabelableElement = descendantLabelableElement;\n\t\t\t}\n\t\t}\n\t});\n\n\treturn labelableElement;\n}\n\n/**\n * Polyfill of HTMLLabelElement.control\n * https://html.spec.whatwg.org/multipage/forms.html#labeled-control\n * @param label\n */\nfunction getControlOfLabel(label: HTMLLabelElement): Element | null {\n\tif (label.control !== undefined) {\n\t\treturn label.control;\n\t}\n\n\tconst htmlFor = label.getAttribute(\"for\");\n\tif (htmlFor !== null) {\n\t\treturn label.ownerDocument.getElementById(htmlFor);\n\t}\n\n\treturn findLabelableElement(label);\n}\n\n/**\n * Polyfill of HTMLInputElement.labels\n * https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement/labels\n * @param element\n */\nfunction getLabels(element: Element): HTMLLabelElement[] | null {\n\tconst labelsProperty = (element as any).labels as\n\t\t| undefined\n\t\t| null\n\t\t| NodeListOf<HTMLLabelElement>;\n\tif (labelsProperty === null) {\n\t\treturn labelsProperty;\n\t}\n\tif (labelsProperty !== undefined) {\n\t\treturn ArrayFrom(labelsProperty);\n\t}\n\n\t// polyfill\n\tif (!isLabelableElement(element)) {\n\t\treturn null;\n\t}\n\tconst document = element.ownerDocument;\n\n\treturn ArrayFrom(document.querySelectorAll(\"label\")).filter((label) => {\n\t\treturn getControlOfLabel(label) === element;\n\t});\n}\n\n/**\n * Gets the contents of a slot used for computing the accname\n * @param slot\n */\nfunction getSlotContents(slot: HTMLSlotElement): Node[] {\n\t// Computing the accessible name for elements containing slots is not\n\t// currently defined in the spec. This implementation reflects the\n\t// behavior of NVDA 2020.2/Firefox 81 and iOS VoiceOver/Safari 13.6.\n\tconst assignedNodes = slot.assignedNodes();\n\tif (assignedNodes.length === 0) {\n\t\t// if no nodes are assigned to the slot, it displays the default content\n\t\treturn ArrayFrom(slot.childNodes);\n\t}\n\treturn assignedNodes;\n}\n\n/**\n * implements https://w3c.github.io/accname/#mapping_additional_nd_te\n * @param root\n * @param [options]\n * @param [options.getComputedStyle] - mock window.getComputedStyle. Needs `content`, `display` and `visibility`\n */\nexport function computeTextAlternative(\n\troot: Element,\n\toptions: ComputeTextAlternativeOptions = {}\n): string {\n\tconst consultedNodes = new SetLike<Node>();\n\n\tconst window = safeWindow(root);\n\tconst {\n\t\tcompute = \"name\",\n\t\tcomputedStyleSupportsPseudoElements = options.getComputedStyle !==\n\t\t\tundefined,\n\t\t// This might be overengineered. I don't know what happens if I call\n\t\t// window.getComputedStyle(elementFromAnotherWindow) or if I don't bind it\n\t\t// the type declarations don't require a `this`\n\t\t// eslint-disable-next-line no-restricted-properties\n\t\tgetComputedStyle = window.getComputedStyle.bind(window),\n\t} = options;\n\n\t// 2F.i\n\tfunction computeMiscTextAlternative(\n\t\tnode: Node,\n\t\tcontext: { isEmbeddedInLabel: boolean; isReferenced: boolean }\n\t): string {\n\t\tlet accumulatedText = \"\";\n\t\tif (isElement(node) && computedStyleSupportsPseudoElements) {\n\t\t\tconst pseudoBefore = getComputedStyle(node, \"::before\");\n\t\t\tconst beforeContent = getTextualContent(pseudoBefore);\n\t\t\taccumulatedText = `${beforeContent} ${accumulatedText}`;\n\t\t}\n\n\t\t// FIXME: Including aria-owns is not defined in the spec\n\t\t// But it is required in the web-platform-test\n\t\tconst childNodes = isHTMLSlotElement(node)\n\t\t\t? getSlotContents(node)\n\t\t\t: ArrayFrom(node.childNodes).concat(queryIdRefs(node, \"aria-owns\"));\n\t\tchildNodes.forEach((child) => {\n\t\t\tconst result = computeTextAlternative(child, {\n\t\t\t\tisEmbeddedInLabel: context.isEmbeddedInLabel,\n\t\t\t\tisReferenced: false,\n\t\t\t\trecursion: true,\n\t\t\t});\n\t\t\t// TODO: Unclear why display affects delimiter\n\t\t\t// see https://github.com/w3c/accname/issues/3\n\t\t\tconst display = isElement(child)\n\t\t\t\t? getComputedStyle(child).getPropertyValue(\"display\")\n\t\t\t\t: \"inline\";\n\t\t\tconst separator = display !== \"inline\" ? \" \" : \"\";\n\t\t\t// trailing separator for wpt tests\n\t\t\taccumulatedText += `${separator}${result}${separator}`;\n\t\t});\n\n\t\tif (isElement(node) && computedStyleSupportsPseudoElements) {\n\t\t\tconst pseudoAfter = getComputedStyle(node, \"::after\");\n\t\t\tconst afterContent = getTextualContent(pseudoAfter);\n\t\t\taccumulatedText = `${accumulatedText} ${afterContent}`;\n\t\t}\n\n\t\treturn accumulatedText;\n\t}\n\n\tfunction computeElementTextAlternative(node: Node): string | null {\n\t\tif (!isElement(node)) {\n\t\t\treturn null;\n\t\t}\n\n\t\t/**\n\t\t *\n\t\t * @param element\n\t\t * @param attributeName\n\t\t * @returns A string non-empty string or `null`\n\t\t */\n\t\tfunction useAttribute(\n\t\t\telement: Element,\n\t\t\tattributeName: string\n\t\t): string | null {\n\t\t\tconst attribute = element.getAttributeNode(attributeName);\n\t\t\tif (\n\t\t\t\tattribute !== null &&\n\t\t\t\t!consultedNodes.has(attribute) &&\n\t\t\t\tattribute.value.trim() !== \"\"\n\t\t\t) {\n\t\t\t\tconsultedNodes.add(attribute);\n\t\t\t\treturn attribute.value;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\t// https://w3c.github.io/html-aam/#fieldset-and-legend-elements\n\t\tif (isHTMLFieldSetElement(node)) {\n\t\t\tconsultedNodes.add(node);\n\t\t\tconst children = ArrayFrom(node.childNodes);\n\t\t\tfor (let i = 0; i < children.length; i += 1) {\n\t\t\t\tconst child = children[i];\n\t\t\t\tif (isHTMLLegendElement(child)) {\n\t\t\t\t\treturn computeTextAlternative(child, {\n\t\t\t\t\t\tisEmbeddedInLabel: false,\n\t\t\t\t\t\tisReferenced: false,\n\t\t\t\t\t\trecursion: false,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (isHTMLTableElement(node)) {\n\t\t\t// https://w3c.github.io/html-aam/#table-element\n\t\t\tconsultedNodes.add(node);\n\t\t\tconst children = ArrayFrom(node.childNodes);\n\t\t\tfor (let i = 0; i < children.length; i += 1) {\n\t\t\t\tconst child = children[i];\n\t\t\t\tif (isHTMLTableCaptionElement(child)) {\n\t\t\t\t\treturn computeTextAlternative(child, {\n\t\t\t\t\t\tisEmbeddedInLabel: false,\n\t\t\t\t\t\tisReferenced: false,\n\t\t\t\t\t\trecursion: false,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (isSVGSVGElement(node)) {\n\t\t\t// https://www.w3.org/TR/svg-aam-1.0/\n\t\t\tconsultedNodes.add(node);\n\t\t\tconst children = ArrayFrom(node.childNodes);\n\t\t\tfor (let i = 0; i < children.length; i += 1) {\n\t\t\t\tconst child = children[i];\n\t\t\t\tif (isSVGTitleElement(child)) {\n\t\t\t\t\treturn child.textContent;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t} else if (getLocalName(node) === \"img\" || getLocalName(node) === \"area\") {\n\t\t\t// https://w3c.github.io/html-aam/#area-element\n\t\t\t// https://w3c.github.io/html-aam/#img-element\n\t\t\tconst nameFromAlt = useAttribute(node, \"alt\");\n\t\t\tif (nameFromAlt !== null) {\n\t\t\t\treturn nameFromAlt;\n\t\t\t}\n\t\t} else if (isHTMLOptGroupElement(node)) {\n\t\t\tconst nameFromLabel = useAttribute(node, \"label\");\n\t\t\tif (nameFromLabel !== null) {\n\t\t\t\treturn nameFromLabel;\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tisHTMLInputElement(node) &&\n\t\t\t(node.type === \"button\" ||\n\t\t\t\tnode.type === \"submit\" ||\n\t\t\t\tnode.type === \"reset\")\n\t\t) {\n\t\t\t// https://w3c.github.io/html-aam/#input-type-text-input-type-password-input-type-search-input-type-tel-input-type-email-input-type-url-and-textarea-element-accessible-description-computation\n\t\t\tconst nameFromValue = useAttribute(node, \"value\");\n\t\t\tif (nameFromValue !== null) {\n\t\t\t\treturn nameFromValue;\n\t\t\t}\n\n\t\t\t// TODO: l10n\n\t\t\tif (node.type === \"submit\") {\n\t\t\t\treturn \"Submit\";\n\t\t\t}\n\t\t\t// TODO: l10n\n\t\t\tif (node.type === \"reset\") {\n\t\t\t\treturn \"Reset\";\n\t\t\t}\n\t\t}\n\n\t\tconst labels = getLabels(node);\n\t\tif (labels !== null && labels.length !== 0) {\n\t\t\tconsultedNodes.add(node);\n\t\t\treturn ArrayFrom(labels)\n\t\t\t\t.map((element) => {\n\t\t\t\t\treturn computeTextAlternative(element, {\n\t\t\t\t\t\tisEmbeddedInLabel: true,\n\t\t\t\t\t\tisReferenced: false,\n\t\t\t\t\t\trecursion: true,\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.filter((label) => {\n\t\t\t\t\treturn label.length > 0;\n\t\t\t\t})\n\t\t\t\t.join(\" \");\n\t\t}\n\n\t\t// https://w3c.github.io/html-aam/#input-type-image-accessible-name-computation\n\t\t// TODO: wpt test consider label elements but html-aam does not mention them\n\t\t// We follow existing implementations over spec\n\t\tif (isHTMLInputElement(node) && node.type === \"image\") {\n\t\t\tconst nameFromAlt = useAttribute(node, \"alt\");\n\t\t\tif (nameFromAlt !== null) {\n\t\t\t\treturn nameFromAlt;\n\t\t\t}\n\n\t\t\tconst nameFromTitle = useAttribute(node, \"title\");\n\t\t\tif (nameFromTitle !== null) {\n\t\t\t\treturn nameFromTitle;\n\t\t\t}\n\n\t\t\t// TODO: l10n\n\t\t\treturn \"Submit Query\";\n\t\t}\n\n\t\treturn useAttribute(node, \"title\");\n\t}\n\n\tfunction computeTextAlternative(\n\t\tcurrent: Node,\n\t\tcontext: {\n\t\t\tisEmbeddedInLabel: boolean;\n\t\t\tisReferenced: boolean;\n\t\t\trecursion: boolean;\n\t\t}\n\t): string {\n\t\tif (consultedNodes.has(current)) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\t// special casing, cheating to make tests pass\n\t\t// https://github.com/w3c/accname/issues/67\n\t\tif (hasAnyConcreteRoles(current, [\"menu\"])) {\n\t\t\tconsultedNodes.add(current);\n\t\t\treturn \"\";\n\t\t}\n\n\t\t// 2A\n\t\tif (isHidden(current, getComputedStyle) && !context.isReferenced) {\n\t\t\tconsultedNodes.add(current);\n\t\t\treturn \"\" as FlatString;\n\t\t}\n\n\t\t// 2B\n\t\tconst labelElements = queryIdRefs(current, \"aria-labelledby\");\n\t\tif (\n\t\t\tcompute === \"name\" &&\n\t\t\t!context.isReferenced &&\n\t\t\tlabelElements.length > 0\n\t\t) {\n\t\t\treturn labelElements\n\t\t\t\t.map((element) =>\n\t\t\t\t\tcomputeTextAlternative(element, {\n\t\t\t\t\t\tisEmbeddedInLabel: context.isEmbeddedInLabel,\n\t\t\t\t\t\tisReferenced: true,\n\t\t\t\t\t\t// thais isn't recursion as specified, otherwise we would skip\n\t\t\t\t\t\t// `aria-label` in\n\t\t\t\t\t\t// <input id=\"myself\" aria-label=\"foo\" aria-labelledby=\"myself\"\n\t\t\t\t\t\trecursion: false,\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t.join(\" \");\n\t\t}\n\n\t\t// 2C\n\t\t// Changed from the spec in anticipation of https://github.com/w3c/accname/issues/64\n\t\t// spec says we should only consider skipping if we have a non-empty label\n\t\tconst skipToStep2E =\n\t\t\tcontext.recursion && isControl(current) && compute === \"name\";\n\t\tif (!skipToStep2E) {\n\t\t\tconst ariaLabel = (\n\t\t\t\t(isElement(current) && current.getAttribute(\"aria-label\")) ||\n\t\t\t\t\"\"\n\t\t\t).trim();\n\t\t\tif (ariaLabel !== \"\" && compute === \"name\") {\n\t\t\t\tconsultedNodes.add(current);\n\t\t\t\treturn ariaLabel;\n\t\t\t}\n\n\t\t\t// 2D\n\t\t\tif (!isMarkedPresentational(current)) {\n\t\t\t\tconst elementTextAlternative = computeElementTextAlternative(current);\n\t\t\t\tif (elementTextAlternative !== null) {\n\t\t\t\t\tconsultedNodes.add(current);\n\t\t\t\t\treturn elementTextAlternative;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// 2E\n\t\tif (skipToStep2E || context.isEmbeddedInLabel || context.isReferenced) {\n\t\t\tif (hasAnyConcreteRoles(current, [\"combobox\", \"listbox\"])) {\n\t\t\t\tconsultedNodes.add(current);\n\t\t\t\tconst selectedOptions = querySelectedOptions(current);\n\t\t\t\tif (selectedOptions.length === 0) {\n\t\t\t\t\t// defined per test `name_heading_combobox`\n\t\t\t\t\treturn isHTMLInputElement(current) ? current.value : \"\";\n\t\t\t\t}\n\t\t\t\treturn ArrayFrom(selectedOptions)\n\t\t\t\t\t.map((selectedOption) => {\n\t\t\t\t\t\treturn computeTextAlternative(selectedOption, {\n\t\t\t\t\t\t\tisEmbeddedInLabel: context.isEmbeddedInLabel,\n\t\t\t\t\t\t\tisReferenced: false,\n\t\t\t\t\t\t\trecursion: true,\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.join(\" \");\n\t\t\t}\n\t\t\tif (hasAbstractRole(current, \"range\")) {\n\t\t\t\tconsultedNodes.add(current);\n\t\t\t\tif (current.hasAttribute(\"aria-valuetext\")) {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- safe due to hasAttribute guard\n\t\t\t\t\treturn current.getAttribute(\"aria-valuetext\")!;\n\t\t\t\t}\n\t\t\t\tif (current.hasAttribute(\"aria-valuenow\")) {\n\t\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- safe due to hasAttribute guard\n\t\t\t\t\treturn current.getAttribute(\"aria-valuenow\")!;\n\t\t\t\t}\n\t\t\t\t// Otherwise, use the value as specified by a host language attribute.\n\t\t\t\treturn current.getAttribute(\"value\") || \"\";\n\t\t\t}\n\t\t\tif (hasAnyConcreteRoles(current, [\"textbox\"])) {\n\t\t\t\tconsultedNodes.add(current);\n\t\t\t\treturn getValueOfTextbox(current);\n\t\t\t}\n\t\t}\n\n\t\t// 2F: https://w3c.github.io/accname/#step2F\n\t\tif (\n\t\t\tallowsNameFromContent(current) ||\n\t\t\t(isElement(current) && context.isReferenced) ||\n\t\t\tisNativeHostLanguageTextAlternativeElement(current) ||\n\t\t\tisDescendantOfNativeHostLanguageTextAlternativeElement(current)\n\t\t) {\n\t\t\tconsultedNodes.add(current);\n\t\t\treturn computeMiscTextAlternative(current, {\n\t\t\t\tisEmbeddedInLabel: context.isEmbeddedInLabel,\n\t\t\t\tisReferenced: false,\n\t\t\t});\n\t\t}\n\n\t\tif (current.nodeType === current.TEXT_NODE) {\n\t\t\tconsultedNodes.add(current);\n\t\t\treturn current.textContent || \"\";\n\t\t}\n\n\t\tif (context.recursion) {\n\t\t\tconsultedNodes.add(current);\n\t\t\treturn computeMiscTextAlternative(current, {\n\t\t\t\tisEmbeddedInLabel: context.isEmbeddedInLabel,\n\t\t\t\tisReferenced: false,\n\t\t\t});\n\t\t}\n\n\t\tconst tooltipAttributeValue = computeTooltipAttributeValue(current);\n\t\tif (tooltipAttributeValue !== null) {\n\t\t\tconsultedNodes.add(current);\n\t\t\treturn tooltipAttributeValue;\n\t\t}\n\n\t\t// TODO should this be reachable?\n\t\tconsultedNodes.add(current);\n\t\treturn \"\";\n\t}\n\n\treturn asFlatString(\n\t\tcomputeTextAlternative(root, {\n\t\t\tisEmbeddedInLabel: false,\n\t\t\t// by spec computeAccessibleDescription starts with the referenced elements as roots\n\t\t\tisReferenced: compute === \"description\",\n\t\t\trecursion: false,\n\t\t})\n\t);\n}\n"]}