518f48d0a5848b9a02f6f4b86317801d
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var debug = require('debug')('nock.common');

var set = require('lodash.set');

var timers = require('timers');

var url = require('url');

var util = require('util');

function normalizeRequestOptions(options) {
  options.proto = options.proto || 'http';
  options.port = options.port || (options.proto === 'http' ? 80 : 443);

  if (options.host) {
    debug('options.host:', options.host);

    if (!options.hostname) {
      if (options.host.split(':').length === 2) {
        options.hostname = options.host.split(':')[0];
      } else {
        options.hostname = options.host;
      }
    }
  }

  debug('options.hostname in the end: %j', options.hostname);
  options.host = (options.hostname || 'localhost') + ":" + options.port;
  debug('options.host in the end: %j', options.host);
  ['hostname', 'host'].forEach(function (attr) {
    if (options[attr]) {
      options[attr] = options[attr].toLowerCase();
    }
  });
  return options;
}

function isUtf8Representable(buffer) {
  var utfEncodedBuffer = buffer.toString('utf8');
  var reconstructedBuffer = Buffer.from(utfEncodedBuffer, 'utf8');
  return reconstructedBuffer.equals(buffer);
}

var requestOverrides = {};

function overrideRequests(newRequest) {
  debug('overriding requests');
  ['http', 'https'].forEach(function (proto) {
    debug('- overriding request for', proto);
    var moduleName = proto;
    var module = {
      http: require('http'),
      https: require('https')
    }[moduleName];
    var overriddenRequest = module.request;
    var overriddenGet = module.get;

    if (requestOverrides[moduleName]) {
      throw new Error("Module's request already overridden for " + moduleName + " protocol.");
    }

    requestOverrides[moduleName] = {
      module: module,
      request: overriddenRequest,
      get: overriddenGet
    };

    module.request = function (input, options, callback) {
      return newRequest(proto, overriddenRequest.bind(module), [input, options, callback]);
    };

    module.get = function (input, options, callback) {
      var req = newRequest(proto, overriddenGet.bind(module), [input, options, callback]);
      req.end();
      return req;
    };

    debug('- overridden request for', proto);
  });
}

function restoreOverriddenRequests() {
  debug('restoring requests');
  Object.entries(requestOverrides).forEach(function (_ref) {
    var _ref2 = (0, _slicedToArray2.default)(_ref, 2),
        proto = _ref2[0],
        _ref2$ = _ref2[1],
        module = _ref2$.module,
        request = _ref2$.request,
        get = _ref2$.get;

    debug('- restoring request for', proto);
    module.request = request;
    module.get = get;
    debug('- restored request for', proto);
  });
  requestOverrides = {};
}

function normalizeOrigin(proto, host, port) {
  var hostHasPort = host.includes(':');
  var portIsStandard = proto === 'http' && (port === 80 || port === '80') || proto === 'https' && (port === 443 || port === '443');
  var portStr = hostHasPort || portIsStandard ? '' : ":" + port;
  return proto + "://" + host + portStr;
}

function stringifyRequest(options, body) {
  var _options$method = options.method,
      method = _options$method === void 0 ? 'GET' : _options$method,
      _options$path = options.path,
      path = _options$path === void 0 ? '' : _options$path,
      port = options.port;
  var origin = normalizeOrigin(options.proto, options.hostname, port);
  var log = {
    method: method,
    url: "" + origin + path,
    headers: options.headers
  };

  if (body) {
    log.body = body;
  }

  return JSON.stringify(log, null, 2);
}

function isContentEncoded(headers) {
  var contentEncoding = headers['content-encoding'];
  return typeof contentEncoding === 'string' && contentEncoding !== '';
}

function contentEncoding(headers, encoder) {
  var contentEncoding = headers['content-encoding'];
  return contentEncoding !== undefined && contentEncoding.toString() === encoder;
}

function isJSONContent(headers) {
  var contentType = String(headers['content-type'] || '').toLowerCase();
  return contentType.startsWith('application/json');
}

function headersFieldNamesToLowerCase(headers) {
  if (!isPlainObject(headers)) {
    throw Error('Headers must be provided as an object');
  }

  var lowerCaseHeaders = {};
  Object.entries(headers).forEach(function (_ref3) {
    var _ref4 = (0, _slicedToArray2.default)(_ref3, 2),
        fieldName = _ref4[0],
        fieldValue = _ref4[1];

    var key = fieldName.toLowerCase();

    if (lowerCaseHeaders[key] !== undefined) {
      throw Error("Failed to convert header keys to lower case due to field name conflict: " + key);
    }

    lowerCaseHeaders[key] = fieldValue;
  });
  return lowerCaseHeaders;
}

var headersFieldsArrayToLowerCase = function headersFieldsArrayToLowerCase(headers) {
  return (0, _toConsumableArray2.default)(new Set(headers.map(function (fieldName) {
    return fieldName.toLowerCase();
  })));
};

function headersInputToRawArray(headers) {
  if (headers === undefined) {
    return [];
  }

  if (Array.isArray(headers)) {
    if (headers.length % 2) {
      throw new Error("Raw headers must be provided as an array with an even number of items. [fieldName, value, ...]");
    }

    return (0, _toConsumableArray2.default)(headers);
  }

  if (util.types.isMap(headers)) {
    var _ref5;

    return (_ref5 = []).concat.apply(_ref5, (0, _toConsumableArray2.default)(Array.from(headers, function (_ref6) {
      var _ref7 = (0, _slicedToArray2.default)(_ref6, 2),
          k = _ref7[0],
          v = _ref7[1];

      return [k.toString(), v];
    })));
  }

  if (isPlainObject(headers)) {
    var _ref8;

    return (_ref8 = []).concat.apply(_ref8, (0, _toConsumableArray2.default)(Object.entries(headers)));
  }

  throw new Error("Headers must be provided as an array of raw values, a Map, or a plain Object. " + headers);
}

function headersArrayToObject(rawHeaders) {
  if (!Array.isArray(rawHeaders)) {
    throw Error('Expected a header array');
  }

  var accumulator = {};
  forEachHeader(rawHeaders, function (value, fieldName) {
    addHeaderLine(accumulator, fieldName, value);
  });
  return accumulator;
}

var noDuplicatesHeaders = new Set(['age', 'authorization', 'content-length', 'content-type', 'etag', 'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since', 'last-modified', 'location', 'max-forwards', 'proxy-authorization', 'referer', 'retry-after', 'user-agent']);

function addHeaderLine(headers, name, value) {
  var values;

  if (typeof value === 'function') {
    values = [value.name];
  } else if (Array.isArray(value)) {
    values = value.map(String);
  } else {
    values = [String(value)];
  }

  var key = name.toLowerCase();

  if (key === 'set-cookie') {
    if (headers['set-cookie'] === undefined) {
      headers['set-cookie'] = values;
    } else {
      var _headers$setCookie;

      (_headers$setCookie = headers['set-cookie']).push.apply(_headers$setCookie, (0, _toConsumableArray2.default)(values));
    }
  } else if (noDuplicatesHeaders.has(key)) {
    if (headers[key] === undefined) {
      headers[key] = values[0];
    }
  } else {
    if (headers[key] !== undefined) {
      values = [headers[key]].concat((0, _toConsumableArray2.default)(values));
    }

    var separator = key === 'cookie' ? '; ' : ', ';
    headers[key] = values.join(separator);
  }
}

function deleteHeadersField(headers, fieldNameToDelete) {
  if (!isPlainObject(headers)) {
    throw Error('headers must be an object');
  }

  if (typeof fieldNameToDelete !== 'string') {
    throw Error('field name must be a string');
  }

  var lowerCaseFieldNameToDelete = fieldNameToDelete.toLowerCase();
  Object.keys(headers).filter(function (fieldName) {
    return fieldName.toLowerCase() === lowerCaseFieldNameToDelete;
  }).forEach(function (fieldName) {
    return delete headers[fieldName];
  });
}

function forEachHeader(rawHeaders, callback) {
  for (var i = 0; i < rawHeaders.length; i += 2) {
    callback(rawHeaders[i + 1], rawHeaders[i], i);
  }
}

function percentDecode(str) {
  try {
    return decodeURIComponent(str.replace(/\+/g, ' '));
  } catch (e) {
    return str;
  }
}

function percentEncode(str) {
  return encodeURIComponent(str).replace(/[!'()*]/g, function (c) {
    return "%" + c.charCodeAt(0).toString(16).toUpperCase();
  });
}

function matchStringOrRegexp(target, pattern) {
  var targetStr = target === undefined || target === null ? '' : String(target);

  if (pattern instanceof RegExp) {
    pattern.lastIndex = 0;
    return pattern.test(targetStr);
  }

  return targetStr === String(pattern);
}

function formatQueryValue(key, value, stringFormattingFn) {
  switch (true) {
    case typeof value === 'number':
    case typeof value === 'boolean':
      value = value.toString();
      break;

    case value === null:
    case value === undefined:
      value = '';
      break;

    case typeof value === 'string':
      if (stringFormattingFn) {
        value = stringFormattingFn(value);
      }

      break;

    case value instanceof RegExp:
      break;

    case Array.isArray(value):
      {
        value = value.map(function (val, idx) {
          return formatQueryValue(idx, val, stringFormattingFn)[1];
        });
        break;
      }

    case typeof value === 'object':
      {
        value = Object.entries(value).reduce(function (acc, _ref9) {
          var _ref10 = (0, _slicedToArray2.default)(_ref9, 2),
              subKey = _ref10[0],
              subVal = _ref10[1];

          var subPair = formatQueryValue(subKey, subVal, stringFormattingFn);
          acc[subPair[0]] = subPair[1];
          return acc;
        }, {});
        break;
      }
  }

  if (stringFormattingFn) key = stringFormattingFn(key);
  return [key, value];
}

function isStream(obj) {
  return obj && typeof obj !== 'string' && !Buffer.isBuffer(obj) && typeof obj.setEncoding === 'function';
}

function normalizeClientRequestArgs(input, options, cb) {
  if (typeof input === 'string') {
    input = urlToOptions(new url.URL(input));
  } else if (input instanceof url.URL) {
    input = urlToOptions(input);
  } else {
    cb = options;
    options = input;
    input = null;
  }

  if (typeof options === 'function') {
    cb = options;
    options = input || {};
  } else {
    options = (0, _extends2.default)(input || {}, options);
  }

  return {
    options: options,
    callback: cb
  };
}

function urlToOptions(url) {
  var options = {
    protocol: url.protocol,
    hostname: typeof url.hostname === 'string' && url.hostname.startsWith('[') ? url.hostname.slice(1, -1) : url.hostname,
    hash: url.hash,
    search: url.search,
    pathname: url.pathname,
    path: "" + url.pathname + (url.search || ''),
    href: url.href
  };

  if (url.port !== '') {
    options.port = Number(url.port);
  }

  if (url.username || url.password) {
    options.auth = url.username + ":" + url.password;
  }

  return options;
}

var dataEqual = function dataEqual(expected, actual) {
  if (isPlainObject(expected)) {
    expected = expand(expected);
  }

  if (isPlainObject(actual)) {
    actual = expand(actual);
  }

  return deepEqual(expected, actual);
};

var expand = function expand(input) {
  return Object.entries(input).reduce(function (acc, _ref11) {
    var _ref12 = (0, _slicedToArray2.default)(_ref11, 2),
        k = _ref12[0],
        v = _ref12[1];

    return set(acc, k, v);
  }, {});
};

function deepEqual(expected, actual) {
  debug('deepEqual comparing', typeof expected, expected, typeof actual, actual);

  if (expected instanceof RegExp) {
    return expected.test(actual);
  }

  if (Array.isArray(expected) && Array.isArray(actual)) {
    if (expected.length !== actual.length) {
      return false;
    }

    return expected.every(function (expVal, idx) {
      return deepEqual(expVal, actual[idx]);
    });
  }

  if (isPlainObject(expected) && isPlainObject(actual)) {
    var allKeys = Array.from(new Set(Object.keys(expected).concat(Object.keys(actual))));
    return allKeys.every(function (key) {
      return deepEqual(expected[key], actual[key]);
    });
  }

  return expected === actual;
}

function isPlainObject(value) {
  var isObjectLike = typeof value === 'object' && value !== null;
  var tag = Object.prototype.toString.call(value);

  if (!isObjectLike || tag !== '[object Object]') {
    return false;
  }

  if (Object.getPrototypeOf(value) === null) {
    return true;
  }

  var proto = value;

  while (Object.getPrototypeOf(proto) !== null) {
    proto = Object.getPrototypeOf(proto);
  }

  return Object.getPrototypeOf(value) === proto;
}

function mapValue(object, iteratee) {
  object = Object(object);
  var result = {};
  Object.keys(object).forEach(function (key) {
    result[key] = iteratee(object[key], key, object);
  });
  return result;
}

var timeouts = [];
var intervals = [];
var immediates = [];

var wrapTimer = function wrapTimer(timer, ids) {
  return function () {
    var id = timer.apply(void 0, arguments);
    ids.push(id);
    return id;
  };
};

var setTimeout = wrapTimer(timers.setTimeout, timeouts);
var setInterval = wrapTimer(timers.setInterval, intervals);
var setImmediate = wrapTimer(timers.setImmediate, immediates);

function clearTimer(clear, ids) {
  while (ids.length) {
    clear(ids.shift());
  }
}

function removeAllTimers() {
  clearTimer(clearTimeout, timeouts);
  clearTimer(clearInterval, intervals);
  clearTimer(clearImmediate, immediates);
}

function isRequestDestroyed(req) {
  return !!(req.destroyed === true || req.aborted || req.socket && req.socket.destroyed);
}

module.exports = {
  contentEncoding: contentEncoding,
  dataEqual: dataEqual,
  deleteHeadersField: deleteHeadersField,
  forEachHeader: forEachHeader,
  formatQueryValue: formatQueryValue,
  headersArrayToObject: headersArrayToObject,
  headersFieldNamesToLowerCase: headersFieldNamesToLowerCase,
  headersFieldsArrayToLowerCase: headersFieldsArrayToLowerCase,
  headersInputToRawArray: headersInputToRawArray,
  isContentEncoded: isContentEncoded,
  isJSONContent: isJSONContent,
  isPlainObject: isPlainObject,
  isRequestDestroyed: isRequestDestroyed,
  isStream: isStream,
  isUtf8Representable: isUtf8Representable,
  mapValue: mapValue,
  matchStringOrRegexp: matchStringOrRegexp,
  normalizeClientRequestArgs: normalizeClientRequestArgs,
  normalizeOrigin: normalizeOrigin,
  normalizeRequestOptions: normalizeRequestOptions,
  overrideRequests: overrideRequests,
  percentDecode: percentDecode,
  percentEncode: percentEncode,
  removeAllTimers: removeAllTimers,
  restoreOverriddenRequests: restoreOverriddenRequests,
  setImmediate: setImmediate,
  setInterval: setInterval,
  setTimeout: setTimeout,
  stringifyRequest: stringifyRequest
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1vbi5qcyJdLCJuYW1lcyI6WyJkZWJ1ZyIsInJlcXVpcmUiLCJzZXQiLCJ0aW1lcnMiLCJ1cmwiLCJ1dGlsIiwibm9ybWFsaXplUmVxdWVzdE9wdGlvbnMiLCJvcHRpb25zIiwicHJvdG8iLCJwb3J0IiwiaG9zdCIsImhvc3RuYW1lIiwic3BsaXQiLCJsZW5ndGgiLCJmb3JFYWNoIiwiYXR0ciIsInRvTG93ZXJDYXNlIiwiaXNVdGY4UmVwcmVzZW50YWJsZSIsImJ1ZmZlciIsInV0ZkVuY29kZWRCdWZmZXIiLCJ0b1N0cmluZyIsInJlY29uc3RydWN0ZWRCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiZXF1YWxzIiwicmVxdWVzdE92ZXJyaWRlcyIsIm92ZXJyaWRlUmVxdWVzdHMiLCJuZXdSZXF1ZXN0IiwibW9kdWxlTmFtZSIsIm1vZHVsZSIsImh0dHAiLCJodHRwcyIsIm92ZXJyaWRkZW5SZXF1ZXN0IiwicmVxdWVzdCIsIm92ZXJyaWRkZW5HZXQiLCJnZXQiLCJFcnJvciIsImlucHV0IiwiY2FsbGJhY2siLCJiaW5kIiwicmVxIiwiZW5kIiwicmVzdG9yZU92ZXJyaWRkZW5SZXF1ZXN0cyIsIk9iamVjdCIsImVudHJpZXMiLCJub3JtYWxpemVPcmlnaW4iLCJob3N0SGFzUG9ydCIsImluY2x1ZGVzIiwicG9ydElzU3RhbmRhcmQiLCJwb3J0U3RyIiwic3RyaW5naWZ5UmVxdWVzdCIsImJvZHkiLCJtZXRob2QiLCJwYXRoIiwib3JpZ2luIiwibG9nIiwiaGVhZGVycyIsIkpTT04iLCJzdHJpbmdpZnkiLCJpc0NvbnRlbnRFbmNvZGVkIiwiY29udGVudEVuY29kaW5nIiwiZW5jb2RlciIsInVuZGVmaW5lZCIsImlzSlNPTkNvbnRlbnQiLCJjb250ZW50VHlwZSIsIlN0cmluZyIsInN0YXJ0c1dpdGgiLCJoZWFkZXJzRmllbGROYW1lc1RvTG93ZXJDYXNlIiwiaXNQbGFpbk9iamVjdCIsImxvd2VyQ2FzZUhlYWRlcnMiLCJmaWVsZE5hbWUiLCJmaWVsZFZhbHVlIiwia2V5IiwiaGVhZGVyc0ZpZWxkc0FycmF5VG9Mb3dlckNhc2UiLCJTZXQiLCJtYXAiLCJoZWFkZXJzSW5wdXRUb1Jhd0FycmF5IiwiQXJyYXkiLCJpc0FycmF5IiwidHlwZXMiLCJpc01hcCIsImNvbmNhdCIsImsiLCJ2IiwiaGVhZGVyc0FycmF5VG9PYmplY3QiLCJyYXdIZWFkZXJzIiwiYWNjdW11bGF0b3IiLCJmb3JFYWNoSGVhZGVyIiwidmFsdWUiLCJhZGRIZWFkZXJMaW5lIiwibm9EdXBsaWNhdGVzSGVhZGVycyIsIm5hbWUiLCJ2YWx1ZXMiLCJwdXNoIiwiaGFzIiwic2VwYXJhdG9yIiwiam9pbiIsImRlbGV0ZUhlYWRlcnNGaWVsZCIsImZpZWxkTmFtZVRvRGVsZXRlIiwibG93ZXJDYXNlRmllbGROYW1lVG9EZWxldGUiLCJrZXlzIiwiZmlsdGVyIiwiaSIsInBlcmNlbnREZWNvZGUiLCJzdHIiLCJkZWNvZGVVUklDb21wb25lbnQiLCJyZXBsYWNlIiwiZSIsInBlcmNlbnRFbmNvZGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJjIiwiY2hhckNvZGVBdCIsInRvVXBwZXJDYXNlIiwibWF0Y2hTdHJpbmdPclJlZ2V4cCIsInRhcmdldCIsInBhdHRlcm4iLCJ0YXJnZXRTdHIiLCJSZWdFeHAiLCJsYXN0SW5kZXgiLCJ0ZXN0IiwiZm9ybWF0UXVlcnlWYWx1ZSIsInN0cmluZ0Zvcm1hdHRpbmdGbiIsInZhbCIsImlkeCIsInJlZHVjZSIsImFjYyIsInN1YktleSIsInN1YlZhbCIsInN1YlBhaXIiLCJpc1N0cmVhbSIsIm9iaiIsImlzQnVmZmVyIiwic2V0RW5jb2RpbmciLCJub3JtYWxpemVDbGllbnRSZXF1ZXN0QXJncyIsImNiIiwidXJsVG9PcHRpb25zIiwiVVJMIiwicHJvdG9jb2wiLCJzbGljZSIsImhhc2giLCJzZWFyY2giLCJwYXRobmFtZSIsImhyZWYiLCJOdW1iZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiYXV0aCIsImRhdGFFcXVhbCIsImV4cGVjdGVkIiwiYWN0dWFsIiwiZXhwYW5kIiwiZGVlcEVxdWFsIiwiZXZlcnkiLCJleHBWYWwiLCJhbGxLZXlzIiwiaXNPYmplY3RMaWtlIiwidGFnIiwicHJvdG90eXBlIiwiY2FsbCIsImdldFByb3RvdHlwZU9mIiwibWFwVmFsdWUiLCJvYmplY3QiLCJpdGVyYXRlZSIsInJlc3VsdCIsInRpbWVvdXRzIiwiaW50ZXJ2YWxzIiwiaW1tZWRpYXRlcyIsIndyYXBUaW1lciIsInRpbWVyIiwiaWRzIiwiaWQiLCJzZXRUaW1lb3V0Iiwic2V0SW50ZXJ2YWwiLCJzZXRJbW1lZGlhdGUiLCJjbGVhclRpbWVyIiwiY2xlYXIiLCJzaGlmdCIsInJlbW92ZUFsbFRpbWVycyIsImNsZWFyVGltZW91dCIsImNsZWFySW50ZXJ2YWwiLCJjbGVhckltbWVkaWF0ZSIsImlzUmVxdWVzdERlc3Ryb3llZCIsImRlc3Ryb3llZCIsImFib3J0ZWQiLCJzb2NrZXQiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7OztBQUVBLElBQU1BLEtBQUssR0FBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBUCxDQUFpQixhQUFqQixDQUFkOztBQUNBLElBQU1DLEdBQUcsR0FBR0QsT0FBTyxDQUFDLFlBQUQsQ0FBbkI7O0FBQ0EsSUFBTUUsTUFBTSxHQUFHRixPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFDQSxJQUFNRyxHQUFHLEdBQUdILE9BQU8sQ0FBQyxLQUFELENBQW5COztBQUNBLElBQU1JLElBQUksR0FBR0osT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBT0EsU0FBU0ssdUJBQVQsQ0FBaUNDLE9BQWpDLEVBQTBDO0FBQ3hDQSxFQUFBQSxPQUFPLENBQUNDLEtBQVIsR0FBZ0JELE9BQU8sQ0FBQ0MsS0FBUixJQUFpQixNQUFqQztBQUNBRCxFQUFBQSxPQUFPLENBQUNFLElBQVIsR0FBZUYsT0FBTyxDQUFDRSxJQUFSLEtBQWlCRixPQUFPLENBQUNDLEtBQVIsS0FBa0IsTUFBbEIsR0FBMkIsRUFBM0IsR0FBZ0MsR0FBakQsQ0FBZjs7QUFDQSxN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QUFBLGdCQUFnQixFQUFoQkEsZ0JBVmU7QUFXZkksRUFBQUEsYUFBYSxFQUFiQSxhQVhlO0FBWWZLLEVBQUFBLGFBQWEsRUFBYkEsYUFaZTtBQWFmaUgsRUFBQUEsa0JBQWtCLEVBQWxCQSxrQkFiZTtBQWNmcEQsRUFBQUEsUUFBUSxFQUFSQSxRQWRlO0FBZWZoSCxFQUFBQSxtQkFBbUIsRUFBbkJBLG1CQWZlO0FBZ0JmK0ksRUFBQUEsUUFBUSxFQUFSQSxRQWhCZTtBQWlCZi9DLEVBQUFBLG1CQUFtQixFQUFuQkEsbUJBakJlO0FBa0Jmb0IsRUFBQUEsMEJBQTBCLEVBQTFCQSwwQkFsQmU7QUFtQmZ4RixFQUFBQSxlQUFlLEVBQWZBLGVBbkJlO0FBb0JmdkMsRUFBQUEsdUJBQXVCLEVBQXZCQSx1QkFwQmU7QUFxQmZvQixFQUFBQSxnQkFBZ0IsRUFBaEJBLGdCQXJCZTtBQXNCZjZFLEVBQUFBLGFBQWEsRUFBYkEsYUF0QmU7QUF1QmZLLEVBQUFBLGFBQWEsRUFBYkEsYUF2QmU7QUF3QmZxRSxFQUFBQSxlQUFlLEVBQWZBLGVBeEJlO0FBeUJmdkksRUFBQUEseUJBQXlCLEVBQXpCQSx5QkF6QmU7QUEwQmZtSSxFQUFBQSxZQUFZLEVBQVpBLFlBMUJlO0FBMkJmRCxFQUFBQSxXQUFXLEVBQVhBLFdBM0JlO0FBNEJmRCxFQUFBQSxVQUFVLEVBQVZBLFVBNUJlO0FBNkJmekgsRUFBQUEsZ0JBQWdCLEVBQWhCQTtBQTdCZSxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5jb25zdCBkZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJykoJ25vY2suY29tbW9uJylcbmNvbnN0IHNldCA9IHJlcXVpcmUoJ2xvZGFzaC5zZXQnKVxuY29uc3QgdGltZXJzID0gcmVxdWlyZSgndGltZXJzJylcbmNvbnN0IHVybCA9IHJlcXVpcmUoJ3VybCcpXG5jb25zdCB1dGlsID0gcmVxdWlyZSgndXRpbCcpXG5cbi8qKlxuICogTm9ybWFsaXplcyB0aGUgcmVxdWVzdCBvcHRpb25zIHNvIHRoYXQgaXQgYWx3YXlzIGhhcyBgaG9zdGAgcHJvcGVydHkuXG4gKlxuICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zIC0gYSBwYXJzZWQgb3B0aW9ucyBvYmplY3Qgb2YgdGhlIHJlcXVlc3RcbiAqL1xuZnVuY3Rpb24gbm9ybWFsaXplUmVxdWVzdE9wdGlvbnMob3B0aW9ucykge1xuICBvcHRpb25zLnByb3RvID0gb3B0aW9ucy5wcm90byB8fCAnaHR0cCdcbiAgb3B0aW9ucy5wb3J0ID0gb3B0aW9ucy5wb3J0IHx8IChvcHRpb25zLnByb3RvID09PSAnaHR0cCcgPyA4MCA6IDQ0MylcbiAgaWYgKG9wdGlvbnMuaG9zdCkge1xuICAgIGRlYnVnKCdvcHRpb25zLmhvc3Q6Jywgb3B0aW9ucy5ob3N0KVxuICAgIGlmICghb3B0aW9ucy5ob3N0bmFtZSkge1xuICAgICAgaWYgKG9wdGlvbnMuaG9zdC5zcGxpdCgnOicpLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBvcHRpb25zLmhvc3RuYW1lID0gb3B0aW9ucy5ob3N0LnNwbGl0KCc6JylbMF1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG9wdGlvbnMuaG9zdG5hbWUgPSBvcHRpb25zLmhvc3RcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZGVidWcoJ29wdGlvbnMuaG9zdG5hbWUgaW4gdGhlIGVuZDogJWonLCBvcHRpb25zLmhvc3RuYW1lKVxuICBvcHRpb25zLmhvc3QgPSBgJHtvcHRpb25zLmhvc3RuYW1lIHx8ICdsb2NhbGhvc3QnfToke29wdGlvbnMucG9ydH1gXG4gIGRlYnVnKCdvcHRpb25zLmhvc3QgaW4gdGhlIGVuZDogJWonLCBvcHRpb25zLmhvc3QpXG5cbiAgLy8vIGxvd2VyY2FzZSBob3N0IG5hbWVzXG4gIDtbJ2hvc3RuYW1lJywgJ2hvc3QnXS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyKSB7XG4gICAgaWYgKG9wdGlvbnNbYXR0cl0pIHtcbiAgICAgIG9wdGlvbnNbYXR0cl0gPSBvcHRpb25zW2F0dHJdLnRvTG93ZXJDYXNlKClcbiAgICB9XG4gIH0pXG5cbiAgcmV0dXJuIG9wdGlvbnNcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGRhdGEgY29udGFpbmVkIGluIGJ1ZmZlciBjYW4gYmUgcmVjb25zdHJ1Y3RlZFxuICogZnJvbSBpdHMgdXRmOCByZXByZXNlbnRhdGlvbi5cbiAqXG4gKiBAcGFyYW0gIHtPYmplY3R9IGJ1ZmZlciAtIGEgQnVmZmVyIG9iamVjdFxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzVXRmOFJlcHJlc2VudGFibGUoYnVmZmVyKSB7XG4gIGNvbnN0IHV0ZkVuY29kZWRCdWZmZXIgPSBidWZmZXIudG9TdHJpbmcoJ3V0ZjgnKVxuICBjb25zdCByZWNvbnN0cnVjdGVkQnVmZmVyID0gQnVmZmVyLmZyb20odXRmRW5jb2RlZEJ1ZmZlciwgJ3V0ZjgnKVxuICByZXR1cm4gcmVjb25zdHJ1Y3RlZEJ1ZmZlci5lcXVhbHMoYnVmZmVyKVxufVxuXG4vLyAgQXJyYXkgd2hlcmUgYWxsIGluZm9ybWF0aW9uIGFib3V0IGFsbCB0aGUgb3ZlcnJpZGRlbiByZXF1ZXN0cyBhcmUgaGVsZC5cbmxldCByZXF1ZXN0T3ZlcnJpZGVzID0ge31cblxuLyoqXG4gKiBPdmVycmlkZXMgdGhlIGN1cnJlbnQgYHJlcXVlc3RgIGZ1bmN0aW9uIG9mIGBodHRwYCBhbmQgYGh0dHBzYCBtb2R1bGVzIHdpdGhcbiAqIG91ciBvd24gdmVyc2lvbiB3aGljaCBpbnRlcmNlcHRzIGlzc3VlcyBIVFRQL0hUVFBTIHJlcXVlc3RzIGFuZCBmb3J3YXJkcyB0aGVtXG4gKiB0byB0aGUgZ2l2ZW4gYG5ld1JlcXVlc3RgIGZ1bmN0aW9uLlxuICpcbiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBuZXdSZXF1ZXN0IC0gYSBmdW5jdGlvbiBoYW5kbGluZyByZXF1ZXN0czsgaXQgYWNjZXB0cyBmb3VyIGFyZ3VtZW50czpcbiAqICAgLSBwcm90byAtIGEgc3RyaW5nIHdpdGggdGhlIG92ZXJyaWRkZW4gbW9kdWxlJ3MgcHJvdG9jb2wgbmFtZSAoZWl0aGVyIGBodHRwYCBvciBgaHR0cHNgKVxuICogICAtIG92ZXJyaWRkZW5SZXF1ZXN0IC0gdGhlIG92ZXJyaWRkZW4gbW9kdWxlJ3MgcmVxdWVzdCBmdW5jdGlvbiBhbHJlYWR5IGJvdW5kIHRvIG1vZHVsZSdzIG9iamVjdFxuICogICAtIG9wdGlvbnMgLSB0aGUgb3B0aW9ucyBvZiB0aGUgaXNzdWVkIHJlcXVlc3RcbiAqICAgLSBjYWxsYmFjayAtIHRoZSBjYWxsYmFjayBvZiB0aGUgaXNzdWVkIHJlcXVlc3RcbiAqL1xuZnVuY3Rpb24gb3ZlcnJpZGVSZXF1ZXN0cyhuZXdSZXF1ZXN0KSB7XG4gIGRlYnVnKCdvdmVycmlkaW5nIHJlcXVlc3RzJylcbiAgO1snaHR0cCcsICdodHRwcyddLmZvckVhY2goZnVuY3Rpb24gKHByb3RvKSB7XG4gICAgZGVidWcoJy0gb3ZlcnJpZGluZyByZXF1ZXN0IGZvcicsIHByb3RvKVxuXG4gICAgY29uc3QgbW9kdWxlTmFtZSA9IHByb3RvIC8vIDEgdG8gMSBtYXRjaCBvZiBwcm90b2NvbCBhbmQgbW9kdWxlIGlzIGZvcnR1bmF0ZSA6KVxuICAgIGNvbnN0IG1vZHVsZSA9IHtcbiAgICAgIGh0dHA6IHJlcXVpcmUoJ2h0dHAnKSxcbiAgICAgIGh0dHBzOiByZXF1aXJlKCdodHRwcycpLFxuICAgIH1bbW9kdWxlTmFtZV1cbiAgICBjb25zdCBvdmVycmlkZGVuUmVxdWVzdCA9IG1vZHVsZS5yZXF1ZXN0XG4gICAgY29uc3Qgb3ZlcnJpZGRlbkdldCA9IG1vZHVsZS5nZXRcblxuICAgIGlmIChyZXF1ZXN0T3ZlcnJpZGVzW21vZHVsZU5hbWVdKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBNb2R1bGUncyByZXF1ZXN0IGFscmVhZHkgb3ZlcnJpZGRlbiBmb3IgJHttb2R1bGVOYW1lfSBwcm90b2NvbC5gXG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gIFN0b3JlIHRoZSBwcm9wZXJ0aWVzIG9mIHRoZSBvdmVycmlkZGVuIHJlcXVlc3Qgc28gdGhhdCBpdCBjYW4gYmUgcmVzdG9yZWQgbGF0ZXIgb24uXG4gICAgcmVxdWVzdE92ZXJyaWRlc1ttb2R1bGVOYW1lXSA9IHtcbiAgICAgIG1vZHVsZSxcbiAgICAgIHJlcXVlc3Q6IG92ZXJyaWRkZW5SZXF1ZXN0LFxuICAgICAgZ2V0OiBvdmVycmlkZGVuR2V0LFxuICAgIH1cbiAgICAvLyBodHRwczovL25vZGVqcy5vcmcvYXBpL2h0dHAuaHRtbCNodHRwX2h0dHBfcmVxdWVzdF91cmxfb3B0aW9uc19jYWxsYmFja1xuICAgIG1vZHVsZS5yZXF1ZXN0ID0gZnVuY3Rpb24gKGlucHV0LCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgICAgcmV0dXJuIG5ld1JlcXVlc3QocHJvdG8sIG92ZXJyaWRkZW5SZXF1ZXN0LmJpbmQobW9kdWxlKSwgW1xuICAgICAgICBpbnB1dCxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgY2FsbGJhY2ssXG4gICAgICBdKVxuICAgIH1cbiAgICAvLyBodHRwczovL25vZGVqcy5vcmcvYXBpL2h0dHAuaHRtbCNodHRwX2h0dHBfZ2V0X29wdGlvbnNfY2FsbGJhY2tcbiAgICBtb2R1bGUuZ2V0ID0gZnVuY3Rpb24gKGlucHV0LCBvcHRpb25zLCBjYWxsYmFjaykge1xuICAgICAgY29uc3QgcmVxID0gbmV3UmVxdWVzdChwcm90bywgb3ZlcnJpZGRlbkdldC5iaW5kKG1vZHVsZSksIFtcbiAgICAgICAgaW5wdXQsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGNhbGxiYWNrLFxuICAgICAgXSlcbiAgICAgIHJlcS5lbmQoKVxuICAgICAgcmV0dXJuIHJlcVxuICAgIH1cblxuICAgIGRlYnVnKCctIG92ZXJyaWRkZW4gcmVxdWVzdCBmb3InLCBwcm90bylcbiAgfSlcbn1cblxuLyoqXG4gKiBSZXN0b3JlcyBgcmVxdWVzdGAgZnVuY3Rpb24gb2YgYGh0dHBgIGFuZCBgaHR0cHNgIG1vZHVsZXMgdG8gdmFsdWVzIHRoZXlcbiAqIGhlbGQgYmVmb3JlIHRoZXkgd2VyZSBvdmVycmlkZGVuIGJ5IHVzLlxuICovXG5mdW5jdGlvbiByZXN0b3JlT3ZlcnJpZGRlblJlcXVlc3RzKCkge1xuICBkZWJ1ZygncmVzdG9yaW5nIHJlcXVlc3RzJylcbiAgT2JqZWN0LmVudHJpZXMocmVxdWVzdE92ZXJyaWRlcykuZm9yRWFjaChcbiAgICAoW3Byb3RvLCB7IG1vZHVsZSwgcmVxdWVzdCwgZ2V0IH1dKSA9PiB7XG4gICAgICBkZWJ1ZygnLSByZXN0b3JpbmcgcmVxdWVzdCBmb3InLCBwcm90bylcbiAgICAgIG1vZHVsZS5yZXF1ZXN0ID0gcmVxdWVzdFxuICAgICAgbW9kdWxlLmdldCA9IGdldFxuICAgICAgZGVidWcoJy0gcmVzdG9yZWQgcmVxdWVzdCBmb3InLCBwcm90bylcbiAgICB9XG4gIClcbiAgcmVxdWVzdE92ZXJyaWRlcyA9IHt9XG59XG5cbi8qKlxuICogSW4gV0hBVFdHIFVSTCB2ZXJuYWN1bGFyLCB0aGlzIHJldHVybnMgdGhlIG9yaWdpbiBwb3J0aW9uIG9mIGEgVVJMLlxuICogSG93ZXZlciwgdGhlIHBvcnQgaXMgbm90IGluY2x1ZGVkIGlmIGl0J3Mgc3RhbmRhcmQgYW5kIG5vdCBhbHJlYWR5IHByZXNlbnQgb24gdGhlIGhvc3QuXG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZU9yaWdpbihwcm90bywgaG9zdCwgcG9ydCkge1xuICBjb25zdCBob3N0SGFzUG9ydCA9IGhvc3QuaW5jbHVkZXMoJzonKVxuICBjb25zdCBwb3J0SXNTdGFuZGFyZCA9XG4gICAgKHByb3RvID09PSAnaHR0cCcgJiYgKHBvcnQgPT09IDgwIHx8IHBvcnQgPT09ICc4MCcpKSB8fFxuICAgIChwcm90byA9PT0gJ2h0dHBzJyAmJiAocG9ydCA9PT0gNDQzIHx8IHBvcnQgPT09ICc0NDMnKSlcbiAgY29uc3QgcG9ydFN0ciA9IGhvc3RIYXNQb3J0IHx8IHBvcnRJc1N0YW5kYXJkID8gJycgOiBgOiR7cG9ydH1gXG5cbiAgcmV0dXJuIGAke3Byb3RvfTovLyR7aG9zdH0ke3BvcnRTdHJ9YFxufVxuXG4vKipcbiAqIEdldCBoaWdoIGxldmVsIGluZm9ybWF0aW9uIGFib3V0IHJlcXVlc3QgYXMgc3RyaW5nXG4gKiBAcGFyYW0gIHtPYmplY3R9IG9wdGlvbnNcbiAqIEBwYXJhbSAge3N0cmluZ30gb3B0aW9ucy5tZXRob2RcbiAqIEBwYXJhbSAge251bWJlcnxzdHJpbmd9IG9wdGlvbnMucG9ydFxuICogQHBhcmFtICB7c3RyaW5nfSBvcHRpb25zLnByb3RvIFNldCBpbnRlcm5hbGx5LiBhbHdheXMgaHR0cCBvciBodHRwc1xuICogQHBhcmFtICB7c3RyaW5nfSBvcHRpb25zLmhvc3RuYW1lXG4gKiBAcGFyYW0gIHtzdHJpbmd9IG9wdGlvbnMucGF0aFxuICogQHBhcmFtICB7T2JqZWN0fSBvcHRpb25zLmhlYWRlcnNcbiAqIEBwYXJhbSAge3N0cmluZ30gYm9keVxuICogQHJldHVybiB7c3RyaW5nfVxuICovXG5mdW5jdGlvbiBzdHJpbmdpZnlSZXF1ZXN0KG9wdGlvbnMsIGJvZHkpIHtcbiAgY29uc3QgeyBtZXRob2QgPSAnR0VUJywgcGF0aCA9ICcnLCBwb3J0IH0gPSBvcHRpb25zXG4gIGNvbnN0IG9yaWdpbiA9IG5vcm1hbGl6ZU9yaWdpbihvcHRpb25zLnByb3RvLCBvcHRpb25zLmhvc3RuYW1lLCBwb3J0KVxuXG4gIGNvbnN0IGxvZyA9IHtcbiAgICBtZXRob2QsXG4gICAgdXJsOiBgJHtvcmlnaW59JHtwYXRofWAsXG4gICAgaGVhZGVyczogb3B0aW9ucy5oZWFkZXJzLFxuICB9XG5cbiAgaWYgKGJvZHkpIHtcbiAgICBsb2cuYm9keSA9IGJvZHlcbiAgfVxuXG4gIHJldHVybiBKU09OLnN0cmluZ2lmeShsb2csIG51bGwsIDIpXG59XG5cbmZ1bmN0aW9uIGlzQ29udGVudEVuY29kZWQoaGVhZGVycykge1xuICBjb25zdCBjb250ZW50RW5jb2RpbmcgPSBoZWFkZXJzWydjb250ZW50LWVuY29kaW5nJ11cbiAgcmV0dXJuIHR5cGVvZiBjb250ZW50RW5jb2RpbmcgPT09ICdzdHJpbmcnICYmIGNvbnRlbnRFbmNvZGluZyAhPT0gJydcbn1cblxuZnVuY3Rpb24gY29udGVudEVuY29kaW5nKGhlYWRlcnMsIGVuY29kZXIpIHtcbiAgY29uc3QgY29udGVudEVuY29kaW5nID0gaGVhZGVyc1snY29udGVudC1lbmNvZGluZyddXG4gIHJldHVybiBjb250ZW50RW5jb2RpbmcgIT09IHVuZGVmaW5lZCAmJiBjb250ZW50RW5jb2RpbmcudG9TdHJpbmcoKSA9PT0gZW5jb2RlclxufVxuXG5mdW5jdGlvbiBpc0pTT05Db250ZW50KGhlYWRlcnMpIHtcbiAgLy8gaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzgyNTlcbiAgY29uc3QgY29udGVudFR5cGUgPSBTdHJpbmcoaGVhZGVyc1snY29udGVudC10eXBlJ10gfHwgJycpLnRvTG93ZXJDYXNlKClcbiAgcmV0dXJuIGNvbnRlbnRUeXBlLnN0YXJ0c1dpdGgoJ2FwcGxpY2F0aW9uL2pzb24nKVxufVxuXG4vKipcbiAqIFJldHVybiBhIG5ldyBvYmplY3Qgd2l0aCBhbGwgZmllbGQgbmFtZXMgb2YgdGhlIGhlYWRlcnMgbG93ZXItY2FzZWQuXG4gKlxuICogRHVwbGljYXRlcyB0aHJvdyBhbiBlcnJvci5cbiAqL1xuZnVuY3Rpb24gaGVhZGVyc0ZpZWxkTmFtZXNUb0xvd2VyQ2FzZShoZWFkZXJzKSB7XG4gIGlmICghaXNQbGFpbk9iamVjdChoZWFkZXJzKSkge1xuICAgIHRocm93IEVycm9yKCdIZWFkZXJzIG11c3QgYmUgcHJvdmlkZWQgYXMgYW4gb2JqZWN0JylcbiAgfVxuXG4gIGNvbnN0IGxvd2VyQ2FzZUhlYWRlcnMgPSB7fVxuICBPYmplY3QuZW50cmllcyhoZWFkZXJzKS5mb3JFYWNoKChbZmllbGROYW1lLCBmaWVsZFZhbHVlXSkgPT4ge1xuICAgIGNvbnN0IGtleSA9IGZpZWxkTmFtZS50b0xvd2VyQ2FzZSgpXG4gICAgaWYgKGxvd2VyQ2FzZUhlYWRlcnNba2V5XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aHJvdyBFcnJvcihcbiAgICAgICAgYEZhaWxlZCB0byBjb252ZXJ0IGhlYWRlciBrZXlzIHRvIGxvd2VyIGNhc2UgZHVlIHRvIGZpZWxkIG5hbWUgY29uZmxpY3Q6ICR7a2V5fWBcbiAgICAgIClcbiAgICB9XG4gICAgbG93ZXJDYXNlSGVhZGVyc1trZXldID0gZmllbGRWYWx1ZVxuICB9KVxuXG4gIHJldHVybiBsb3dlckNhc2VIZWFkZXJzXG59XG5cbmNvbnN0IGhlYWRlcnNGaWVsZHNBcnJheVRvTG93ZXJDYXNlID0gaGVhZGVycyA9PiBbXG4gIC4uLm5ldyBTZXQoaGVhZGVycy5tYXAoZmllbGROYW1lID0+IGZpZWxkTmFtZS50b0xvd2VyQ2FzZSgpKSksXG5dXG5cbi8qKlxuICogQ29udmVydHMgdGhlIHZhcmlvdXMgYWNjZXB0ZWQgZm9ybWF0cyBvZiBoZWFkZXJzIGludG8gYSBmbGF0IGFycmF5IHJlcHJlc2VudGluZyBcInJhdyBoZWFkZXJzXCIuXG4gKlxuICogTm9jayBhbGxvd3MgaGVhZGVycyB0byBiZSBwcm92aWRlZCBhcyBhIHJhdyBhcnJheSwgYSBwbGFpbiBvYmplY3QsIG9yIGEgTWFwLlxuICpcbiAqIFdoaWxlIGFsbCB0aGUgaGVhZGVyIG5hbWVzIGFyZSBleHBlY3RlZCB0byBiZSBzdHJpbmdzLCB0aGUgdmFsdWVzIGFyZSBsZWZ0IGludGFjdCBhcyB0aGV5IGNhblxuICogYmUgZnVuY3Rpb25zLCBzdHJpbmdzLCBvciBhcnJheXMgb2Ygc3RyaW5ncy5cbiAqXG4gKiAgaHR0cHM6Ly9ub2RlanMub3JnL2FwaS9odHRwLmh0bWwjaHR0cF9tZXNzYWdlX3Jhd2hlYWRlcnNcbiAqL1xuZnVuY3Rpb24gaGVhZGVyc0lucHV0VG9SYXdBcnJheShoZWFkZXJzKSB7XG4gIGlmIChoZWFkZXJzID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm4gW11cbiAgfVxuXG4gIGlmIChBcnJheS5pc0FycmF5KGhlYWRlcnMpKSB7XG4gICAgLy8gSWYgdGhlIGlucHV0IGlzIGFuIGFycmF5LCBhc3N1bWUgaXQncyBhbHJlYWR5IGluIHRoZSByYXcgZm9ybWF0IGFuZCBzaW1wbHkgcmV0dXJuIGEgY29weVxuICAgIC8vIGJ1dCB0aHJvdyBhbiBlcnJvciBpZiB0aGVyZSBhcmVuJ3QgYW4gZXZlbiBudW1iZXIgb2YgaXRlbXMgaW4gdGhlIGFycmF5XG4gICAgaWYgKGhlYWRlcnMubGVuZ3RoICUgMikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgUmF3IGhlYWRlcnMgbXVzdCBiZSBwcm92aWRlZCBhcyBhbiBhcnJheSB3aXRoIGFuIGV2ZW4gbnVtYmVyIG9mIGl0ZW1zLiBbZmllbGROYW1lLCB2YWx1ZSwgLi4uXWBcbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIFsuLi5oZWFkZXJzXVxuICB9XG5cbiAgLy8gW10uY29uY2F0KC4uLikgaXMgdXNlZCBpbnN0ZWFkIG9mIEFycmF5LmZsYXQgdW50aWwgdjExIGlzIHRoZSBtaW5pbXVtIE5vZGUgdmVyc2lvblxuICBpZiAodXRpbC50eXBlcy5pc01hcChoZWFkZXJzKSkge1xuICAgIHJldHVybiBbXS5jb25jYXQoLi4uQXJyYXkuZnJvbShoZWFkZXJzLCAoW2ssIHZdKSA9PiBbay50b1N0cmluZygpLCB2XSkpXG4gIH1cblxuICBpZiAoaXNQbGFpbk9iamVjdChoZWFkZXJzKSkge1xuICAgIHJldHVybiBbXS5jb25jYXQoLi4uT2JqZWN0LmVudHJpZXMoaGVhZGVycykpXG4gIH1cblxuICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgYEhlYWRlcnMgbXVzdCBiZSBwcm92aWRlZCBhcyBhbiBhcnJheSBvZiByYXcgdmFsdWVzLCBhIE1hcCwgb3IgYSBwbGFpbiBPYmplY3QuICR7aGVhZGVyc31gXG4gIClcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBhbiBhcnJheSBvZiByYXcgaGVhZGVycyB0byBhbiBvYmplY3QsIHVzaW5nIHRoZSBzYW1lIHJ1bGVzIGFzIE5vZGVzIGBodHRwLkluY29taW5nTWVzc2FnZS5oZWFkZXJzYC5cbiAqXG4gKiBIZWFkZXIgbmFtZXMva2V5cyBhcmUgbG93ZXItY2FzZWQuXG4gKi9cbmZ1bmN0aW9uIGhlYWRlcnNBcnJheVRvT2JqZWN0KHJhd0hlYWRlcnMpIHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KHJhd0hlYWRlcnMpKSB7XG4gICAgdGhyb3cgRXJyb3IoJ0V4cGVjdGVkIGEgaGVhZGVyIGFycmF5JylcbiAgfVxuXG4gIGNvbnN0IGFjY3VtdWxhdG9yID0ge31cblxuICBmb3JFYWNoSGVhZGVyKHJhd0hlYWRlcnMsICh2YWx1ZSwgZmllbGROYW1lKSA9PiB7XG4gICAgYWRkSGVhZGVyTGluZShhY2N1bXVsYXRvciwgZmllbGROYW1lLCB2YWx1ZSlcbiAgfSlcblxuICByZXR1cm4gYWNjdW11bGF0b3Jcbn1cblxuY29uc3Qgbm9EdXBsaWNhdGVzSGVhZGVycyA9IG5ldyBTZXQoW1xuICAnYWdlJyxcbiAgJ2F1dGhvcml6YXRpb24nLFxuICAnY29udGVudC1sZW5ndGgnLFxuICAnY29udGVudC10eXBlJyxcbiAgJ2V0YWcnLFxuICAnZXhwaXJlcycsXG4gICdmcm9tJyxcbiAgJ2hvc3QnLFxuICAnaWYtbW9kaWZpZWQtc2luY2UnLFxuICAnaWYtdW5tb2RpZmllZC1zaW5jZScsXG4gICdsYXN0LW1vZGlmaWVkJyxcbiAgJ2xvY2F0aW9uJyxcbiAgJ21heC1mb3J3YXJkcycsXG4gICdwcm94eS1hdXRob3JpemF0aW9uJyxcbiAgJ3JlZmVyZXInLFxuICAncmV0cnktYWZ0ZXInLFxuICAndXNlci1hZ2VudCcsXG5dKVxuXG4vKipcbiAqIFNldCBrZXkvdmFsdWUgZGF0YSBpbiBhY2NvcmRhbmNlIHdpdGggTm9kZSdzIGxvZ2ljIGZvciBmb2xkaW5nIGR1cGxpY2F0ZSBoZWFkZXJzLlxuICpcbiAqIFRoZSBgdmFsdWVgIHBhcmFtIHNob3VsZCBiZSBhIGZ1bmN0aW9uLCBzdHJpbmcsIG9yIGFycmF5IG9mIHN0cmluZ3MuXG4gKlxuICogTm9kZSdzIGRvY3MgYW5kIHNvdXJjZTpcbiAqIGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvaHR0cC5odG1sI2h0dHBfbWVzc2FnZV9oZWFkZXJzXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzL25vZGUvYmxvYi85MDgyOTJjZjFmNTUxYzYxNGE3MzNkODU4NTI4ZmZiMTNmYjNhNTI0L2xpYi9faHR0cF9pbmNvbWluZy5qcyNMMjQ1XG4gKlxuICogSGVhZGVyIG5hbWVzIGFyZSBsb3dlci1jYXNlZC5cbiAqIER1cGxpY2F0ZXMgaW4gcmF3IGhlYWRlcnMgYXJlIGhhbmRsZWQgaW4gdGhlIGZvbGxvd2luZyB3YXlzLCBkZXBlbmRpbmcgb24gdGhlIGhlYWRlciBuYW1lOlxuICogLSBEdXBsaWNhdGVzIG9mIGZpZWxkIG5hbWVzIGxpc3RlZCBpbiBgbm9EdXBsaWNhdGVzSGVhZGVyc2AgKGFib3ZlKSBhcmUgZGlzY2FyZGVkLlxuICogLSBgc2V0LWNvb2tpZWAgaXMgYWx3YXlzIGFuIGFycmF5LiBEdXBsaWNhdGVzIGFyZSBhZGRlZCB0byB0aGUgYXJyYXkuXG4gKiAtIEZvciBkdXBsaWNhdGUgYGNvb2tpZWAgaGVhZGVycywgdGhlIHZhbHVlcyBhcmUgam9pbmVkIHRvZ2V0aGVyIHdpdGggJzsgJy5cbiAqIC0gRm9yIGFsbCBvdGhlciBoZWFkZXJzLCB0aGUgdmFsdWVzIGFyZSBqb2luZWQgdG9nZXRoZXIgd2l0aCAnLCAnLlxuICpcbiAqIE5vZGUncyBpbXBsZW1lbnRhdGlvbiBpcyBsYXJnZXIgYmVjYXVzZSBpdCBoaWdobHkgb3B0aW1pemVzIGZvciBub3QgaGF2aW5nIHRvIGNhbGwgYHRvTG93ZXJDYXNlKClgLlxuICogV2UndmUgb3B0ZWQgdG8gYWx3YXlzIGNhbGwgYHRvTG93ZXJDYXNlYCBpbiBleGNoYW5nZSBmb3IgYSBtb3JlIGNvbmNpc2UgZnVuY3Rpb24uXG4gKlxuICogV2hpbGUgTm9kZSBoYXMgdGhlIGx1eHVyeSBvZiBrbm93aW5nIGB2YWx1ZWAgaXMgYWx3YXlzIGEgc3RyaW5nLCB3ZSBkbyBhbiBleHRyYSBzdGVwIG9mIGNvZXJjaW9uIGF0IHRoZSB0b3AuXG4gKi9cbmZ1bmN0aW9uIGFkZEhlYWRlckxpbmUoaGVhZGVycywgbmFtZSwgdmFsdWUpIHtcbiAgbGV0IHZhbHVlcyAvLyBjb2RlIGJlbG93IGV4cGVjdHMgYHZhbHVlc2AgdG8gYmUgYW4gYXJyYXkgb2Ygc3RyaW5nc1xuICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgLy8gRnVuY3Rpb24gdmFsdWVzIGFyZSBldmFsdWF0ZWQgdG93YXJkcyB0aGUgZW5kIG9mIHRoZSByZXNwb25zZSwgYmVmb3JlIHRoYXQgd2UgdXNlIGEgcGxhY2Vob2xkZXJcbiAgICAvLyBzdHJpbmcganVzdCB0byBkZXNpZ25hdGUgdGhhdCB0aGUgaGVhZGVyIGV4aXN0cy4gVXNlZnVsIHdoZW4gYENvbnRlbnQtVHlwZWAgaXMgc2V0IHdpdGggYSBmdW5jdGlvbi5cbiAgICB2YWx1ZXMgPSBbdmFsdWUubmFtZV1cbiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIHZhbHVlcyA9IHZhbHVlLm1hcChTdHJpbmcpXG4gIH0gZWxzZSB7XG4gICAgdmFsdWVzID0gW1N0cmluZyh2YWx1ZSldXG4gIH1cblxuICBjb25zdCBrZXkgPSBuYW1lLnRvTG93ZXJDYXNlKClcbiAgaWYgKGtleSA9PT0gJ3NldC1jb29raWUnKSB7XG4gICAgLy8gQXJyYXkgaGVhZGVyIC0tIG9ubHkgU2V0LUNvb2tpZSBhdCB0aGUgbW9tZW50XG4gICAgaWYgKGhlYWRlcnNbJ3NldC1jb29raWUnXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBoZWFkZXJzWydzZXQtY29va2llJ10gPSB2YWx1ZXNcbiAgICB9IGVsc2Uge1xuICAgICAgaGVhZGVyc1snc2V0LWNvb2tpZSddLnB1c2goLi4udmFsdWVzKVxuICAgIH1cbiAgfSBlbHNlIGlmIChub0R1cGxpY2F0ZXNIZWFkZXJzLmhhcyhrZXkpKSB7XG4gICAgaWYgKGhlYWRlcnNba2V5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBEcm9wIGR1cGxpY2F0ZXNcbiAgICAgIGhlYWRlcnNba2V5XSA9IHZhbHVlc1swXVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoaGVhZGVyc1trZXldICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHZhbHVlcyA9IFtoZWFkZXJzW2tleV0sIC4uLnZhbHVlc11cbiAgICB9XG5cbiAgICBjb25zdCBzZXBhcmF0b3IgPSBrZXkgPT09ICdjb29raWUnID8gJzsgJyA6ICcsICdcbiAgICBoZWFkZXJzW2tleV0gPSB2YWx1ZXMuam9pbihzZXBhcmF0b3IpXG4gIH1cbn1cblxuLyoqXG4gKiBEZWxldGVzIHRoZSBnaXZlbiBgZmllbGROYW1lYCBwcm9wZXJ0eSBmcm9tIGBoZWFkZXJzYCBvYmplY3QgYnkgcGVyZm9ybWluZ1xuICogY2FzZS1pbnNlbnNpdGl2ZSBzZWFyY2ggdGhyb3VnaCBrZXlzLlxuICpcbiAqIEBoZWFkZXJzICAge09iamVjdH0gaGVhZGVycyAtIG9iamVjdCBvZiBoZWFkZXIgZmllbGQgbmFtZXMgYW5kIHZhbHVlc1xuICogQGZpZWxkTmFtZSB7U3RyaW5nfSBmaWVsZCBuYW1lIC0gc3RyaW5nIHdpdGggdGhlIGNhc2UtaW5zZW5zaXRpdmUgZmllbGQgbmFtZVxuICovXG5mdW5jdGlvbiBkZWxldGVIZWFkZXJzRmllbGQoaGVhZGVycywgZmllbGROYW1lVG9EZWxldGUpIHtcbiAgaWYgKCFpc1BsYWluT2JqZWN0KGhlYWRlcnMpKSB7XG4gICAgdGhyb3cgRXJyb3IoJ2hlYWRlcnMgbXVzdCBiZSBhbiBvYmplY3QnKVxuICB9XG5cbiAgaWYgKHR5cGVvZiBmaWVsZE5hbWVUb0RlbGV0ZSAhPT0gJ3N0cmluZycpIHtcbiAgICB0aHJvdyBFcnJvcignZmllbGQgbmFtZSBtdXN0IGJlIGEgc3RyaW5nJylcbiAgfVxuXG4gIGNvbnN0IGxvd2VyQ2FzZUZpZWxkTmFtZVRvRGVsZXRlID0gZmllbGROYW1lVG9EZWxldGUudG9Mb3dlckNhc2UoKVxuXG4gIC8vIFNlYXJjaCB0aHJvdWdoIHRoZSBoZWFkZXJzIGFuZCBkZWxldGUgYWxsIHZhbHVlcyB3aG9zZSBmaWVsZCBuYW1lIG1hdGNoZXMgdGhlIGdpdmVuIGZpZWxkIG5hbWUuXG4gIE9iamVjdC5rZXlzKGhlYWRlcnMpXG4gICAgLmZpbHRlcihmaWVsZE5hbWUgPT4gZmllbGROYW1lLnRvTG93ZXJDYXNlKCkgPT09IGxvd2VyQ2FzZUZpZWxkTmFtZVRvRGVsZXRlKVxuICAgIC5mb3JFYWNoKGZpZWxkTmFtZSA9PiBkZWxldGUgaGVhZGVyc1tmaWVsZE5hbWVdKVxufVxuXG4vKipcbiAqIFV0aWxpdHkgZm9yIGl0ZXJhdGluZyBvdmVyIGEgcmF3IGhlYWRlcnMgYXJyYXkuXG4gKlxuICogVGhlIGNhbGxiYWNrIGlzIGNhbGxlZCB3aXRoOlxuICogIC0gVGhlIGhlYWRlciB2YWx1ZS4gc3RyaW5nLCBhcnJheSBvZiBzdHJpbmdzLCBvciBhIGZ1bmN0aW9uXG4gKiAgLSBUaGUgaGVhZGVyIGZpZWxkIG5hbWUuIHN0cmluZ1xuICogIC0gSW5kZXggb2YgdGhlIGhlYWRlciBmaWVsZCBpbiB0aGUgcmF3IGhlYWRlciBhcnJheS5cbiAqL1xuZnVuY3Rpb24gZm9yRWFjaEhlYWRlcihyYXdIZWFkZXJzLCBjYWxsYmFjaykge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHJhd0hlYWRlcnMubGVuZ3RoOyBpICs9IDIpIHtcbiAgICBjYWxsYmFjayhyYXdIZWFkZXJzW2kgKyAxXSwgcmF3SGVhZGVyc1tpXSwgaSlcbiAgfVxufVxuXG5mdW5jdGlvbiBwZXJjZW50RGVjb2RlKHN0cikge1xuICB0cnkge1xuICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoc3RyLnJlcGxhY2UoL1xcKy9nLCAnICcpKVxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHN0clxuICB9XG59XG5cbi8qKlxuICogVVJJIGVuY29kZSB0aGUgcHJvdmlkZWQgc3RyaW5nLCBzdHJpbmdlbnRseSBhZGhlcmluZyB0byBSRkMgMzk4Ni5cbiAqXG4gKiBSRkMgMzk4NiByZXNlcnZlcyAhLCAnLCAoLCApLCBhbmQgKiBidXQgZW5jb2RlVVJJQ29tcG9uZW50IGRvZXMgbm90IGVuY29kZSB0aGVtIHNvIHdlIGRvIGl0IG1hbnVhbGx5LlxuICpcbiAqIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMzOTg2XG4gKiBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9lbmNvZGVVUklDb21wb25lbnRcbiAqL1xuZnVuY3Rpb24gcGVyY2VudEVuY29kZShzdHIpIHtcbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHIpLnJlcGxhY2UoL1shJygpKl0vZywgZnVuY3Rpb24gKGMpIHtcbiAgICByZXR1cm4gYCUke2MuY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKX1gXG4gIH0pXG59XG5cbmZ1bmN0aW9uIG1hdGNoU3RyaW5nT3JSZWdleHAodGFyZ2V0LCBwYXR0ZXJuKSB7XG4gIGNvbnN0IHRhcmdldFN0ciA9XG4gICAgdGFyZ2V0ID09PSB1bmRlZmluZWQgfHwgdGFyZ2V0ID09PSBudWxsID8gJycgOiBTdHJpbmcodGFyZ2V0KVxuXG4gIGlmIChwYXR0ZXJuIGluc3RhbmNlb2YgUmVnRXhwKSB7XG4gICAgLy8gaWYgdGhlIHJlZ2V4cCBoYXBwZW5zIHRvIGhhdmUgYSBnbG9iYWwgZmxhZywgd2Ugd2FudCB0byBlbnN1cmUgd2UgdGVzdCB0aGUgZW50aXJlIHRhcmdldFxuICAgIHBhdHRlcm4ubGFzdEluZGV4ID0gMFxuICAgIHJldHVybiBwYXR0ZXJuLnRlc3QodGFyZ2V0U3RyKVxuICB9XG4gIHJldHVybiB0YXJnZXRTdHIgPT09IFN0cmluZyhwYXR0ZXJuKVxufVxuXG4vKipcbiAqIEZvcm1hdHMgYSBxdWVyeSBwYXJhbWV0ZXIuXG4gKlxuICogQHBhcmFtIGtleSAgICAgICAgICAgICAgICBUaGUga2V5IG9mIHRoZSBxdWVyeSBwYXJhbWV0ZXIgdG8gZm9ybWF0LlxuICogQHBhcmFtIHZhbHVlICAgICAgICAgICAgICBUaGUgdmFsdWUgb2YgdGhlIHF1ZXJ5IHBhcmFtZXRlciB0byBmb3JtYXQuXG4gKiBAcGFyYW0gc3RyaW5nRm9ybWF0dGluZ0ZuIFRoZSBmdW5jdGlvbiB1c2VkIHRvIGZvcm1hdCBzdHJpbmcgdmFsdWVzLiBDYW5cbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgYmUgdXNlZCB0byBlbmNvZGUgb3IgZGVjb2RlIHRoZSBxdWVyeSB2YWx1ZS5cbiAqXG4gKiBAcmV0dXJucyAqW10gdGhlIGZvcm1hdHRlZCBba2V5LCB2YWx1ZV0gcGFpci5cbiAqL1xuZnVuY3Rpb24gZm9ybWF0UXVlcnlWYWx1ZShrZXksIHZhbHVlLCBzdHJpbmdGb3JtYXR0aW5nRm4pIHtcbiAgLy8gVE9ETzogUHJvYmFibHkgcmVmYWN0b3IgY29kZSB0byByZXBsYWNlIGBzd2l0Y2godHJ1ZSlgIHdpdGggYGlmYC9gZWxzZWAuXG4gIHN3aXRjaCAodHJ1ZSkge1xuICAgIGNhc2UgdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJzogLy8gZmFsbC10aHJvdWdoXG4gICAgY2FzZSB0eXBlb2YgdmFsdWUgPT09ICdib29sZWFuJzpcbiAgICAgIHZhbHVlID0gdmFsdWUudG9TdHJpbmcoKVxuICAgICAgYnJlYWtcbiAgICBjYXNlIHZhbHVlID09PSBudWxsOlxuICAgIGNhc2UgdmFsdWUgPT09IHVuZGVmaW5lZDpcbiAgICAgIHZhbHVlID0gJydcbiAgICAgIGJyZWFrXG4gICAgY2FzZSB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnOlxuICAgICAgaWYgKHN0cmluZ0Zvcm1hdHRpbmdGbikge1xuICAgICAgICB2YWx1ZSA9IHN0cmluZ0Zvcm1hdHRpbmdGbih2YWx1ZSlcbiAgICAgIH1cbiAgICAgIGJyZWFrXG4gICAgY2FzZSB2YWx1ZSBpbnN0YW5jZW9mIFJlZ0V4cDpcbiAgICAgIGJyZWFrXG4gICAgY2FzZSBBcnJheS5pc0FycmF5KHZhbHVlKToge1xuICAgICAgdmFsdWUgPSB2YWx1ZS5tYXAoZnVuY3Rpb24gKHZhbCwgaWR4KSB7XG4gICAgICAgIHJldHVybiBmb3JtYXRRdWVyeVZhbHVlKGlkeCwgdmFsLCBzdHJpbmdGb3JtYXR0aW5nRm4pWzFdXG4gICAgICB9KVxuICAgICAgYnJlYWtcbiAgICB9XG4gICAgY2FzZSB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnOiB7XG4gICAgICB2YWx1ZSA9IE9iamVjdC5lbnRyaWVzKHZhbHVlKS5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgW3N1YktleSwgc3ViVmFsXSkge1xuICAgICAgICBjb25zdCBzdWJQYWlyID0gZm9ybWF0UXVlcnlWYWx1ZShzdWJLZXksIHN1YlZhbCwgc3RyaW5nRm9ybWF0dGluZ0ZuKVxuICAgICAgICBhY2Nbc3ViUGFpclswXV0gPSBzdWJQYWlyWzFdXG5cbiAgICAgICAgcmV0dXJuIGFjY1xuICAgICAgfSwge30pXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIGlmIChzdHJpbmdGb3JtYXR0aW5nRm4pIGtleSA9IHN0cmluZ0Zvcm1hdHRpbmdGbihrZXkpXG4gIHJldHVybiBba2V5LCB2YWx1ZV1cbn1cblxuZnVuY3Rpb24gaXNTdHJlYW0ob2JqKSB7XG4gIHJldHVybiAoXG4gICAgb2JqICYmXG4gICAgdHlwZW9mIG9iaiAhPT0gJ3N0cmluZycgJiZcbiAgICAhQnVmZmVyLmlzQnVmZmVyKG9iaikgJiZcbiAgICB0eXBlb2Ygb2JqLnNldEVuY29kaW5nID09PSAnZnVuY3Rpb24nXG4gIClcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyB0aGUgYXJndW1lbnRzIGZyb20gdGhlIHZhcmlvdXMgc2lnbmF0dXJlcyBvZiBodHRwW3NdLnJlcXVlc3QgaW50byBhIHN0YW5kYXJkXG4gKiBvcHRpb25zIG9iamVjdCBhbmQgYW4gb3B0aW9uYWwgY2FsbGJhY2sgZnVuY3Rpb24uXG4gKlxuICogaHR0cHM6Ly9ub2RlanMub3JnL2FwaS9odHRwLmh0bWwjaHR0cF9odHRwX3JlcXVlc3RfdXJsX29wdGlvbnNfY2FsbGJhY2tcbiAqXG4gKiBUYWtlbiBmcm9tIHRoZSBiZWdpbm5pbmcgb2YgdGhlIG5hdGl2ZSBgQ2xpZW50UmVxdWVzdGAuXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzL25vZGUvYmxvYi85MDgyOTJjZjFmNTUxYzYxNGE3MzNkODU4NTI4ZmZiMTNmYjNhNTI0L2xpYi9faHR0cF9jbGllbnQuanMjTDY4XG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZUNsaWVudFJlcXVlc3RBcmdzKGlucHV0LCBvcHRpb25zLCBjYikge1xuICBpZiAodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJykge1xuICAgIGlucHV0ID0gdXJsVG9PcHRpb25zKG5ldyB1cmwuVVJMKGlucHV0KSlcbiAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIHVybC5VUkwpIHtcbiAgICBpbnB1dCA9IHVybFRvT3B0aW9ucyhpbnB1dClcbiAgfSBlbHNlIHtcbiAgICBjYiA9IG9wdGlvbnNcbiAgICBvcHRpb25zID0gaW5wdXRcbiAgICBpbnB1dCA9IG51bGxcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGNiID0gb3B0aW9uc1xuICAgIG9wdGlvbnMgPSBpbnB1dCB8fCB7fVxuICB9IGVsc2Uge1xuICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKGlucHV0IHx8IHt9LCBvcHRpb25zKVxuICB9XG5cbiAgcmV0dXJuIHsgb3B0aW9ucywgY2FsbGJhY2s6IGNiIH1cbn1cblxuLyoqXG4gKiBVdGlsaXR5IGZ1bmN0aW9uIHRoYXQgY29udmVydHMgYSBVUkwgb2JqZWN0IGludG8gYW4gb3JkaW5hcnlcbiAqIG9wdGlvbnMgb2JqZWN0IGFzIGV4cGVjdGVkIGJ5IHRoZSBodHRwLnJlcXVlc3QgYW5kIGh0dHBzLnJlcXVlc3QgQVBJcy5cbiAqXG4gKiBUaGlzIHdhcyBjb3BpZWQgZnJvbSBOb2RlJ3Mgc291cmNlXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbm9kZWpzL25vZGUvYmxvYi85MDgyOTJjZjFmNTUxYzYxNGE3MzNkODU4NTI4ZmZiMTNmYjNhNTI0L2xpYi9pbnRlcm5hbC91cmwuanMjTDEyNTdcbiAqL1xuZnVuY3Rpb24gdXJsVG9PcHRpb25zKHVybCkge1xuICBjb25zdCBvcHRpb25zID0ge1xuICAgIHByb3RvY29sOiB1cmwucHJvdG9jb2wsXG4gICAgaG9zdG5hbWU6XG4gICAgICB0eXBlb2YgdXJsLmhvc3RuYW1lID09PSAnc3RyaW5nJyAmJiB1cmwuaG9zdG5hbWUuc3RhcnRzV2l0aCgnWycpXG4gICAgICAgID8gdXJsLmhvc3RuYW1lLnNsaWNlKDEsIC0xKVxuICAgICAgICA6IHVybC5ob3N0bmFtZSxcbiAgICBoYXNoOiB1cmwuaGFzaCxcbiAgICBzZWFyY2g6IHVybC5zZWFyY2gsXG4gICAgcGF0aG5hbWU6IHVybC5wYXRobmFtZSxcbiAgICBwYXRoOiBgJHt1cmwucGF0aG5hbWV9JHt1cmwuc2VhcmNoIHx8ICcnfWAsXG4gICAgaHJlZjogdXJsLmhyZWYsXG4gIH1cbiAgaWYgKHVybC5wb3J0ICE9PSAnJykge1xuICAgIG9wdGlvbnMucG9ydCA9IE51bWJlcih1cmwucG9ydClcbiAgfVxuICBpZiAodXJsLnVzZXJuYW1lIHx8IHVybC5wYXNzd29yZCkge1xuICAgIG9wdGlvbnMuYXV0aCA9IGAke3VybC51c2VybmFtZX06JHt1cmwucGFzc3dvcmR9YFxuICB9XG4gIHJldHVybiBvcHRpb25zXG59XG5cbi8qKlxuICogRGV0ZXJtaW5lcyBpZiByZXF1ZXN0IGRhdGEgbWF0Y2hlcyB0aGUgZXhwZWN0ZWQgc2NoZW1hLlxuICpcbiAqIFVzZWQgZm9yIGNvbXBhcmluZyBkZWNvZGVkIHNlYXJjaCBwYXJhbWV0ZXJzLCByZXF1ZXN0IGJvZHkgSlNPTiBvYmplY3RzLFxuICogYW5kIFVSTCBkZWNvZGVkIHJlcXVlc3QgZm9ybSBib2RpZXMuXG4gKlxuICogUGVyZm9ybXMgYSBnZW5lcmFsIHJlY3Vyc2l2ZSBzdHJpY3QgY29tcGFyaXNpb24gd2l0aCB0d28gY2F2ZWF0czpcbiAqICAtIFRoZSBleHBlY3RlZCBkYXRhIGNhbiB1c2UgcmVnZXhwIHRvIGNvbXBhcmUgdmFsdWVzXG4gKiAgLSBKU09OIHBhdGggbm90YXRpb24gYW5kIG5lc3RlZCBvYmplY3RzIGFyZSBjb25zaWRlcmVkIGVxdWFsXG4gKi9cbmNvbnN0IGRhdGFFcXVhbCA9IChleHBlY3RlZCwgYWN0dWFsKSA9PiB7XG4gIGlmIChpc1BsYWluT2JqZWN0KGV4cGVjdGVkKSkge1xuICAgIGV4cGVjdGVkID0gZXhwYW5kKGV4cGVjdGVkKVxuICB9XG4gIGlmIChpc1BsYWluT2JqZWN0KGFjdHVhbCkpIHtcbiAgICBhY3R1YWwgPSBleHBhbmQoYWN0dWFsKVxuICB9XG4gIHJldHVybiBkZWVwRXF1YWwoZXhwZWN0ZWQsIGFjdHVhbClcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyBmbGF0IG9iamVjdHMgd2hvc2Uga2V5cyB1c2UgSlNPTiBwYXRoIG5vdGF0aW9uIHRvIG5lc3RlZCBvYmplY3RzLlxuICpcbiAqIFRoZSBpbnB1dCBvYmplY3QgaXMgbm90IG11dGF0ZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIHsgJ2Zvb1tiYXJdWzBdJzogJ2JheicgfSAtPiB7IGZvbzogeyBiYXI6IFsgJ2JheicgXSB9IH1cbiAqL1xuY29uc3QgZXhwYW5kID0gaW5wdXQgPT5cbiAgT2JqZWN0LmVudHJpZXMoaW5wdXQpLnJlZHVjZSgoYWNjLCBbaywgdl0pID0+IHNldChhY2MsIGssIHYpLCB7fSlcblxuLyoqXG4gKiBQZXJmb3JtcyBhIHJlY3Vyc2l2ZSBzdHJpY3QgY29tcGFyaXNvbiBiZXR3ZWVuIHR3byB2YWx1ZXMuXG4gKlxuICogRXhwZWN0ZWQgdmFsdWVzIG9yIGxlYWYgbm9kZXMgb2YgZXhwZWN0ZWQgb2JqZWN0IHZhbHVlcyB0aGF0IGFyZSBSZWdFeHAgdXNlIHRlc3QoKSBmb3IgY29tcGFyaXNvbi5cbiAqL1xuZnVuY3Rpb24gZGVlcEVxdWFsKGV4cGVjdGVkLCBhY3R1YWwpIHtcbiAgZGVidWcoJ2RlZXBFcXVhbCBjb21wYXJpbmcnLCB0eXBlb2YgZXhwZWN0ZWQsIGV4cGVjdGVkLCB0eXBlb2YgYWN0dWFsLCBhY3R1YWwpXG4gIGlmIChleHBlY3RlZCBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgIHJldHVybiBleHBlY3RlZC50ZXN0KGFjdHVhbClcbiAgfVxuXG4gIGlmIChBcnJheS5pc0FycmF5KGV4cGVjdGVkKSAmJiBBcnJheS5pc0FycmF5KGFjdHVhbCkpIHtcbiAgICBpZiAoZXhwZWN0ZWQubGVuZ3RoICE9PSBhY3R1YWwubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICByZXR1cm4gZXhwZWN0ZWQuZXZlcnkoKGV4cFZhbCwgaWR4KSA9PiBkZWVwRXF1YWwoZXhwVmFsLCBhY3R1YWxbaWR4XSkpXG4gIH1cblxuICBpZiAoaXNQbGFpbk9iamVjdChleHBlY3RlZCkgJiYgaXNQbGFpbk9iamVjdChhY3R1YWwpKSB7XG4gICAgY29uc3QgYWxsS2V5cyA9IEFycmF5LmZyb20oXG4gICAgICBuZXcgU2V0KE9iamVjdC5rZXlzKGV4cGVjdGVkKS5jb25jYXQoT2JqZWN0LmtleXMoYWN0dWFsKSkpXG4gICAgKVxuXG4gICAgcmV0dXJuIGFsbEtleXMuZXZlcnkoa2V5ID0+IGRlZXBFcXVhbChleHBlY3RlZFtrZXldLCBhY3R1YWxba2V5XSkpXG4gIH1cblxuICByZXR1cm4gZXhwZWN0ZWQgPT09IGFjdHVhbFxufVxuXG4vKipcbiAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgcGxhaW4gb2JqZWN0LCB0aGF0IGlzLCBhbiBvYmplY3QgY3JlYXRlZCBieSB0aGVcbiAqIGBPYmplY3RgIGNvbnN0cnVjdG9yIG9yIG9uZSB3aXRoIGEgYFtbUHJvdG90eXBlXV1gIG9mIGBudWxsYC5cbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9sb2Rhc2gvbG9kYXNoL2Jsb2IvNTg4YmYzZTIwZGIwYWUwMzlhODIyYTE0YThmYTIzOGM1YjI5OGU2NS9pc1BsYWluT2JqZWN0LmpzXG4gKlxuICogQHBhcmFtIHsqfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gKiBAcmV0dXJuIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBpc1BsYWluT2JqZWN0KHZhbHVlKSB7XG4gIGNvbnN0IGlzT2JqZWN0TGlrZSA9IHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGxcbiAgY29uc3QgdGFnID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHZhbHVlKVxuICBpZiAoIWlzT2JqZWN0TGlrZSB8fCB0YWcgIT09ICdbb2JqZWN0IE9iamVjdF0nKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbiAgaWYgKE9iamVjdC5nZXRQcm90b3R5cGVPZih2YWx1ZSkgPT09IG51bGwpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIGxldCBwcm90byA9IHZhbHVlXG4gIHdoaWxlIChPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG8pICE9PSBudWxsKSB7XG4gICAgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG8pXG4gIH1cbiAgcmV0dXJuIE9iamVjdC5nZXRQcm90b3R5cGVPZih2YWx1ZSkgPT09IHByb3RvXG59XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBvYmplY3Qgd2l0aCB0aGUgc2FtZSBrZXlzIGFzIGBvYmplY3RgIGFuZCB2YWx1ZXMgZ2VuZXJhdGVkXG4gKiBieSBydW5uaW5nIGVhY2ggb3duIGVudW1lcmFibGUgc3RyaW5nIGtleWVkIHByb3BlcnR5IG9mIGBvYmplY3RgIHRocnVcbiAqIGBpdGVyYXRlZWAuIChpdGVyYXRpb24gb3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpXG4gKiBUaGUgaXRlcmF0ZWUgaXMgaW52b2tlZCB3aXRoIHRocmVlIGFyZ3VtZW50czogKHZhbHVlLCBrZXksIG9iamVjdCkuXG4gKiBodHRwczovL2dpdGh1Yi5jb20vbG9kYXNoL2xvZGFzaC9ibG9iLzU4OGJmM2UyMGRiMGFlMDM5YTgyMmExNGE4ZmEyMzhjNWIyOThlNjUvbWFwVmFsdWUuanNcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlcmF0ZWUgVGhlIGZ1bmN0aW9uIGludm9rZWQgcGVyIGl0ZXJhdGlvbi5cbiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIG5ldyBtYXBwZWQgb2JqZWN0LlxuICovXG5mdW5jdGlvbiBtYXBWYWx1ZShvYmplY3QsIGl0ZXJhdGVlKSB7XG4gIG9iamVjdCA9IE9iamVjdChvYmplY3QpXG4gIGNvbnN0IHJlc3VsdCA9IHt9XG5cbiAgT2JqZWN0LmtleXMob2JqZWN0KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgcmVzdWx0W2tleV0gPSBpdGVyYXRlZShvYmplY3Rba2V5XSwga2V5LCBvYmplY3QpXG4gIH0pXG4gIHJldHVybiByZXN1bHRcbn1cblxuY29uc3QgdGltZW91dHMgPSBbXVxuY29uc3QgaW50ZXJ2YWxzID0gW11cbmNvbnN0IGltbWVkaWF0ZXMgPSBbXVxuXG5jb25zdCB3cmFwVGltZXIgPSAodGltZXIsIGlkcykgPT4gKC4uLmFyZ3MpID0+IHtcbiAgY29uc3QgaWQgPSB0aW1lciguLi5hcmdzKVxuICBpZHMucHVzaChpZClcbiAgcmV0dXJuIGlkXG59XG5cbmNvbnN0IHNldFRpbWVvdXQgPSB3cmFwVGltZXIodGltZXJzLnNldFRpbWVvdXQsIHRpbWVvdXRzKVxuY29uc3Qgc2V0SW50ZXJ2YWwgPSB3cmFwVGltZXIodGltZXJzLnNldEludGVydmFsLCBpbnRlcnZhbHMpXG5jb25zdCBzZXRJbW1lZGlhdGUgPSB3cmFwVGltZXIodGltZXJzLnNldEltbWVkaWF0ZSwgaW1tZWRpYXRlcylcblxuZnVuY3Rpb24gY2xlYXJUaW1lcihjbGVhciwgaWRzKSB7XG4gIHdoaWxlIChpZHMubGVuZ3RoKSB7XG4gICAgY2xlYXIoaWRzLnNoaWZ0KCkpXG4gIH1cbn1cblxuZnVuY3Rpb24gcmVtb3ZlQWxsVGltZXJzKCkge1xuICBjbGVhclRpbWVyKGNsZWFyVGltZW91dCwgdGltZW91dHMpXG4gIGNsZWFyVGltZXIoY2xlYXJJbnRlcnZhbCwgaW50ZXJ2YWxzKVxuICBjbGVhclRpbWVyKGNsZWFySW1tZWRpYXRlLCBpbW1lZGlhdGVzKVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHRoZSBDbGllbnQgUmVxdWVzdCBoYXMgYmVlbiBjYW5jZWxsZWQuXG4gKlxuICogVW50aWwgTm9kZSAxNCBpcyB0aGUgbWluaW11bSwgd2UgbmVlZCB0byBsb29rIGF0IGJvdGggZmxhZ3MgdG8gc2VlIGlmIHRoZSByZXF1ZXN0IGhhcyBiZWVuIGNhbmNlbGxlZC5cbiAqIFRoZSB0d28gZmxhZ3MgaGF2ZSB0aGUgc2FtZSBwdXJwb3NlLCBidXQgdGhlIE5vZGUgbWFpbnRhaW5lcnMgYXJlIG1pZ3JhdGluZyBmcm9tIGBhYm9ydChlZClgIHRvXG4gKiBgZGVzdHJveShlZClgIHRlcm1pbm9sb2d5LCB0byBiZSBtb3JlIGNvbnNpc3RlbnQgd2l0aCBgc3RyZWFtLldyaXRhYmxlYC5cbiAqIEluIE5vZGUgMTQueCssIENhbGxpbmcgYGFib3J0KClgIHdpbGwgc2V0IGJvdGggYGFib3J0ZWRgIGFuZCBgZGVzdHJveWVkYCB0byB0cnVlLCBob3dldmVyLFxuICogY2FsbGluZyBgZGVzdHJveSgpYCB3aWxsIG9ubHkgc2V0IGBkZXN0cm95ZWRgIHRvIHRydWUuXG4gKiBGYWxsaW5nIGJhY2sgb24gY2hlY2tpbmcgaWYgdGhlIHNvY2tldCBpcyBkZXN0cm95ZWQgdG8gY292ZXIgdGhlIGNhc2Ugb2YgTm9kZSA8MTQueCB3aGVyZVxuICogYGRlc3Ryb3koKWAgaXMgY2FsbGVkLCBidXQgYGRlc3Ryb3llZGAgaXMgdW5kZWZpbmVkLlxuICpcbiAqIE5vZGUgQ2xpZW50IFJlcXVlc3QgaGlzdG9yeTpcbiAqIC0gYHJlcXVlc3QuYWJvcnQoKWA6IEFkZGVkIGluOiB2MC4zLjgsIERlcHJlY2F0ZWQgc2luY2U6IHYxNC4xLjAsIHYxMy4xNC4wXG4gKiAtIGByZXF1ZXN0LmFib3J0ZWRgOiBBZGRlZCBpbjogdjAuMTEuMTQsIEJlY2FtZSBhIGJvb2xlYW4gaW5zdGVhZCBvZiBhIHRpbWVzdGFtcDogdjExLjAuMCwgTm90IGRlcHJlY2F0ZWQgKHlldClcbiAqIC0gYHJlcXVlc3QuZGVzdHJveSgpYDogQWRkZWQgaW46IHYwLjMuMFxuICogLSBgcmVxdWVzdC5kZXN0cm95ZWRgOiBBZGRlZCBpbjogdjE0LjEuMCwgdjEzLjE0LjBcbiAqXG4gKiBAcGFyYW0ge0NsaWVudFJlcXVlc3R9IHJlcVxuICogQHJldHVybnMge2Jvb2xlYW59XG4gKi9cbmZ1bmN0aW9uIGlzUmVxdWVzdERlc3Ryb3llZChyZXEpIHtcbiAgcmV0dXJuICEhKFxuICAgIHJlcS5kZXN0cm95ZWQgPT09IHRydWUgfHxcbiAgICByZXEuYWJvcnRlZCB8fFxuICAgIChyZXEuc29ja2V0ICYmIHJlcS5zb2NrZXQuZGVzdHJveWVkKVxuICApXG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBjb250ZW50RW5jb2RpbmcsXG4gIGRhdGFFcXVhbCxcbiAgZGVsZXRlSGVhZGVyc0ZpZWxkLFxuICBmb3JFYWNoSGVhZGVyLFxuICBmb3JtYXRRdWVyeVZhbHVlLFxuICBoZWFkZXJzQXJyYXlUb09iamVjdCxcbiAgaGVhZGVyc0ZpZWxkTmFtZXNUb0xvd2VyQ2FzZSxcbiAgaGVhZGVyc0ZpZWxkc0FycmF5VG9Mb3dlckNhc2UsXG4gIGhlYWRlcnNJbnB1dFRvUmF3QXJyYXksXG4gIGlzQ29udGVudEVuY29kZWQsXG4gIGlzSlNPTkNvbnRlbnQsXG4gIGlzUGxhaW5PYmplY3QsXG4gIGlzUmVxdWVzdERlc3Ryb3llZCxcbiAgaXNTdHJlYW0sXG4gIGlzVXRmOFJlcHJlc2VudGFibGUsXG4gIG1hcFZhbHVlLFxuICBtYXRjaFN0cmluZ09yUmVnZXhwLFxuICBub3JtYWxpemVDbGllbnRSZXF1ZXN0QXJncyxcbiAgbm9ybWFsaXplT3JpZ2luLFxuICBub3JtYWxpemVSZXF1ZXN0T3B0aW9ucyxcbiAgb3ZlcnJpZGVSZXF1ZXN0cyxcbiAgcGVyY2VudERlY29kZSxcbiAgcGVyY2VudEVuY29kZSxcbiAgcmVtb3ZlQWxsVGltZXJzLFxuICByZXN0b3JlT3ZlcnJpZGRlblJlcXVlc3RzLFxuICBzZXRJbW1lZGlhdGUsXG4gIHNldEludGVydmFsLFxuICBzZXRUaW1lb3V0LFxuICBzdHJpbmdpZnlSZXF1ZXN0LFxufVxuIl19