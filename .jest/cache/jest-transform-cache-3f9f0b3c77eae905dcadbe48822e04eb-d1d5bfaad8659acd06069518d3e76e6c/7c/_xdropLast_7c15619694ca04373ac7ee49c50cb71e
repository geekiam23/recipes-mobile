3d4f054b21a1410ac5feeed3a8fc4cd5
var _curry2 = require("./_curry2");

var _xfBase = require("./_xfBase");

var XDropLast = function () {
  function XDropLast(n, xf) {
    this.xf = xf;
    this.pos = 0;
    this.full = false;
    this.acc = new Array(n);
  }

  XDropLast.prototype['@@transducer/init'] = _xfBase.init;

  XDropLast.prototype['@@transducer/result'] = function (result) {
    this.acc = null;
    return this.xf['@@transducer/result'](result);
  };

  XDropLast.prototype['@@transducer/step'] = function (result, input) {
    if (this.full) {
      result = this.xf['@@transducer/step'](result, this.acc[this.pos]);
    }

    this.store(input);
    return result;
  };

  XDropLast.prototype.store = function (input) {
    this.acc[this.pos] = input;
    this.pos += 1;

    if (this.pos === this.acc.length) {
      this.pos = 0;
      this.full = true;
    }
  };

  return XDropLast;
}();

var _xdropLast = _curry2(function _xdropLast(n, xf) {
  return new XDropLast(n, xf);
});

module.exports = _xdropLast;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl94ZHJvcExhc3QuanMiXSwibmFtZXMiOlsiX2N1cnJ5MiIsInJlcXVpcmUiLCJfeGZCYXNlIiwiWERyb3BMYXN0IiwibiIsInhmIiwicG9zIiwiZnVsbCIsImFjYyIsIkFycmF5IiwicHJvdG90eXBlIiwiaW5pdCIsInJlc3VsdCIsImlucHV0Iiwic3RvcmUiLCJsZW5ndGgiLCJfeGRyb3BMYXN0IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsT0FBTyxHQUFnQkMsT0FBTyxhQUFsQzs7QUFFQSxJQUFJQyxPQUFPLEdBQWdCRCxPQUFPLGFBQWxDOztBQUVBLElBQUlFLFNBQVMsR0FBZ0IsWUFBWTtBQUV2QyxXQUFTQSxTQUFULENBQW1CQyxDQUFuQixFQUFzQkMsRUFBdEIsRUFBMEI7QUFDeEIsU0FBS0EsRUFBTCxHQUFVQSxFQUFWO0FBQ0EsU0FBS0MsR0FBTCxHQUFXLENBQVg7QUFDQSxTQUFLQyxJQUFMLEdBQVksS0FBWjtBQUNBLFNBQUtDLEdBQUwsR0FBVyxJQUFJQyxLQUFKLENBQVVMLENBQVYsQ0FBWDtBQUNEOztBQUNERCxFQUFBQSxTQUFTLENBQUNPLFNBQVYsQ0FBb0IsbUJBQXBCLElBQTJDUixPQUFPLENBQUNTLElBQW5EOztBQUNBUixFQUFBQSxTQUFTLENBQUNPLFNBQVYsQ0FBb0IscUJBQXBCLElBQTZDLFVBQVVFLE1BQVYsRUFBa0I7QUFDN0QsU0FBS0osR0FBTCxHQUFXLElBQVg7QUFDQSxXQUFPLEtBQUtILEVBQUwsQ0FBUSxxQkFBUixFQUErQk8sTUFBL0IsQ0FBUDtBQUNELEdBSEQ7O0FBSUFULEVBQUFBLFNBQVMsQ0FBQ08sU0FBVixDQUFvQixtQkFBcEIsSUFBMkMsVUFBVUUsTUFBVixFQUFrQkMsS0FBbEIsRUFBeUI7QUFDbEUsUUFBSSxLQUFLTixJQUFULEVBQWU7QUFDYkssTUFBQUEsTUFBTSxHQUFHLEtBQUtQLEVBQUwsQ0FBUSxtQkFBUixFQUE2Qk8sTUFBN0IsRUFBcUMsS0FBS0osR0FBTCxDQUFTLEtBQUtGLEdBQWQsQ0FBckMsQ0FBVDtBQUNEOztBQUNELFNBQUtRLEtBQUwsQ0FBV0QsS0FBWDtBQUNBLFdBQU9ELE1BQVA7QUFDRCxHQU5EOztBQU9BVCxFQUFBQSxTQUFTLENBQUNPLFNBQVYsQ0FBb0JJLEtBQXBCLEdBQTRCLFVBQVVELEtBQVYsRUFBaUI7QUFDM0MsU0FBS0wsR0FBTCxDQUFTLEtBQUtGLEdBQWQsSUFBcUJPLEtBQXJCO0FBQ0EsU0FBS1AsR0FBTCxJQUFZLENBQVo7O0FBQ0EsUUFBSSxLQUFLQSxHQUFMLEtBQWEsS0FBS0UsR0FBTCxDQUFTTyxNQUExQixFQUFrQztBQUNoQyxXQUFLVCxHQUFMLEdBQVcsQ0FBWDtBQUNBLFdBQUtDLElBQUwsR0FBWSxJQUFaO0FBQ0Q7QUFDRixHQVBEOztBQVNBLFNBQU9KLFNBQVA7QUFDRCxDQTlCNEIsRUFBN0I7O0FBZ0NBLElBQUlhLFVBQVUsR0FBZ0JoQixPQUFPLENBQUMsU0FBU2dCLFVBQVQsQ0FBb0JaLENBQXBCLEVBQXVCQyxFQUF2QixFQUEyQjtBQUMvRCxTQUFPLElBQUlGLFNBQUosQ0FBY0MsQ0FBZCxFQUFpQkMsRUFBakIsQ0FBUDtBQUNELENBRm9DLENBQXJDOztBQUdBWSxNQUFNLENBQUNDLE9BQVAsR0FBaUJGLFVBQWpCIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF9jdXJyeTIgPSAvKiNfX1BVUkVfXyovcmVxdWlyZSgnLi9fY3VycnkyJyk7XG5cbnZhciBfeGZCYXNlID0gLyojX19QVVJFX18qL3JlcXVpcmUoJy4vX3hmQmFzZScpO1xuXG52YXIgWERyb3BMYXN0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcblxuICBmdW5jdGlvbiBYRHJvcExhc3QobiwgeGYpIHtcbiAgICB0aGlzLnhmID0geGY7XG4gICAgdGhpcy5wb3MgPSAwO1xuICAgIHRoaXMuZnVsbCA9IGZhbHNlO1xuICAgIHRoaXMuYWNjID0gbmV3IEFycmF5KG4pO1xuICB9XG4gIFhEcm9wTGFzdC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9pbml0J10gPSBfeGZCYXNlLmluaXQ7XG4gIFhEcm9wTGFzdC5wcm90b3R5cGVbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXSA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICB0aGlzLmFjYyA9IG51bGw7XG4gICAgcmV0dXJuIHRoaXMueGZbJ0BAdHJhbnNkdWNlci9yZXN1bHQnXShyZXN1bHQpO1xuICB9O1xuICBYRHJvcExhc3QucHJvdG90eXBlWydAQHRyYW5zZHVjZXIvc3RlcCddID0gZnVuY3Rpb24gKHJlc3VsdCwgaW5wdXQpIHtcbiAgICBpZiAodGhpcy5mdWxsKSB7XG4gICAgICByZXN1bHQgPSB0aGlzLnhmWydAQHRyYW5zZHVjZXIvc3RlcCddKHJlc3VsdCwgdGhpcy5hY2NbdGhpcy5wb3NdKTtcbiAgICB9XG4gICAgdGhpcy5zdG9yZShpbnB1dCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcbiAgWERyb3BMYXN0LnByb3RvdHlwZS5zdG9yZSA9IGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIHRoaXMuYWNjW3RoaXMucG9zXSA9IGlucHV0O1xuICAgIHRoaXMucG9zICs9IDE7XG4gICAgaWYgKHRoaXMucG9zID09PSB0aGlzLmFjYy5sZW5ndGgpIHtcbiAgICAgIHRoaXMucG9zID0gMDtcbiAgICAgIHRoaXMuZnVsbCA9IHRydWU7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBYRHJvcExhc3Q7XG59KCk7XG5cbnZhciBfeGRyb3BMYXN0ID0gLyojX19QVVJFX18qL19jdXJyeTIoZnVuY3Rpb24gX3hkcm9wTGFzdChuLCB4Zikge1xuICByZXR1cm4gbmV3IFhEcm9wTGFzdChuLCB4Zik7XG59KTtcbm1vZHVsZS5leHBvcnRzID0gX3hkcm9wTGFzdDsiXX0=