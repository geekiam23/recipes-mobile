85a61f8837119deb46228dfb57c64ca3
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.cleanupSemantic = exports.DIFF_INSERT = exports.DIFF_DELETE = exports.DIFF_EQUAL = exports.Diff = void 0;

function _defineProperty(obj, key, value) {
  if (key in obj) {
    Object.defineProperty(obj, key, {
      value: value,
      enumerable: true,
      configurable: true,
      writable: true
    });
  } else {
    obj[key] = value;
  }

  return obj;
}

var DIFF_DELETE = -1;
exports.DIFF_DELETE = DIFF_DELETE;
var DIFF_INSERT = 1;
exports.DIFF_INSERT = DIFF_INSERT;
var DIFF_EQUAL = 0;
exports.DIFF_EQUAL = DIFF_EQUAL;

var Diff = function Diff(op, text) {
  (0, _classCallCheck2.default)(this, Diff);

  _defineProperty(this, 0, void 0);

  _defineProperty(this, 1, void 0);

  this[0] = op;
  this[1] = text;
};

exports.Diff = Diff;

var diff_commonPrefix = function diff_commonPrefix(text1, text2) {
  if (!text1 || !text2 || text1.charAt(0) != text2.charAt(0)) {
    return 0;
  }

  var pointermin = 0;
  var pointermax = Math.min(text1.length, text2.length);
  var pointermid = pointermax;
  var pointerstart = 0;

  while (pointermin < pointermid) {
    if (text1.substring(pointerstart, pointermid) == text2.substring(pointerstart, pointermid)) {
      pointermin = pointermid;
      pointerstart = pointermin;
    } else {
      pointermax = pointermid;
    }

    pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);
  }

  return pointermid;
};

var diff_commonSuffix = function diff_commonSuffix(text1, text2) {
  if (!text1 || !text2 || text1.charAt(text1.length - 1) != text2.charAt(text2.length - 1)) {
    return 0;
  }

  var pointermin = 0;
  var pointermax = Math.min(text1.length, text2.length);
  var pointermid = pointermax;
  var pointerend = 0;

  while (pointermin < pointermid) {
    if (text1.substring(text1.length - pointermid, text1.length - pointerend) == text2.substring(text2.length - pointermid, text2.length - pointerend)) {
      pointermin = pointermid;
      pointerend = pointermin;
    } else {
      pointermax = pointermid;
    }

    pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);
  }

  return pointermid;
};

var diff_commonOverlap_ = function diff_commonOverlap_(text1, text2) {
  var text1_length = text1.length;
  var text2_length = text2.length;

  if (text1_length == 0 || text2_length == 0) {
    return 0;
  }

  if (text1_length > text2_length) {
    text1 = text1.substring(text1_length - text2_length);
  } else if (text1_length < text2_length) {
    text2 = text2.substring(0, text1_length);
  }

  var text_length = Math.min(text1_length, text2_length);

  if (text1 == text2) {
    return text_length;
  }

  var best = 0;
  var length = 1;

  while (true) {
    var pattern = text1.substring(text_length - length);
    var found = text2.indexOf(pattern);

    if (found == -1) {
      return best;
    }

    length += found;

    if (found == 0 || text1.substring(text_length - length) == text2.substring(0, length)) {
      best = length;
      length++;
    }
  }
};

var diff_cleanupSemantic = function diff_cleanupSemantic(diffs) {
  var changes = false;
  var equalities = [];
  var equalitiesLength = 0;
  var lastEquality = null;
  var pointer = 0;
  var length_insertions1 = 0;
  var length_deletions1 = 0;
  var length_insertions2 = 0;
  var length_deletions2 = 0;

  while (pointer < diffs.length) {
    if (diffs[pointer][0] == DIFF_EQUAL) {
      equalities[equalitiesLength++] = pointer;
      length_insertions1 = length_insertions2;
      length_deletions1 = length_deletions2;
      length_insertions2 = 0;
      length_deletions2 = 0;
      lastEquality = diffs[pointer][1];
    } else {
      if (diffs[pointer][0] == DIFF_INSERT) {
        length_insertions2 += diffs[pointer][1].length;
      } else {
        length_deletions2 += diffs[pointer][1].length;
      }

      if (lastEquality && lastEquality.length <= Math.max(length_insertions1, length_deletions1) && lastEquality.length <= Math.max(length_insertions2, length_deletions2)) {
        diffs.splice(equalities[equalitiesLength - 1], 0, new Diff(DIFF_DELETE, lastEquality));
        diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT;
        equalitiesLength--;
        equalitiesLength--;
        pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1;
        length_insertions1 = 0;
        length_deletions1 = 0;
        length_insertions2 = 0;
        length_deletions2 = 0;
        lastEquality = null;
        changes = true;
      }
    }

    pointer++;
  }

  if (changes) {
    diff_cleanupMerge(diffs);
  }

  diff_cleanupSemanticLossless(diffs);
  pointer = 1;

  while (pointer < diffs.length) {
    if (diffs[pointer - 1][0] == DIFF_DELETE && diffs[pointer][0] == DIFF_INSERT) {
      var deletion = diffs[pointer - 1][1];
      var insertion = diffs[pointer][1];
      var overlap_length1 = diff_commonOverlap_(deletion, insertion);
      var overlap_length2 = diff_commonOverlap_(insertion, deletion);

      if (overlap_length1 >= overlap_length2) {
        if (overlap_length1 >= deletion.length / 2 || overlap_length1 >= insertion.length / 2) {
          diffs.splice(pointer, 0, new Diff(DIFF_EQUAL, insertion.substring(0, overlap_length1)));
          diffs[pointer - 1][1] = deletion.substring(0, deletion.length - overlap_length1);
          diffs[pointer + 1][1] = insertion.substring(overlap_length1);
          pointer++;
        }
      } else {
        if (overlap_length2 >= deletion.length / 2 || overlap_length2 >= insertion.length / 2) {
          diffs.splice(pointer, 0, new Diff(DIFF_EQUAL, deletion.substring(0, overlap_length2)));
          diffs[pointer - 1][0] = DIFF_INSERT;
          diffs[pointer - 1][1] = insertion.substring(0, insertion.length - overlap_length2);
          diffs[pointer + 1][0] = DIFF_DELETE;
          diffs[pointer + 1][1] = deletion.substring(overlap_length2);
          pointer++;
        }
      }

      pointer++;
    }

    pointer++;
  }
};

exports.cleanupSemantic = diff_cleanupSemantic;

var diff_cleanupSemanticLossless = function diff_cleanupSemanticLossless(diffs) {
  function diff_cleanupSemanticScore_(one, two) {
    if (!one || !two) {
      return 6;
    }

    var char1 = one.charAt(one.length - 1);
    var char2 = two.charAt(0);
    var nonAlphaNumeric1 = char1.match(nonAlphaNumericRegex_);
    var nonAlphaNumeric2 = char2.match(nonAlphaNumericRegex_);
    var whitespace1 = nonAlphaNumeric1 && char1.match(whitespaceRegex_);
    var whitespace2 = nonAlphaNumeric2 && char2.match(whitespaceRegex_);
    var lineBreak1 = whitespace1 && char1.match(linebreakRegex_);
    var lineBreak2 = whitespace2 && char2.match(linebreakRegex_);
    var blankLine1 = lineBreak1 && one.match(blanklineEndRegex_);
    var blankLine2 = lineBreak2 && two.match(blanklineStartRegex_);

    if (blankLine1 || blankLine2) {
      return 5;
    } else if (lineBreak1 || lineBreak2) {
      return 4;
    } else if (nonAlphaNumeric1 && !whitespace1 && whitespace2) {
      return 3;
    } else if (whitespace1 || whitespace2) {
      return 2;
    } else if (nonAlphaNumeric1 || nonAlphaNumeric2) {
      return 1;
    }

    return 0;
  }

  var pointer = 1;

  while (pointer < diffs.length - 1) {
    if (diffs[pointer - 1][0] == DIFF_EQUAL && diffs[pointer + 1][0] == DIFF_EQUAL) {
      var equality1 = diffs[pointer - 1][1];
      var edit = diffs[pointer][1];
      var equality2 = diffs[pointer + 1][1];
      var commonOffset = diff_commonSuffix(equality1, edit);

      if (commonOffset) {
        var commonString = edit.substring(edit.length - commonOffset);
        equality1 = equality1.substring(0, equality1.length - commonOffset);
        edit = commonString + edit.substring(0, edit.length - commonOffset);
        equality2 = commonString + equality2;
      }

      var bestEquality1 = equality1;
      var bestEdit = edit;
      var bestEquality2 = equality2;
      var bestScore = diff_cleanupSemanticScore_(equality1, edit) + diff_cleanupSemanticScore_(edit, equality2);

      while (edit.charAt(0) === equality2.charAt(0)) {
        equality1 += edit.charAt(0);
        edit = edit.substring(1) + equality2.charAt(0);
        equality2 = equality2.substring(1);
        var score = diff_cleanupSemanticScore_(equality1, edit) + diff_cleanupSemanticScore_(edit, equality2);

        if (score >= bestScore) {
          bestScore = score;
          bestEquality1 = equality1;
          bestEdit = edit;
          bestEquality2 = equality2;
        }
      }

      if (diffs[pointer - 1][1] != bestEquality1) {
        if (bestEquality1) {
          diffs[pointer - 1][1] = bestEquality1;
        } else {
          diffs.splice(pointer - 1, 1);
          pointer--;
        }

        diffs[pointer][1] = bestEdit;

        if (bestEquality2) {
          diffs[pointer + 1][1] = bestEquality2;
        } else {
          diffs.splice(pointer + 1, 1);
          pointer--;
        }
      }
    }

    pointer++;
  }
};

var nonAlphaNumericRegex_ = /[^a-zA-Z0-9]/;
var whitespaceRegex_ = /\s/;
var linebreakRegex_ = /[\r\n]/;
var blanklineEndRegex_ = /\n\r?\n$/;
var blanklineStartRegex_ = /^\r?\n\r?\n/;

var diff_cleanupMerge = function diff_cleanupMerge(diffs) {
  diffs.push(new Diff(DIFF_EQUAL, ''));
  var pointer = 0;
  var count_delete = 0;
  var count_insert = 0;
  var text_delete = '';
  var text_insert = '';
  var commonlength;

  while (pointer < diffs.length) {
    switch (diffs[pointer][0]) {
      case DIFF_INSERT:
        count_insert++;
        text_insert += diffs[pointer][1];
        pointer++;
        break;

      case DIFF_DELETE:
        count_delete++;
        text_delete += diffs[pointer][1];
        pointer++;
        break;

      case DIFF_EQUAL:
        if (count_delete + count_insert > 1) {
          if (count_delete !== 0 && count_insert !== 0) {
            commonlength = diff_commonPrefix(text_insert, text_delete);

            if (commonlength !== 0) {
              if (pointer - count_delete - count_insert > 0 && diffs[pointer - count_delete - count_insert - 1][0] == DIFF_EQUAL) {
                diffs[pointer - count_delete - count_insert - 1][1] += text_insert.substring(0, commonlength);
              } else {
                diffs.splice(0, 0, new Diff(DIFF_EQUAL, text_insert.substring(0, commonlength)));
                pointer++;
              }

              text_insert = text_insert.substring(commonlength);
              text_delete = text_delete.substring(commonlength);
            }

            commonlength = diff_commonSuffix(text_insert, text_delete);

            if (commonlength !== 0) {
              diffs[pointer][1] = text_insert.substring(text_insert.length - commonlength) + diffs[pointer][1];
              text_insert = text_insert.substring(0, text_insert.length - commonlength);
              text_delete = text_delete.substring(0, text_delete.length - commonlength);
            }
          }

          pointer -= count_delete + count_insert;
          diffs.splice(pointer, count_delete + count_insert);

          if (text_delete.length) {
            diffs.splice(pointer, 0, new Diff(DIFF_DELETE, text_delete));
            pointer++;
          }

          if (text_insert.length) {
            diffs.splice(pointer, 0, new Diff(DIFF_INSERT, text_insert));
            pointer++;
          }

          pointer++;
        } else if (pointer !== 0 && diffs[pointer - 1][0] == DIFF_EQUAL) {
          diffs[pointer - 1][1] += diffs[pointer][1];
          diffs.splice(pointer, 1);
        } else {
          pointer++;
        }

        count_insert = 0;
        count_delete = 0;
        text_delete = '';
        text_insert = '';
        break;
    }
  }

  if (diffs[diffs.length - 1][1] === '') {
    diffs.pop();
  }

  var changes = false;
  pointer = 1;

  while (pointer < diffs.length - 1) {
    if (diffs[pointer - 1][0] == DIFF_EQUAL && diffs[pointer + 1][0] == DIFF_EQUAL) {
      if (diffs[pointer][1].substring(diffs[pointer][1].length - diffs[pointer - 1][1].length) == diffs[pointer - 1][1]) {
        diffs[pointer][1] = diffs[pointer - 1][1] + diffs[pointer][1].substring(0, diffs[pointer][1].length - diffs[pointer - 1][1].length);
        diffs[pointer + 1][1] = diffs[pointer - 1][1] + diffs[pointer + 1][1];
        diffs.splice(pointer - 1, 1);
        changes = true;
      } else if (diffs[pointer][1].substring(0, diffs[pointer + 1][1].length) == diffs[pointer + 1][1]) {
        diffs[pointer - 1][1] += diffs[pointer + 1][1];
        diffs[pointer][1] = diffs[pointer][1].substring(diffs[pointer + 1][1].length) + diffs[pointer + 1][1];
        diffs.splice(pointer + 1, 1);
        changes = true;
      }
    }

    pointer++;
  }

  if (changes) {
    diff_cleanupMerge(diffs);
  }
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNsZWFudXBTZW1hbnRpYy5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImNsZWFudXBTZW1hbnRpYyIsIkRJRkZfSU5TRVJUIiwiRElGRl9ERUxFVEUiLCJESUZGX0VRVUFMIiwiRGlmZiIsIl9kZWZpbmVQcm9wZXJ0eSIsIm9iaiIsImtleSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsIm9wIiwidGV4dCIsImRpZmZfY29tbW9uUHJlZml4IiwidGV4dDEiLCJ0ZXh0MiIsImNoYXJBdCIsInBvaW50ZXJtaW4iLCJwb2ludGVybWF4IiwiTWF0aCIsIm1pbiIsImxlbmd0aCIsInBvaW50ZXJtaWQiLCJwb2ludGVyc3RhcnQiLCJzdWJzdHJpbmciLCJmbG9vciIsImRpZmZfY29tbW9uU3VmZml4IiwicG9pbnRlcmVuZCIsImRpZmZfY29tbW9uT3ZlcmxhcF8iLCJ0ZXh0MV9sZW5ndGgiLCJ0ZXh0Ml9sZW5ndGgiLCJ0ZXh0X2xlbmd0aCIsImJlc3QiLCJwYXR0ZXJuIiwiZm91bmQiLCJpbmRleE9mIiwiZGlmZl9jbGVhbnVwU2VtYW50aWMiLCJkaWZmcyIsImNoYW5nZXMiLCJlcXVhbGl0aWVzIiwiZXF1YWxpdGllc0xlbmd0aCIsImxhc3RFcXVhbGl0eSIsInBvaW50ZXIiLCJsZW5ndGhfaW5zZXJ0aW9uczEiLCJsZW5ndGhfZGVsZXRpb25zMSIsImxlbmd0aF9pbnNlcnRpb25zMiIsImxlbmd0aF9kZWxldGlvbnMyIiwibWF4Iiwic3BsaWNlIiwiZGlmZl9jbGVhbnVwTWVyZ2UiLCJkaWZmX2NsZWFudXBTZW1hbnRpY0xvc3NsZXNzIiwiZGVsZXRpb24iLCJpbnNlcnRpb24iLCJvdmVybGFwX2xlbmd0aDEiLCJvdmVybGFwX2xlbmd0aDIiLCJkaWZmX2NsZWFudXBTZW1hbnRpY1Njb3JlXyIsIm9uZSIsInR3byIsImNoYXIxIiwiY2hhcjIiLCJub25BbHBoYU51bWVyaWMxIiwibWF0Y2giLCJub25BbHBoYU51bWVyaWNSZWdleF8iLCJub25BbHBoYU51bWVyaWMyIiwid2hpdGVzcGFjZTEiLCJ3aGl0ZXNwYWNlUmVnZXhfIiwid2hpdGVzcGFjZTIiLCJsaW5lQnJlYWsxIiwibGluZWJyZWFrUmVnZXhfIiwibGluZUJyZWFrMiIsImJsYW5rTGluZTEiLCJibGFua2xpbmVFbmRSZWdleF8iLCJibGFua0xpbmUyIiwiYmxhbmtsaW5lU3RhcnRSZWdleF8iLCJlcXVhbGl0eTEiLCJlZGl0IiwiZXF1YWxpdHkyIiwiY29tbW9uT2Zmc2V0IiwiY29tbW9uU3RyaW5nIiwiYmVzdEVxdWFsaXR5MSIsImJlc3RFZGl0IiwiYmVzdEVxdWFsaXR5MiIsImJlc3RTY29yZSIsInNjb3JlIiwicHVzaCIsImNvdW50X2RlbGV0ZSIsImNvdW50X2luc2VydCIsInRleHRfZGVsZXRlIiwidGV4dF9pbnNlcnQiLCJjb21tb25sZW5ndGgiLCJwb3AiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7QUFFQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztBQUMzQ0MsRUFBQUEsS0FBSyxFQUFFO0FBRG9DLENBQTdDO0FBR0FELE9BQU8sQ0FBQ0UsZUFBUixHQUEwQkYsT0FBTyxDQUFDRyxXQUFSLEdBQXNCSCxPQUFPLENBQUNJLFdBQVIsR0FBc0JKLE9BQU8sQ0FBQ0ssVUFBUixHQUFxQkwsT0FBTyxDQUFDTSxJQUFSLEdBQWUsS0FBSyxDQUEvRzs7QUFFQSxTQUFTQyxlQUFULENBQXlCQyxHQUF6QixFQUE4QkMsR0FBOUIsRUFBbUNSLEtBQW5DLEVBQTBDO0FBQ3hDLE1BQUlRLEdBQUcsSUFBSUQsR0FBWCxFQUFnQjtBQUNkVixJQUFBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JTLEdBQXRCLEVBQTJCQyxHQUEzQixFQUFnQztBQUM5QlIsTUFBQUEsS0FBSyxFQUFFQSxLQUR1QjtBQUU5QlMsTUFBQUEsVUFBVSxFQUFFLElBRmtCO0FBRzlCQyxNQUFBQSxZQUFZLEVB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T0FBTyxHQUFHLENBQVgsQ0FBTCxDQUFtQixDQUFuQixDQUF6QjtBQUNBTCxRQUFBQSxLQUFLLENBQUNLLE9BQUQsQ0FBTCxDQUFlLENBQWYsSUFDRUwsS0FBSyxDQUFDSyxPQUFELENBQUwsQ0FBZSxDQUFmLEVBQWtCbEIsU0FBbEIsQ0FBNEJhLEtBQUssQ0FBQ0ssT0FBTyxHQUFHLENBQVgsQ0FBTCxDQUFtQixDQUFuQixFQUFzQnJCLE1BQWxELElBQ0FnQixLQUFLLENBQUNLLE9BQU8sR0FBRyxDQUFYLENBQUwsQ0FBbUIsQ0FBbkIsQ0FGRjtBQUdBTCxRQUFBQSxLQUFLLENBQUNXLE1BQU4sQ0FBYU4sT0FBTyxHQUFHLENBQXZCLEVBQTBCLENBQTFCO0FBQ0FKLFFBQUFBLE9BQU8sR0FBRyxJQUFWO0FBQ0Q7QUFDRjs7QUFFREksSUFBQUEsT0FBTztBQUNSOztBQUVELE1BQUlKLE9BQUosRUFBYTtBQUNYVyxJQUFBQSxpQkFBaUIsQ0FBQ1osS0FBRCxDQUFqQjtBQUNEO0FBQ0YsQ0F0SkQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5jbGVhbnVwU2VtYW50aWMgPSBleHBvcnRzLkRJRkZfSU5TRVJUID0gZXhwb3J0cy5ESUZGX0RFTEVURSA9IGV4cG9ydHMuRElGRl9FUVVBTCA9IGV4cG9ydHMuRGlmZiA9IHZvaWQgMDtcblxuZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkge1xuICBpZiAoa2V5IGluIG9iaikge1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwge1xuICAgICAgdmFsdWU6IHZhbHVlLFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgb2JqW2tleV0gPSB2YWx1ZTtcbiAgfVxuICByZXR1cm4gb2JqO1xufVxuXG4vKipcbiAqIERpZmYgTWF0Y2ggYW5kIFBhdGNoXG4gKiBDb3B5cmlnaHQgMjAxOCBUaGUgZGlmZi1tYXRjaC1wYXRjaCBBdXRob3JzLlxuICogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9kaWZmLW1hdGNoLXBhdGNoXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKipcbiAqIEBmaWxlb3ZlcnZpZXcgQ29tcHV0ZXMgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0d28gdGV4dHMgdG8gY3JlYXRlIGEgcGF0Y2guXG4gKiBBcHBsaWVzIHRoZSBwYXRjaCBvbnRvIGFub3RoZXIgdGV4dCwgYWxsb3dpbmcgZm9yIGVycm9ycy5cbiAqIEBhdXRob3IgZnJhc2VyQGdvb2dsZS5jb20gKE5laWwgRnJhc2VyKVxuICovXG5cbi8qKlxuICogQ0hBTkdFUyBieSBwZWRyb3R0aW1hcmsgdG8gZGlmZl9tYXRjaF9wYXRjaF91bmNvbXByZXNzZWQudHMgZmlsZTpcbiAqXG4gKiAxLiBEZWxldGUgYW55dGhpbmcgbm90IG5lZWRlZCB0byB1c2UgZGlmZl9jbGVhbnVwU2VtYW50aWMgbWV0aG9kXG4gKiAyLiBDb252ZXJ0IGZyb20gcHJvdG90eXBlIHByb3BlcnRpZXMgdG8gdmFyIGRlY2xhcmF0aW9uc1xuICogMy4gQ29udmVydCBEaWZmIHRvIGNsYXNzIGZyb20gY29uc3RydWN0b3IgYW5kIHByb3RvdHlwZVxuICogNC4gQWRkIHR5cGUgYW5ub3RhdGlvbnMgZm9yIGFyZ3VtZW50cyBhbmQgcmV0dXJuIHZhbHVlc1xuICogNS4gQWRkIGV4cG9ydHNcbiAqL1xuXG4vKipcbiAqIFRoZSBkYXRhIHN0cnVjdHVyZSByZXByZXNlbnRpbmcgYSBkaWZmIGlzIGFuIGFycmF5IG9mIHR1cGxlczpcbiAqIFtbRElGRl9ERUxFVEUsICdIZWxsbyddLCBbRElGRl9JTlNFUlQsICdHb29kYnllJ10sIFtESUZGX0VRVUFMLCAnIHdvcmxkLiddXVxuICogd2hpY2ggbWVhbnM6IGRlbGV0ZSAnSGVsbG8nLCBhZGQgJ0dvb2RieWUnIGFuZCBrZWVwICcgd29ybGQuJ1xuICovXG52YXIgRElGRl9ERUxFVEUgPSAtMTtcbmV4cG9ydHMuRElGRl9ERUxFVEUgPSBESUZGX0RFTEVURTtcbnZhciBESUZGX0lOU0VSVCA9IDE7XG5leHBvcnRzLkRJRkZfSU5TRVJUID0gRElGRl9JTlNFUlQ7XG52YXIgRElGRl9FUVVBTCA9IDA7XG4vKipcbiAqIENsYXNzIHJlcHJlc2VudGluZyBvbmUgZGlmZiB0dXBsZS5cbiAqIEF0dGVtcHRzIHRvIGxvb2sgbGlrZSBhIHR3by1lbGVtZW50IGFycmF5ICh3aGljaCBpcyB3aGF0IHRoaXMgdXNlZCB0byBiZSkuXG4gKiBAcGFyYW0ge251bWJlcn0gb3AgT3BlcmF0aW9uLCBvbmUgb2Y6IERJRkZfREVMRVRFLCBESUZGX0lOU0VSVCwgRElGRl9FUVVBTC5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0IFRleHQgdG8gYmUgZGVsZXRlZCwgaW5zZXJ0ZWQsIG9yIHJldGFpbmVkLlxuICogQGNvbnN0cnVjdG9yXG4gKi9cblxuZXhwb3J0cy5ESUZGX0VRVUFMID0gRElGRl9FUVVBTDtcblxuY2xhc3MgRGlmZiB7XG4gIGNvbnN0cnVjdG9yKG9wLCB0ZXh0KSB7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIDAsIHZvaWQgMCk7XG5cbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgMSwgdm9pZCAwKTtcblxuICAgIHRoaXNbMF0gPSBvcDtcbiAgICB0aGlzWzFdID0gdGV4dDtcbiAgfVxufVxuLyoqXG4gKiBEZXRlcm1pbmUgdGhlIGNvbW1vbiBwcmVmaXggb2YgdHdvIHN0cmluZ3MuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgRmlyc3Qgc3RyaW5nLlxuICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIFNlY29uZCBzdHJpbmcuXG4gKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBjb21tb24gdG8gdGhlIHN0YXJ0IG9mIGVhY2hcbiAqICAgICBzdHJpbmcuXG4gKi9cblxuZXhwb3J0cy5EaWZmID0gRGlmZjtcblxudmFyIGRpZmZfY29tbW9uUHJlZml4ID0gZnVuY3Rpb24gZGlmZl9jb21tb25QcmVmaXgodGV4dDEsIHRleHQyKSB7XG4gIC8vIFF1aWNrIGNoZWNrIGZvciBjb21tb24gbnVsbCBjYXNlcy5cbiAgaWYgKCF0ZXh0MSB8fCAhdGV4dDIgfHwgdGV4dDEuY2hhckF0KDApICE9IHRleHQyLmNoYXJBdCgwKSkge1xuICAgIHJldHVybiAwO1xuICB9IC8vIEJpbmFyeSBzZWFyY2guXG4gIC8vIFBlcmZvcm1hbmNlIGFuYWx5c2lzOiBodHRwczovL25laWwuZnJhc2VyLm5hbWUvbmV3cy8yMDA3LzEwLzA5L1xuXG4gIHZhciBwb2ludGVybWluID0gMDtcbiAgdmFyIHBvaW50ZXJtYXggPSBNYXRoLm1pbih0ZXh0MS5sZW5ndGgsIHRleHQyLmxlbmd0aCk7XG4gIHZhciBwb2ludGVybWlkID0gcG9pbnRlcm1heDtcbiAgdmFyIHBvaW50ZXJzdGFydCA9IDA7XG5cbiAgd2hpbGUgKHBvaW50ZXJtaW4gPCBwb2ludGVybWlkKSB7XG4gICAgaWYgKFxuICAgICAgdGV4dDEuc3Vic3RyaW5nKHBvaW50ZXJzdGFydCwgcG9pbnRlcm1pZCkgPT1cbiAgICAgIHRleHQyLnN1YnN0cmluZyhwb2ludGVyc3RhcnQsIHBvaW50ZXJtaWQpXG4gICAgKSB7XG4gICAgICBwb2ludGVybWluID0gcG9pbnRlcm1pZDtcbiAgICAgIHBvaW50ZXJzdGFydCA9IHBvaW50ZXJtaW47XG4gICAgfSBlbHNlIHtcbiAgICAgIHBvaW50ZXJtYXggPSBwb2ludGVybWlkO1xuICAgIH1cblxuICAgIHBvaW50ZXJtaWQgPSBNYXRoLmZsb29yKChwb2ludGVybWF4IC0gcG9pbnRlcm1pbikgLyAyICsgcG9pbnRlcm1pbik7XG4gIH1cblxuICByZXR1cm4gcG9pbnRlcm1pZDtcbn07XG4vKipcbiAqIERldGVybWluZSB0aGUgY29tbW9uIHN1ZmZpeCBvZiB0d28gc3RyaW5ncy5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MSBGaXJzdCBzdHJpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dDIgU2Vjb25kIHN0cmluZy5cbiAqIEByZXR1cm4ge251bWJlcn0gVGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGNvbW1vbiB0byB0aGUgZW5kIG9mIGVhY2ggc3RyaW5nLlxuICovXG5cbnZhciBkaWZmX2NvbW1vblN1ZmZpeCA9IGZ1bmN0aW9uIGRpZmZfY29tbW9uU3VmZml4KHRleHQxLCB0ZXh0Mikge1xuICAvLyBRdWljayBjaGVjayBmb3IgY29tbW9uIG51bGwgY2FzZXMuXG4gIGlmIChcbiAgICAhdGV4dDEgfHxcbiAgICAhdGV4dDIgfHxcbiAgICB0ZXh0MS5jaGFyQXQodGV4dDEubGVuZ3RoIC0gMSkgIT0gdGV4dDIuY2hhckF0KHRleHQyLmxlbmd0aCAtIDEpXG4gICkge1xuICAgIHJldHVybiAwO1xuICB9IC8vIEJpbmFyeSBzZWFyY2guXG4gIC8vIFBlcmZvcm1hbmNlIGFuYWx5c2lzOiBodHRwczovL25laWwuZnJhc2VyLm5hbWUvbmV3cy8yMDA3LzEwLzA5L1xuXG4gIHZhciBwb2ludGVybWluID0gMDtcbiAgdmFyIHBvaW50ZXJtYXggPSBNYXRoLm1pbih0ZXh0MS5sZW5ndGgsIHRleHQyLmxlbmd0aCk7XG4gIHZhciBwb2ludGVybWlkID0gcG9pbnRlcm1heDtcbiAgdmFyIHBvaW50ZXJlbmQgPSAwO1xuXG4gIHdoaWxlIChwb2ludGVybWluIDwgcG9pbnRlcm1pZCkge1xuICAgIGlmIChcbiAgICAgIHRleHQxLnN1YnN0cmluZyh0ZXh0MS5sZW5ndGggLSBwb2ludGVybWlkLCB0ZXh0MS5sZW5ndGggLSBwb2ludGVyZW5kKSA9PVxuICAgICAgdGV4dDIuc3Vic3RyaW5nKHRleHQyLmxlbmd0aCAtIHBvaW50ZXJtaWQsIHRleHQyLmxlbmd0aCAtIHBvaW50ZXJlbmQpXG4gICAgKSB7XG4gICAgICBwb2ludGVybWluID0gcG9pbnRlcm1pZDtcbiAgICAgIHBvaW50ZXJlbmQgPSBwb2ludGVybWluO1xuICAgIH0gZWxzZSB7XG4gICAgICBwb2ludGVybWF4ID0gcG9pbnRlcm1pZDtcbiAgICB9XG5cbiAgICBwb2ludGVybWlkID0gTWF0aC5mbG9vcigocG9pbnRlcm1heCAtIHBvaW50ZXJtaW4pIC8gMiArIHBvaW50ZXJtaW4pO1xuICB9XG5cbiAgcmV0dXJuIHBvaW50ZXJtaWQ7XG59O1xuLyoqXG4gKiBEZXRlcm1pbmUgaWYgdGhlIHN1ZmZpeCBvZiBvbmUgc3RyaW5nIGlzIHRoZSBwcmVmaXggb2YgYW5vdGhlci5cbiAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MSBGaXJzdCBzdHJpbmcuXG4gKiBAcGFyYW0ge3N0cmluZ30gdGV4dDIgU2Vjb25kIHN0cmluZy5cbiAqIEByZXR1cm4ge251bWJlcn0gVGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGNvbW1vbiB0byB0aGUgZW5kIG9mIHRoZSBmaXJzdFxuICogICAgIHN0cmluZyBhbmQgdGhlIHN0YXJ0IG9mIHRoZSBzZWNvbmQgc3RyaW5nLlxuICogQHByaXZhdGVcbiAqL1xuXG52YXIgZGlmZl9jb21tb25PdmVybGFwXyA9IGZ1bmN0aW9uIGRpZmZfY29tbW9uT3ZlcmxhcF8odGV4dDEsIHRleHQyKSB7XG4gIC8vIENhY2hlIHRoZSB0ZXh0IGxlbmd0aHMgdG8gcHJldmVudCBtdWx0aXBsZSBjYWxscy5cbiAgdmFyIHRleHQxX2xlbmd0aCA9IHRleHQxLmxlbmd0aDtcbiAgdmFyIHRleHQyX2xlbmd0aCA9IHRleHQyLmxlbmd0aDsgLy8gRWxpbWluYXRlIHRoZSBudWxsIGNhc2UuXG5cbiAgaWYgKHRleHQxX2xlbmd0aCA9PSAwIHx8IHRleHQyX2xlbmd0aCA9PSAwKSB7XG4gICAgcmV0dXJuIDA7XG4gIH0gLy8gVHJ1bmNhdGUgdGhlIGxvbmdlciBzdHJpbmcuXG5cbiAgaWYgKHRleHQxX2xlbmd0aCA+IHRleHQyX2xlbmd0aCkge1xuICAgIHRleHQxID0gdGV4dDEuc3Vic3RyaW5nKHRleHQxX2xlbmd0aCAtIHRleHQyX2xlbmd0aCk7XG4gIH0gZWxzZSBpZiAodGV4dDFfbGVuZ3RoIDwgdGV4dDJfbGVuZ3RoKSB7XG4gICAgdGV4dDIgPSB0ZXh0Mi5zdWJzdHJpbmcoMCwgdGV4dDFfbGVuZ3RoKTtcbiAgfVxuXG4gIHZhciB0ZXh0X2xlbmd0aCA9IE1hdGgubWluKHRleHQxX2xlbmd0aCwgdGV4dDJfbGVuZ3RoKTsgLy8gUXVpY2sgY2hlY2sgZm9yIHRoZSB3b3JzdCBjYXNlLlxuXG4gIGlmICh0ZXh0MSA9PSB0ZXh0Mikge1xuICAgIHJldHVybiB0ZXh0X2xlbmd0aDtcbiAgfSAvLyBTdGFydCBieSBsb29raW5nIGZvciBhIHNpbmdsZSBjaGFyYWN0ZXIgbWF0Y2hcbiAgLy8gYW5kIGluY3JlYXNlIGxlbmd0aCB1bnRpbCBubyBtYXRjaCBpcyBmb3VuZC5cbiAgLy8gUGVyZm9ybWFuY2UgYW5hbHlzaXM6IGh0dHBzOi8vbmVpbC5mcmFzZXIubmFtZS9uZXdzLzIwMTAvMTEvMDQvXG5cbiAgdmFyIGJlc3QgPSAwO1xuICB2YXIgbGVuZ3RoID0gMTtcblxuICB3aGlsZSAodHJ1ZSkge1xuICAgIHZhciBwYXR0ZXJuID0gdGV4dDEuc3Vic3RyaW5nKHRleHRfbGVuZ3RoIC0gbGVuZ3RoKTtcbiAgICB2YXIgZm91bmQgPSB0ZXh0Mi5pbmRleE9mKHBhdHRlcm4pO1xuXG4gICAgaWYgKGZvdW5kID09IC0xKSB7XG4gICAgICByZXR1cm4gYmVzdDtcbiAgICB9XG5cbiAgICBsZW5ndGggKz0gZm91bmQ7XG5cbiAgICBpZiAoXG4gICAgICBmb3VuZCA9PSAwIHx8XG4gICAgICB0ZXh0MS5zdWJzdHJpbmcodGV4dF9sZW5ndGggLSBsZW5ndGgpID09IHRleHQyLnN1YnN0cmluZygwLCBsZW5ndGgpXG4gICAgKSB7XG4gICAgICBiZXN0ID0gbGVuZ3RoO1xuICAgICAgbGVuZ3RoKys7XG4gICAgfVxuICB9XG59O1xuLyoqXG4gKiBSZWR1Y2UgdGhlIG51bWJlciBvZiBlZGl0cyBieSBlbGltaW5hdGluZyBzZW1hbnRpY2FsbHkgdHJpdmlhbCBlcXVhbGl0aWVzLlxuICogQHBhcmFtIHshQXJyYXkuPCFkaWZmX21hdGNoX3BhdGNoLkRpZmY+fSBkaWZmcyBBcnJheSBvZiBkaWZmIHR1cGxlcy5cbiAqL1xuXG52YXIgZGlmZl9jbGVhbnVwU2VtYW50aWMgPSBmdW5jdGlvbiBkaWZmX2NsZWFudXBTZW1hbnRpYyhkaWZmcykge1xuICB2YXIgY2hhbmdlcyA9IGZhbHNlO1xuICB2YXIgZXF1YWxpdGllcyA9IFtdOyAvLyBTdGFjayBvZiBpbmRpY2VzIHdoZXJlIGVxdWFsaXRpZXMgYXJlIGZvdW5kLlxuXG4gIHZhciBlcXVhbGl0aWVzTGVuZ3RoID0gMDsgLy8gS2VlcGluZyBvdXIgb3duIGxlbmd0aCB2YXIgaXMgZmFzdGVyIGluIEpTLlxuXG4gIC8qKiBAdHlwZSB7P3N0cmluZ30gKi9cblxuICB2YXIgbGFzdEVxdWFsaXR5ID0gbnVsbDsgLy8gQWx3YXlzIGVxdWFsIHRvIGRpZmZzW2VxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCAtIDFdXVsxXVxuXG4gIHZhciBwb2ludGVyID0gMDsgLy8gSW5kZXggb2YgY3VycmVudCBwb3NpdGlvbi5cbiAgLy8gTnVtYmVyIG9mIGNoYXJhY3RlcnMgdGhhdCBjaGFuZ2VkIHByaW9yIHRvIHRoZSBlcXVhbGl0eS5cblxuICB2YXIgbGVuZ3RoX2luc2VydGlvbnMxID0gMDtcbiAgdmFyIGxlbmd0aF9kZWxldGlvbnMxID0gMDsgLy8gTnVtYmVyIG9mIGNoYXJhY3RlcnMgdGhhdCBjaGFuZ2VkIGFmdGVyIHRoZSBlcXVhbGl0eS5cblxuICB2YXIgbGVuZ3RoX2luc2VydGlvbnMyID0gMDtcbiAgdmFyIGxlbmd0aF9kZWxldGlvbnMyID0gMDtcblxuICB3aGlsZSAocG9pbnRlciA8IGRpZmZzLmxlbmd0aCkge1xuICAgIGlmIChkaWZmc1twb2ludGVyXVswXSA9PSBESUZGX0VRVUFMKSB7XG4gICAgICAvLyBFcXVhbGl0eSBmb3VuZC5cbiAgICAgIGVxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCsrXSA9IHBvaW50ZXI7XG4gICAgICBsZW5ndGhfaW5zZXJ0aW9uczEgPSBsZW5ndGhfaW5zZXJ0aW9uczI7XG4gICAgICBsZW5ndGhfZGVsZXRpb25zMSA9IGxlbmd0aF9kZWxldGlvbnMyO1xuICAgICAgbGVuZ3RoX2luc2VydGlvbnMyID0gMDtcbiAgICAgIGxlbmd0aF9kZWxldGlvbnMyID0gMDtcbiAgICAgIGxhc3RFcXVhbGl0eSA9IGRpZmZzW3BvaW50ZXJdWzFdO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBBbiBpbnNlcnRpb24gb3IgZGVsZXRpb24uXG4gICAgICBpZiAoZGlmZnNbcG9pbnRlcl1bMF0gPT0gRElGRl9JTlNFUlQpIHtcbiAgICAgICAgbGVuZ3RoX2luc2VydGlvbnMyICs9IGRpZmZzW3BvaW50ZXJdWzFdLmxlbmd0aDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxlbmd0aF9kZWxldGlvbnMyICs9IGRpZmZzW3BvaW50ZXJdWzFdLmxlbmd0aDtcbiAgICAgIH0gLy8gRWxpbWluYXRlIGFuIGVxdWFsaXR5IHRoYXQgaXMgc21hbGxlciBvciBlcXVhbCB0byB0aGUgZWRpdHMgb24gYm90aFxuICAgICAgLy8gc2lkZXMgb2YgaXQuXG5cbiAgICAgIGlmIChcbiAgICAgICAgbGFzdEVxdWFsaXR5ICYmXG4gICAgICAgIGxhc3RFcXVhbGl0eS5sZW5ndGggPD1cbiAgICAgICAgICBNYXRoLm1heChsZW5ndGhfaW5zZXJ0aW9uczEsIGxlbmd0aF9kZWxldGlvbnMxKSAmJlxuICAgICAgICBsYXN0RXF1YWxpdHkubGVuZ3RoIDw9IE1hdGgubWF4KGxlbmd0aF9pbnNlcnRpb25zMiwgbGVuZ3RoX2RlbGV0aW9uczIpXG4gICAgICApIHtcbiAgICAgICAgLy8gRHVwbGljYXRlIHJlY29yZC5cbiAgICAgICAgZGlmZnMuc3BsaWNlKFxuICAgICAgICAgIGVxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCAtIDFdLFxuICAgICAgICAgIDAsXG4gICAgICAgICAgbmV3IERpZmYoRElGRl9ERUxFVEUsIGxhc3RFcXVhbGl0eSlcbiAgICAgICAgKTsgLy8gQ2hhbmdlIHNlY29uZCBjb3B5IHRvIGluc2VydC5cblxuICAgICAgICBkaWZmc1tlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGggLSAxXSArIDFdWzBdID0gRElGRl9JTlNFUlQ7IC8vIFRocm93IGF3YXkgdGhlIGVxdWFsaXR5IHdlIGp1c3QgZGVsZXRlZC5cblxuICAgICAgICBlcXVhbGl0aWVzTGVuZ3RoLS07IC8vIFRocm93IGF3YXkgdGhlIHByZXZpb3VzIGVxdWFsaXR5IChpdCBuZWVkcyB0byBiZSByZWV2YWx1YXRlZCkuXG5cbiAgICAgICAgZXF1YWxpdGllc0xlbmd0aC0tO1xuICAgICAgICBwb2ludGVyID0gZXF1YWxpdGllc0xlbmd0aCA+IDAgPyBlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGggLSAxXSA6IC0xO1xuICAgICAgICBsZW5ndGhfaW5zZXJ0aW9uczEgPSAwOyAvLyBSZXNldCB0aGUgY291bnRlcnMuXG5cbiAgICAgICAgbGVuZ3RoX2RlbGV0aW9uczEgPSAwO1xuICAgICAgICBsZW5ndGhfaW5zZXJ0aW9uczIgPSAwO1xuICAgICAgICBsZW5ndGhfZGVsZXRpb25zMiA9IDA7XG4gICAgICAgIGxhc3RFcXVhbGl0eSA9IG51bGw7XG4gICAgICAgIGNoYW5nZXMgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHBvaW50ZXIrKztcbiAgfSAvLyBOb3JtYWxpemUgdGhlIGRpZmYuXG5cbiAgaWYgKGNoYW5nZXMpIHtcbiAgICBkaWZmX2NsZWFudXBNZXJnZShkaWZmcyk7XG4gIH1cblxuICBkaWZmX2NsZWFudXBTZW1hbnRpY0xvc3NsZXNzKGRpZmZzKTsgLy8gRmluZCBhbnkgb3ZlcmxhcHMgYmV0d2VlbiBkZWxldGlvbnMgYW5kIGluc2VydGlvbnMuXG4gIC8vIGUuZzogPGRlbD5hYmN4eHg8L2RlbD48aW5zPnh4eGRlZjwvaW5zPlxuICAvLyAgIC0+IDxkZWw+YWJjPC9kZWw+eHh4PGlucz5kZWY8L2lucz5cbiAgLy8gZS5nOiA8ZGVsPnh4eGFiYzwvZGVsPjxpbnM+ZGVmeHh4PC9pbnM+XG4gIC8vICAgLT4gPGlucz5kZWY8L2lucz54eHg8ZGVsPmFiYzwvZGVsPlxuICAvLyBPbmx5IGV4dHJhY3QgYW4gb3ZlcmxhcCBpZiBpdCBpcyBhcyBiaWcgYXMgdGhlIGVkaXQgYWhlYWQgb3IgYmVoaW5kIGl0LlxuXG4gIHBvaW50ZXIgPSAxO1xuXG4gIHdoaWxlIChwb2ludGVyIDwgZGlmZnMubGVuZ3RoKSB7XG4gICAgaWYgKFxuICAgICAgZGlmZnNbcG9pbnRlciAtIDFdWzBdID09IERJRkZfREVMRVRFICYmXG4gICAgICBkaWZmc1twb2ludGVyXVswXSA9PSBESUZGX0lOU0VSVFxuICAgICkge1xuICAgICAgdmFyIGRlbGV0aW9uID0gZGlmZnNbcG9pbnRlciAtIDFdWzFdO1xuICAgICAgdmFyIGluc2VydGlvbiA9IGRpZmZzW3BvaW50ZXJdWzFdO1xuICAgICAgdmFyIG92ZXJsYXBfbGVuZ3RoMSA9IGRpZmZfY29tbW9uT3ZlcmxhcF8oZGVsZXRpb24sIGluc2VydGlvbik7XG4gICAgICB2YXIgb3ZlcmxhcF9sZW5ndGgyID0gZGlmZl9jb21tb25PdmVybGFwXyhpbnNlcnRpb24sIGRlbGV0aW9uKTtcblxuICAgICAgaWYgKG92ZXJsYXBfbGVuZ3RoMSA+PSBvdmVybGFwX2xlbmd0aDIpIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIG92ZXJsYXBfbGVuZ3RoMSA+PSBkZWxldGlvbi5sZW5ndGggLyAyIHx8XG4gICAgICAgICAgb3ZlcmxhcF9sZW5ndGgxID49IGluc2VydGlvbi5sZW5ndGggLyAyXG4gICAgICAgICkge1xuICAgICAgICAgIC8vIE92ZXJsYXAgZm91bmQuICBJbnNlcnQgYW4gZXF1YWxpdHkgYW5kIHRyaW0gdGhlIHN1cnJvdW5kaW5nIGVkaXRzLlxuICAgICAgICAgIGRpZmZzLnNwbGljZShcbiAgICAgICAgICAgIHBvaW50ZXIsXG4gICAgICAgICAgICAwLFxuICAgICAgICAgICAgbmV3IERpZmYoRElGRl9FUVVBTCwgaW5zZXJ0aW9uLnN1YnN0cmluZygwLCBvdmVybGFwX2xlbmd0aDEpKVxuICAgICAgICAgICk7XG4gICAgICAgICAgZGlmZnNbcG9pbnRlciAtIDFdWzFdID0gZGVsZXRpb24uc3Vic3RyaW5nKFxuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIGRlbGV0aW9uLmxlbmd0aCAtIG92ZXJsYXBfbGVuZ3RoMVxuICAgICAgICAgICk7XG4gICAgICAgICAgZGlmZnNbcG9pbnRlciArIDFdWzFdID0gaW5zZXJ0aW9uLnN1YnN0cmluZyhvdmVybGFwX2xlbmd0aDEpO1xuICAgICAgICAgIHBvaW50ZXIrKztcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIG92ZXJsYXBfbGVuZ3RoMiA+PSBkZWxldGlvbi5sZW5ndGggLyAyIHx8XG4gICAgICAgICAgb3ZlcmxhcF9sZW5ndGgyID49IGluc2VydGlvbi5sZW5ndGggLyAyXG4gICAgICAgICkge1xuICAgICAgICAgIC8vIFJldmVyc2Ugb3ZlcmxhcCBmb3VuZC5cbiAgICAgICAgICAvLyBJbnNlcnQgYW4gZXF1YWxpdHkgYW5kIHN3YXAgYW5kIHRyaW0gdGhlIHN1cnJvdW5kaW5nIGVkaXRzLlxuICAgICAgICAgIGRpZmZzLnNwbGljZShcbiAgICAgICAgICAgIHBvaW50ZXIsXG4gICAgICAgICAgICAwLFxuICAgICAgICAgICAgbmV3IERpZmYoRElGRl9FUVVBTCwgZGVsZXRpb24uc3Vic3RyaW5nKDAsIG92ZXJsYXBfbGVuZ3RoMikpXG4gICAgICAgICAgKTtcbiAgICAgICAgICBkaWZmc1twb2ludGVyIC0gMV1bMF0gPSBESUZGX0lOU0VSVDtcbiAgICAgICAgICBkaWZmc1twb2ludGVyIC0gMV1bMV0gPSBpbnNlcnRpb24uc3Vic3RyaW5nKFxuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIGluc2VydGlvbi5sZW5ndGggLSBvdmVybGFwX2xlbmd0aDJcbiAgICAgICAgICApO1xuICAgICAgICAgIGRpZmZzW3BvaW50ZXIgKyAxXVswXSA9IERJRkZfREVMRVRFO1xuICAgICAgICAgIGRpZmZzW3BvaW50ZXIgKyAxXVsxXSA9IGRlbGV0aW9uLnN1YnN0cmluZyhvdmVybGFwX2xlbmd0aDIpO1xuICAgICAgICAgIHBvaW50ZXIrKztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBwb2ludGVyKys7XG4gICAgfVxuXG4gICAgcG9pbnRlcisrO1xuICB9XG59O1xuLyoqXG4gKiBMb29rIGZvciBzaW5nbGUgZWRpdHMgc3Vycm91bmRlZCBvbiBib3RoIHNpZGVzIGJ5IGVxdWFsaXRpZXNcbiAqIHdoaWNoIGNhbiBiZSBzaGlmdGVkIHNpZGV3YXlzIHRvIGFsaWduIHRoZSBlZGl0IHRvIGEgd29yZCBib3VuZGFyeS5cbiAqIGUuZzogVGhlIGM8aW5zPmF0IGM8L2lucz5hbWUuIC0+IFRoZSA8aW5zPmNhdCA8L2lucz5jYW1lLlxuICogQHBhcmFtIHshQXJyYXkuPCFkaWZmX21hdGNoX3BhdGNoLkRpZmY+fSBkaWZmcyBBcnJheSBvZiBkaWZmIHR1cGxlcy5cbiAqL1xuXG5leHBvcnRzLmNsZWFudXBTZW1hbnRpYyA9IGRpZmZfY2xlYW51cFNlbWFudGljO1xuXG52YXIgZGlmZl9jbGVhbnVwU2VtYW50aWNMb3NzbGVzcyA9IGZ1bmN0aW9uIGRpZmZfY2xlYW51cFNlbWFudGljTG9zc2xlc3MoXG4gIGRpZmZzXG4pIHtcbiAgLyoqXG4gICAqIEdpdmVuIHR3byBzdHJpbmdzLCBjb21wdXRlIGEgc2NvcmUgcmVwcmVzZW50aW5nIHdoZXRoZXIgdGhlIGludGVybmFsXG4gICAqIGJvdW5kYXJ5IGZhbGxzIG9uIGxvZ2ljYWwgYm91bmRhcmllcy5cbiAgICogU2NvcmVzIHJhbmdlIGZyb20gNiAoYmVzdCkgdG8gMCAod29yc3QpLlxuICAgKiBDbG9zdXJlLCBidXQgZG9lcyBub3QgcmVmZXJlbmNlIGFueSBleHRlcm5hbCB2YXJpYWJsZXMuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBvbmUgRmlyc3Qgc3RyaW5nLlxuICAgKiBAcGFyYW0ge3N0cmluZ30gdHdvIFNlY29uZCBzdHJpbmcuXG4gICAqIEByZXR1cm4ge251bWJlcn0gVGhlIHNjb3JlLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZnVuY3Rpb24gZGlmZl9jbGVhbnVwU2VtYW50aWNTY29yZV8ob25lLCB0d28pIHtcbiAgICBpZiAoIW9uZSB8fCAhdHdvKSB7XG4gICAgICAvLyBFZGdlcyBhcmUgdGhlIGJlc3QuXG4gICAgICByZXR1cm4gNjtcbiAgICB9IC8vIEVhY2ggcG9ydCBvZiB0aGlzIGZ1bmN0aW9uIGJlaGF2ZXMgc2xpZ2h0bHkgZGlmZmVyZW50bHkgZHVlIHRvXG4gICAgLy8gc3VidGxlIGRpZmZlcmVuY2VzIGluIGVhY2ggbGFuZ3VhZ2UncyBkZWZpbml0aW9uIG9mIHRoaW5ncyBsaWtlXG4gICAgLy8gJ3doaXRlc3BhY2UnLiAgU2luY2UgdGhpcyBmdW5jdGlvbidzIHB1cnBvc2UgaXMgbGFyZ2VseSBjb3NtZXRpYyxcbiAgICAvLyB0aGUgY2hvaWNlIGhhcyBiZWVuIG1hZGUgdG8gdXNlIGVhY2ggbGFuZ3VhZ2UncyBuYXRpdmUgZmVhdHVyZXNcbiAgICAvLyByYXRoZXIgdGhhbiBmb3JjZSB0b3RhbCBjb25mb3JtaXR5LlxuXG4gICAgdmFyIGNoYXIxID0gb25lLmNoYXJBdChvbmUubGVuZ3RoIC0gMSk7XG4gICAgdmFyIGNoYXIyID0gdHdvLmNoYXJBdCgwKTtcbiAgICB2YXIgbm9uQWxwaGFOdW1lcmljMSA9IGNoYXIxLm1hdGNoKG5vbkFscGhhTnVtZXJpY1JlZ2V4Xyk7XG4gICAgdmFyIG5vbkFscGhhTnVtZXJpYzIgPSBjaGFyMi5tYXRjaChub25BbHBoYU51bWVyaWNSZWdleF8pO1xuICAgIHZhciB3aGl0ZXNwYWNlMSA9IG5vbkFscGhhTnVtZXJpYzEgJiYgY2hhcjEubWF0Y2god2hpdGVzcGFjZVJlZ2V4Xyk7XG4gICAgdmFyIHdoaXRlc3BhY2UyID0gbm9uQWxwaGFOdW1lcmljMiAmJiBjaGFyMi5tYXRjaCh3aGl0ZXNwYWNlUmVnZXhfKTtcbiAgICB2YXIgbGluZUJyZWFrMSA9IHdoaXRlc3BhY2UxICYmIGNoYXIxLm1hdGNoKGxpbmVicmVha1JlZ2V4Xyk7XG4gICAgdmFyIGxpbmVCcmVhazIgPSB3aGl0ZXNwYWNlMiAmJiBjaGFyMi5tYXRjaChsaW5lYnJlYWtSZWdleF8pO1xuICAgIHZhciBibGFua0xpbmUxID0gbGluZUJyZWFrMSAmJiBvbmUubWF0Y2goYmxhbmtsaW5lRW5kUmVnZXhfKTtcbiAgICB2YXIgYmxhbmtMaW5lMiA9IGxpbmVCcmVhazIgJiYgdHdvLm1hdGNoKGJsYW5rbGluZVN0YXJ0UmVnZXhfKTtcblxuICAgIGlmIChibGFua0xpbmUxIHx8IGJsYW5rTGluZTIpIHtcbiAgICAgIC8vIEZpdmUgcG9pbnRzIGZvciBibGFuayBsaW5lcy5cbiAgICAgIHJldHVybiA1O1xuICAgIH0gZWxzZSBpZiAobGluZUJyZWFrMSB8fCBsaW5lQnJlYWsyKSB7XG4gICAgICAvLyBGb3VyIHBvaW50cyBmb3IgbGluZSBicmVha3MuXG4gICAgICByZXR1cm4gNDtcbiAgICB9IGVsc2UgaWYgKG5vbkFscGhhTnVtZXJpYzEgJiYgIXdoaXRlc3BhY2UxICYmIHdoaXRlc3BhY2UyKSB7XG4gICAgICAvLyBUaHJlZSBwb2ludHMgZm9yIGVuZCBvZiBzZW50ZW5jZXMuXG4gICAgICByZXR1cm4gMztcbiAgICB9IGVsc2UgaWYgKHdoaXRlc3BhY2UxIHx8IHdoaXRlc3BhY2UyKSB7XG4gICAgICAvLyBUd28gcG9pbnRzIGZvciB3aGl0ZXNwYWNlLlxuICAgICAgcmV0dXJuIDI7XG4gICAgfSBlbHNlIGlmIChub25BbHBoYU51bWVyaWMxIHx8IG5vbkFscGhhTnVtZXJpYzIpIHtcbiAgICAgIC8vIE9uZSBwb2ludCBmb3Igbm9uLWFscGhhbnVtZXJpYy5cbiAgICAgIHJldHVybiAxO1xuICAgIH1cblxuICAgIHJldHVybiAwO1xuICB9XG5cbiAgdmFyIHBvaW50ZXIgPSAxOyAvLyBJbnRlbnRpb25hbGx5IGlnbm9yZSB0aGUgZmlyc3QgYW5kIGxhc3QgZWxlbWVudCAoZG9uJ3QgbmVlZCBjaGVja2luZykuXG5cbiAgd2hpbGUgKHBvaW50ZXIgPCBkaWZmcy5sZW5ndGggLSAxKSB7XG4gICAgaWYgKFxuICAgICAgZGlmZnNbcG9pbnRlciAtIDFdWzBdID09IERJRkZfRVFVQUwgJiZcbiAgICAgIGRpZmZzW3BvaW50ZXIgKyAxXVswXSA9PSBESUZGX0VRVUFMXG4gICAgKSB7XG4gICAgICAvLyBUaGlzIGlzIGEgc2luZ2xlIGVkaXQgc3Vycm91bmRlZCBieSBlcXVhbGl0aWVzLlxuICAgICAgdmFyIGVxdWFsaXR5MSA9IGRpZmZzW3BvaW50ZXIgLSAxXVsxXTtcbiAgICAgIHZhciBlZGl0ID0gZGlmZnNbcG9pbnRlcl1bMV07XG4gICAgICB2YXIgZXF1YWxpdHkyID0gZGlmZnNbcG9pbnRlciArIDFdWzFdOyAvLyBGaXJzdCwgc2hpZnQgdGhlIGVkaXQgYXMgZmFyIGxlZnQgYXMgcG9zc2libGUuXG5cbiAgICAgIHZhciBjb21tb25PZmZzZXQgPSBkaWZmX2NvbW1vblN1ZmZpeChlcXVhbGl0eTEsIGVkaXQpO1xuXG4gICAgICBpZiAoY29tbW9uT2Zmc2V0KSB7XG4gICAgICAgIHZhciBjb21tb25TdHJpbmcgPSBlZGl0LnN1YnN0cmluZyhlZGl0Lmxlbmd0aCAtIGNvbW1vbk9mZnNldCk7XG4gICAgICAgIGVxdWFsaXR5MSA9IGVxdWFsaXR5MS5zdWJzdHJpbmcoMCwgZXF1YWxpdHkxLmxlbmd0aCAtIGNvbW1vbk9mZnNldCk7XG4gICAgICAgIGVkaXQgPSBjb21tb25TdHJpbmcgKyBlZGl0LnN1YnN0cmluZygwLCBlZGl0Lmxlbmd0aCAtIGNvbW1vbk9mZnNldCk7XG4gICAgICAgIGVxdWFsaXR5MiA9IGNvbW1vblN0cmluZyArIGVxdWFsaXR5MjtcbiAgICAgIH0gLy8gU2Vjb25kLCBzdGVwIGNoYXJhY3RlciBieSBjaGFyYWN0ZXIgcmlnaHQsIGxvb2tpbmcgZm9yIHRoZSBiZXN0IGZpdC5cblxuICAgICAgdmFyIGJlc3RFcXVhbGl0eTEgPSBlcXVhbGl0eTE7XG4gICAgICB2YXIgYmVzdEVkaXQgPSBlZGl0O1xuICAgICAgdmFyIGJlc3RFcXVhbGl0eTIgPSBlcXVhbGl0eTI7XG4gICAgICB2YXIgYmVzdFNjb3JlID1cbiAgICAgICAgZGlmZl9jbGVhbnVwU2VtYW50aWNTY29yZV8oZXF1YWxpdHkxLCBlZGl0KSArXG4gICAgICAgIGRpZmZfY2xlYW51cFNlbWFudGljU2NvcmVfKGVkaXQsIGVxdWFsaXR5Mik7XG5cbiAgICAgIHdoaWxlIChlZGl0LmNoYXJBdCgwKSA9PT0gZXF1YWxpdHkyLmNoYXJBdCgwKSkge1xuICAgICAgICBlcXVhbGl0eTEgKz0gZWRpdC5jaGFyQXQoMCk7XG4gICAgICAgIGVkaXQgPSBlZGl0LnN1YnN0cmluZygxKSArIGVxdWFsaXR5Mi5jaGFyQXQoMCk7XG4gICAgICAgIGVxdWFsaXR5MiA9IGVxdWFsaXR5Mi5zdWJzdHJpbmcoMSk7XG4gICAgICAgIHZhciBzY29yZSA9XG4gICAgICAgICAgZGlmZl9jbGVhbnVwU2VtYW50aWNTY29yZV8oZXF1YWxpdHkxLCBlZGl0KSArXG4gICAgICAgICAgZGlmZl9jbGVhbnVwU2VtYW50aWNTY29yZV8oZWRpdCwgZXF1YWxpdHkyKTsgLy8gVGhlID49IGVuY291cmFnZXMgdHJhaWxpbmcgcmF0aGVyIHRoYW4gbGVhZGluZyB3aGl0ZXNwYWNlIG9uIGVkaXRzLlxuXG4gICAgICAgIGlmIChzY29yZSA+PSBiZXN0U2NvcmUpIHtcbiAgICAgICAgICBiZXN0U2NvcmUgPSBzY29yZTtcbiAgICAgICAgICBiZXN0RXF1YWxpdHkxID0gZXF1YWxpdHkxO1xuICAgICAgICAgIGJlc3RFZGl0ID0gZWRpdDtcbiAgICAgICAgICBiZXN0RXF1YWxpdHkyID0gZXF1YWxpdHkyO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChkaWZmc1twb2ludGVyIC0gMV1bMV0gIT0gYmVzdEVxdWFsaXR5MSkge1xuICAgICAgICAvLyBXZSBoYXZlIGFuIGltcHJvdmVtZW50LCBzYXZlIGl0IGJhY2sgdG8gdGhlIGRpZmYuXG4gICAgICAgIGlmIChiZXN0RXF1YWxpdHkxKSB7XG4gICAgICAgICAgZGlmZnNbcG9pbnRlciAtIDFdWzFdID0gYmVzdEVxdWFsaXR5MTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciAtIDEsIDEpO1xuICAgICAgICAgIHBvaW50ZXItLTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRpZmZzW3BvaW50ZXJdWzFdID0gYmVzdEVkaXQ7XG5cbiAgICAgICAgaWYgKGJlc3RFcXVhbGl0eTIpIHtcbiAgICAgICAgICBkaWZmc1twb2ludGVyICsgMV1bMV0gPSBiZXN0RXF1YWxpdHkyO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyICsgMSwgMSk7XG4gICAgICAgICAgcG9pbnRlci0tO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcG9pbnRlcisrO1xuICB9XG59OyAvLyBEZWZpbmUgc29tZSByZWdleCBwYXR0ZXJucyBmb3IgbWF0Y2hpbmcgYm91bmRhcmllcy5cblxudmFyIG5vbkFscGhhTnVtZXJpY1JlZ2V4XyA9IC9bXmEtekEtWjAtOV0vO1xudmFyIHdoaXRlc3BhY2VSZWdleF8gPSAvXFxzLztcbnZhciBsaW5lYnJlYWtSZWdleF8gPSAvW1xcclxcbl0vO1xudmFyIGJsYW5rbGluZUVuZFJlZ2V4XyA9IC9cXG5cXHI/XFxuJC87XG52YXIgYmxhbmtsaW5lU3RhcnRSZWdleF8gPSAvXlxccj9cXG5cXHI/XFxuLztcbi8qKlxuICogUmVvcmRlciBhbmQgbWVyZ2UgbGlrZSBlZGl0IHNlY3Rpb25zLiAgTWVyZ2UgZXF1YWxpdGllcy5cbiAqIEFueSBlZGl0IHNlY3Rpb24gY2FuIG1vdmUgYXMgbG9uZyBhcyBpdCBkb2Vzbid0IGNyb3NzIGFuIGVxdWFsaXR5LlxuICogQHBhcmFtIHshQXJyYXkuPCFkaWZmX21hdGNoX3BhdGNoLkRpZmY+fSBkaWZmcyBBcnJheSBvZiBkaWZmIHR1cGxlcy5cbiAqL1xuXG52YXIgZGlmZl9jbGVhbnVwTWVyZ2UgPSBmdW5jdGlvbiBkaWZmX2NsZWFudXBNZXJnZShkaWZmcykge1xuICAvLyBBZGQgYSBkdW1teSBlbnRyeSBhdCB0aGUgZW5kLlxuICBkaWZmcy5wdXNoKG5ldyBEaWZmKERJRkZfRVFVQUwsICcnKSk7XG4gIHZhciBwb2ludGVyID0gMDtcbiAgdmFyIGNvdW50X2RlbGV0ZSA9IDA7XG4gIHZhciBjb3VudF9pbnNlcnQgPSAwO1xuICB2YXIgdGV4dF9kZWxldGUgPSAnJztcbiAgdmFyIHRleHRfaW5zZXJ0ID0gJyc7XG4gIHZhciBjb21tb25sZW5ndGg7XG5cbiAgd2hpbGUgKHBvaW50ZXIgPCBkaWZmcy5sZW5ndGgpIHtcbiAgICBzd2l0Y2ggKGRpZmZzW3BvaW50ZXJdWzBdKSB7XG4gICAgICBjYXNlIERJRkZfSU5TRVJUOlxuICAgICAgICBjb3VudF9pbnNlcnQrKztcbiAgICAgICAgdGV4dF9pbnNlcnQgKz0gZGlmZnNbcG9pbnRlcl1bMV07XG4gICAgICAgIHBvaW50ZXIrKztcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgRElGRl9ERUxFVEU6XG4gICAgICAgIGNvdW50X2RlbGV0ZSsrO1xuICAgICAgICB0ZXh0X2RlbGV0ZSArPSBkaWZmc1twb2ludGVyXVsxXTtcbiAgICAgICAgcG9pbnRlcisrO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBESUZGX0VRVUFMOlxuICAgICAgICAvLyBVcG9uIHJlYWNoaW5nIGFuIGVxdWFsaXR5LCBjaGVjayBmb3IgcHJpb3IgcmVkdW5kYW5jaWVzLlxuICAgICAgICBpZiAoY291bnRfZGVsZXRlICsgY291bnRfaW5zZXJ0ID4gMSkge1xuICAgICAgICAgIGlmIChjb3VudF9kZWxldGUgIT09IDAgJiYgY291bnRfaW5zZXJ0ICE9PSAwKSB7XG4gICAgICAgICAgICAvLyBGYWN0b3Igb3V0IGFueSBjb21tb24gcHJlZml4aWVzLlxuICAgICAgICAgICAgY29tbW9ubGVuZ3RoID0gZGlmZl9jb21tb25QcmVmaXgodGV4dF9pbnNlcnQsIHRleHRfZGVsZXRlKTtcblxuICAgICAgICAgICAgaWYgKGNvbW1vbmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgcG9pbnRlciAtIGNvdW50X2RlbGV0ZSAtIGNvdW50X2luc2VydCA+IDAgJiZcbiAgICAgICAgICAgICAgICBkaWZmc1twb2ludGVyIC0gY291bnRfZGVsZXRlIC0gY291bnRfaW5zZXJ0IC0gMV1bMF0gPT1cbiAgICAgICAgICAgICAgICAgIERJRkZfRVFVQUxcbiAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgZGlmZnNbXG4gICAgICAgICAgICAgICAgICBwb2ludGVyIC0gY291bnRfZGVsZXRlIC0gY291bnRfaW5zZXJ0IC0gMVxuICAgICAgICAgICAgICAgIF1bMV0gKz0gdGV4dF9pbnNlcnQuc3Vic3RyaW5nKDAsIGNvbW1vbmxlbmd0aCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGlmZnMuc3BsaWNlKFxuICAgICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICAgIDAsXG4gICAgICAgICAgICAgICAgICBuZXcgRGlmZihESUZGX0VRVUFMLCB0ZXh0X2luc2VydC5zdWJzdHJpbmcoMCwgY29tbW9ubGVuZ3RoKSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIHBvaW50ZXIrKztcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHRleHRfaW5zZXJ0ID0gdGV4dF9pbnNlcnQuc3Vic3RyaW5nKGNvbW1vbmxlbmd0aCk7XG4gICAgICAgICAgICAgIHRleHRfZGVsZXRlID0gdGV4dF9kZWxldGUuc3Vic3RyaW5nKGNvbW1vbmxlbmd0aCk7XG4gICAgICAgICAgICB9IC8vIEZhY3RvciBvdXQgYW55IGNvbW1vbiBzdWZmaXhpZXMuXG5cbiAgICAgICAgICAgIGNvbW1vbmxlbmd0aCA9IGRpZmZfY29tbW9uU3VmZml4KHRleHRfaW5zZXJ0LCB0ZXh0X2RlbGV0ZSk7XG5cbiAgICAgICAgICAgIGlmIChjb21tb25sZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgZGlmZnNbcG9pbnRlcl1bMV0gPVxuICAgICAgICAgICAgICAgIHRleHRfaW5zZXJ0LnN1YnN0cmluZyh0ZXh0X2luc2VydC5sZW5ndGggLSBjb21tb25sZW5ndGgpICtcbiAgICAgICAgICAgICAgICBkaWZmc1twb2ludGVyXVsxXTtcbiAgICAgICAgICAgICAgdGV4dF9pbnNlcnQgPSB0ZXh0X2luc2VydC5zdWJzdHJpbmcoXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICB0ZXh0X2luc2VydC5sZW5ndGggLSBjb21tb25sZW5ndGhcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgdGV4dF9kZWxldGUgPSB0ZXh0X2RlbGV0ZS5zdWJzdHJpbmcoXG4gICAgICAgICAgICAgICAgMCxcbiAgICAgICAgICAgICAgICB0ZXh0X2RlbGV0ZS5sZW5ndGggLSBjb21tb25sZW5ndGhcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IC8vIERlbGV0ZSB0aGUgb2ZmZW5kaW5nIHJlY29yZHMgYW5kIGFkZCB0aGUgbWVyZ2VkIG9uZXMuXG5cbiAgICAgICAgICBwb2ludGVyIC09IGNvdW50X2RlbGV0ZSArIGNvdW50X2luc2VydDtcbiAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciwgY291bnRfZGVsZXRlICsgY291bnRfaW5zZXJ0KTtcblxuICAgICAgICAgIGlmICh0ZXh0X2RlbGV0ZS5sZW5ndGgpIHtcbiAgICAgICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyLCAwLCBuZXcgRGlmZihESUZGX0RFTEVURSwgdGV4dF9kZWxldGUpKTtcbiAgICAgICAgICAgIHBvaW50ZXIrKztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAodGV4dF9pbnNlcnQubGVuZ3RoKSB7XG4gICAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciwgMCwgbmV3IERpZmYoRElGRl9JTlNFUlQsIHRleHRfaW5zZXJ0KSk7XG4gICAgICAgICAgICBwb2ludGVyKys7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcG9pbnRlcisrO1xuICAgICAgICB9IGVsc2UgaWYgKHBvaW50ZXIgIT09IDAgJiYgZGlmZnNbcG9pbnRlciAtIDFdWzBdID09IERJRkZfRVFVQUwpIHtcbiAgICAgICAgICAvLyBNZXJnZSB0aGlzIGVxdWFsaXR5IHdpdGggdGhlIHByZXZpb3VzIG9uZS5cbiAgICAgICAgICBkaWZmc1twb2ludGVyIC0gMV1bMV0gKz0gZGlmZnNbcG9pbnRlcl1bMV07XG4gICAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIsIDEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHBvaW50ZXIrKztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvdW50X2luc2VydCA9IDA7XG4gICAgICAgIGNvdW50X2RlbGV0ZSA9IDA7XG4gICAgICAgIHRleHRfZGVsZXRlID0gJyc7XG4gICAgICAgIHRleHRfaW5zZXJ0ID0gJyc7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIGlmIChkaWZmc1tkaWZmcy5sZW5ndGggLSAxXVsxXSA9PT0gJycpIHtcbiAgICBkaWZmcy5wb3AoKTsgLy8gUmVtb3ZlIHRoZSBkdW1teSBlbnRyeSBhdCB0aGUgZW5kLlxuICB9IC8vIFNlY29uZCBwYXNzOiBsb29rIGZvciBzaW5nbGUgZWRpdHMgc3Vycm91bmRlZCBvbiBib3RoIHNpZGVzIGJ5IGVxdWFsaXRpZXNcbiAgLy8gd2hpY2ggY2FuIGJlIHNoaWZ0ZWQgc2lkZXdheXMgdG8gZWxpbWluYXRlIGFuIGVxdWFsaXR5LlxuICAvLyBlLmc6IEE8aW5zPkJBPC9pbnM+QyAtPiA8aW5zPkFCPC9pbnM+QUNcblxuICB2YXIgY2hhbmdlcyA9IGZhbHNlO1xuICBwb2ludGVyID0gMTsgLy8gSW50ZW50aW9uYWxseSBpZ25vcmUgdGhlIGZpcnN0IGFuZCBsYXN0IGVsZW1lbnQgKGRvbid0IG5lZWQgY2hlY2tpbmcpLlxuXG4gIHdoaWxlIChwb2ludGVyIDwgZGlmZnMubGVuZ3RoIC0gMSkge1xuICAgIGlmIChcbiAgICAgIGRpZmZzW3BvaW50ZXIgLSAxXVswXSA9PSBESUZGX0VRVUFMICYmXG4gICAgICBkaWZmc1twb2ludGVyICsgMV1bMF0gPT0gRElGRl9FUVVBTFxuICAgICkge1xuICAgICAgLy8gVGhpcyBpcyBhIHNpbmdsZSBlZGl0IHN1cnJvdW5kZWQgYnkgZXF1YWxpdGllcy5cbiAgICAgIGlmIChcbiAgICAgICAgZGlmZnNbcG9pbnRlcl1bMV0uc3Vic3RyaW5nKFxuICAgICAgICAgIGRpZmZzW3BvaW50ZXJdWzFdLmxlbmd0aCAtIGRpZmZzW3BvaW50ZXIgLSAxXVsxXS5sZW5ndGhcbiAgICAgICAgKSA9PSBkaWZmc1twb2ludGVyIC0gMV1bMV1cbiAgICAgICkge1xuICAgICAgICAvLyBTaGlmdCB0aGUgZWRpdCBvdmVyIHRoZSBwcmV2aW91cyBlcXVhbGl0eS5cbiAgICAgICAgZGlmZnNbcG9pbnRlcl1bMV0gPVxuICAgICAgICAgIGRpZmZzW3BvaW50ZXIgLSAxXVsxXSArXG4gICAgICAgICAgZGlmZnNbcG9pbnRlcl1bMV0uc3Vic3RyaW5nKFxuICAgICAgICAgICAgMCxcbiAgICAgICAgICAgIGRpZmZzW3BvaW50ZXJdWzFdLmxlbmd0aCAtIGRpZmZzW3BvaW50ZXIgLSAxXVsxXS5sZW5ndGhcbiAgICAgICAgICApO1xuICAgICAgICBkaWZmc1twb2ludGVyICsgMV1bMV0gPSBkaWZmc1twb2ludGVyIC0gMV1bMV0gKyBkaWZmc1twb2ludGVyICsgMV1bMV07XG4gICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyIC0gMSwgMSk7XG4gICAgICAgIGNoYW5nZXMgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgZGlmZnNbcG9pbnRlcl1bMV0uc3Vic3RyaW5nKDAsIGRpZmZzW3BvaW50ZXIgKyAxXVsxXS5sZW5ndGgpID09XG4gICAgICAgIGRpZmZzW3BvaW50ZXIgKyAxXVsxXVxuICAgICAgKSB7XG4gICAgICAgIC8vIFNoaWZ0IHRoZSBlZGl0IG92ZXIgdGhlIG5leHQgZXF1YWxpdHkuXG4gICAgICAgIGRpZmZzW3BvaW50ZXIgLSAxXVsxXSArPSBkaWZmc1twb2ludGVyICsgMV1bMV07XG4gICAgICAgIGRpZmZzW3BvaW50ZXJdWzFdID1cbiAgICAgICAgICBkaWZmc1twb2ludGVyXVsxXS5zdWJzdHJpbmcoZGlmZnNbcG9pbnRlciArIDFdWzFdLmxlbmd0aCkgK1xuICAgICAgICAgIGRpZmZzW3BvaW50ZXIgKyAxXVsxXTtcbiAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIgKyAxLCAxKTtcbiAgICAgICAgY2hhbmdlcyA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcG9pbnRlcisrO1xuICB9IC8vIElmIHNoaWZ0cyB3ZXJlIG1hZGUsIHRoZSBkaWZmIG5lZWRzIHJlb3JkZXJpbmcgYW5kIGFub3RoZXIgc2hpZnQgc3dlZXAuXG5cbiAgaWYgKGNoYW5nZXMpIHtcbiAgICBkaWZmX2NsZWFudXBNZXJnZShkaWZmcyk7XG4gIH1cbn07XG4iXX0=