21885eba10ef5ebd52ece47776f83a46
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

var _extends2 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

var _objectWithoutProperties2 = _interopRequireDefault2(require("@babel/runtime/helpers/objectWithoutProperties"));

var _excluded = ["key", "routeNames"];
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var React = _interopRequireWildcard(require("react"));

var _routers = require("@react-navigation/routers");

var _EnsureSingleNavigator = _interopRequireDefault(require("./EnsureSingleNavigator"));

var _UnhandledActionContext = _interopRequireDefault(require("./UnhandledActionContext"));

var _NavigationBuilderContext = _interopRequireDefault(require("./NavigationBuilderContext"));

var _NavigationStateContext = _interopRequireDefault(require("./NavigationStateContext"));

var _NavigationRouteContext = _interopRequireDefault(require("./NavigationRouteContext"));

var _NavigationContext = _interopRequireDefault(require("./NavigationContext"));

var _useScheduleUpdate = require("./useScheduleUpdate");

var _useChildListeners = _interopRequireDefault(require("./useChildListeners"));

var _useKeyedChildListeners = _interopRequireDefault(require("./useKeyedChildListeners"));

var _useOptionsGetters = _interopRequireDefault(require("./useOptionsGetters"));

var _useEventEmitter = _interopRequireDefault(require("./useEventEmitter"));

var _useSyncState = _interopRequireDefault(require("./useSyncState"));

var _checkSerializable = _interopRequireDefault(require("./checkSerializable"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

var NOT_INITIALIZED_ERROR = "The 'navigation' object hasn't been initialized yet. This might happen if you don't have a navigator mounted, or if the navigator hasn't finished mounting. See https://reactnavigation.org/docs/navigating-without-navigation-prop#handling-initialization for more details.";
var serializableWarnings = [];

try {
  Object.defineProperty(global, 'REACT_NAVIGATION_REDUX_DEVTOOLS_EXTENSION_INTEGRATION_ENABLED', {
    set: function set(_) {
      console.warn("Redux devtools extension integration can be enabled with the '@react-navigation/devtools' package. For more details, see https://reactnavigation.org/docs/devtools");
    }
  });
} catch (e) {}

var getPartialState = function getPartialState(state) {
  if (state === undefined) {
    return;
  }

  var key = state.key,
      routeNames = state.routeNames,
      partialState = (0, _objectWithoutProperties2.default)(state, _excluded);
  return (0, _extends2.default)({}, partialState, {
    stale: true,
    routes: state.routes.map(function (route) {
      if (route.state === undefined) {
        return route;
      }

      return (0, _extends2.default)({}, route, {
        state: getPartialState(route.state)
      });
    })
  });
};

var BaseNavigationContainer = React.forwardRef(function BaseNavigationContainer(_ref, ref) {
  var initialState = _ref.initialState,
      onStateChange = _ref.onStateChange,
      onUnhandledAction = _ref.onUnhandledAction,
      independent = _ref.independent,
      children = _ref.children;
  var parent = React.useContext(_NavigationStateContext.default);

  if (!parent.isDefault && !independent) {
    throw new Error("Looks like you have nested a 'NavigationContainer' inside another. Normally you need only one container at the root of the app, so this was probably an error. If this was intentional, pass 'independent={true}' explicitely. Note that this will make the child navigators disconnected from the parent and you won't be able to navigate between them.");
  }

  var _ref2 = (0, _useSyncState.default)(function () {
    return getPartialState(initialState == null ? undefined : initialState);
  }),
      _ref3 = (0, _slicedToArray2.default)(_ref2, 5),
      state = _ref3[0],
      getState = _ref3[1],
      setState = _ref3[2],
      scheduleUpdate = _ref3[3],
      flushUpdates = _ref3[4];

  var isFirstMountRef = React.useRef(true);
  var navigatorKeyRef = React.useRef();
  var getKey = React.useCallback(function () {
    return navigatorKeyRef.current;
  }, []);
  var setKey = React.useCallback(function (key) {
    navigatorKeyRef.current = key;
  }, []);

  var _ref4 = (0, _useChildListeners.default)(),
      listeners = _ref4.listeners,
      addListener = _ref4.addListener;

  var _ref5 = (0, _useKeyedChildListeners.default)(),
      keyedListeners = _ref5.keyedListeners,
      addKeyedListener = _ref5.addKeyedListener;

  var dispatch = function dispatch(action) {
    if (listeners.focus[0] == null) {
      throw new Error(NOT_INITIALIZED_ERROR);
    }

    listeners.focus[0](function (navigation) {
      return navigation.dispatch(action);
    });
  };

  var canGoBack = function canGoBack() {
    if (listeners.focus[0] == null) {
      return false;
    }

    var _listeners$focus$ = listeners.focus[0](function (navigation) {
      return navigation.canGoBack();
    }),
        result = _listeners$focus$.result,
        handled = _listeners$focus$.handled;

    if (handled) {
      return result;
    } else {
      return false;
    }
  };

  var resetRoot = React.useCallback(function (state) {
    var _state$key, _keyedListeners$getSt, _keyedListeners$getSt2;

    var target = (_state$key = state === null || state === void 0 ? void 0 : state.key) !== null && _state$key !== void 0 ? _state$key : (_keyedListeners$getSt = (_keyedListeners$getSt2 = keyedListeners.getState).root) === null || _keyedListeners$getSt === void 0 ? void 0 : _keyedListeners$getSt.call(_keyedListeners$getSt2).key;

    if (target == null) {
      throw new Error(NOT_INITIALIZED_ERROR);
    }

    listeners.focus[0](function (navigation) {
      return navigation.dispatch((0, _extends2.default)({}, _routers.CommonActions.reset(state), {
        target: target
      }));
    });
  }, [keyedListeners.getState, listeners.focus]);
  var getRootState = React.useCallback(function () {
    var _keyedListeners$getSt3, _keyedListeners$getSt4;

    return (_keyedListeners$getSt3 = (_keyedListeners$getSt4 = keyedListeners.getState).root) === null || _keyedListeners$getSt3 === void 0 ? void 0 : _keyedListeners$getSt3.call(_keyedListeners$getSt4);
  }, [keyedListeners.getState]);
  var getCurrentRoute = React.useCallback(function () {
    var state = getRootState();

    if (state === undefined) {
      return undefined;
    }

    while (state.routes[state.index].state !== undefined) {
      state = state.routes[state.index].state;
    }

    return state.routes[state.index];
  }, [getRootState]);
  var emitter = (0, _useEventEmitter.default)();

  var _ref6 = (0, _useOptionsGetters.default)({}),
      addOptionsGetter = _ref6.addOptionsGetter,
      getCurrentOptions = _ref6.getCurrentOptions;

  React.useImperativeHandle(ref, function () {
    return (0, _extends2.default)({}, Object.keys(_routers.CommonActions).reduce(function (acc, name) {
      acc[name] = function () {
        var _routers$CommonAction;

        return dispatch((_routers$CommonAction = _routers.CommonActions)[name].apply(_routers$CommonAction, arguments));
      };

      return acc;
    }, {}), emitter.create('root'), {
      resetRoot: resetRoot,
      dispatch: dispatch,
      canGoBack: canGoBack,
      getRootState: getRootState,
      dangerouslyGetState: function dangerouslyGetState() {
        return state;
      },
      dangerouslyGetParent: function dangerouslyGetParent() {
        return undefined;
      },
      getCurrentRoute: getCurrentRoute,
      getCurrentOptions: getCurrentOptions
    });
  });
  var onDispatchAction = React.useCallback(function (action, noop) {
    emitter.emit({
      type: '__unsafe_action__',
      data: {
        action: action,
        noop: noop
      }
    });
  }, [emitter]);
  var lastEmittedOptionsRef = React.useRef();
  var onOptionsChange = React.useCallback(function (options) {
    if (lastEmittedOptionsRef.current === options) {
      return;
    }

    lastEmittedOptionsRef.current = options;
    emitter.emit({
      type: 'options',
      data: {
        options: options
      }
    });
  }, [emitter]);
  var builderContext = React.useMemo(function () {
    return {
      addListener: addListener,
      addKeyedListener: addKeyedListener,
      onDispatchAction: onDispatchAction,
      onOptionsChange: onOptionsChange
    };
  }, [addListener, addKeyedListener, onDispatchAction, onOptionsChange]);
  var scheduleContext = React.useMemo(function () {
    return {
      scheduleUpdate: scheduleUpdate,
      flushUpdates: flushUpdates
    };
  }, [scheduleUpdate, flushUpdates]);
  var isInitialRef = React.useRef(true);
  var getIsInitial = React.useCallback(function () {
    return isInitialRef.current;
  }, []);
  var context = React.useMemo(function () {
    return {
      state: state,
      getState: getState,
      setState: setState,
      getKey: getKey,
      setKey: setKey,
      getIsInitial: getIsInitial,
      addOptionsGetter: addOptionsGetter
    };
  }, [state, getState, setState, getKey, setKey, getIsInitial, addOptionsGetter]);
  var onStateChangeRef = React.useRef(onStateChange);
  React.useEffect(function () {
    isInitialRef.current = false;
    onStateChangeRef.current = onStateChange;
  });
  React.useEffect(function () {
    if (process.env.NODE_ENV !== 'production') {
      if (state !== undefined) {
        var result = (0, _checkSerializable.default)(state);

        if (!result.serializable) {
          var location = result.location,
              reason = result.reason;
          var path = '';
          var pointer = state;
          var params = false;

          for (var i = 0; i < location.length; i++) {
            var curr = location[i];
            var prev = location[i - 1];
            pointer = pointer[curr];

            if (!params && curr === 'state') {
              continue;
            } else if (!params && curr === 'routes') {
              if (path) {
                path += ' > ';
              }
            } else if (!params && typeof curr === 'number' && prev === 'routes') {
              var _pointer;

              path += (_pointer = pointer) === null || _pointer === void 0 ? void 0 : _pointer.name;
            } else if (!params) {
              path += " > ".concat(curr);
              params = true;
            } else {
              if (typeof curr === 'number' || /^[0-9]+$/.test(curr)) {
                path += "[".concat(curr, "]");
              } else if (/^[a-z$_]+$/i.test(curr)) {
                path += ".".concat(curr);
              } else {
                path += "[".concat(JSON.stringify(curr), "]");
              }
            }
          }

          var message = "Non-serializable values were found in the navigation state. Check:\n\n".concat(path, " (").concat(reason, ")\n\nThis can break usage such as persisting and restoring state. This might happen if you passed non-serializable values such as function, class instances etc. in params. If you need to use components with callbacks in your options, you can use 'navigation.setOptions' instead. See https://reactnavigation.org/docs/troubleshooting#i-get-the-warning-non-serializable-values-were-found-in-the-navigation-state for more details.");

          if (!serializableWarnings.includes(message)) {
            serializableWarnings.push(message);
            console.warn(message);
          }
        }
      }
    }

    emitter.emit({
      type: 'state',
      data: {
        state: state
      }
    });

    if (!isFirstMountRef.current && onStateChangeRef.current) {
      onStateChangeRef.current(getRootState());
    }

    isFirstMountRef.current = false;
  }, [getRootState, emitter, state]);
  var defaultOnUnhandledAction = React.useCallback(function (action) {
    if (process.env.NODE_ENV === 'production') {
      return;
    }

    var payload = action.payload;
    var message = "The action '".concat(action.type, "'").concat(payload ? " with payload ".concat(JSON.stringify(action.payload)) : '', " was not handled by any navigator.");

    switch (action.type) {
      case 'NAVIGATE':
      case 'PUSH':
      case 'REPLACE':
      case 'JUMP_TO':
        if (payload !== null && payload !== void 0 && payload.name) {
          message += "\n\nDo you have a screen named '".concat(payload.name, "'?\n\nIf you're trying to navigate to a screen in a nested navigator, see https://reactnavigation.org/docs/nesting-navigators#navigating-to-a-screen-in-a-nested-navigator.");
        } else {
          message += "\n\nYou need to pass the name of the screen to navigate to.\n\nSee https://reactnavigation.org/docs/navigation-actions for usage.";
        }

        break;

      case 'GO_BACK':
      case 'POP':
      case 'POP_TO_TOP':
        message += "\n\nIs there any screen to go back to?";
        break;

      case 'OPEN_DRAWER':
      case 'CLOSE_DRAWER':
      case 'TOGGLE_DRAWER':
        message += "\n\nIs your screen inside a Drawer navigator?";
        break;
    }

    message += "\n\nThis is a development-only warning and won't be shown in production.";
    console.error(message);
  }, []);
  var element = React.createElement(_useScheduleUpdate.ScheduleUpdateContext.Provider, {
    value: scheduleContext
  }, React.createElement(_NavigationBuilderContext.default.Provider, {
    value: builderContext
  }, React.createElement(_NavigationStateContext.default.Provider, {
    value: context
  }, React.createElement(_UnhandledActionContext.default.Provider, {
    value: onUnhandledAction !== null && onUnhandledAction !== void 0 ? onUnhandledAction : defaultOnUnhandledAction
  }, React.createElement(_EnsureSingleNavigator.default, null, children)))));

  if (independent) {
    element = React.createElement(_NavigationRouteContext.default.Provider, {
      value: undefined
    }, React.createElement(_NavigationContext.default.Provider, {
      value: undefined
    }, element));
  }

  return element;
});
var _default = BaseNavigationContainer;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkJhc2VOYXZpZ2F0aW9uQ29udGFpbmVyLnRzeCJdLCJuYW1lcyI6WyJOT1RfSU5JVElBTElaRURfRVJST1IiLCJzZXJpYWxpemFibGVXYXJuaW5ncyIsIk9iamVjdCIsInNldCIsImNvbnNvbGUiLCJnZXRQYXJ0aWFsU3RhdGUiLCJzdGF0ZSIsInBhcnRpYWxTdGF0ZSIsInN0YWxlIiwicm91dGVzIiwicm91dGUiLCJCYXNlTmF2aWdhdGlvbkNvbnRhaW5lciIsImNoaWxkcmVuIiwicGFyZW50IiwiUmVhY3QiLCJOYXZpZ2F0aW9uU3RhdGVDb250ZXh0IiwiaW5pdGlhbFN0YXRlIiwiaXNGaXJzdE1vdW50UmVmIiwibmF2aWdhdG9yS2V5UmVmIiwiZ2V0S2V5Iiwic2V0S2V5Iiwia2V5IiwiYWRkTGlzdGVuZXIiLCJhZGRLZXllZExpc3RlbmVyIiwiZGlzcGF0Y2giLCJhY3Rpb24iLCJsaXN0ZW5lcnMiLCJuYXZpZ2F0aW9uIiwiY2FuR29CYWNrIiwiaGFuZGxlZCIsInJlc2V0Um9vdCIsInRhcmdldCIsIkNvbW1vbkFjdGlvbnMiLCJrZXllZExpc3RlbmVycyIsImdldFJvb3RTdGF0ZSIsImdldEN1cnJlbnRSb3V0ZSIsImVtaXR0ZXIiLCJnZXRDdXJyZW50T3B0aW9ucyIsImFjYyIsImRhbmdlcm91c2x5R2V0U3RhdGUiLCJkYW5nZXJvdXNseUdldFBhcmVudCIsIm9uRGlzcGF0Y2hBY3Rpb24iLCJ0eXBlIiwiZGF0YSIsIm5vb3AiLCJsYXN0RW1pdHRlZE9wdGlvbnNSZWYiLCJvbk9wdGlvbnNDaGFuZ2UiLCJvcHRpb25zIiwiYnVpbGRlckNvbnRleHQiLCJzY2hlZHVsZUNvbnRleHQiLCJzY2hlZHVsZVVwZGF0ZSIsImZsdXNoVXBkYXRlcyIsImlzSW5pdGlhbFJlZiIsImdldElzSW5pdGlhbCIsImNvbnRleHQiLCJnZXRTdGF0ZSIsInNldFN0YXRlIiwiYWRkT3B0aW9uc0dldHRlciIsIm9uU3RhdGVDaGFuZ2VSZWYiLCJwcm9jZXNzIiwicmVzdWx0IiwicmVhc29uIiwicGF0aCIsInBvaW50ZXIiLCJwYXJhbXMiLCJpIiwibG9jYXRpb24iLCJjdXJyIiwicHJldiIsIkpTT04iLCJtZXNzYWdlIiwiZGVmYXVsdE9uVW5oYW5kbGVkQWN0aW9uIiwicGF5bG9hZCIsImVsZW1lbnQiLCJvblVuaGFuZGxlZEFjdGlvbiIsInVuZGVmaW5lZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUEsS0FBQSxHQUFBLHVCQUFBLENBQUEsT0FBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBOztBQUNBLElBQUEsUUFBQSxHQUFBLE9BQUEsQ0FBQSwyQkFBQSxDQUFBOztBQVFBLElBQUEsc0JBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsMkJBQUEsQ0FBQTs7QUFDQSxJQUFBLHVCQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLDRCQUFBLENBQUE7O0FBQ0EsSUFBQSx5QkFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSw4QkFBQSxDQUFBOztBQUNBLElBQUEsdUJBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsNEJBQUEsQ0FBQTs7QUFDQSxJQUFBLHVCQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLDRCQUFBLENBQUE7O0FBQ0EsSUFBQSxrQkFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSx1QkFBQSxDQUFBOztBQUNBLElBQUEsa0JBQUEsR0FBQSxPQUFBLHVCQUFBOztBQUNBLElBQUEsa0JBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsdUJBQUEsQ0FBQTs7QUFDQSxJQUFBLHVCQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLDRCQUFBLENBQUE7O0FBQ0EsSUFBQSxrQkFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSx1QkFBQSxDQUFBOztBQUNBLElBQUEsZ0JBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEscUJBQUEsQ0FBQTs7QUFDQSxJQUFBLGFBQUEsR0FBQSxzQkFBQSxDQUFBLE9BQUEsa0JBQUEsQ0FBQTs7QUFDQSxJQUFBLGtCQUFBLEdBQUEsc0JBQUEsQ0FBQSxPQUFBLHVC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YUFBQSxDQUFDLHVCQUFBLENBQUQsT0FBQyxDQUFELFFBQUEsRUFBQTtBQUFpQyxJQUFBLEtBQUssRUFBRU07QUFBeEMsR0FBQSxFQUNFLEtBQUEsQ0FBQSxhQUFBLENBQUMsdUJBQUEsQ0FBRCxPQUFDLENBQUQsUUFBQSxFQUFBO0FBQ0UsSUFBQSxLQUFLLEVBQUVvQixpQkFBRixLQUFBLElBQUVBLElBQUFBLGlCQUFGLEtBQUEsS0FBQSxDQUFFQSxHQUFGLGlCQUFFQSxHQUFxQkg7QUFEOUIsR0FBQSxFQUdFLEtBQUEsQ0FBQSxhQUFBLENBQUMsc0JBQUEsQ0FBRCxPQUFBLEVBQUEsSUFBQSxFQVBWLFFBT1UsQ0FIRixDQURGLENBREYsQ0FERixDQURGOztBQWNBLE1BQUEsV0FBQSxFQUFpQjtBQUVmRSxJQUFBQSxPQUFPLEdBQ0wsS0FBQSxDQUFBLGFBQUEsQ0FBQyx1QkFBQSxDQUFELE9BQUMsQ0FBRCxRQUFBLEVBQUE7QUFBaUMsTUFBQSxLQUFLLEVBQUVFO0FBQXhDLEtBQUEsRUFDRSxLQUFBLENBQUEsYUFBQSxDQUFDLGtCQUFBLENBQUQsT0FBQyxDQUFELFFBQUEsRUFBQTtBQUE0QixNQUFBLEtBQUssRUFBRUE7QUFBbkMsS0FBQSxFQUZKRixPQUVJLENBREYsQ0FERkE7QUFPRDs7QUFFRCxTQUFBLE9BQUE7QUE3VUosQ0FBZ0MsQ0FBaEM7ZUFpVmU5RCx1QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7XG4gIENvbW1vbkFjdGlvbnMsXG4gIFJvdXRlLFxuICBOYXZpZ2F0aW9uU3RhdGUsXG4gIEluaXRpYWxTdGF0ZSxcbiAgUGFydGlhbFN0YXRlLFxuICBOYXZpZ2F0aW9uQWN0aW9uLFxufSBmcm9tICdAcmVhY3QtbmF2aWdhdGlvbi9yb3V0ZXJzJztcbmltcG9ydCBFbnN1cmVTaW5nbGVOYXZpZ2F0b3IgZnJvbSAnLi9FbnN1cmVTaW5nbGVOYXZpZ2F0b3InO1xuaW1wb3J0IFVuaGFuZGxlZEFjdGlvbkNvbnRleHQgZnJvbSAnLi9VbmhhbmRsZWRBY3Rpb25Db250ZXh0JztcbmltcG9ydCBOYXZpZ2F0aW9uQnVpbGRlckNvbnRleHQgZnJvbSAnLi9OYXZpZ2F0aW9uQnVpbGRlckNvbnRleHQnO1xuaW1wb3J0IE5hdmlnYXRpb25TdGF0ZUNvbnRleHQgZnJvbSAnLi9OYXZpZ2F0aW9uU3RhdGVDb250ZXh0JztcbmltcG9ydCBOYXZpZ2F0aW9uUm91dGVDb250ZXh0IGZyb20gJy4vTmF2aWdhdGlvblJvdXRlQ29udGV4dCc7XG5pbXBvcnQgTmF2aWdhdGlvbkNvbnRleHQgZnJvbSAnLi9OYXZpZ2F0aW9uQ29udGV4dCc7XG5pbXBvcnQgeyBTY2hlZHVsZVVwZGF0ZUNvbnRleHQgfSBmcm9tICcuL3VzZVNjaGVkdWxlVXBkYXRlJztcbmltcG9ydCB1c2VDaGlsZExpc3RlbmVycyBmcm9tICcuL3VzZUNoaWxkTGlzdGVuZXJzJztcbmltcG9ydCB1c2VLZXllZENoaWxkTGlzdGVuZXJzIGZyb20gJy4vdXNlS2V5ZWRDaGlsZExpc3RlbmVycyc7XG5pbXBvcnQgdXNlT3B0aW9uc0dldHRlcnMgZnJvbSAnLi91c2VPcHRpb25zR2V0dGVycyc7XG5pbXBvcnQgdXNlRXZlbnRFbWl0dGVyIGZyb20gJy4vdXNlRXZlbnRFbWl0dGVyJztcbmltcG9ydCB1c2VTeW5jU3RhdGUgZnJvbSAnLi91c2VTeW5jU3RhdGUnO1xuaW1wb3J0IGNoZWNrU2VyaWFsaXphYmxlIGZyb20gJy4vY2hlY2tTZXJpYWxpemFibGUnO1xuaW1wb3J0IHR5cGUge1xuICBOYXZpZ2F0aW9uQ29udGFpbmVyRXZlbnRNYXAsXG4gIE5hdmlnYXRpb25Db250YWluZXJSZWYsXG4gIE5hdmlnYXRpb25Db250YWluZXJQcm9wcyxcbn0gZnJvbSAnLi90eXBlcyc7XG5cbnR5cGUgU3RhdGUgPSBOYXZpZ2F0aW9uU3RhdGUgfCBQYXJ0aWFsU3RhdGU8TmF2aWdhdGlvblN0YXRlPiB8IHVuZGVmaW5lZDtcblxuY29uc3QgTk9UX0lOSVRJQUxJWkVEX0VSUk9SID1cbiAgXCJUaGUgJ25hdmlnYXRpb24nIG9iamVjdCBoYXNuJ3QgYmVlbiBpbml0aWFsaXplZCB5ZXQuIFRoaXMgbWlnaHQgaGFwcGVuIGlmIHlvdSBkb24ndCBoYXZlIGEgbmF2aWdhdG9yIG1vdW50ZWQsIG9yIGlmIHRoZSBuYXZpZ2F0b3IgaGFzbid0IGZpbmlzaGVkIG1vdW50aW5nLiBTZWUgaHR0cHM6Ly9yZWFjdG5hdmlnYXRpb24ub3JnL2RvY3MvbmF2aWdhdGluZy13aXRob3V0LW5hdmlnYXRpb24tcHJvcCNoYW5kbGluZy1pbml0aWFsaXphdGlvbiBmb3IgbW9yZSBkZXRhaWxzLlwiO1xuXG5jb25zdCBzZXJpYWxpemFibGVXYXJuaW5nczogc3RyaW5nW10gPSBbXTtcblxudHJ5IHtcbiAgLyoqXG4gICAqIE1pZ3JhdGlvbiBpbnN0cnVjdGlvbnMgZm9yIHJlbW92YWwgb2YgZGV2dG9vbHMgZnJvbSBjb3JlXG4gICAqL1xuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXG4gICAgZ2xvYmFsLFxuICAgICdSRUFDVF9OQVZJR0FUSU9OX1JFRFVYX0RFVlRPT0xTX0VYVEVOU0lPTl9JTlRFR1JBVElPTl9FTkFCTEVEJyxcbiAgICB7XG4gICAgICBzZXQoXykge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJSZWR1eCBkZXZ0b29scyBleHRlbnNpb24gaW50ZWdyYXRpb24gY2FuIGJlIGVuYWJsZWQgd2l0aCB0aGUgJ0ByZWFjdC1uYXZpZ2F0aW9uL2RldnRvb2xzJyBwYWNrYWdlLiBGb3IgbW9yZSBkZXRhaWxzLCBzZWUgaHR0cHM6Ly9yZWFjdG5hdmlnYXRpb24ub3JnL2RvY3MvZGV2dG9vbHNcIlxuICAgICAgICApO1xuICAgICAgfSxcbiAgICB9XG4gICk7XG59IGNhdGNoIChlKSB7XG4gIC8vIElnbm9yZVxufVxuXG4vKipcbiAqIFJlbW92ZSBga2V5YCBhbmQgYHJvdXRlTmFtZXNgIGZyb20gdGhlIHN0YXRlIG9iamVjdHMgcmVjdXJzaXZlbHkgdG8gZ2V0IHBhcnRpYWwgc3RhdGUuXG4gKlxuICogQHBhcmFtIHN0YXRlIEluaXRpYWwgc3RhdGUgb2JqZWN0LlxuICovXG5jb25zdCBnZXRQYXJ0aWFsU3RhdGUgPSAoXG4gIHN0YXRlOiBJbml0aWFsU3RhdGUgfCB1bmRlZmluZWRcbik6IFBhcnRpYWxTdGF0ZTxOYXZpZ2F0aW9uU3RhdGU+IHwgdW5kZWZpbmVkID0+IHtcbiAgaWYgKHN0YXRlID09PSB1bmRlZmluZWQpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG4gIGNvbnN0IHsga2V5LCByb3V0ZU5hbWVzLCAuLi5wYXJ0aWFsU3RhdGUgfSA9IHN0YXRlO1xuXG4gIHJldHVybiB7XG4gICAgLi4ucGFydGlhbFN0YXRlLFxuICAgIHN0YWxlOiB0cnVlLFxuICAgIHJvdXRlczogc3RhdGUucm91dGVzLm1hcCgocm91dGUpID0+IHtcbiAgICAgIGlmIChyb3V0ZS5zdGF0ZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiByb3V0ZSBhcyBSb3V0ZTxzdHJpbmc+ICYge1xuICAgICAgICAgIHN0YXRlPzogUGFydGlhbFN0YXRlPE5hdmlnYXRpb25TdGF0ZT47XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7IC4uLnJvdXRlLCBzdGF0ZTogZ2V0UGFydGlhbFN0YXRlKHJvdXRlLnN0YXRlKSB9O1xuICAgIH0pLFxuICB9O1xufTtcblxuLyoqXG4gKiBDb250YWluZXIgY29tcG9uZW50IHdoaWNoIGhvbGRzIHRoZSBuYXZpZ2F0aW9uIHN0YXRlLlxuICogVGhpcyBzaG91bGQgYmUgcmVuZGVyZWQgYXQgdGhlIHJvb3Qgd3JhcHBpbmcgdGhlIHdob2xlIGFwcC5cbiAqXG4gKiBAcGFyYW0gcHJvcHMuaW5pdGlhbFN0YXRlIEluaXRpYWwgc3RhdGUgb2JqZWN0IGZvciB0aGUgbmF2aWdhdGlvbiB0cmVlLlxuICogQHBhcmFtIHByb3BzLm9uU3RhdGVDaGFuZ2UgQ2FsbGJhY2sgd2hpY2ggaXMgY2FsbGVkIHdpdGggdGhlIGxhdGVzdCBuYXZpZ2F0aW9uIHN0YXRlIHdoZW4gaXQgY2hhbmdlcy5cbiAqIEBwYXJhbSBwcm9wcy5jaGlsZHJlbiBDaGlsZCBlbGVtZW50cyB0byByZW5kZXIgdGhlIGNvbnRlbnQuXG4gKiBAcGFyYW0gcHJvcHMucmVmIFJlZiBvYmplY3Qgd2hpY2ggcmVmZXJzIHRvIHRoZSBuYXZpZ2F0aW9uIG9iamVjdCBjb250YWluaW5nIGhlbHBlciBtZXRob2RzLlxuICovXG5jb25zdCBCYXNlTmF2aWdhdGlvbkNvbnRhaW5lciA9IFJlYWN0LmZvcndhcmRSZWYoXG4gIGZ1bmN0aW9uIEJhc2VOYXZpZ2F0aW9uQ29udGFpbmVyKFxuICAgIHtcbiAgICAgIGluaXRpYWxTdGF0ZSxcbiAgICAgIG9uU3RhdGVDaGFuZ2UsXG4gICAgICBvblVuaGFuZGxlZEFjdGlvbixcbiAgICAgIGluZGVwZW5kZW50LFxuICAgICAgY2hpbGRyZW4sXG4gICAgfTogTmF2aWdhdGlvbkNvbnRhaW5lclByb3BzLFxuICAgIHJlZj86IFJlYWN0LlJlZjxOYXZpZ2F0aW9uQ29udGFpbmVyUmVmPlxuICApIHtcbiAgICBjb25zdCBwYXJlbnQgPSBSZWFjdC51c2VDb250ZXh0KE5hdmlnYXRpb25TdGF0ZUNvbnRleHQpO1xuXG4gICAgaWYgKCFwYXJlbnQuaXNEZWZhdWx0ICYmICFpbmRlcGVuZGVudCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBcIkxvb2tzIGxpa2UgeW91IGhhdmUgbmVzdGVkIGEgJ05hdmlnYXRpb25Db250YWluZXInIGluc2lkZSBhbm90aGVyLiBOb3JtYWxseSB5b3UgbmVlZCBvbmx5IG9uZSBjb250YWluZXIgYXQgdGhlIHJvb3Qgb2YgdGhlIGFwcCwgc28gdGhpcyB3YXMgcHJvYmFibHkgYW4gZXJyb3IuIElmIHRoaXMgd2FzIGludGVudGlvbmFsLCBwYXNzICdpbmRlcGVuZGVudD17dHJ1ZX0nIGV4cGxpY2l0ZWx5LiBOb3RlIHRoYXQgdGhpcyB3aWxsIG1ha2UgdGhlIGNoaWxkIG5hdmlnYXRvcnMgZGlzY29ubmVjdGVkIGZyb20gdGhlIHBhcmVudCBhbmQgeW91IHdvbid0IGJlIGFibGUgdG8gbmF2aWdhdGUgYmV0d2VlbiB0aGVtLlwiXG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IFtcbiAgICAgIHN0YXRlLFxuICAgICAgZ2V0U3RhdGUsXG4gICAgICBzZXRTdGF0ZSxcbiAgICAgIHNjaGVkdWxlVXBkYXRlLFxuICAgICAgZmx1c2hVcGRhdGVzLFxuICAgIF0gPSB1c2VTeW5jU3RhdGU8U3RhdGU+KCgpID0+XG4gICAgICBnZXRQYXJ0aWFsU3RhdGUoaW5pdGlhbFN0YXRlID09IG51bGwgPyB1bmRlZmluZWQgOiBpbml0aWFsU3RhdGUpXG4gICAgKTtcblxuICAgIGNvbnN0IGlzRmlyc3RNb3VudFJlZiA9IFJlYWN0LnVzZVJlZjxib29sZWFuPih0cnVlKTtcblxuICAgIGNvbnN0IG5hdmlnYXRvcktleVJlZiA9IFJlYWN0LnVzZVJlZjxzdHJpbmcgfCB1bmRlZmluZWQ+KCk7XG5cbiAgICBjb25zdCBnZXRLZXkgPSBSZWFjdC51c2VDYWxsYmFjaygoKSA9PiBuYXZpZ2F0b3JLZXlSZWYuY3VycmVudCwgW10pO1xuXG4gICAgY29uc3Qgc2V0S2V5ID0gUmVhY3QudXNlQ2FsbGJhY2soKGtleTogc3RyaW5nKSA9PiB7XG4gICAgICBuYXZpZ2F0b3JLZXlSZWYuY3VycmVudCA9IGtleTtcbiAgICB9LCBbXSk7XG5cbiAgICBjb25zdCB7IGxpc3RlbmVycywgYWRkTGlzdGVuZXIgfSA9IHVzZUNoaWxkTGlzdGVuZXJzKCk7XG5cbiAgICBjb25zdCB7IGtleWVkTGlzdGVuZXJzLCBhZGRLZXllZExpc3RlbmVyIH0gPSB1c2VLZXllZENoaWxkTGlzdGVuZXJzKCk7XG5cbiAgICBjb25zdCBkaXNwYXRjaCA9IChcbiAgICAgIGFjdGlvbjogTmF2aWdhdGlvbkFjdGlvbiB8ICgoc3RhdGU6IE5hdmlnYXRpb25TdGF0ZSkgPT4gTmF2aWdhdGlvbkFjdGlvbilcbiAgICApID0+IHtcbiAgICAgIGlmIChsaXN0ZW5lcnMuZm9jdXNbMF0gPT0gbnVsbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoTk9UX0lOSVRJQUxJWkVEX0VSUk9SKTtcbiAgICAgIH1cblxuICAgICAgbGlzdGVuZXJzLmZvY3VzWzBdKChuYXZpZ2F0aW9uKSA9PiBuYXZpZ2F0aW9uLmRpc3BhdGNoKGFjdGlvbikpO1xuICAgIH07XG5cbiAgICBjb25zdCBjYW5Hb0JhY2sgPSAoKSA9PiB7XG4gICAgICBpZiAobGlzdGVuZXJzLmZvY3VzWzBdID09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB7IHJlc3VsdCwgaGFuZGxlZCB9ID0gbGlzdGVuZXJzLmZvY3VzWzBdKChuYXZpZ2F0aW9uKSA9PlxuICAgICAgICBuYXZpZ2F0aW9uLmNhbkdvQmFjaygpXG4gICAgICApO1xuXG4gICAgICBpZiAoaGFuZGxlZCkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdCByZXNldFJvb3QgPSBSZWFjdC51c2VDYWxsYmFjayhcbiAgICAgIChzdGF0ZT86IFBhcnRpYWxTdGF0ZTxOYXZpZ2F0aW9uU3RhdGU+IHwgTmF2aWdhdGlvblN0YXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IHRhcmdldCA9IHN0YXRlPy5rZXkgPz8ga2V5ZWRMaXN0ZW5lcnMuZ2V0U3RhdGUucm9vdD8uKCkua2V5O1xuXG4gICAgICAgIGlmICh0YXJnZXQgPT0gbnVsbCkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihOT1RfSU5JVElBTElaRURfRVJST1IpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGlzdGVuZXJzLmZvY3VzWzBdKChuYXZpZ2F0aW9uKSA9PlxuICAgICAgICAgIG5hdmlnYXRpb24uZGlzcGF0Y2goe1xuICAgICAgICAgICAgLi4uQ29tbW9uQWN0aW9ucy5yZXNldChzdGF0ZSksXG4gICAgICAgICAgICB0YXJnZXQsXG4gICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgIH0sXG4gICAgICBba2V5ZWRMaXN0ZW5lcnMuZ2V0U3RhdGUsIGxpc3RlbmVycy5mb2N1c11cbiAgICApO1xuXG4gICAgY29uc3QgZ2V0Um9vdFN0YXRlID0gUmVhY3QudXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgcmV0dXJuIGtleWVkTGlzdGVuZXJzLmdldFN0YXRlLnJvb3Q/LigpO1xuICAgIH0sIFtrZXllZExpc3RlbmVycy5nZXRTdGF0ZV0pO1xuXG4gICAgY29uc3QgZ2V0Q3VycmVudFJvdXRlID0gUmVhY3QudXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgICAgbGV0IHN0YXRlID0gZ2V0Um9vdFN0YXRlKCk7XG4gICAgICBpZiAoc3RhdGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgICAgd2hpbGUgKHN0YXRlLnJvdXRlc1tzdGF0ZS5pbmRleF0uc3RhdGUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBzdGF0ZSA9IHN0YXRlLnJvdXRlc1tzdGF0ZS5pbmRleF0uc3RhdGUgYXMgTmF2aWdhdGlvblN0YXRlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN0YXRlLnJvdXRlc1tzdGF0ZS5pbmRleF07XG4gICAgfSwgW2dldFJvb3RTdGF0ZV0pO1xuXG4gICAgY29uc3QgZW1pdHRlciA9IHVzZUV2ZW50RW1pdHRlcjxOYXZpZ2F0aW9uQ29udGFpbmVyRXZlbnRNYXA+KCk7XG5cbiAgICBjb25zdCB7IGFkZE9wdGlvbnNHZXR0ZXIsIGdldEN1cnJlbnRPcHRpb25zIH0gPSB1c2VPcHRpb25zR2V0dGVycyh7fSk7XG5cbiAgICBSZWFjdC51c2VJbXBlcmF0aXZlSGFuZGxlKHJlZiwgKCkgPT4gKHtcbiAgICAgIC4uLihPYmplY3Qua2V5cyhDb21tb25BY3Rpb25zKSBhcyAoa2V5b2YgdHlwZW9mIENvbW1vbkFjdGlvbnMpW10pLnJlZHVjZTxcbiAgICAgICAgYW55XG4gICAgICA+KChhY2MsIG5hbWUpID0+IHtcbiAgICAgICAgYWNjW25hbWVdID0gKC4uLmFyZ3M6IGFueVtdKSA9PlxuICAgICAgICAgIGRpc3BhdGNoKFxuICAgICAgICAgICAgQ29tbW9uQWN0aW9uc1tuYW1lXShcbiAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvcjogd2UgY2FuJ3Qga25vdyB0aGUgdHlwZSBzdGF0aWNhbGx5XG4gICAgICAgICAgICAgIC4uLmFyZ3NcbiAgICAgICAgICAgIClcbiAgICAgICAgICApO1xuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSwge30pLFxuICAgICAgLi4uZW1pdHRlci5jcmVhdGUoJ3Jvb3QnKSxcbiAgICAgIHJlc2V0Um9vdCxcbiAgICAgIGRpc3BhdGNoLFxuICAgICAgY2FuR29CYWNrLFxuICAgICAgZ2V0Um9vdFN0YXRlLFxuICAgICAgZGFuZ2Vyb3VzbHlHZXRTdGF0ZTogKCkgPT4gc3RhdGUsXG4gICAgICBkYW5nZXJvdXNseUdldFBhcmVudDogKCkgPT4gdW5kZWZpbmVkLFxuICAgICAgZ2V0Q3VycmVudFJvdXRlLFxuICAgICAgZ2V0Q3VycmVudE9wdGlvbnMsXG4gICAgfSkpO1xuXG4gICAgY29uc3Qgb25EaXNwYXRjaEFjdGlvbiA9IFJlYWN0LnVzZUNhbGxiYWNrKFxuICAgICAgKGFjdGlvbjogTmF2aWdhdGlvbkFjdGlvbiwgbm9vcDogYm9vbGVhbikgPT4ge1xuICAgICAgICBlbWl0dGVyLmVtaXQoeyB0eXBlOiAnX191bnNhZmVfYWN0aW9uX18nLCBkYXRhOiB7IGFjdGlvbiwgbm9vcCB9IH0pO1xuICAgICAgfSxcbiAgICAgIFtlbWl0dGVyXVxuICAgICk7XG5cbiAgICBjb25zdCBsYXN0RW1pdHRlZE9wdGlvbnNSZWYgPSBSZWFjdC51c2VSZWY8b2JqZWN0IHwgdW5kZWZpbmVkPigpO1xuXG4gICAgY29uc3Qgb25PcHRpb25zQ2hhbmdlID0gUmVhY3QudXNlQ2FsbGJhY2soXG4gICAgICAob3B0aW9ucykgPT4ge1xuICAgICAgICBpZiAobGFzdEVtaXR0ZWRPcHRpb25zUmVmLmN1cnJlbnQgPT09IG9wdGlvbnMpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsYXN0RW1pdHRlZE9wdGlvbnNSZWYuY3VycmVudCA9IG9wdGlvbnM7XG5cbiAgICAgICAgZW1pdHRlci5lbWl0KHtcbiAgICAgICAgICB0eXBlOiAnb3B0aW9ucycsXG4gICAgICAgICAgZGF0YTogeyBvcHRpb25zIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSxcbiAgICAgIFtlbWl0dGVyXVxuICAgICk7XG5cbiAgICBjb25zdCBidWlsZGVyQ29udGV4dCA9IFJlYWN0LnVzZU1lbW8oXG4gICAgICAoKSA9PiAoe1xuICAgICAgICBhZGRMaXN0ZW5lcixcbiAgICAgICAgYWRkS2V5ZWRMaXN0ZW5lcixcbiAgICAgICAgb25EaXNwYXRjaEFjdGlvbixcbiAgICAgICAgb25PcHRpb25zQ2hhbmdlLFxuICAgICAgfSksXG4gICAgICBbYWRkTGlzdGVuZXIsIGFkZEtleWVkTGlzdGVuZXIsIG9uRGlzcGF0Y2hBY3Rpb24sIG9uT3B0aW9uc0NoYW5nZV1cbiAgICApO1xuXG4gICAgY29uc3Qgc2NoZWR1bGVDb250ZXh0ID0gUmVhY3QudXNlTWVtbyhcbiAgICAgICgpID0+ICh7IHNjaGVkdWxlVXBkYXRlLCBmbHVzaFVwZGF0ZXMgfSksXG4gICAgICBbc2NoZWR1bGVVcGRhdGUsIGZsdXNoVXBkYXRlc11cbiAgICApO1xuXG4gICAgY29uc3QgaXNJbml0aWFsUmVmID0gUmVhY3QudXNlUmVmKHRydWUpO1xuXG4gICAgY29uc3QgZ2V0SXNJbml0aWFsID0gUmVhY3QudXNlQ2FsbGJhY2soKCkgPT4gaXNJbml0aWFsUmVmLmN1cnJlbnQsIFtdKTtcblxuICAgIGNvbnN0IGNvbnRleHQgPSBSZWFjdC51c2VNZW1vKFxuICAgICAgKCkgPT4gKHtcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGdldFN0YXRlLFxuICAgICAgICBzZXRTdGF0ZSxcbiAgICAgICAgZ2V0S2V5LFxuICAgICAgICBzZXRLZXksXG4gICAgICAgIGdldElzSW5pdGlhbCxcbiAgICAgICAgYWRkT3B0aW9uc0dldHRlcixcbiAgICAgIH0pLFxuICAgICAgW1xuICAgICAgICBzdGF0ZSxcbiAgICAgICAgZ2V0U3RhdGUsXG4gICAgICAgIHNldFN0YXRlLFxuICAgICAgICBnZXRLZXksXG4gICAgICAgIHNldEtleSxcbiAgICAgICAgZ2V0SXNJbml0aWFsLFxuICAgICAgICBhZGRPcHRpb25zR2V0dGVyLFxuICAgICAgXVxuICAgICk7XG5cbiAgICBjb25zdCBvblN0YXRlQ2hhbmdlUmVmID0gUmVhY3QudXNlUmVmKG9uU3RhdGVDaGFuZ2UpO1xuXG4gICAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlzSW5pdGlhbFJlZi5jdXJyZW50ID0gZmFsc2U7XG4gICAgICBvblN0YXRlQ2hhbmdlUmVmLmN1cnJlbnQgPSBvblN0YXRlQ2hhbmdlO1xuICAgIH0pO1xuXG4gICAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XG4gICAgICAgIGlmIChzdGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gY2hlY2tTZXJpYWxpemFibGUoc3RhdGUpO1xuXG4gICAgICAgICAgaWYgKCFyZXN1bHQuc2VyaWFsaXphYmxlKSB7XG4gICAgICAgICAgICBjb25zdCB7IGxvY2F0aW9uLCByZWFzb24gfSA9IHJlc3VsdDtcblxuICAgICAgICAgICAgbGV0IHBhdGggPSAnJztcbiAgICAgICAgICAgIGxldCBwb2ludGVyOiBSZWNvcmQ8YW55LCBhbnk+ID0gc3RhdGU7XG4gICAgICAgICAgICBsZXQgcGFyYW1zID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbG9jYXRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgY29uc3QgY3VyciA9IGxvY2F0aW9uW2ldO1xuICAgICAgICAgICAgICBjb25zdCBwcmV2ID0gbG9jYXRpb25baSAtIDFdO1xuXG4gICAgICAgICAgICAgIHBvaW50ZXIgPSBwb2ludGVyW2N1cnJdO1xuXG4gICAgICAgICAgICAgIGlmICghcGFyYW1zICYmIGN1cnIgPT09ICdzdGF0ZScpIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgfSBlbHNlIGlmICghcGFyYW1zICYmIGN1cnIgPT09ICdyb3V0ZXMnKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhdGgpIHtcbiAgICAgICAgICAgICAgICAgIHBhdGggKz0gJyA+ICc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgICAgICFwYXJhbXMgJiZcbiAgICAgICAgICAgICAgICB0eXBlb2YgY3VyciA9PT0gJ251bWJlcicgJiZcbiAgICAgICAgICAgICAgICBwcmV2ID09PSAncm91dGVzJ1xuICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBwYXRoICs9IHBvaW50ZXI/Lm5hbWU7XG4gICAgICAgICAgICAgIH0gZWxzZSBpZiAoIXBhcmFtcykge1xuICAgICAgICAgICAgICAgIHBhdGggKz0gYCA+ICR7Y3Vycn1gO1xuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHRydWU7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjdXJyID09PSAnbnVtYmVyJyB8fCAvXlswLTldKyQvLnRlc3QoY3VycikpIHtcbiAgICAgICAgICAgICAgICAgIHBhdGggKz0gYFske2N1cnJ9XWA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICgvXlthLXokX10rJC9pLnRlc3QoY3VycikpIHtcbiAgICAgICAgICAgICAgICAgIHBhdGggKz0gYC4ke2N1cnJ9YDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgcGF0aCArPSBgWyR7SlNPTi5zdHJpbmdpZnkoY3Vycil9XWA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgTm9uLXNlcmlhbGl6YWJsZSB2YWx1ZXMgd2VyZSBmb3VuZCBpbiB0aGUgbmF2aWdhdGlvbiBzdGF0ZS4gQ2hlY2s6XFxuXFxuJHtwYXRofSAoJHtyZWFzb259KVxcblxcblRoaXMgY2FuIGJyZWFrIHVzYWdlIHN1Y2ggYXMgcGVyc2lzdGluZyBhbmQgcmVzdG9yaW5nIHN0YXRlLiBUaGlzIG1pZ2h0IGhhcHBlbiBpZiB5b3UgcGFzc2VkIG5vbi1zZXJpYWxpemFibGUgdmFsdWVzIHN1Y2ggYXMgZnVuY3Rpb24sIGNsYXNzIGluc3RhbmNlcyBldGMuIGluIHBhcmFtcy4gSWYgeW91IG5lZWQgdG8gdXNlIGNvbXBvbmVudHMgd2l0aCBjYWxsYmFja3MgaW4geW91ciBvcHRpb25zLCB5b3UgY2FuIHVzZSAnbmF2aWdhdGlvbi5zZXRPcHRpb25zJyBpbnN0ZWFkLiBTZWUgaHR0cHM6Ly9yZWFjdG5hdmlnYXRpb24ub3JnL2RvY3MvdHJvdWJsZXNob290aW5nI2ktZ2V0LXRoZS13YXJuaW5nLW5vbi1zZXJpYWxpemFibGUtdmFsdWVzLXdlcmUtZm91bmQtaW4tdGhlLW5hdmlnYXRpb24tc3RhdGUgZm9yIG1vcmUgZGV0YWlscy5gO1xuXG4gICAgICAgICAgICBpZiAoIXNlcmlhbGl6YWJsZVdhcm5pbmdzLmluY2x1ZGVzKG1lc3NhZ2UpKSB7XG4gICAgICAgICAgICAgIHNlcmlhbGl6YWJsZVdhcm5pbmdzLnB1c2gobWVzc2FnZSk7XG4gICAgICAgICAgICAgIGNvbnNvbGUud2FybihtZXNzYWdlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZW1pdHRlci5lbWl0KHsgdHlwZTogJ3N0YXRlJywgZGF0YTogeyBzdGF0ZSB9IH0pO1xuXG4gICAgICBpZiAoIWlzRmlyc3RNb3VudFJlZi5jdXJyZW50ICYmIG9uU3RhdGVDaGFuZ2VSZWYuY3VycmVudCkge1xuICAgICAgICBvblN0YXRlQ2hhbmdlUmVmLmN1cnJlbnQoZ2V0Um9vdFN0YXRlKCkpO1xuICAgICAgfVxuXG4gICAgICBpc0ZpcnN0TW91bnRSZWYuY3VycmVudCA9IGZhbHNlO1xuICAgIH0sIFtnZXRSb290U3RhdGUsIGVtaXR0ZXIsIHN0YXRlXSk7XG5cbiAgICBjb25zdCBkZWZhdWx0T25VbmhhbmRsZWRBY3Rpb24gPSBSZWFjdC51c2VDYWxsYmFjayhcbiAgICAgIChhY3Rpb246IE5hdmlnYXRpb25BY3Rpb24pID0+IHtcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwYXlsb2FkOiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgdW5kZWZpbmVkID0gYWN0aW9uLnBheWxvYWQ7XG5cbiAgICAgICAgbGV0IG1lc3NhZ2UgPSBgVGhlIGFjdGlvbiAnJHthY3Rpb24udHlwZX0nJHtcbiAgICAgICAgICBwYXlsb2FkID8gYCB3aXRoIHBheWxvYWQgJHtKU09OLnN0cmluZ2lmeShhY3Rpb24ucGF5bG9hZCl9YCA6ICcnXG4gICAgICAgIH0gd2FzIG5vdCBoYW5kbGVkIGJ5IGFueSBuYXZpZ2F0b3IuYDtcblxuICAgICAgICBzd2l0Y2ggKGFjdGlvbi50eXBlKSB7XG4gICAgICAgICAgY2FzZSAnTkFWSUdBVEUnOlxuICAgICAgICAgIGNhc2UgJ1BVU0gnOlxuICAgICAgICAgIGNhc2UgJ1JFUExBQ0UnOlxuICAgICAgICAgIGNhc2UgJ0pVTVBfVE8nOlxuICAgICAgICAgICAgaWYgKHBheWxvYWQ/Lm5hbWUpIHtcbiAgICAgICAgICAgICAgbWVzc2FnZSArPSBgXFxuXFxuRG8geW91IGhhdmUgYSBzY3JlZW4gbmFtZWQgJyR7cGF5bG9hZC5uYW1lfSc/XFxuXFxuSWYgeW91J3JlIHRyeWluZyB0byBuYXZpZ2F0ZSB0byBhIHNjcmVlbiBpbiBhIG5lc3RlZCBuYXZpZ2F0b3IsIHNlZSBodHRwczovL3JlYWN0bmF2aWdhdGlvbi5vcmcvZG9jcy9uZXN0aW5nLW5hdmlnYXRvcnMjbmF2aWdhdGluZy10by1hLXNjcmVlbi1pbi1hLW5lc3RlZC1uYXZpZ2F0b3IuYDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG1lc3NhZ2UgKz0gYFxcblxcbllvdSBuZWVkIHRvIHBhc3MgdGhlIG5hbWUgb2YgdGhlIHNjcmVlbiB0byBuYXZpZ2F0ZSB0by5cXG5cXG5TZWUgaHR0cHM6Ly9yZWFjdG5hdmlnYXRpb24ub3JnL2RvY3MvbmF2aWdhdGlvbi1hY3Rpb25zIGZvciB1c2FnZS5gO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdHT19CQUNLJzpcbiAgICAgICAgICBjYXNlICdQT1AnOlxuICAgICAgICAgIGNhc2UgJ1BPUF9UT19UT1AnOlxuICAgICAgICAgICAgbWVzc2FnZSArPSBgXFxuXFxuSXMgdGhlcmUgYW55IHNjcmVlbiB0byBnbyBiYWNrIHRvP2A7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICBjYXNlICdPUEVOX0RSQVdFUic6XG4gICAgICAgICAgY2FzZSAnQ0xPU0VfRFJBV0VSJzpcbiAgICAgICAgICBjYXNlICdUT0dHTEVfRFJBV0VSJzpcbiAgICAgICAgICAgIG1lc3NhZ2UgKz0gYFxcblxcbklzIHlvdXIgc2NyZWVuIGluc2lkZSBhIERyYXdlciBuYXZpZ2F0b3I/YDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgbWVzc2FnZSArPSBgXFxuXFxuVGhpcyBpcyBhIGRldmVsb3BtZW50LW9ubHkgd2FybmluZyBhbmQgd29uJ3QgYmUgc2hvd24gaW4gcHJvZHVjdGlvbi5gO1xuXG4gICAgICAgIGNvbnNvbGUuZXJyb3IobWVzc2FnZSk7XG4gICAgICB9LFxuICAgICAgW11cbiAgICApO1xuXG4gICAgbGV0IGVsZW1lbnQgPSAoXG4gICAgICA8U2NoZWR1bGVVcGRhdGVDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtzY2hlZHVsZUNvbnRleHR9PlxuICAgICAgICA8TmF2aWdhdGlvbkJ1aWxkZXJDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXtidWlsZGVyQ29udGV4dH0+XG4gICAgICAgICAgPE5hdmlnYXRpb25TdGF0ZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2NvbnRleHR9PlxuICAgICAgICAgICAgPFVuaGFuZGxlZEFjdGlvbkNvbnRleHQuUHJvdmlkZXJcbiAgICAgICAgICAgICAgdmFsdWU9e29uVW5oYW5kbGVkQWN0aW9uID8/IGRlZmF1bHRPblVuaGFuZGxlZEFjdGlvbn1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEVuc3VyZVNpbmdsZU5hdmlnYXRvcj57Y2hpbGRyZW59PC9FbnN1cmVTaW5nbGVOYXZpZ2F0b3I+XG4gICAgICAgICAgICA8L1VuaGFuZGxlZEFjdGlvbkNvbnRleHQuUHJvdmlkZXI+XG4gICAgICAgICAgPC9OYXZpZ2F0aW9uU3RhdGVDb250ZXh0LlByb3ZpZGVyPlxuICAgICAgICA8L05hdmlnYXRpb25CdWlsZGVyQ29udGV4dC5Qcm92aWRlcj5cbiAgICAgIDwvU2NoZWR1bGVVcGRhdGVDb250ZXh0LlByb3ZpZGVyPlxuICAgICk7XG5cbiAgICBpZiAoaW5kZXBlbmRlbnQpIHtcbiAgICAgIC8vIFdlIG5lZWQgdG8gY2xlYXIgYW55IGV4aXN0aW5nIGNvbnRleHRzIGZvciBuZXN0ZWQgaW5kZXBlbmRlbnQgY29udGFpbmVyIHRvIHdvcmsgY29ycmVjdGx5XG4gICAgICBlbGVtZW50ID0gKFxuICAgICAgICA8TmF2aWdhdGlvblJvdXRlQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17dW5kZWZpbmVkfT5cbiAgICAgICAgICA8TmF2aWdhdGlvbkNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3VuZGVmaW5lZH0+XG4gICAgICAgICAgICB7ZWxlbWVudH1cbiAgICAgICAgICA8L05hdmlnYXRpb25Db250ZXh0LlByb3ZpZGVyPlxuICAgICAgICA8L05hdmlnYXRpb25Sb3V0ZUNvbnRleHQuUHJvdmlkZXI+XG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG4pO1xuXG5leHBvcnQgZGVmYXVsdCBCYXNlTmF2aWdhdGlvbkNvbnRhaW5lcjtcbiJdfQ==