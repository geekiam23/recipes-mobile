a21844adb8de8cb9645ef79fef0ca431
'use strict';

function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

var escapeStringRegexp = require('escape-string-regexp');

var ansiStyles = require('ansi-styles');

var stdoutColor = require('supports-color').stdout;

var template = require("./templates.js");

var isSimpleWindowsTerm = process.platform === 'win32' && !(process.env.TERM || '').toLowerCase().startsWith('xterm');
var levelMapping = ['ansi', 'ansi', 'ansi256', 'ansi16m'];
var skipModels = new Set(['gray']);
var styles = Object.create(null);

function applyOptions(obj, options) {
  options = options || {};
  var scLevel = stdoutColor ? stdoutColor.level : 0;
  obj.level = options.level === undefined ? scLevel : options.level;
  obj.enabled = 'enabled' in options ? options.enabled : obj.level > 0;
}

function Chalk(options) {
  if (!this || !(this instanceof Chalk) || this.template) {
    var chalk = {};
    applyOptions(chalk, options);

    chalk.template = function () {
      var args = [].slice.call(arguments);
      return chalkTag.apply(null, [chalk.template].concat(args));
    };

    Object.setPrototypeOf(chalk, Chalk.prototype);
    Object.setPrototypeOf(chalk.template, chalk);
    chalk.template.constructor = Chalk;
    return chalk.template;
  }

  applyOptions(this, options);
}

if (isSimpleWindowsTerm) {
  ansiStyles.blue.open = "\x1B[94m";
}

var _loop = function _loop(key) {
  ansiStyles[key].closeRe = new RegExp(escapeStringRegexp(ansiStyles[key].close), 'g');
  styles[key] = {
    get: function get() {
      var codes = ansiStyles[key];
      return build.call(this, this._styles ? this._styles.concat(codes) : [codes], this._empty, key);
    }
  };
};

for (var _i = 0, _Object$keys = Object.keys(ansiStyles); _i < _Object$keys.length; _i++) {
  var key = _Object$keys[_i];

  _loop(key);
}

styles.visible = {
  get: function get() {
    return build.call(this, this._styles || [], true, 'visible');
  }
};
ansiStyles.color.closeRe = new RegExp(escapeStringRegexp(ansiStyles.color.close), 'g');

var _loop2 = function _loop2(model) {
  if (skipModels.has(model)) {
    return "continue";
  }

  styles[model] = {
    get: function get() {
      var level = this.level;
      return function () {
        var open = ansiStyles.color[levelMapping[level]][model].apply(null, arguments);
        var codes = {
          open: open,
          close: ansiStyles.color.close,
          closeRe: ansiStyles.color.closeRe
        };
        return build.call(this, this._styles ? this._styles.concat(codes) : [codes], this._empty, model);
      };
    }
  };
};

for (var _i2 = 0, _Object$keys2 = Object.keys(ansiStyles.color.ansi); _i2 < _Object$keys2.length; _i2++) {
  var model = _Object$keys2[_i2];

  var _ret = _loop2(model);

  if (_ret === "continue") continue;
}

ansiStyles.bgColor.closeRe = new RegExp(escapeStringRegexp(ansiStyles.bgColor.close), 'g');

var _loop3 = function _loop3(_model) {
  if (skipModels.has(_model)) {
    return "continue";
  }

  var bgModel = 'bg' + _model[0].toUpperCase() + _model.slice(1);

  styles[bgModel] = {
    get: function get() {
      var level = this.level;
      return function () {
        var open = ansiStyles.bgColor[levelMapping[level]][_model].apply(null, arguments);

        var codes = {
          open: open,
          close: ansiStyles.bgColor.close,
          closeRe: ansiStyles.bgColor.closeRe
        };
        return build.call(this, this._styles ? this._styles.concat(codes) : [codes], this._empty, _model);
      };
    }
  };
};

for (var _i3 = 0, _Object$keys3 = Object.keys(ansiStyles.bgColor.ansi); _i3 < _Object$keys3.length; _i3++) {
  var _model = _Object$keys3[_i3];

  var _ret2 = _loop3(_model);

  if (_ret2 === "continue") continue;
}

var proto = Object.defineProperties(function () {}, styles);

function build(_styles, _empty, key) {
  var builder = function builder() {
    return applyStyle.apply(builder, arguments);
  };

  builder._styles = _styles;
  builder._empty = _empty;
  var self = this;
  Object.defineProperty(builder, 'level', {
    enumerable: true,
    get: function get() {
      return self.level;
    },
    set: function set(level) {
      self.level = level;
    }
  });
  Object.defineProperty(builder, 'enabled', {
    enumerable: true,
    get: function get() {
      return self.enabled;
    },
    set: function set(enabled) {
      self.enabled = enabled;
    }
  });
  builder.hasGrey = this.hasGrey || key === 'gray' || key === 'grey';
  builder.__proto__ = proto;
  return builder;
}

function applyStyle() {
  var args = arguments;
  var argsLen = args.length;
  var str = String(arguments[0]);

  if (argsLen === 0) {
    return '';
  }

  if (argsLen > 1) {
    for (var a = 1; a < argsLen; a++) {
      str += ' ' + args[a];
    }
  }

  if (!this.enabled || this.level <= 0 || !str) {
    return this._empty ? '' : str;
  }

  var originalDim = ansiStyles.dim.open;

  if (isSimpleWindowsTerm && this.hasGrey) {
    ansiStyles.dim.open = '';
  }

  for (var _iterator = _createForOfIteratorHelperLoose(this._styles.slice().reverse()), _step; !(_step = _iterator()).done;) {
    var code = _step.value;
    str = code.open + str.replace(code.closeRe, code.open) + code.close;
    str = str.replace(/\r?\n/g, code.close + "$&" + code.open);
  }

  ansiStyles.dim.open = originalDim;
  return str;
}

function chalkTag(chalk, strings) {
  if (!Array.isArray(strings)) {
    return [].slice.call(arguments, 1).join(' ');
  }

  var args = [].slice.call(arguments, 2);
  var parts = [strings.raw[0]];

  for (var i = 1; i < strings.length; i++) {
    parts.push(String(args[i - 1]).replace(/[{}\\]/g, '\\$&'));
    parts.push(String(strings.raw[i]));
  }

  return template(chalk, parts.join(''));
}

Object.defineProperties(Chalk.prototype, styles);
module.exports = Chalk();
module.exports.supportsColor = stdoutColor;
module.exports.default = module.exports;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImVzY2FwZVN0cmluZ1JlZ2V4cCIsInJlcXVpcmUiLCJhbnNpU3R5bGVzIiwic3Rkb3V0Q29sb3IiLCJzdGRvdXQiLCJ0ZW1wbGF0ZSIsImlzU2ltcGxlV2luZG93c1Rlcm0iLCJwcm9jZXNzIiwicGxhdGZvcm0iLCJlbnYiLCJURVJNIiwidG9Mb3dlckNhc2UiLCJzdGFydHNXaXRoIiwibGV2ZWxNYXBwaW5nIiwic2tpcE1vZGVscyIsIlNldCIsInN0eWxlcyIsIk9iamVjdCIsImNyZWF0ZSIsImFwcGx5T3B0aW9ucyIsIm9iaiIsIm9wdGlvbnMiLCJzY0xldmVsIiwibGV2ZWwiLCJ1bmRlZmluZWQiLCJlbmFibGVkIiwiQ2hhbGsiLCJjaGFsayIsImFyZ3MiLCJzbGljZSIsImNhbGwiLCJhcmd1bWVudHMiLCJjaGFsa1RhZyIsImFwcGx5IiwiY29uY2F0Iiwic2V0UHJvdG90eXBlT2YiLCJwcm90b3R5cGUiLCJjb25zdHJ1Y3RvciIsImJsdWUiLCJvcGVuIiwia2V5IiwiY2xvc2VSZSIsIlJlZ0V4cCIsImNsb3NlIiwiZ2V0IiwiY29kZXMiLCJidWlsZCIsIl9zdHlsZXMiLCJfZW1wdHkiLCJrZXlzIiwidmlzaWJsZSIsImNvbG9yIiwibW9kZWwiLCJoYXMiLCJhbnNpIiwiYmdDb2xvciIsImJnTW9kZWwiLCJ0b1VwcGVyQ2FzZSIsInByb3RvIiwiZGVmaW5lUHJvcGVydGllcyIsImJ1aWxkZXIiLCJhcHBseVN0eWxlIiwic2VsZiIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsInNldCIsImhhc0dyZXkiLCJfX3Byb3RvX18iLCJhcmdzTGVuIiwibGVuZ3RoIiwic3RyIiwiU3RyaW5nIiwiYSIsIm9yaWdpbmFsRGltIiwiZGltIiwicmV2ZXJzZSIsImNvZGUiLCJyZXBsYWNlIiwic3RyaW5ncyIsIkFycmF5IiwiaXNBcnJheSIsImpvaW4iLCJwYXJ0cyIsInJhdyIsImkiLCJwdXNoIiwibW9kdWxlIiwiZXhw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VyxFQUFYLENBQVIsQ0FBZjtBQUNBOztBQUVEaEUsTUFBTSxDQUFDMEMsZ0JBQVAsQ0FBd0JqQyxLQUFLLENBQUNVLFNBQTlCLEVBQXlDcEIsTUFBekM7QUFFQXNFLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjdELEtBQUssRUFBdEI7QUFDQTRELE1BQU0sQ0FBQ0MsT0FBUCxDQUFlQyxhQUFmLEdBQStCckYsV0FBL0I7QUFDQW1GLE1BQU0sQ0FBQ0MsT0FBUCxDQUFlRSxPQUFmLEdBQXlCSCxNQUFNLENBQUNDLE9BQWhDIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuY29uc3QgZXNjYXBlU3RyaW5nUmVnZXhwID0gcmVxdWlyZSgnZXNjYXBlLXN0cmluZy1yZWdleHAnKTtcbmNvbnN0IGFuc2lTdHlsZXMgPSByZXF1aXJlKCdhbnNpLXN0eWxlcycpO1xuY29uc3Qgc3Rkb3V0Q29sb3IgPSByZXF1aXJlKCdzdXBwb3J0cy1jb2xvcicpLnN0ZG91dDtcblxuY29uc3QgdGVtcGxhdGUgPSByZXF1aXJlKCcuL3RlbXBsYXRlcy5qcycpO1xuXG5jb25zdCBpc1NpbXBsZVdpbmRvd3NUZXJtID0gcHJvY2Vzcy5wbGF0Zm9ybSA9PT0gJ3dpbjMyJyAmJiAhKHByb2Nlc3MuZW52LlRFUk0gfHwgJycpLnRvTG93ZXJDYXNlKCkuc3RhcnRzV2l0aCgneHRlcm0nKTtcblxuLy8gYHN1cHBvcnRzQ29sb3IubGV2ZWxgIOKGkiBgYW5zaVN0eWxlcy5jb2xvcltuYW1lXWAgbWFwcGluZ1xuY29uc3QgbGV2ZWxNYXBwaW5nID0gWydhbnNpJywgJ2Fuc2knLCAnYW5zaTI1NicsICdhbnNpMTZtJ107XG5cbi8vIGBjb2xvci1jb252ZXJ0YCBtb2RlbHMgdG8gZXhjbHVkZSBmcm9tIHRoZSBDaGFsayBBUEkgZHVlIHRvIGNvbmZsaWN0cyBhbmQgc3VjaFxuY29uc3Qgc2tpcE1vZGVscyA9IG5ldyBTZXQoWydncmF5J10pO1xuXG5jb25zdCBzdHlsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXG5mdW5jdGlvbiBhcHBseU9wdGlvbnMob2JqLCBvcHRpb25zKSB7XG5cdG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG5cdC8vIERldGVjdCBsZXZlbCBpZiBub3Qgc2V0IG1hbnVhbGx5XG5cdGNvbnN0IHNjTGV2ZWwgPSBzdGRvdXRDb2xvciA/IHN0ZG91dENvbG9yLmxldmVsIDogMDtcblx0b2JqLmxldmVsID0gb3B0aW9ucy5sZXZlbCA9PT0gdW5kZWZpbmVkID8gc2NMZXZlbCA6IG9wdGlvbnMubGV2ZWw7XG5cdG9iai5lbmFibGVkID0gJ2VuYWJsZWQnIGluIG9wdGlvbnMgPyBvcHRpb25zLmVuYWJsZWQgOiBvYmoubGV2ZWwgPiAwO1xufVxuXG5mdW5jdGlvbiBDaGFsayhvcHRpb25zKSB7XG5cdC8vIFdlIGNoZWNrIGZvciB0aGlzLnRlbXBsYXRlIGhlcmUgc2luY2UgY2FsbGluZyBgY2hhbGsuY29uc3RydWN0b3IoKWBcblx0Ly8gYnkgaXRzZWxmIHdpbGwgaGF2ZSBhIGB0aGlzYCBvZiBhIHByZXZpb3VzbHkgY29uc3RydWN0ZWQgY2hhbGsgb2JqZWN0XG5cdGlmICghdGhpcyB8fCAhKHRoaXMgaW5zdGFuY2VvZiBDaGFsaykgfHwgdGhpcy50ZW1wbGF0ZSkge1xuXHRcdGNvbnN0IGNoYWxrID0ge307XG5cdFx0YXBwbHlPcHRpb25zKGNoYWxrLCBvcHRpb25zKTtcblxuXHRcdGNoYWxrLnRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Y29uc3QgYXJncyA9IFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtcblx0XHRcdHJldHVybiBjaGFsa1RhZy5hcHBseShudWxsLCBbY2hhbGsudGVtcGxhdGVdLmNvbmNhdChhcmdzKSk7XG5cdFx0fTtcblxuXHRcdE9iamVjdC5zZXRQcm90b3R5cGVPZihjaGFsaywgQ2hhbGsucHJvdG90eXBlKTtcblx0XHRPYmplY3Quc2V0UHJvdG90eXBlT2YoY2hhbGsudGVtcGxhdGUsIGNoYWxrKTtcblxuXHRcdGNoYWxrLnRlbXBsYXRlLmNvbnN0cnVjdG9yID0gQ2hhbGs7XG5cblx0XHRyZXR1cm4gY2hhbGsudGVtcGxhdGU7XG5cdH1cblxuXHRhcHBseU9wdGlvbnModGhpcywgb3B0aW9ucyk7XG59XG5cbi8vIFVzZSBicmlnaHQgYmx1ZSBvbiBXaW5kb3dzIGFzIHRoZSBub3JtYWwgYmx1ZSBjb2xvciBpcyBpbGxlZ2libGVcbmlmIChpc1NpbXBsZVdpbmRvd3NUZXJtKSB7XG5cdGFuc2lTdHlsZXMuYmx1ZS5vcGVuID0gJ1xcdTAwMUJbOTRtJztcbn1cblxuZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoYW5zaVN0eWxlcykpIHtcblx0YW5zaVN0eWxlc1trZXldLmNsb3NlUmUgPSBuZXcgUmVnRXhwKGVzY2FwZVN0cmluZ1JlZ2V4cChhbnNpU3R5bGVzW2tleV0uY2xvc2UpLCAnZycpO1xuXG5cdHN0eWxlc1trZXldID0ge1xuXHRcdGdldCgpIHtcblx0XHRcdGNvbnN0IGNvZGVzID0gYW5zaVN0eWxlc1trZXldO1xuXHRcdFx0cmV0dXJuIGJ1aWxkLmNhbGwodGhpcywgdGhpcy5fc3R5bGVzID8gdGhpcy5fc3R5bGVzLmNvbmNhdChjb2RlcykgOiBbY29kZXNdLCB0aGlzLl9lbXB0eSwga2V5KTtcblx0XHR9XG5cdH07XG59XG5cbnN0eWxlcy52aXNpYmxlID0ge1xuXHRnZXQoKSB7XG5cdFx0cmV0dXJuIGJ1aWxkLmNhbGwodGhpcywgdGhpcy5fc3R5bGVzIHx8IFtdLCB0cnVlLCAndmlzaWJsZScpO1xuXHR9XG59O1xuXG5hbnNpU3R5bGVzLmNvbG9yLmNsb3NlUmUgPSBuZXcgUmVnRXhwKGVzY2FwZVN0cmluZ1JlZ2V4cChhbnNpU3R5bGVzLmNvbG9yLmNsb3NlKSwgJ2cnKTtcbmZvciAoY29uc3QgbW9kZWwgb2YgT2JqZWN0LmtleXMoYW5zaVN0eWxlcy5jb2xvci5hbnNpKSkge1xuXHRpZiAoc2tpcE1vZGVscy5oYXMobW9kZWwpKSB7XG5cdFx0Y29udGludWU7XG5cdH1cblxuXHRzdHlsZXNbbW9kZWxdID0ge1xuXHRcdGdldCgpIHtcblx0XHRcdGNvbnN0IGxldmVsID0gdGhpcy5sZXZlbDtcblx0XHRcdHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdGNvbnN0IG9wZW4gPSBhbnNpU3R5bGVzLmNvbG9yW2xldmVsTWFwcGluZ1tsZXZlbF1dW21vZGVsXS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRjb25zdCBjb2RlcyA9IHtcblx0XHRcdFx0XHRvcGVuLFxuXHRcdFx0XHRcdGNsb3NlOiBhbnNpU3R5bGVzLmNvbG9yLmNsb3NlLFxuXHRcdFx0XHRcdGNsb3NlUmU6IGFuc2lTdHlsZXMuY29sb3IuY2xvc2VSZVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRyZXR1cm4gYnVpbGQuY2FsbCh0aGlzLCB0aGlzLl9zdHlsZXMgPyB0aGlzLl9zdHlsZXMuY29uY2F0KGNvZGVzKSA6IFtjb2Rlc10sIHRoaXMuX2VtcHR5LCBtb2RlbCk7XG5cdFx0XHR9O1xuXHRcdH1cblx0fTtcbn1cblxuYW5zaVN0eWxlcy5iZ0NvbG9yLmNsb3NlUmUgPSBuZXcgUmVnRXhwKGVzY2FwZVN0cmluZ1JlZ2V4cChhbnNpU3R5bGVzLmJnQ29sb3IuY2xvc2UpLCAnZycpO1xuZm9yIChjb25zdCBtb2RlbCBvZiBPYmplY3Qua2V5cyhhbnNpU3R5bGVzLmJnQ29sb3IuYW5zaSkpIHtcblx0aWYgKHNraXBNb2RlbHMuaGFzKG1vZGVsKSkge1xuXHRcdGNvbnRpbnVlO1xuXHR9XG5cblx0Y29uc3QgYmdNb2RlbCA9ICdiZycgKyBtb2RlbFswXS50b1VwcGVyQ2FzZSgpICsgbW9kZWwuc2xpY2UoMSk7XG5cdHN0eWxlc1tiZ01vZGVsXSA9IHtcblx0XHRnZXQoKSB7XG5cdFx0XHRjb25zdCBsZXZlbCA9IHRoaXMubGV2ZWw7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRjb25zdCBvcGVuID0gYW5zaVN0eWxlcy5iZ0NvbG9yW2xldmVsTWFwcGluZ1tsZXZlbF1dW21vZGVsXS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRjb25zdCBjb2RlcyA9IHtcblx0XHRcdFx0XHRvcGVuLFxuXHRcdFx0XHRcdGNsb3NlOiBhbnNpU3R5bGVzLmJnQ29sb3IuY2xvc2UsXG5cdFx0XHRcdFx0Y2xvc2VSZTogYW5zaVN0eWxlcy5iZ0NvbG9yLmNsb3NlUmVcblx0XHRcdFx0fTtcblx0XHRcdFx0cmV0dXJuIGJ1aWxkLmNhbGwodGhpcywgdGhpcy5fc3R5bGVzID8gdGhpcy5fc3R5bGVzLmNvbmNhdChjb2RlcykgOiBbY29kZXNdLCB0aGlzLl9lbXB0eSwgbW9kZWwpO1xuXHRcdFx0fTtcblx0XHR9XG5cdH07XG59XG5cbmNvbnN0IHByb3RvID0gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoKCkgPT4ge30sIHN0eWxlcyk7XG5cbmZ1bmN0aW9uIGJ1aWxkKF9zdHlsZXMsIF9lbXB0eSwga2V5KSB7XG5cdGNvbnN0IGJ1aWxkZXIgPSBmdW5jdGlvbiAoKSB7XG5cdFx0cmV0dXJuIGFwcGx5U3R5bGUuYXBwbHkoYnVpbGRlciwgYXJndW1lbnRzKTtcblx0fTtcblxuXHRidWlsZGVyLl9zdHlsZXMgPSBfc3R5bGVzO1xuXHRidWlsZGVyLl9lbXB0eSA9IF9lbXB0eTtcblxuXHRjb25zdCBzZWxmID0gdGhpcztcblxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoYnVpbGRlciwgJ2xldmVsJywge1xuXHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0Z2V0KCkge1xuXHRcdFx0cmV0dXJuIHNlbGYubGV2ZWw7XG5cdFx0fSxcblx0XHRzZXQobGV2ZWwpIHtcblx0XHRcdHNlbGYubGV2ZWwgPSBsZXZlbDtcblx0XHR9XG5cdH0pO1xuXG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShidWlsZGVyLCAnZW5hYmxlZCcsIHtcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdGdldCgpIHtcblx0XHRcdHJldHVybiBzZWxmLmVuYWJsZWQ7XG5cdFx0fSxcblx0XHRzZXQoZW5hYmxlZCkge1xuXHRcdFx0c2VsZi5lbmFibGVkID0gZW5hYmxlZDtcblx0XHR9XG5cdH0pO1xuXG5cdC8vIFNlZSBiZWxvdyBmb3IgZml4IHJlZ2FyZGluZyBpbnZpc2libGUgZ3JleS9kaW0gY29tYmluYXRpb24gb24gV2luZG93c1xuXHRidWlsZGVyLmhhc0dyZXkgPSB0aGlzLmhhc0dyZXkgfHwga2V5ID09PSAnZ3JheScgfHwga2V5ID09PSAnZ3JleSc7XG5cblx0Ly8gYF9fcHJvdG9fX2AgaXMgdXNlZCBiZWNhdXNlIHdlIG11c3QgcmV0dXJuIGEgZnVuY3Rpb24sIGJ1dCB0aGVyZSBpc1xuXHQvLyBubyB3YXkgdG8gY3JlYXRlIGEgZnVuY3Rpb24gd2l0aCBhIGRpZmZlcmVudCBwcm90b3R5cGVcblx0YnVpbGRlci5fX3Byb3RvX18gPSBwcm90bzsgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1wcm90b1xuXG5cdHJldHVybiBidWlsZGVyO1xufVxuXG5mdW5jdGlvbiBhcHBseVN0eWxlKCkge1xuXHQvLyBTdXBwb3J0IHZhcmFncywgYnV0IHNpbXBseSBjYXN0IHRvIHN0cmluZyBpbiBjYXNlIHRoZXJlJ3Mgb25seSBvbmUgYXJnXG5cdGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XG5cdGNvbnN0IGFyZ3NMZW4gPSBhcmdzLmxlbmd0aDtcblx0bGV0IHN0ciA9IFN0cmluZyhhcmd1bWVudHNbMF0pO1xuXG5cdGlmIChhcmdzTGVuID09PSAwKSB7XG5cdFx0cmV0dXJuICcnO1xuXHR9XG5cblx0aWYgKGFyZ3NMZW4gPiAxKSB7XG5cdFx0Ly8gRG9uJ3Qgc2xpY2UgYGFyZ3VtZW50c2AsIGl0IHByZXZlbnRzIFY4IG9wdGltaXphdGlvbnNcblx0XHRmb3IgKGxldCBhID0gMTsgYSA8IGFyZ3NMZW47IGErKykge1xuXHRcdFx0c3RyICs9ICcgJyArIGFyZ3NbYV07XG5cdFx0fVxuXHR9XG5cblx0aWYgKCF0aGlzLmVuYWJsZWQgfHwgdGhpcy5sZXZlbCA8PSAwIHx8ICFzdHIpIHtcblx0XHRyZXR1cm4gdGhpcy5fZW1wdHkgPyAnJyA6IHN0cjtcblx0fVxuXG5cdC8vIFR1cm5zIG91dCB0aGF0IG9uIFdpbmRvd3MgZGltbWVkIGdyYXkgdGV4dCBiZWNvbWVzIGludmlzaWJsZSBpbiBjbWQuZXhlLFxuXHQvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2NoYWxrL2NoYWxrL2lzc3Vlcy81OFxuXHQvLyBJZiB3ZSdyZSBvbiBXaW5kb3dzIGFuZCB3ZSdyZSBkZWFsaW5nIHdpdGggYSBncmF5IGNvbG9yLCB0ZW1wb3JhcmlseSBtYWtlICdkaW0nIGEgbm9vcC5cblx0Y29uc3Qgb3JpZ2luYWxEaW0gPSBhbnNpU3R5bGVzLmRpbS5vcGVuO1xuXHRpZiAoaXNTaW1wbGVXaW5kb3dzVGVybSAmJiB0aGlzLmhhc0dyZXkpIHtcblx0XHRhbnNpU3R5bGVzLmRpbS5vcGVuID0gJyc7XG5cdH1cblxuXHRmb3IgKGNvbnN0IGNvZGUgb2YgdGhpcy5fc3R5bGVzLnNsaWNlKCkucmV2ZXJzZSgpKSB7XG5cdFx0Ly8gUmVwbGFjZSBhbnkgaW5zdGFuY2VzIGFscmVhZHkgcHJlc2VudCB3aXRoIGEgcmUtb3BlbmluZyBjb2RlXG5cdFx0Ly8gb3RoZXJ3aXNlIG9ubHkgdGhlIHBhcnQgb2YgdGhlIHN0cmluZyB1bnRpbCBzYWlkIGNsb3NpbmcgY29kZVxuXHRcdC8vIHdpbGwgYmUgY29sb3JlZCwgYW5kIHRoZSByZXN0IHdpbGwgc2ltcGx5IGJlICdwbGFpbicuXG5cdFx0c3RyID0gY29kZS5vcGVuICsgc3RyLnJlcGxhY2UoY29kZS5jbG9zZVJlLCBjb2RlLm9wZW4pICsgY29kZS5jbG9zZTtcblxuXHRcdC8vIENsb3NlIHRoZSBzdHlsaW5nIGJlZm9yZSBhIGxpbmVicmVhayBhbmQgcmVvcGVuXG5cdFx0Ly8gYWZ0ZXIgbmV4dCBsaW5lIHRvIGZpeCBhIGJsZWVkIGlzc3VlIG9uIG1hY09TXG5cdFx0Ly8gaHR0cHM6Ly9naXRodWIuY29tL2NoYWxrL2NoYWxrL3B1bGwvOTJcblx0XHRzdHIgPSBzdHIucmVwbGFjZSgvXFxyP1xcbi9nLCBgJHtjb2RlLmNsb3NlfSQmJHtjb2RlLm9wZW59YCk7XG5cdH1cblxuXHQvLyBSZXNldCB0aGUgb3JpZ2luYWwgYGRpbWAgaWYgd2UgY2hhbmdlZCBpdCB0byB3b3JrIGFyb3VuZCB0aGUgV2luZG93cyBkaW1tZWQgZ3JheSBpc3N1ZVxuXHRhbnNpU3R5bGVzLmRpbS5vcGVuID0gb3JpZ2luYWxEaW07XG5cblx0cmV0dXJuIHN0cjtcbn1cblxuZnVuY3Rpb24gY2hhbGtUYWcoY2hhbGssIHN0cmluZ3MpIHtcblx0aWYgKCFBcnJheS5pc0FycmF5KHN0cmluZ3MpKSB7XG5cdFx0Ly8gSWYgY2hhbGsoKSB3YXMgY2FsbGVkIGJ5IGl0c2VsZiBvciB3aXRoIGEgc3RyaW5nLFxuXHRcdC8vIHJldHVybiB0aGUgc3RyaW5nIGl0c2VsZiBhcyBhIHN0cmluZy5cblx0XHRyZXR1cm4gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpLmpvaW4oJyAnKTtcblx0fVxuXG5cdGNvbnN0IGFyZ3MgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMik7XG5cdGNvbnN0IHBhcnRzID0gW3N0cmluZ3MucmF3WzBdXTtcblxuXHRmb3IgKGxldCBpID0gMTsgaSA8IHN0cmluZ3MubGVuZ3RoOyBpKyspIHtcblx0XHRwYXJ0cy5wdXNoKFN0cmluZyhhcmdzW2kgLSAxXSkucmVwbGFjZSgvW3t9XFxcXF0vZywgJ1xcXFwkJicpKTtcblx0XHRwYXJ0cy5wdXNoKFN0cmluZyhzdHJpbmdzLnJhd1tpXSkpO1xuXHR9XG5cblx0cmV0dXJuIHRlbXBsYXRlKGNoYWxrLCBwYXJ0cy5qb2luKCcnKSk7XG59XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKENoYWxrLnByb3RvdHlwZSwgc3R5bGVzKTtcblxubW9kdWxlLmV4cG9ydHMgPSBDaGFsaygpOyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5ldy1jYXBcbm1vZHVsZS5leHBvcnRzLnN1cHBvcnRzQ29sb3IgPSBzdGRvdXRDb2xvcjtcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBtb2R1bGUuZXhwb3J0czsgLy8gRm9yIFR5cGVTY3JpcHRcbiJdfQ==