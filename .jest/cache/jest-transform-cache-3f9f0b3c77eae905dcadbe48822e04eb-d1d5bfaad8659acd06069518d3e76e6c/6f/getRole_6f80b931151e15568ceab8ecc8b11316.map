{"version":3,"sources":["../sources/getRole.ts"],"names":["localNameToRoleMappings","article","aside","body","button","datalist","dd","details","dialog","dt","fieldset","figure","form","footer","h1","h2","h3","h4","h5","h6","header","hr","legend","li","math","main","menu","nav","ol","optgroup","option","output","progress","section","summary","table","tbody","textarea","tfoot","td","th","thead","tr","ul","prohibitedAttributes","caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript","element","hasGlobalAriaAttributes","explicitRole","getExplicitRole","implicitRole","getImplicitRole","ignorePresentationalRole","mappedByTag","type","role"],"mappings":"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","sourcesContent":["// https://w3c.github.io/html-aria/#document-conformance-requirements-for-use-of-aria-attributes-in-html\n\nimport { getLocalName } from \"./util\";\n\nconst localNameToRoleMappings: Record<string, string | undefined> = {\n\tarticle: \"article\",\n\taside: \"complementary\",\n\tbody: \"document\",\n\tbutton: \"button\",\n\tdatalist: \"listbox\",\n\tdd: \"definition\",\n\tdetails: \"group\",\n\tdialog: \"dialog\",\n\tdt: \"term\",\n\tfieldset: \"group\",\n\tfigure: \"figure\",\n\t// WARNING: Only with an accessible name\n\tform: \"form\",\n\tfooter: \"contentinfo\",\n\th1: \"heading\",\n\th2: \"heading\",\n\th3: \"heading\",\n\th4: \"heading\",\n\th5: \"heading\",\n\th6: \"heading\",\n\theader: \"banner\",\n\thr: \"separator\",\n\tlegend: \"legend\",\n\tli: \"listitem\",\n\tmath: \"math\",\n\tmain: \"main\",\n\tmenu: \"list\",\n\tnav: \"navigation\",\n\tol: \"list\",\n\toptgroup: \"group\",\n\t// WARNING: Only in certain context\n\toption: \"option\",\n\toutput: \"status\",\n\tprogress: \"progressbar\",\n\t// WARNING: Only with an accessible name\n\tsection: \"region\",\n\tsummary: \"button\",\n\ttable: \"table\",\n\ttbody: \"rowgroup\",\n\ttextarea: \"textbox\",\n\ttfoot: \"rowgroup\",\n\t// WARNING: Only in certain context\n\ttd: \"cell\",\n\tth: \"columnheader\",\n\tthead: \"rowgroup\",\n\ttr: \"row\",\n\tul: \"list\",\n};\n\nconst prohibitedAttributes: Record<string, Set<string>> = {\n\tcaption: new Set([\"aria-label\", \"aria-labelledby\"]),\n\tcode: new Set([\"aria-label\", \"aria-labelledby\"]),\n\tdeletion: new Set([\"aria-label\", \"aria-labelledby\"]),\n\temphasis: new Set([\"aria-label\", \"aria-labelledby\"]),\n\tgeneric: new Set([\"aria-label\", \"aria-labelledby\", \"aria-roledescription\"]),\n\tinsertion: new Set([\"aria-label\", \"aria-labelledby\"]),\n\tparagraph: new Set([\"aria-label\", \"aria-labelledby\"]),\n\tpresentation: new Set([\"aria-label\", \"aria-labelledby\"]),\n\tstrong: new Set([\"aria-label\", \"aria-labelledby\"]),\n\tsubscript: new Set([\"aria-label\", \"aria-labelledby\"]),\n\tsuperscript: new Set([\"aria-label\", \"aria-labelledby\"]),\n};\n\n/**\n *\n * @param element\n * @param role The role used for this element. This is specified to control whether you want to use the implicit or explicit role.\n */\nfunction hasGlobalAriaAttributes(element: Element, role: string): boolean {\n\t// https://rawgit.com/w3c/aria/stable/#global_states\n\t// commented attributes are deprecated\n\treturn [\n\t\t\"aria-atomic\",\n\t\t\"aria-busy\",\n\t\t\"aria-controls\",\n\t\t\"aria-current\",\n\t\t\"aria-describedby\",\n\t\t\"aria-details\",\n\t\t// \"disabled\",\n\t\t\"aria-dropeffect\",\n\t\t// \"errormessage\",\n\t\t\"aria-flowto\",\n\t\t\"aria-grabbed\",\n\t\t// \"haspopup\",\n\t\t\"aria-hidden\",\n\t\t// \"invalid\",\n\t\t\"aria-keyshortcuts\",\n\t\t\"aria-label\",\n\t\t\"aria-labelledby\",\n\t\t\"aria-live\",\n\t\t\"aria-owns\",\n\t\t\"aria-relevant\",\n\t\t\"aria-roledescription\",\n\t].some((attributeName) => {\n\t\treturn (\n\t\t\telement.hasAttribute(attributeName) &&\n\t\t\t!prohibitedAttributes[role]?.has(attributeName)\n\t\t);\n\t});\n}\n\nfunction ignorePresentationalRole(\n\telement: Element,\n\timplicitRole: string\n): boolean {\n\t// https://rawgit.com/w3c/aria/stable/#conflict_resolution_presentation_none\n\treturn hasGlobalAriaAttributes(element, implicitRole);\n}\n\nexport default function getRole(element: Element): string | null {\n\tconst explicitRole = getExplicitRole(element);\n\tif (explicitRole === null || explicitRole === \"presentation\") {\n\t\tconst implicitRole = getImplicitRole(element);\n\t\tif (\n\t\t\texplicitRole !== \"presentation\" ||\n\t\t\tignorePresentationalRole(element, implicitRole || \"\")\n\t\t) {\n\t\t\treturn implicitRole;\n\t\t}\n\t}\n\n\treturn explicitRole;\n}\n\nfunction getImplicitRole(element: Element): string | null {\n\tconst mappedByTag = localNameToRoleMappings[getLocalName(element)];\n\tif (mappedByTag !== undefined) {\n\t\treturn mappedByTag;\n\t}\n\n\tswitch (getLocalName(element)) {\n\t\tcase \"a\":\n\t\tcase \"area\":\n\t\tcase \"link\":\n\t\t\tif (element.hasAttribute(\"href\")) {\n\t\t\t\treturn \"link\";\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"img\":\n\t\t\tif (\n\t\t\t\telement.getAttribute(\"alt\") === \"\" &&\n\t\t\t\t!ignorePresentationalRole(element, \"img\")\n\t\t\t) {\n\t\t\t\treturn \"presentation\";\n\t\t\t}\n\t\t\treturn \"img\";\n\t\tcase \"input\": {\n\t\t\tconst { type } = element as HTMLInputElement;\n\t\t\tswitch (type) {\n\t\t\t\tcase \"button\":\n\t\t\t\tcase \"image\":\n\t\t\t\tcase \"reset\":\n\t\t\t\tcase \"submit\":\n\t\t\t\t\treturn \"button\";\n\t\t\t\tcase \"checkbox\":\n\t\t\t\tcase \"radio\":\n\t\t\t\t\treturn type;\n\t\t\t\tcase \"range\":\n\t\t\t\t\treturn \"slider\";\n\t\t\t\tcase \"email\":\n\t\t\t\tcase \"tel\":\n\t\t\t\tcase \"text\":\n\t\t\t\tcase \"url\":\n\t\t\t\t\tif (element.hasAttribute(\"list\")) {\n\t\t\t\t\t\treturn \"combobox\";\n\t\t\t\t\t}\n\t\t\t\t\treturn \"textbox\";\n\n\t\t\t\tcase \"search\":\n\t\t\t\t\tif (element.hasAttribute(\"list\")) {\n\t\t\t\t\t\treturn \"combobox\";\n\t\t\t\t\t}\n\t\t\t\t\treturn \"searchbox\";\n\t\t\t\tdefault:\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tcase \"select\":\n\t\t\tif (\n\t\t\t\telement.hasAttribute(\"multiple\") ||\n\t\t\t\t(element as HTMLSelectElement).size > 1\n\t\t\t) {\n\t\t\t\treturn \"listbox\";\n\t\t\t}\n\t\t\treturn \"combobox\";\n\t}\n\treturn null;\n}\n\nfunction getExplicitRole(element: Element): string | null {\n\tconst role = element.getAttribute(\"role\");\n\tif (role !== null) {\n\t\tconst explicitRole = role.trim().split(\" \")[0];\n\t\t// String.prototype.split(sep, limit) will always return an array with at least one member\n\t\t// as long as limit is either undefined or > 0\n\t\tif (explicitRole.length > 0) {\n\t\t\treturn explicitRole;\n\t\t}\n\t}\n\n\treturn null;\n}\n"]}