a6ea0bed3abeb0dcd3ceb042956f4149
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = (0, _getPrototypeOf2.default)(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = (0, _getPrototypeOf2.default)(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return (0, _possibleConstructorReturn2.default)(this, result); }; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

var _require = require("./intercept"),
    addInterceptor = _require.addInterceptor,
    isOn = _require.isOn;

var common = require("./common");

var assert = require('assert');

var url = require('url');

var debug = require('debug')('nock.scope');

var _require2 = require('events'),
    EventEmitter = _require2.EventEmitter;

var Interceptor = require("./interceptor");

var fs;

try {
  fs = require('fs');
} catch (err) {}

var Scope = function (_EventEmitter) {
  (0, _inherits2.default)(Scope, _EventEmitter);

  var _super = _createSuper(Scope);

  function Scope(basePath, options) {
    var _this;

    (0, _classCallCheck2.default)(this, Scope);
    _this = _super.call(this);
    _this.keyedInterceptors = {};
    _this.interceptors = [];
    _this.transformPathFunction = null;
    _this.transformRequestBodyFunction = null;
    _this.matchHeaders = [];
    _this.scopeOptions = options || {};
    _this.urlParts = {};
    _this._persist = false;
    _this.contentLen = false;
    _this.date = null;
    _this.basePath = basePath;
    _this.basePathname = '';
    _this.port = null;
    _this._defaultReplyHeaders = [];
    var logNamespace = String(basePath);

    if (!(basePath instanceof RegExp)) {
      _this.urlParts = url.parse(basePath);
      _this.port = _this.urlParts.port || (_this.urlParts.protocol === 'http:' ? 80 : 443);
      _this.basePathname = _this.urlParts.pathname.replace(/\/$/, '');
      _this.basePath = _this.urlParts.protocol + "//" + _this.urlParts.hostname + ":" + _this.port;
      logNamespace = _this.urlParts.host;
    }

    _this.logger = debug.extend(logNamespace);
    return _this;
  }

  (0, _createClass2.default)(Scope, [{
    key: "add",
    value: function add(key, interceptor) {
      if (!(key in this.keyedInterceptors)) {
        this.keyedInterceptors[key] = [];
      }

      this.keyedInterceptors[key].push(interceptor);
      addInterceptor(this.basePath, interceptor, this, this.scopeOptions, this.urlParts.hostname);
    }
  }, {
    key: "remove",
    value: function remove(key, interceptor) {
      if (this._persist) {
        return;
      }

      var arr = this.keyedInterceptors[key];

      if (arr) {
        arr.splice(arr.indexOf(interceptor), 1);

        if (arr.length === 0) {
          delete this.keyedInterceptors[key];
        }
      }
    }
  }, {
    key: "intercept",
    value: function intercept(uri, method, requestBody, interceptorOptions) {
      var ic = new Interceptor(this, uri, method, requestBody, interceptorOptions);
      this.interceptors.push(ic);
      return ic;
    }
  }, {
    key: "get",
    value: function get(uri, requestBody, options) {
      return this.intercept(uri, 'GET', requestBody, options);
    }
  }, {
    key: "post",
    value: function post(uri, requestBody, options) {
      return this.intercept(uri, 'POST', requestBody, options);
    }
  }, {
    key: "put",
    value: function put(uri, requestBody, options) {
      return this.intercept(uri, 'PUT', requestBody, options);
    }
  }, {
    key: "head",
    value: function head(uri, requestBody, options) {
      return this.intercept(uri, 'HEAD', requestBody, options);
    }
  }, {
    key: "patch",
    value: function patch(uri, requestBody, options) {
      return this.intercept(uri, 'PATCH', requestBody, options);
    }
  }, {
    key: "merge",
    value: function merge(uri, requestBody, options) {
      return this.intercept(uri, 'MERGE', requestBody, options);
    }
  }, {
    key: "delete",
    value: function _delete(uri, requestBody, options) {
      return this.intercept(uri, 'DELETE', requestBody, options);
    }
  }, {
    key: "options",
    value: function options(uri, requestBody, _options) {
      return this.intercept(uri, 'OPTIONS', requestBody, _options);
    }
  }, {
    key: "pendingMocks",
    value: function pendingMocks() {
      var _this2 = this;

      return this.activeMocks().filter(function (key) {
        return _this2.keyedInterceptors[key].some(function (_ref) {
          var interceptionCounter = _ref.interceptionCounter,
              optional = _ref.optional;
          var persistedAndUsed = _this2._persist && interceptionCounter > 0;
          return !persistedAndUsed && !optional;
        });
      });
    }
  }, {
    key: "activeMocks",
    value: function activeMocks() {
      return Object.keys(this.keyedInterceptors);
    }
  }, {
    key: "isDone",
    value: function isDone() {
      if (!isOn()) {
        return true;
      }

      return this.pendingMocks().length === 0;
    }
  }, {
    key: "done",
    value: function done() {
      assert.ok(this.isDone(), "Mocks not yet satisfied:\n" + this.pendingMocks().join('\n'));
    }
  }, {
    key: "buildFilter",
    value: function buildFilter() {
      var filteringArguments = arguments;

      if (arguments[0] instanceof RegExp) {
        return function (candidate) {
          if (typeof candidate !== 'string') {
            throw Error("Nock internal assertion failed: typeof candidate is " + typeof candidate + ". If you encounter this error, please report it as a bug.");
          }

          return candidate.replace(filteringArguments[0], filteringArguments[1]);
        };
      } else if (typeof arguments[0] === 'function') {
        return arguments[0];
      }
    }
  }, {
    key: "filteringPath",
    value: function filteringPath() {
      this.transformPathFunction = this.buildFilter.apply(this, arguments);

      if (!this.transformPathFunction) {
        throw new Error('Invalid arguments: filtering path should be a function or a regular expression');
      }

      return this;
    }
  }, {
    key: "filteringRequestBody",
    value: function filteringRequestBody() {
      this.transformRequestBodyFunction = this.buildFilter.apply(this, arguments);

      if (!this.transformRequestBodyFunction) {
        throw new Error('Invalid arguments: filtering request body should be a function or a regular expression');
      }

      return this;
    }
  }, {
    key: "matchHeader",
    value: function matchHeader(name, value) {
      this.matchHeaders.push({
        name: name.toLowerCase(),
        value: value
      });
      return this;
    }
  }, {
    key: "defaultReplyHeaders",
    value: function defaultReplyHeaders(headers) {
      this._defaultReplyHeaders = common.headersInputToRawArray(headers);
      return this;
    }
  }, {
    key: "persist",
    value: function persist() {
      var flag = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;

      if (typeof flag !== 'boolean') {
        throw new Error('Invalid arguments: argument should be a boolean');
      }

      this._persist = flag;
      return this;
    }
  }, {
    key: "shouldPersist",
    value: function shouldPersist() {
      return this._persist;
    }
  }, {
    key: "replyContentLength",
    value: function replyContentLength() {
      this.contentLen = true;
      return this;
    }
  }, {
    key: "replyDate",
    value: function replyDate(d) {
      this.date = d || new Date();
      return this;
    }
  }]);
  return Scope;
}(EventEmitter);

function loadDefs(path) {
  if (!fs) {
    throw new Error('No fs');
  }

  var contents = fs.readFileSync(path);
  return JSON.parse(contents);
}

function load(path) {
  return define(loadDefs(path));
}

function getStatusFromDefinition(nockDef) {
  if (nockDef.reply !== undefined) {
    var parsedReply = parseInt(nockDef.reply, 10);

    if (isNaN(parsedReply)) {
      throw Error('`reply`, when present, must be a numeric string');
    }

    return parsedReply;
  }

  var DEFAULT_STATUS_OK = 200;
  return nockDef.status || DEFAULT_STATUS_OK;
}

function getScopeFromDefinition(nockDef) {
  if (nockDef.port !== undefined) {
    var options = url.parse(nockDef.scope);

    if (options.port === null) {
      return nockDef.scope + ":" + nockDef.port;
    } else {
      if (parseInt(options.port) !== parseInt(nockDef.port)) {
        throw new Error('Mismatched port numbers in scope and port properties of nock definition.');
      }
    }
  }

  return nockDef.scope;
}

function tryJsonParse(string) {
  try {
    return JSON.parse(string);
  } catch (err) {
    return string;
  }
}

function define(nockDefs) {
  var scopes = [];
  nockDefs.forEach(function (nockDef) {
    var nscope = getScopeFromDefinition(nockDef);
    var npath = nockDef.path;

    if (!nockDef.method) {
      throw Error('Method is required');
    }

    var method = nockDef.method.toLowerCase();
    var status = getStatusFromDefinition(nockDef);
    var rawHeaders = nockDef.rawHeaders || [];
    var reqheaders = nockDef.reqheaders || {};
    var badheaders = nockDef.badheaders || [];
    var options = (0, _extends2.default)({}, nockDef.options);
    options.reqheaders = reqheaders;
    options.badheaders = badheaders;
    var response;

    if (!nockDef.response) {
      response = '';
    } else if (nockDef.responseIsBinary) {
      response = Buffer.from(nockDef.response, 'hex');
    } else {
      response = typeof nockDef.response === 'string' ? tryJsonParse(nockDef.response) : nockDef.response;
    }

    var scope = new Scope(nscope, options);
    Object.entries(reqheaders).forEach(function (_ref2) {
      var _ref3 = (0, _slicedToArray2.default)(_ref2, 2),
          fieldName = _ref3[0],
          value = _ref3[1];

      scope.matchHeader(fieldName, value);
    });
    var acceptableFilters = ['filteringRequestBody', 'filteringPath'];
    acceptableFilters.forEach(function (filter) {
      if (nockDef[filter]) {
        scope[filter](nockDef[filter]);
      }
    });
    scope.intercept(npath, method, nockDef.body).reply(status, response, rawHeaders);
    scopes.push(scope);
  });
  return scopes;
}

module.exports = {
  Scope: Scope,
  load: load,
  loadDefs: loadDefs,
  define: define
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjb3BlLmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJhZGRJbnRlcmNlcHRvciIsImlzT24iLCJjb21tb24iLCJhc3NlcnQiLCJ1cmwiLCJkZWJ1ZyIsIkV2ZW50RW1pdHRlciIsIkludGVyY2VwdG9yIiwiZnMiLCJlcnIiLCJTY29wZSIsImJhc2VQYXRoIiwib3B0aW9ucyIsImtleWVkSW50ZXJjZXB0b3JzIiwiaW50ZXJjZXB0b3JzIiwidHJhbnNmb3JtUGF0aEZ1bmN0aW9uIiwidHJhbnNmb3JtUmVxdWVzdEJvZHlGdW5jdGlvbiIsIm1hdGNoSGVhZGVycyIsInNjb3BlT3B0aW9ucyIsInVybFBhcnRzIiwiX3BlcnNpc3QiLCJjb250ZW50TGVuIiwiZGF0ZSIsImJhc2VQYXRobmFtZSIsInBvcnQiLCJfZGVmYXVsdFJlcGx5SGVhZGVycyIsImxvZ05hbWVzcGFjZSIsIlN0cmluZyIsIlJlZ0V4cCIsInBhcnNlIiwicHJvdG9jb2wiLCJwYXRobmFtZSIsInJlcGxhY2UiLCJob3N0bmFtZSIsImhvc3QiLCJsb2dnZXIiLCJleHRlbmQiLCJrZXkiLCJpbnRlcmNlcHRvciIsInB1c2giLCJhcnIiLCJzcGxpY2UiLCJpbmRleE9mIiwibGVuZ3RoIiwidXJpIiwibWV0aG9kIiwicmVxdWVzdEJvZHkiLCJpbnRlcmNlcHRvck9wdGlvbnMiLCJpYyIsImludGVyY2VwdCIsImFjdGl2ZU1vY2tzIiwiZmlsdGVyIiwic29tZSIsImludGVyY2VwdGlvbkNvdW50ZXIiLCJvcHRpb25hbCIsInBlcnNpc3RlZEFuZFVzZWQiLCJPYmplY3QiLCJrZXlzIiwicGVuZGluZ01vY2tzIiwib2siLCJpc0RvbmUiLCJqb2luIiwiZmlsdGVyaW5nQXJndW1lbnRzIiwiYXJndW1lbnRzIiwiY2FuZGlkYXRlIiwiRXJyb3IiLCJidWlsZEZpbHRlciIsImFwcGx5IiwibmFtZSIsInZhbHVlIiwidG9Mb3dlckNhc2UiLCJoZWFkZXJzIiwiaGVhZGVyc0lucHV0VG9SYXdBcnJheSIsImZsYWciLCJkIiwiRGF0ZSIsImxvYWREZWZzIiwicGF0aCIsImNvbnRlbnRzIiwicmVhZEZpbGVTeW5jIiwiSlNPTiIsImxvYWQiLCJkZWZpbmUiLCJnZXRTdGF0dXNGcm9tRGVmaW5pdGlvbiIsIm5vY2tEZWYiLCJyZXBseSIsInVuZGVmaW5lZCIsInBhcnNlZFJlcGx5IiwicGFyc2VJbnQiLCJpc05hTiIsIkRFRkFVTFRfU1RBVFVTX09LIiwic3RhdHVzIiwiZ2V0U2NvcGVGcm9tRGVmaW5pdGlvbiIsInNjb3BlIiwidHJ5SnNvblBhcnNlIiwic3RyaW5nIiwibm9ja0RlZnMiLCJzY29wZXMiLCJmb3JFYWNoIiwibnNjb3BlIiwibnBhdGgiLCJyYXdIZWFkZXJzIiwicmVxaGVhZGVycyIsImJhZGhlYWRlcnMiLCJyZXNwb25zZSIsInJlc3BvbnNlSXNCaW5hcnkiLCJCdWZmZXIiLCJmcm9tIiwiZW50cmllcyIsImZpZWxkTmFtZSIsIm1hdGNoSGVhZGVyIiwiYWNjZXB0YWJsZUZpbHRlcnMiLCJib2R5IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFLQSxlQUFpQ0EsT0FBTyxlQUF4QztBQUFBLElBQVFDLGNBQVIsWUFBUUEsY0FBUjtBQUFBLElBQXdCQyxJQUF4QixZQUF3QkEsSUFBeEI7O0FBQ0EsSUFBTUMsTUFBTSxHQUFHSCxPQUFPLFlBQXRCOztBQUNBLElBQU1JLE1BQU0sR0FBR0osT0FBTyxDQUFDLFFBQUQsQ0FBdEI7O0FBQ0EsSUFBTUssR0FBRyxHQUFHTCxPQUFPLENBQUMsS0FBRCxDQUFuQjs7QUFDQSxJQUFNTSxLQUFLLEdBQUdOLE9BQU8sQ0FBQyxPQUFELENBQVAsQ0FBaUIsWUFBakIsQ0FBZDs7QUFDQSxnQkFBeUJBLE9BQU8sQ0FBQyxRQUFELENBQWhDO0FBQUEsSUFBUU8sWUFBUixhQUFRQSxZQUFSOztBQUNBLElBQU1DLFdBQVcsR0FBR1IsT0FBTyxpQkFBM0I7O0FBRUEsSUFBSVMsRUFBSjs7QUFFQSxJQUFJO0FB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LEdBckREO0FBdURBLFNBQU9JLE1BQVA7QUFDRDs7QUFFRGdCLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQjtBQUNmeEcsRUFBQUEsS0FBSyxFQUFMQSxLQURlO0FBRWZ1RSxFQUFBQSxJQUFJLEVBQUpBLElBRmU7QUFHZkwsRUFBQUEsUUFBUSxFQUFSQSxRQUhlO0FBSWZNLEVBQUFBLE1BQU0sRUFBTkE7QUFKZSxDQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG4vKipcbiAqIEBtb2R1bGUgbm9jay9zY29wZVxuICovXG5jb25zdCB7IGFkZEludGVyY2VwdG9yLCBpc09uIH0gPSByZXF1aXJlKCcuL2ludGVyY2VwdCcpXG5jb25zdCBjb21tb24gPSByZXF1aXJlKCcuL2NvbW1vbicpXG5jb25zdCBhc3NlcnQgPSByZXF1aXJlKCdhc3NlcnQnKVxuY29uc3QgdXJsID0gcmVxdWlyZSgndXJsJylcbmNvbnN0IGRlYnVnID0gcmVxdWlyZSgnZGVidWcnKSgnbm9jay5zY29wZScpXG5jb25zdCB7IEV2ZW50RW1pdHRlciB9ID0gcmVxdWlyZSgnZXZlbnRzJylcbmNvbnN0IEludGVyY2VwdG9yID0gcmVxdWlyZSgnLi9pbnRlcmNlcHRvcicpXG5cbmxldCBmc1xuXG50cnkge1xuICBmcyA9IHJlcXVpcmUoJ2ZzJylcbn0gY2F0Y2ggKGVycikge1xuICAvLyBkbyBub3RoaW5nLCB3ZSdyZSBpbiB0aGUgYnJvd3NlclxufVxuXG4vKipcbiAqIEBwYXJhbSAge3N0cmluZ3xSZWdFeHB8dXJsLnVybH0gYmFzZVBhdGhcbiAqIEBwYXJhbSAge09iamVjdH0gICBvcHRpb25zXG4gKiBAcGFyYW0gIHtib29sZWFufSAgb3B0aW9ucy5hbGxvd1VubW9ja2VkXG4gKiBAcGFyYW0gIHtzdHJpbmdbXX0gb3B0aW9ucy5iYWRoZWFkZXJzXG4gKiBAcGFyYW0gIHtmdW5jdGlvbn0gb3B0aW9ucy5jb25kaXRpb25hbGx5XG4gKiBAcGFyYW0gIHtib29sZWFufSAgb3B0aW9ucy5lbmNvZGVkUXVlcnlQYXJhbXNcbiAqIEBwYXJhbSAge2Z1bmN0aW9ufSBvcHRpb25zLmZpbHRlcmluZ1Njb3BlXG4gKiBAcGFyYW0gIHtPYmplY3R9ICAgb3B0aW9ucy5yZXFoZWFkZXJzXG4gKiBAY29uc3RydWN0b3JcbiAqL1xuY2xhc3MgU2NvcGUgZXh0ZW5kcyBFdmVudEVtaXR0ZXIge1xuICBjb25zdHJ1Y3RvcihiYXNlUGF0aCwgb3B0aW9ucykge1xuICAgIHN1cGVyKClcblxuICAgIHRoaXMua2V5ZWRJbnRlcmNlcHRvcnMgPSB7fVxuICAgIHRoaXMuaW50ZXJjZXB0b3JzID0gW11cbiAgICB0aGlzLnRyYW5zZm9ybVBhdGhGdW5jdGlvbiA9IG51bGxcbiAgICB0aGlzLnRyYW5zZm9ybVJlcXVlc3RCb2R5RnVuY3Rpb24gPSBudWxsXG4gICAgdGhpcy5tYXRjaEhlYWRlcnMgPSBbXVxuICAgIHRoaXMuc2NvcGVPcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuICAgIHRoaXMudXJsUGFydHMgPSB7fVxuICAgIHRoaXMuX3BlcnNpc3QgPSBmYWxzZVxuICAgIHRoaXMuY29udGVudExlbiA9IGZhbHNlXG4gICAgdGhpcy5kYXRlID0gbnVsbFxuICAgIHRoaXMuYmFzZVBhdGggPSBiYXNlUGF0aFxuICAgIHRoaXMuYmFzZVBhdGhuYW1lID0gJydcbiAgICB0aGlzLnBvcnQgPSBudWxsXG4gICAgdGhpcy5fZGVmYXVsdFJlcGx5SGVhZGVycyA9IFtdXG5cbiAgICBsZXQgbG9nTmFtZXNwYWNlID0gU3RyaW5nKGJhc2VQYXRoKVxuXG4gICAgaWYgKCEoYmFzZVBhdGggaW5zdGFuY2VvZiBSZWdFeHApKSB7XG4gICAgICB0aGlzLnVybFBhcnRzID0gdXJsLnBhcnNlKGJhc2VQYXRoKVxuICAgICAgdGhpcy5wb3J0ID1cbiAgICAgICAgdGhpcy51cmxQYXJ0cy5wb3J0IHx8ICh0aGlzLnVybFBhcnRzLnByb3RvY29sID09PSAnaHR0cDonID8gODAgOiA0NDMpXG4gICAgICB0aGlzLmJhc2VQYXRobmFtZSA9IHRoaXMudXJsUGFydHMucGF0aG5hbWUucmVwbGFjZSgvXFwvJC8sICcnKVxuICAgICAgdGhpcy5iYXNlUGF0aCA9IGAke3RoaXMudXJsUGFydHMucHJvdG9jb2x9Ly8ke3RoaXMudXJsUGFydHMuaG9zdG5hbWV9OiR7dGhpcy5wb3J0fWBcbiAgICAgIGxvZ05hbWVzcGFjZSA9IHRoaXMudXJsUGFydHMuaG9zdFxuICAgIH1cblxuICAgIHRoaXMubG9nZ2VyID0gZGVidWcuZXh0ZW5kKGxvZ05hbWVzcGFjZSlcbiAgfVxuXG4gIGFkZChrZXksIGludGVyY2VwdG9yKSB7XG4gICAgaWYgKCEoa2V5IGluIHRoaXMua2V5ZWRJbnRlcmNlcHRvcnMpKSB7XG4gICAgICB0aGlzLmtleWVkSW50ZXJjZXB0b3JzW2tleV0gPSBbXVxuICAgIH1cbiAgICB0aGlzLmtleWVkSW50ZXJjZXB0b3JzW2tleV0ucHVzaChpbnRlcmNlcHRvcilcbiAgICBhZGRJbnRlcmNlcHRvcihcbiAgICAgIHRoaXMuYmFzZVBhdGgsXG4gICAgICBpbnRlcmNlcHRvcixcbiAgICAgIHRoaXMsXG4gICAgICB0aGlzLnNjb3BlT3B0aW9ucyxcbiAgICAgIHRoaXMudXJsUGFydHMuaG9zdG5hbWVcbiAgICApXG4gIH1cblxuICByZW1vdmUoa2V5LCBpbnRlcmNlcHRvcikge1xuICAgIGlmICh0aGlzLl9wZXJzaXN0KSB7XG4gICAgICByZXR1cm5cbiAgICB9XG4gICAgY29uc3QgYXJyID0gdGhpcy5rZXllZEludGVyY2VwdG9yc1trZXldXG4gICAgaWYgKGFycikge1xuICAgICAgYXJyLnNwbGljZShhcnIuaW5kZXhPZihpbnRlcmNlcHRvciksIDEpXG4gICAgICBpZiAoYXJyLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBkZWxldGUgdGhpcy5rZXllZEludGVyY2VwdG9yc1trZXldXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaW50ZXJjZXB0KHVyaSwgbWV0aG9kLCByZXF1ZXN0Qm9keSwgaW50ZXJjZXB0b3JPcHRpb25zKSB7XG4gICAgY29uc3QgaWMgPSBuZXcgSW50ZXJjZXB0b3IoXG4gICAgICB0aGlzLFxuICAgICAgdXJpLFxuICAgICAgbWV0aG9kLFxuICAgICAgcmVxdWVzdEJvZHksXG4gICAgICBpbnRlcmNlcHRvck9wdGlvbnNcbiAgICApXG5cbiAgICB0aGlzLmludGVyY2VwdG9ycy5wdXNoKGljKVxuICAgIHJldHVybiBpY1xuICB9XG5cbiAgZ2V0KHVyaSwgcmVxdWVzdEJvZHksIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5pbnRlcmNlcHQodXJpLCAnR0VUJywgcmVxdWVzdEJvZHksIG9wdGlvbnMpXG4gIH1cblxuICBwb3N0KHVyaSwgcmVxdWVzdEJvZHksIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5pbnRlcmNlcHQodXJpLCAnUE9TVCcsIHJlcXVlc3RCb2R5LCBvcHRpb25zKVxuICB9XG5cbiAgcHV0KHVyaSwgcmVxdWVzdEJvZHksIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5pbnRlcmNlcHQodXJpLCAnUFVUJywgcmVxdWVzdEJvZHksIG9wdGlvbnMpXG4gIH1cblxuICBoZWFkKHVyaSwgcmVxdWVzdEJvZHksIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5pbnRlcmNlcHQodXJpLCAnSEVBRCcsIHJlcXVlc3RCb2R5LCBvcHRpb25zKVxuICB9XG5cbiAgcGF0Y2godXJpLCByZXF1ZXN0Qm9keSwgb3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLmludGVyY2VwdCh1cmksICdQQVRDSCcsIHJlcXVlc3RCb2R5LCBvcHRpb25zKVxuICB9XG5cbiAgbWVyZ2UodXJpLCByZXF1ZXN0Qm9keSwgb3B0aW9ucykge1xuICAgIHJldHVybiB0aGlzLmludGVyY2VwdCh1cmksICdNRVJHRScsIHJlcXVlc3RCb2R5LCBvcHRpb25zKVxuICB9XG5cbiAgZGVsZXRlKHVyaSwgcmVxdWVzdEJvZHksIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5pbnRlcmNlcHQodXJpLCAnREVMRVRFJywgcmVxdWVzdEJvZHksIG9wdGlvbnMpXG4gIH1cblxuICBvcHRpb25zKHVyaSwgcmVxdWVzdEJvZHksIG9wdGlvbnMpIHtcbiAgICByZXR1cm4gdGhpcy5pbnRlcmNlcHQodXJpLCAnT1BUSU9OUycsIHJlcXVlc3RCb2R5LCBvcHRpb25zKVxuICB9XG5cbiAgLy8gUmV0dXJucyB0aGUgbGlzdCBvZiBrZXlzIGZvciBub24tb3B0aW9uYWwgSW50ZXJjZXB0b3JzIHRoYXQgaGF2ZW4ndCBiZWVuIGNvbXBsZXRlZCB5ZXQuXG4gIC8vIFRPRE86IFRoaXMgYXNzdW1lcyB0aGF0IGNvbXBsZXRlZCBtb2NrcyBhcmUgcmVtb3ZlZCBmcm9tIHRoZSBrZXllZEludGVyY2VwdG9ycyBsaXN0XG4gIC8vICh3aGVuIHBlcnNpc3RlbmNlIGlzIG9mZikuIFdlIHNob3VsZCBjaGFuZ2UgdGhhdCAoYW5kIHRoaXMpIGluIGZ1dHVyZS5cbiAgcGVuZGluZ01vY2tzKCkge1xuICAgIHJldHVybiB0aGlzLmFjdGl2ZU1vY2tzKCkuZmlsdGVyKGtleSA9PlxuICAgICAgdGhpcy5rZXllZEludGVyY2VwdG9yc1trZXldLnNvbWUoKHsgaW50ZXJjZXB0aW9uQ291bnRlciwgb3B0aW9uYWwgfSkgPT4ge1xuICAgICAgICBjb25zdCBwZXJzaXN0ZWRBbmRVc2VkID0gdGhpcy5fcGVyc2lzdCAmJiBpbnRlcmNlcHRpb25Db3VudGVyID4gMFxuICAgICAgICByZXR1cm4gIXBlcnNpc3RlZEFuZFVzZWQgJiYgIW9wdGlvbmFsXG4gICAgICB9KVxuICAgIClcbiAgfVxuXG4gIC8vIFJldHVybnMgYWxsIGtleWVkSW50ZXJjZXB0b3JzIHRoYXQgYXJlIGFjdGl2ZS5cbiAgLy8gVGhpcyBpbmNsdWRlcyBpbmNvbXBsZXRlIGludGVyY2VwdG9ycywgcGVyc2lzdGVkIGJ1dCBjb21wbGV0ZSBpbnRlcmNlcHRvcnMsIGFuZFxuICAvLyBvcHRpb25hbCBpbnRlcmNlcHRvcnMsIGJ1dCBub3Qgbm9uLXBlcnNpc3RlZCBhbmQgY29tcGxldGVkIGludGVyY2VwdG9ycy5cbiAgYWN0aXZlTW9ja3MoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMua2V5ZWRJbnRlcmNlcHRvcnMpXG4gIH1cblxuICBpc0RvbmUoKSB7XG4gICAgaWYgKCFpc09uKCkpIHtcbiAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMucGVuZGluZ01vY2tzKCkubGVuZ3RoID09PSAwXG4gIH1cblxuICBkb25lKCkge1xuICAgIGFzc2VydC5vayhcbiAgICAgIHRoaXMuaXNEb25lKCksXG4gICAgICBgTW9ja3Mgbm90IHlldCBzYXRpc2ZpZWQ6XFxuJHt0aGlzLnBlbmRpbmdNb2NrcygpLmpvaW4oJ1xcbicpfWBcbiAgICApXG4gIH1cblxuICBidWlsZEZpbHRlcigpIHtcbiAgICBjb25zdCBmaWx0ZXJpbmdBcmd1bWVudHMgPSBhcmd1bWVudHNcblxuICAgIGlmIChhcmd1bWVudHNbMF0gaW5zdGFuY2VvZiBSZWdFeHApIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoY2FuZGlkYXRlKSB7XG4gICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqL1xuICAgICAgICBpZiAodHlwZW9mIGNhbmRpZGF0ZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAvLyBHaXZlbiB0aGUgd2F5IG5vY2sgaXMgd3JpdHRlbiwgaXQgc2VlbXMgbGlrZSBgY2FuZGlkYXRlYCB3aWxsIGFsd2F5c1xuICAgICAgICAgIC8vIGJlIGEgc3RyaW5nLCByZWdhcmRsZXNzIG9mIHdoYXQgb3B0aW9ucyBtaWdodCBiZSBwYXNzZWQgdG8gaXQuXG4gICAgICAgICAgLy8gSG93ZXZlciB0aGUgY29kZSB1c2VkIHRvIGNvbnRhaW4gYSB0cnV0aGluZXNzIHRlc3Qgb2YgYGNhbmRpZGF0ZWAuXG4gICAgICAgICAgLy8gVGhlIGNoZWNrIGlzIGJlaW5nIHByZXNlcnZlZCBmb3Igbm93LlxuICAgICAgICAgIHRocm93IEVycm9yKFxuICAgICAgICAgICAgYE5vY2sgaW50ZXJuYWwgYXNzZXJ0aW9uIGZhaWxlZDogdHlwZW9mIGNhbmRpZGF0ZSBpcyAke3R5cGVvZiBjYW5kaWRhdGV9LiBJZiB5b3UgZW5jb3VudGVyIHRoaXMgZXJyb3IsIHBsZWFzZSByZXBvcnQgaXQgYXMgYSBidWcuYFxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FuZGlkYXRlLnJlcGxhY2UoZmlsdGVyaW5nQXJndW1lbnRzWzBdLCBmaWx0ZXJpbmdBcmd1bWVudHNbMV0pXG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYXJndW1lbnRzWzBdID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICByZXR1cm4gYXJndW1lbnRzWzBdXG4gICAgfVxuICB9XG5cbiAgZmlsdGVyaW5nUGF0aCgpIHtcbiAgICB0aGlzLnRyYW5zZm9ybVBhdGhGdW5jdGlvbiA9IHRoaXMuYnVpbGRGaWx0ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuICAgIGlmICghdGhpcy50cmFuc2Zvcm1QYXRoRnVuY3Rpb24pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgJ0ludmFsaWQgYXJndW1lbnRzOiBmaWx0ZXJpbmcgcGF0aCBzaG91bGQgYmUgYSBmdW5jdGlvbiBvciBhIHJlZ3VsYXIgZXhwcmVzc2lvbidcbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGZpbHRlcmluZ1JlcXVlc3RCb2R5KCkge1xuICAgIHRoaXMudHJhbnNmb3JtUmVxdWVzdEJvZHlGdW5jdGlvbiA9IHRoaXMuYnVpbGRGaWx0ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuICAgIGlmICghdGhpcy50cmFuc2Zvcm1SZXF1ZXN0Qm9keUZ1bmN0aW9uKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICdJbnZhbGlkIGFyZ3VtZW50czogZmlsdGVyaW5nIHJlcXVlc3QgYm9keSBzaG91bGQgYmUgYSBmdW5jdGlvbiBvciBhIHJlZ3VsYXIgZXhwcmVzc2lvbidcbiAgICAgIClcbiAgICB9XG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIG1hdGNoSGVhZGVyKG5hbWUsIHZhbHVlKSB7XG4gICAgLy8gIFdlIHVzZSBsb3dlci1jYXNlIGhlYWRlciBmaWVsZCBuYW1lcyB0aHJvdWdob3V0IE5vY2suXG4gICAgdGhpcy5tYXRjaEhlYWRlcnMucHVzaCh7IG5hbWU6IG5hbWUudG9Mb3dlckNhc2UoKSwgdmFsdWUgfSlcbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgZGVmYXVsdFJlcGx5SGVhZGVycyhoZWFkZXJzKSB7XG4gICAgdGhpcy5fZGVmYXVsdFJlcGx5SGVhZGVycyA9IGNvbW1vbi5oZWFkZXJzSW5wdXRUb1Jhd0FycmF5KGhlYWRlcnMpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHBlcnNpc3QoZmxhZyA9IHRydWUpIHtcbiAgICBpZiAodHlwZW9mIGZsYWcgIT09ICdib29sZWFuJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGFyZ3VtZW50czogYXJndW1lbnQgc2hvdWxkIGJlIGEgYm9vbGVhbicpXG4gICAgfVxuICAgIHRoaXMuX3BlcnNpc3QgPSBmbGFnXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICovXG4gIHNob3VsZFBlcnNpc3QoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3BlcnNpc3RcbiAgfVxuXG4gIHJlcGx5Q29udGVudExlbmd0aCgpIHtcbiAgICB0aGlzLmNvbnRlbnRMZW4gPSB0cnVlXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIHJlcGx5RGF0ZShkKSB7XG4gICAgdGhpcy5kYXRlID0gZCB8fCBuZXcgRGF0ZSgpXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxufVxuXG5mdW5jdGlvbiBsb2FkRGVmcyhwYXRoKSB7XG4gIGlmICghZnMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGZzJylcbiAgfVxuXG4gIGNvbnN0IGNvbnRlbnRzID0gZnMucmVhZEZpbGVTeW5jKHBhdGgpXG4gIHJldHVybiBKU09OLnBhcnNlKGNvbnRlbnRzKVxufVxuXG5mdW5jdGlvbiBsb2FkKHBhdGgpIHtcbiAgcmV0dXJuIGRlZmluZShsb2FkRGVmcyhwYXRoKSlcbn1cblxuZnVuY3Rpb24gZ2V0U3RhdHVzRnJvbURlZmluaXRpb24obm9ja0RlZikge1xuICAvLyBCYWNrd2FyZCBjb21wYXRpYmlsaXR5IGZvciB3aGVuIGBzdGF0dXNgIHdhcyBlbmNvZGVkIGFzIHN0cmluZyBpbiBgcmVwbHlgLlxuICBpZiAobm9ja0RlZi5yZXBseSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgY29uc3QgcGFyc2VkUmVwbHkgPSBwYXJzZUludChub2NrRGVmLnJlcGx5LCAxMClcbiAgICBpZiAoaXNOYU4ocGFyc2VkUmVwbHkpKSB7XG4gICAgICB0aHJvdyBFcnJvcignYHJlcGx5YCwgd2hlbiBwcmVzZW50LCBtdXN0IGJlIGEgbnVtZXJpYyBzdHJpbmcnKVxuICAgIH1cblxuICAgIHJldHVybiBwYXJzZWRSZXBseVxuICB9XG5cbiAgY29uc3QgREVGQVVMVF9TVEFUVVNfT0sgPSAyMDBcbiAgcmV0dXJuIG5vY2tEZWYuc3RhdHVzIHx8IERFRkFVTFRfU1RBVFVTX09LXG59XG5cbmZ1bmN0aW9uIGdldFNjb3BlRnJvbURlZmluaXRpb24obm9ja0RlZikge1xuICAvLyAgQmFja3dhcmQgY29tcGF0aWJpbGl0eSBmb3Igd2hlbiBgcG9ydGAgd2FzIHBhcnQgb2YgZGVmaW5pdGlvbi5cbiAgaWYgKG5vY2tEZWYucG9ydCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgLy8gIEluY2x1ZGUgYHBvcnRgIGludG8gc2NvcGUgaWYgaXQgZG9lc24ndCBleGlzdC5cbiAgICBjb25zdCBvcHRpb25zID0gdXJsLnBhcnNlKG5vY2tEZWYuc2NvcGUpXG4gICAgaWYgKG9wdGlvbnMucG9ydCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIGAke25vY2tEZWYuc2NvcGV9OiR7bm9ja0RlZi5wb3J0fWBcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHBhcnNlSW50KG9wdGlvbnMucG9ydCkgIT09IHBhcnNlSW50KG5vY2tEZWYucG9ydCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICdNaXNtYXRjaGVkIHBvcnQgbnVtYmVycyBpbiBzY29wZSBhbmQgcG9ydCBwcm9wZXJ0aWVzIG9mIG5vY2sgZGVmaW5pdGlvbi4nXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gbm9ja0RlZi5zY29wZVxufVxuXG5mdW5jdGlvbiB0cnlKc29uUGFyc2Uoc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIEpTT04ucGFyc2Uoc3RyaW5nKVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gc3RyaW5nXG4gIH1cbn1cblxuZnVuY3Rpb24gZGVmaW5lKG5vY2tEZWZzKSB7XG4gIGNvbnN0IHNjb3BlcyA9IFtdXG5cbiAgbm9ja0RlZnMuZm9yRWFjaChmdW5jdGlvbiAobm9ja0RlZikge1xuICAgIGNvbnN0IG5zY29wZSA9IGdldFNjb3BlRnJvbURlZmluaXRpb24obm9ja0RlZilcbiAgICBjb25zdCBucGF0aCA9IG5vY2tEZWYucGF0aFxuICAgIGlmICghbm9ja0RlZi5tZXRob2QpIHtcbiAgICAgIHRocm93IEVycm9yKCdNZXRob2QgaXMgcmVxdWlyZWQnKVxuICAgIH1cbiAgICBjb25zdCBtZXRob2QgPSBub2NrRGVmLm1ldGhvZC50b0xvd2VyQ2FzZSgpXG4gICAgY29uc3Qgc3RhdHVzID0gZ2V0U3RhdHVzRnJvbURlZmluaXRpb24obm9ja0RlZilcbiAgICBjb25zdCByYXdIZWFkZXJzID0gbm9ja0RlZi5yYXdIZWFkZXJzIHx8IFtdXG4gICAgY29uc3QgcmVxaGVhZGVycyA9IG5vY2tEZWYucmVxaGVhZGVycyB8fCB7fVxuICAgIGNvbnN0IGJhZGhlYWRlcnMgPSBub2NrRGVmLmJhZGhlYWRlcnMgfHwgW11cbiAgICBjb25zdCBvcHRpb25zID0geyAuLi5ub2NrRGVmLm9wdGlvbnMgfVxuXG4gICAgLy8gIFdlIHVzZSByZXF1ZXN0IGhlYWRlcnMgZm9yIGJvdGggZmlsdGVyaW5nIChzZWUgYmVsb3cpIGFuZCBtb2NraW5nLlxuICAgIC8vICBIZXJlIHdlIGFyZSBzZXR0aW5nIHVwIG1vY2tlZCByZXF1ZXN0IGhlYWRlcnMgYnV0IHdlIGRvbid0IHdhbnQgdG9cbiAgICAvLyAgYmUgY2hhbmdpbmcgdGhlIHVzZXIncyBvcHRpb25zIG9iamVjdCBzbyB3ZSBjbG9uZSBpdCBmaXJzdC5cbiAgICBvcHRpb25zLnJlcWhlYWRlcnMgPSByZXFoZWFkZXJzXG4gICAgb3B0aW9ucy5iYWRoZWFkZXJzID0gYmFkaGVhZGVyc1xuXG4gICAgLy8gUmVzcG9uc2UgaXMgbm90IGFsd2F5cyBKU09OIGFzIGl0IGNvdWxkIGJlIGEgc3RyaW5nIG9yIGJpbmFyeSBkYXRhIG9yXG4gICAgLy8gZXZlbiBhbiBhcnJheSBvZiBiaW5hcnkgYnVmZmVycyAoZS5nLiB3aGVuIGNvbnRlbnQgaXMgZW5jb2RlZCkuXG4gICAgbGV0IHJlc3BvbnNlXG4gICAgaWYgKCFub2NrRGVmLnJlc3BvbnNlKSB7XG4gICAgICByZXNwb25zZSA9ICcnXG4gICAgICAvLyBUT0RPOiBSZW5hbWUgYHJlc3BvbnNlSXNCaW5hcnlgIHRvIGByZXNwb25zZUlzVXRmOFJlcHJlc2VudGFibGVgLlxuICAgIH0gZWxzZSBpZiAobm9ja0RlZi5yZXNwb25zZUlzQmluYXJ5KSB7XG4gICAgICByZXNwb25zZSA9IEJ1ZmZlci5mcm9tKG5vY2tEZWYucmVzcG9uc2UsICdoZXgnKVxuICAgIH0gZWxzZSB7XG4gICAgICByZXNwb25zZSA9XG4gICAgICAgIHR5cGVvZiBub2NrRGVmLnJlc3BvbnNlID09PSAnc3RyaW5nJ1xuICAgICAgICAgID8gdHJ5SnNvblBhcnNlKG5vY2tEZWYucmVzcG9uc2UpXG4gICAgICAgICAgOiBub2NrRGVmLnJlc3BvbnNlXG4gICAgfVxuXG4gICAgY29uc3Qgc2NvcGUgPSBuZXcgU2NvcGUobnNjb3BlLCBvcHRpb25zKVxuXG4gICAgLy8gSWYgcmVxdWVzdCBoZWFkZXJzIHdlcmUgc3BlY2lmaWVkIGZpbHRlciBieSB0aGVtLlxuICAgIE9iamVjdC5lbnRyaWVzKHJlcWhlYWRlcnMpLmZvckVhY2goKFtmaWVsZE5hbWUsIHZhbHVlXSkgPT4ge1xuICAgICAgc2NvcGUubWF0Y2hIZWFkZXIoZmllbGROYW1lLCB2YWx1ZSlcbiAgICB9KVxuXG4gICAgY29uc3QgYWNjZXB0YWJsZUZpbHRlcnMgPSBbJ2ZpbHRlcmluZ1JlcXVlc3RCb2R5JywgJ2ZpbHRlcmluZ1BhdGgnXVxuICAgIGFjY2VwdGFibGVGaWx0ZXJzLmZvckVhY2goZmlsdGVyID0+IHtcbiAgICAgIGlmIChub2NrRGVmW2ZpbHRlcl0pIHtcbiAgICAgICAgc2NvcGVbZmlsdGVyXShub2NrRGVmW2ZpbHRlcl0pXG4gICAgICB9XG4gICAgfSlcblxuICAgIHNjb3BlXG4gICAgICAuaW50ZXJjZXB0KG5wYXRoLCBtZXRob2QsIG5vY2tEZWYuYm9keSlcbiAgICAgIC5yZXBseShzdGF0dXMsIHJlc3BvbnNlLCByYXdIZWFkZXJzKVxuXG4gICAgc2NvcGVzLnB1c2goc2NvcGUpXG4gIH0pXG5cbiAgcmV0dXJuIHNjb3Blc1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgU2NvcGUsXG4gIGxvYWQsXG4gIGxvYWREZWZzLFxuICBkZWZpbmUsXG59XG4iXX0=