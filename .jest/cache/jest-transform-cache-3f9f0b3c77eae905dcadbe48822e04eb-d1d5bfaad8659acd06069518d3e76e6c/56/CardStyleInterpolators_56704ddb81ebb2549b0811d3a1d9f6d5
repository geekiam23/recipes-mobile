6dbbc245a9b87dcfabe71554c289dbed
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.forHorizontalIOS = forHorizontalIOS;
exports.forVerticalIOS = forVerticalIOS;
exports.forModalPresentationIOS = forModalPresentationIOS;
exports.forFadeFromBottomAndroid = forFadeFromBottomAndroid;
exports.forRevealFromBottomAndroid = forRevealFromBottomAndroid;
exports.forScaleFromCenterAndroid = forScaleFromCenterAndroid;
exports.forNoAnimation = forNoAnimation;

var _reactNative = require("react-native");

var _reactNativeIphoneXHelper = require("react-native-iphone-x-helper");

var _conditional = _interopRequireDefault(require("../utils/conditional"));

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

var _reactNative$Animated = _reactNative.Animated,
    add = _reactNative$Animated.add,
    multiply = _reactNative$Animated.multiply;

function forHorizontalIOS(_ref) {
  var current = _ref.current,
      next = _ref.next,
      inverted = _ref.inverted,
      screen = _ref.layouts.screen;
  var translateFocused = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.width, 0],
    extrapolate: 'clamp'
  }), inverted);
  var translateUnfocused = next ? multiply(next.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, screen.width * -0.3],
    extrapolate: 'clamp'
  }), inverted) : 0;
  var overlayOpacity = current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 0.07],
    extrapolate: 'clamp'
  });
  var shadowOpacity = current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 0.3],
    extrapolate: 'clamp'
  });
  return {
    cardStyle: {
      transform: [{
        translateX: translateFocused
      }, {
        translateX: translateUnfocused
      }]
    },
    overlayStyle: {
      opacity: overlayOpacity
    },
    shadowStyle: {
      shadowOpacity: shadowOpacity
    }
  };
}

function forVerticalIOS(_ref2) {
  var current = _ref2.current,
      inverted = _ref2.inverted,
      screen = _ref2.layouts.screen;
  var translateY = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.height, 0],
    extrapolate: 'clamp'
  }), inverted);
  return {
    cardStyle: {
      transform: [{
        translateY: translateY
      }]
    }
  };
}

function forModalPresentationIOS(_ref3) {
  var index = _ref3.index,
      current = _ref3.current,
      next = _ref3.next,
      inverted = _ref3.inverted,
      screen = _ref3.layouts.screen,
      insets = _ref3.insets;
  var isLandscape = screen.width > screen.height;
  var topOffset = isLandscape ? 0 : 10;
  var statusBarHeight = insets.top;
  var aspectRatio = screen.height / screen.width;
  var progress = add(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 1],
    extrapolate: 'clamp'
  }), next ? next.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 1],
    extrapolate: 'clamp'
  }) : 0);
  var translateY = multiply(progress.interpolate({
    inputRange: [0, 1, 2],
    outputRange: [screen.height, index === 0 ? 0 : topOffset, (index === 0 ? statusBarHeight : 0) - topOffset * aspectRatio]
  }), inverted);
  var overlayOpacity = progress.interpolate({
    inputRange: [0, 1, 1.0001, 2],
    outputRange: [0, 0.3, 1, 1]
  });
  var scale = isLandscape ? 1 : progress.interpolate({
    inputRange: [0, 1, 2],
    outputRange: [1, 1, screen.width ? 1 - topOffset * 2 / screen.width : 1]
  });
  var borderRadius = isLandscape ? 0 : index === 0 ? progress.interpolate({
    inputRange: [0, 1, 1.0001, 2],
    outputRange: [0, 0, (0, _reactNativeIphoneXHelper.isIphoneX)() ? 38 : 0, 10]
  }) : 10;
  return {
    cardStyle: {
      overflow: 'hidden',
      borderTopLeftRadius: borderRadius,
      borderTopRightRadius: borderRadius,
      marginTop: index === 0 ? 0 : statusBarHeight,
      marginBottom: index === 0 ? 0 : topOffset,
      transform: [{
        translateY: translateY
      }, {
        scale: scale
      }]
    },
    overlayStyle: {
      opacity: overlayOpacity
    }
  };
}

function forFadeFromBottomAndroid(_ref4) {
  var current = _ref4.current,
      inverted = _ref4.inverted,
      screen = _ref4.layouts.screen,
      closing = _ref4.closing;
  var translateY = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.height * 0.08, 0],
    extrapolate: 'clamp'
  }), inverted);
  var opacity = (0, _conditional.default)(closing, current.progress, current.progress.interpolate({
    inputRange: [0, 0.5, 0.9, 1],
    outputRange: [0, 0.25, 0.7, 1]
  }));
  return {
    cardStyle: {
      opacity: opacity,
      transform: [{
        translateY: translateY
      }]
    }
  };
}

function forRevealFromBottomAndroid(_ref5) {
  var current = _ref5.current,
      next = _ref5.next,
      inverted = _ref5.inverted,
      screen = _ref5.layouts.screen;
  var containerTranslateY = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.height, 0],
    extrapolate: 'clamp'
  }), inverted);
  var cardTranslateYFocused = multiply(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [screen.height * (95.9 / 100) * -1, 0],
    extrapolate: 'clamp'
  }), inverted);
  var cardTranslateYUnfocused = next ? multiply(next.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, screen.height * (2 / 100) * -1],
    extrapolate: 'clamp'
  }), inverted) : 0;
  var overlayOpacity = current.progress.interpolate({
    inputRange: [0, 0.36, 1],
    outputRange: [0, 0.1, 0.1],
    extrapolate: 'clamp'
  });
  return {
    containerStyle: {
      overflow: 'hidden',
      transform: [{
        translateY: containerTranslateY
      }]
    },
    cardStyle: {
      transform: [{
        translateY: cardTranslateYFocused
      }, {
        translateY: cardTranslateYUnfocused
      }]
    },
    overlayStyle: {
      opacity: overlayOpacity
    }
  };
}

function forScaleFromCenterAndroid(_ref6) {
  var current = _ref6.current,
      next = _ref6.next,
      closing = _ref6.closing;
  var progress = add(current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 1],
    extrapolate: 'clamp'
  }), next ? next.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0, 1],
    extrapolate: 'clamp'
  }) : 0);
  var opacity = progress.interpolate({
    inputRange: [0, 0.75, 0.875, 1, 1.0825, 1.2075, 2],
    outputRange: [0, 0, 1, 1, 1, 1, 0]
  });
  var scale = (0, _conditional.default)(closing, current.progress.interpolate({
    inputRange: [0, 1],
    outputRange: [0.9, 1],
    extrapolate: 'clamp'
  }), progress.interpolate({
    inputRange: [0, 1, 2],
    outputRange: [0.85, 1, 1.1]
  }));
  return {
    containerStyle: {
      opacity: opacity,
      transform: [{
        scale: scale
      }]
    }
  };
}

function forNoAnimation() {
  return {};
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNhcmRTdHlsZUludGVycG9sYXRvcnMudHN4Il0sIm5hbWVzIjpbIm11bHRpcGx5IiwiQW5pbWF0ZWQiLCJsYXlvdXRzIiwic2NyZWVuIiwidHJhbnNsYXRlRm9jdXNlZCIsImlucHV0UmFuZ2UiLCJvdXRwdXRSYW5nZSIsImV4dHJhcG9sYXRlIiwidHJhbnNsYXRlVW5mb2N1c2VkIiwibmV4dCIsIm92ZXJsYXlPcGFjaXR5Iiwic2hhZG93T3BhY2l0eSIsImNhcmRTdHlsZSIsInRyYW5zZm9ybSIsInRyYW5zbGF0ZVgiLCJvdmVybGF5U3R5bGUiLCJvcGFjaXR5Iiwic2hhZG93U3R5bGUiLCJ0cmFuc2xhdGVZIiwiaW5zZXRzIiwiaXNMYW5kc2NhcGUiLCJ0b3BPZmZzZXQiLCJzdGF0dXNCYXJIZWlnaHQiLCJhc3BlY3RSYXRpbyIsInByb2dyZXNzIiwiYWRkIiwiaW5kZXgiLCJzY2FsZSIsImJvcmRlclJhZGl1cyIsIm92ZXJmbG93IiwiYm9yZGVyVG9wTGVmdFJhZGl1cyIsImJvcmRlclRvcFJpZ2h0UmFkaXVzIiwibWFyZ2luVG9wIiwibWFyZ2luQm90dG9tIiwiY2xvc2luZyIsImN1cnJlbnQiLCJjb250YWluZXJUcmFuc2xhdGVZIiwiY2FyZFRyYW5zbGF0ZVlGb2N1c2VkIiwiY2FyZFRyYW5zbGF0ZVlVbmZvY3VzZWQiLCJjb250YWluZXJTdHlsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBLElBQUEsWUFBQSxHQUFBLE9BQUEsQ0FBQSxjQUFBLENBQUE7O0FBQ0EsSUFBQSx5QkFBQSxHQUFBLE9BQUEsQ0FBQSw4QkFBQSxDQUFBOztBQUNBLElBQUEsWUFBQSxHQUFBLHNCQUFBLENBQUEsT0FBQSx3QkFBQSxDQUFBOzs7Ozs7OztBQU1BLDRCQUEwQkMsWUFBQUEsQ0FBMUIsUUFBQTtBQUFBLElBQU0sR0FBTix5QkFBTSxHQUFOO0FBQUEsSUFBYUQsUUFBYix5QkFBYUEsUUFBYjs7QUFLTyxTQUFBLGdCQUFBLE9BS3FEO0FBQUEsTUFM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QUEsQ0FBQSxXQUFBLENBQTZCO0FBQzNCdEIsSUFBQUEsVUFBVSxFQUFFLENBQUEsQ0FBQSxFQURlLENBQ2YsQ0FEZTtBQUUzQkMsSUFBQUEsV0FBVyxFQUFFLENBQUEsR0FBQSxFQUZjLENBRWQsQ0FGYztBQUczQkMsSUFBQUEsV0FBVyxFQUFFO0FBSGMsR0FBN0IsQ0FGWSxFQU9aLFFBQVEsQ0FBUixXQUFBLENBQXFCO0FBQ25CRixJQUFBQSxVQUFVLEVBQUUsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxFQURPLENBQ1AsQ0FETztBQUVuQkMsSUFBQUEsV0FBVyxFQUFFLENBQUEsSUFBQSxFQUFBLENBQUEsRUFBQSxHQUFBO0FBRk0sR0FBckIsQ0FQWSxDQUFkO0FBYUEsU0FBTztBQUNMaUMsSUFBQUEsY0FBYyxFQUFFO0FBQ2R2QixNQUFBQSxPQURjLEVBQ2RBLE9BRGM7QUFFZEgsTUFBQUEsU0FBUyxFQUFFLENBQUM7QUFBRWMsUUFBQUEsS0FBQUEsRUFBQUE7QUFBRixPQUFEO0FBRkc7QUFEWCxHQUFQO0FBTUQ7O0FBRU0sU0FBQSxjQUFBLEdBQXNEO0FBQzNELFNBQUEsRUFBQTtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQW5pbWF0ZWQgfSBmcm9tICdyZWFjdC1uYXRpdmUnO1xuaW1wb3J0IHsgaXNJcGhvbmVYIH0gZnJvbSAncmVhY3QtbmF0aXZlLWlwaG9uZS14LWhlbHBlcic7XG5pbXBvcnQgY29uZGl0aW9uYWwgZnJvbSAnLi4vdXRpbHMvY29uZGl0aW9uYWwnO1xuaW1wb3J0IHR5cGUge1xuICBTdGFja0NhcmRJbnRlcnBvbGF0aW9uUHJvcHMsXG4gIFN0YWNrQ2FyZEludGVycG9sYXRlZFN0eWxlLFxufSBmcm9tICcuLi90eXBlcyc7XG5cbmNvbnN0IHsgYWRkLCBtdWx0aXBseSB9ID0gQW5pbWF0ZWQ7XG5cbi8qKlxuICogU3RhbmRhcmQgaU9TLXN0eWxlIHNsaWRlIGluIGZyb20gdGhlIHJpZ2h0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gZm9ySG9yaXpvbnRhbElPUyh7XG4gIGN1cnJlbnQsXG4gIG5leHQsXG4gIGludmVydGVkLFxuICBsYXlvdXRzOiB7IHNjcmVlbiB9LFxufTogU3RhY2tDYXJkSW50ZXJwb2xhdGlvblByb3BzKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICBjb25zdCB0cmFuc2xhdGVGb2N1c2VkID0gbXVsdGlwbHkoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogW3NjcmVlbi53aWR0aCwgMF0sXG4gICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICB9KSxcbiAgICBpbnZlcnRlZFxuICApO1xuXG4gIGNvbnN0IHRyYW5zbGF0ZVVuZm9jdXNlZCA9IG5leHRcbiAgICA/IG11bHRpcGx5KFxuICAgICAgICBuZXh0LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCBzY3JlZW4ud2lkdGggKiAtMC4zXSxcbiAgICAgICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICAgICAgfSksXG4gICAgICAgIGludmVydGVkXG4gICAgICApXG4gICAgOiAwO1xuXG4gIGNvbnN0IG92ZXJsYXlPcGFjaXR5ID0gY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgIG91dHB1dFJhbmdlOiBbMCwgMC4wN10sXG4gICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gIH0pO1xuXG4gIGNvbnN0IHNoYWRvd09wYWNpdHkgPSBjdXJyZW50LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgb3V0cHV0UmFuZ2U6IFswLCAwLjNdLFxuICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIGNhcmRTdHlsZToge1xuICAgICAgdHJhbnNmb3JtOiBbXG4gICAgICAgIC8vIFRyYW5zbGF0aW9uIGZvciB0aGUgYW5pbWF0aW9uIG9mIHRoZSBjdXJyZW50IGNhcmRcbiAgICAgICAgeyB0cmFuc2xhdGVYOiB0cmFuc2xhdGVGb2N1c2VkIH0sXG4gICAgICAgIC8vIFRyYW5zbGF0aW9uIGZvciB0aGUgYW5pbWF0aW9uIG9mIHRoZSBjYXJkIG9uIHRvcCBvZiB0aGlzXG4gICAgICAgIHsgdHJhbnNsYXRlWDogdHJhbnNsYXRlVW5mb2N1c2VkIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAgb3ZlcmxheVN0eWxlOiB7IG9wYWNpdHk6IG92ZXJsYXlPcGFjaXR5IH0sXG4gICAgc2hhZG93U3R5bGU6IHsgc2hhZG93T3BhY2l0eSB9LFxuICB9O1xufVxuXG4vKipcbiAqIFN0YW5kYXJkIGlPUy1zdHlsZSBzbGlkZSBpbiBmcm9tIHRoZSBib3R0b20gKHVzZWQgZm9yIG1vZGFscykuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JWZXJ0aWNhbElPUyh7XG4gIGN1cnJlbnQsXG4gIGludmVydGVkLFxuICBsYXlvdXRzOiB7IHNjcmVlbiB9LFxufTogU3RhY2tDYXJkSW50ZXJwb2xhdGlvblByb3BzKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICBjb25zdCB0cmFuc2xhdGVZID0gbXVsdGlwbHkoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogW3NjcmVlbi5oZWlnaHQsIDBdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gICAgaW52ZXJ0ZWRcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIGNhcmRTdHlsZToge1xuICAgICAgdHJhbnNmb3JtOiBbXG4gICAgICAgIC8vIFRyYW5zbGF0aW9uIGZvciB0aGUgYW5pbWF0aW9uIG9mIHRoZSBjdXJyZW50IGNhcmRcbiAgICAgICAgeyB0cmFuc2xhdGVZIH0sXG4gICAgICBdLFxuICAgIH0sXG4gIH07XG59XG5cbi8qKlxuICogU3RhbmRhcmQgaU9TLXN0eWxlIG1vZGFsIGFuaW1hdGlvbiBpbiBpT1MgMTMuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JNb2RhbFByZXNlbnRhdGlvbklPUyh7XG4gIGluZGV4LFxuICBjdXJyZW50LFxuICBuZXh0LFxuICBpbnZlcnRlZCxcbiAgbGF5b3V0czogeyBzY3JlZW4gfSxcbiAgaW5zZXRzLFxufTogU3RhY2tDYXJkSW50ZXJwb2xhdGlvblByb3BzKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICBjb25zdCBpc0xhbmRzY2FwZSA9IHNjcmVlbi53aWR0aCA+IHNjcmVlbi5oZWlnaHQ7XG4gIGNvbnN0IHRvcE9mZnNldCA9IGlzTGFuZHNjYXBlID8gMCA6IDEwO1xuICBjb25zdCBzdGF0dXNCYXJIZWlnaHQgPSBpbnNldHMudG9wO1xuICBjb25zdCBhc3BlY3RSYXRpbyA9IHNjcmVlbi5oZWlnaHQgLyBzY3JlZW4ud2lkdGg7XG5cbiAgY29uc3QgcHJvZ3Jlc3MgPSBhZGQoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAsIDFdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gICAgbmV4dFxuICAgICAgPyBuZXh0LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICAgICAgfSlcbiAgICAgIDogMFxuICApO1xuXG4gIGNvbnN0IHRyYW5zbGF0ZVkgPSBtdWx0aXBseShcbiAgICBwcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMSwgMl0sXG4gICAgICBvdXRwdXRSYW5nZTogW1xuICAgICAgICBzY3JlZW4uaGVpZ2h0LFxuICAgICAgICBpbmRleCA9PT0gMCA/IDAgOiB0b3BPZmZzZXQsXG4gICAgICAgIChpbmRleCA9PT0gMCA/IHN0YXR1c0JhckhlaWdodCA6IDApIC0gdG9wT2Zmc2V0ICogYXNwZWN0UmF0aW8sXG4gICAgICBdLFxuICAgIH0pLFxuICAgIGludmVydGVkXG4gICk7XG5cbiAgY29uc3Qgb3ZlcmxheU9wYWNpdHkgPSBwcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDEsIDEuMDAwMSwgMl0sXG4gICAgb3V0cHV0UmFuZ2U6IFswLCAwLjMsIDEsIDFdLFxuICB9KTtcblxuICBjb25zdCBzY2FsZSA9IGlzTGFuZHNjYXBlXG4gICAgPyAxXG4gICAgOiBwcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICAgIGlucHV0UmFuZ2U6IFswLCAxLCAyXSxcbiAgICAgICAgb3V0cHV0UmFuZ2U6IFtcbiAgICAgICAgICAxLFxuICAgICAgICAgIDEsXG4gICAgICAgICAgc2NyZWVuLndpZHRoID8gMSAtICh0b3BPZmZzZXQgKiAyKSAvIHNjcmVlbi53aWR0aCA6IDEsXG4gICAgICAgIF0sXG4gICAgICB9KTtcblxuICBjb25zdCBib3JkZXJSYWRpdXMgPSBpc0xhbmRzY2FwZVxuICAgID8gMFxuICAgIDogaW5kZXggPT09IDBcbiAgICA/IHByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgICAgaW5wdXRSYW5nZTogWzAsIDEsIDEuMDAwMSwgMl0sXG4gICAgICAgIG91dHB1dFJhbmdlOiBbMCwgMCwgaXNJcGhvbmVYKCkgPyAzOCA6IDAsIDEwXSxcbiAgICAgIH0pXG4gICAgOiAxMDtcblxuICByZXR1cm4ge1xuICAgIGNhcmRTdHlsZToge1xuICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nLFxuICAgICAgYm9yZGVyVG9wTGVmdFJhZGl1czogYm9yZGVyUmFkaXVzLFxuICAgICAgYm9yZGVyVG9wUmlnaHRSYWRpdXM6IGJvcmRlclJhZGl1cyxcbiAgICAgIG1hcmdpblRvcDogaW5kZXggPT09IDAgPyAwIDogc3RhdHVzQmFySGVpZ2h0LFxuICAgICAgbWFyZ2luQm90dG9tOiBpbmRleCA9PT0gMCA/IDAgOiB0b3BPZmZzZXQsXG4gICAgICB0cmFuc2Zvcm06IFt7IHRyYW5zbGF0ZVkgfSwgeyBzY2FsZSB9XSxcbiAgICB9LFxuICAgIG92ZXJsYXlTdHlsZTogeyBvcGFjaXR5OiBvdmVybGF5T3BhY2l0eSB9LFxuICB9O1xufVxuXG4vKipcbiAqIFN0YW5kYXJkIEFuZHJvaWQtc3R5bGUgZmFkZSBpbiBmcm9tIHRoZSBib3R0b20gZm9yIEFuZHJvaWQgT3Jlby5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZvckZhZGVGcm9tQm90dG9tQW5kcm9pZCh7XG4gIGN1cnJlbnQsXG4gIGludmVydGVkLFxuICBsYXlvdXRzOiB7IHNjcmVlbiB9LFxuICBjbG9zaW5nLFxufTogU3RhY2tDYXJkSW50ZXJwb2xhdGlvblByb3BzKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICBjb25zdCB0cmFuc2xhdGVZID0gbXVsdGlwbHkoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogW3NjcmVlbi5oZWlnaHQgKiAwLjA4LCAwXSxcbiAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgIH0pLFxuICAgIGludmVydGVkXG4gICk7XG5cbiAgY29uc3Qgb3BhY2l0eSA9IGNvbmRpdGlvbmFsKFxuICAgIGNsb3NpbmcsXG4gICAgY3VycmVudC5wcm9ncmVzcyxcbiAgICBjdXJyZW50LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgIGlucHV0UmFuZ2U6IFswLCAwLjUsIDAuOSwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAsIDAuMjUsIDAuNywgMV0sXG4gICAgfSlcbiAgKTtcblxuICByZXR1cm4ge1xuICAgIGNhcmRTdHlsZToge1xuICAgICAgb3BhY2l0eSxcbiAgICAgIHRyYW5zZm9ybTogW3sgdHJhbnNsYXRlWSB9XSxcbiAgICB9LFxuICB9O1xufVxuXG4vKipcbiAqIFN0YW5kYXJkIEFuZHJvaWQtc3R5bGUgcmV2ZWFsIGZyb20gdGhlIGJvdHRvbSBmb3IgQW5kcm9pZCBQaWUuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JSZXZlYWxGcm9tQm90dG9tQW5kcm9pZCh7XG4gIGN1cnJlbnQsXG4gIG5leHQsXG4gIGludmVydGVkLFxuICBsYXlvdXRzOiB7IHNjcmVlbiB9LFxufTogU3RhY2tDYXJkSW50ZXJwb2xhdGlvblByb3BzKTogU3RhY2tDYXJkSW50ZXJwb2xhdGVkU3R5bGUge1xuICBjb25zdCBjb250YWluZXJUcmFuc2xhdGVZID0gbXVsdGlwbHkoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogW3NjcmVlbi5oZWlnaHQsIDBdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gICAgaW52ZXJ0ZWRcbiAgKTtcblxuICBjb25zdCBjYXJkVHJhbnNsYXRlWUZvY3VzZWQgPSBtdWx0aXBseShcbiAgICBjdXJyZW50LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgIGlucHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgIG91dHB1dFJhbmdlOiBbc2NyZWVuLmhlaWdodCAqICg5NS45IC8gMTAwKSAqIC0xLCAwXSxcbiAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICAgIH0pLFxuICAgIGludmVydGVkXG4gICk7XG5cbiAgY29uc3QgY2FyZFRyYW5zbGF0ZVlVbmZvY3VzZWQgPSBuZXh0XG4gICAgPyBtdWx0aXBseShcbiAgICAgICAgbmV4dC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICAgICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgICAgICAgIG91dHB1dFJhbmdlOiBbMCwgc2NyZWVuLmhlaWdodCAqICgyIC8gMTAwKSAqIC0xXSxcbiAgICAgICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICAgICAgfSksXG4gICAgICAgIGludmVydGVkXG4gICAgICApXG4gICAgOiAwO1xuXG4gIGNvbnN0IG92ZXJsYXlPcGFjaXR5ID0gY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDAuMzYsIDFdLFxuICAgIG91dHB1dFJhbmdlOiBbMCwgMC4xLCAwLjFdLFxuICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnLFxuICB9KTtcblxuICByZXR1cm4ge1xuICAgIGNvbnRhaW5lclN0eWxlOiB7XG4gICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgICB0cmFuc2Zvcm06IFt7IHRyYW5zbGF0ZVk6IGNvbnRhaW5lclRyYW5zbGF0ZVkgfV0sXG4gICAgfSxcbiAgICBjYXJkU3R5bGU6IHtcbiAgICAgIHRyYW5zZm9ybTogW1xuICAgICAgICB7IHRyYW5zbGF0ZVk6IGNhcmRUcmFuc2xhdGVZRm9jdXNlZCB9LFxuICAgICAgICB7IHRyYW5zbGF0ZVk6IGNhcmRUcmFuc2xhdGVZVW5mb2N1c2VkIH0sXG4gICAgICBdLFxuICAgIH0sXG4gICAgb3ZlcmxheVN0eWxlOiB7IG9wYWNpdHk6IG92ZXJsYXlPcGFjaXR5IH0sXG4gIH07XG59XG5cbi8qKlxuICogU3RhbmRhcmQgQW5kcm9pZC1zdHlsZSByZXZlYWwgZnJvbSB0aGUgYm90dG9tIGZvciBBbmRyb2lkIFEuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmb3JTY2FsZUZyb21DZW50ZXJBbmRyb2lkKHtcbiAgY3VycmVudCxcbiAgbmV4dCxcbiAgY2xvc2luZyxcbn06IFN0YWNrQ2FyZEludGVycG9sYXRpb25Qcm9wcyk6IFN0YWNrQ2FyZEludGVycG9sYXRlZFN0eWxlIHtcbiAgY29uc3QgcHJvZ3Jlc3MgPSBhZGQoXG4gICAgY3VycmVudC5wcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAsIDFdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gICAgbmV4dFxuICAgICAgPyBuZXh0LnByb2dyZXNzLmludGVycG9sYXRlKHtcbiAgICAgICAgICBpbnB1dFJhbmdlOiBbMCwgMV0sXG4gICAgICAgICAgb3V0cHV0UmFuZ2U6IFswLCAxXSxcbiAgICAgICAgICBleHRyYXBvbGF0ZTogJ2NsYW1wJyxcbiAgICAgICAgfSlcbiAgICAgIDogMFxuICApO1xuXG4gIGNvbnN0IG9wYWNpdHkgPSBwcm9ncmVzcy5pbnRlcnBvbGF0ZSh7XG4gICAgaW5wdXRSYW5nZTogWzAsIDAuNzUsIDAuODc1LCAxLCAxLjA4MjUsIDEuMjA3NSwgMl0sXG4gICAgb3V0cHV0UmFuZ2U6IFswLCAwLCAxLCAxLCAxLCAxLCAwXSxcbiAgfSk7XG5cbiAgY29uc3Qgc2NhbGUgPSBjb25kaXRpb25hbChcbiAgICBjbG9zaW5nLFxuICAgIGN1cnJlbnQucHJvZ3Jlc3MuaW50ZXJwb2xhdGUoe1xuICAgICAgaW5wdXRSYW5nZTogWzAsIDFdLFxuICAgICAgb3V0cHV0UmFuZ2U6IFswLjksIDFdLFxuICAgICAgZXh0cmFwb2xhdGU6ICdjbGFtcCcsXG4gICAgfSksXG4gICAgcHJvZ3Jlc3MuaW50ZXJwb2xhdGUoe1xuICAgICAgaW5wdXRSYW5nZTogWzAsIDEsIDJdLFxuICAgICAgb3V0cHV0UmFuZ2U6IFswLjg1LCAxLCAxLjFdLFxuICAgIH0pXG4gICk7XG5cbiAgcmV0dXJuIHtcbiAgICBjb250YWluZXJTdHlsZToge1xuICAgICAgb3BhY2l0eSxcbiAgICAgIHRyYW5zZm9ybTogW3sgc2NhbGUgfV0sXG4gICAgfSxcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvck5vQW5pbWF0aW9uKCk6IFN0YWNrQ2FyZEludGVycG9sYXRlZFN0eWxlIHtcbiAgcmV0dXJuIHt9O1xufVxuIl19