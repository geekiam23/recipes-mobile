5ea133fcb562e220f7e409fc04650dd3
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.toHaveStyle = toHaveStyle;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _extends3 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _jestMatcherUtils = require("jest-matcher-utils");

var _jestDiff = _interopRequireDefault(require("jest-diff"));

var _chalk = _interopRequireDefault(require("chalk"));

var _ramda = require("ramda");

var _utils = require("./utils");

function isSubset(expected, received) {
  return (0, _ramda.compose)((0, _ramda.all)(function (_ref) {
    var _ref2 = (0, _slicedToArray2.default)(_ref, 2),
        prop = _ref2[0],
        value = _ref2[1];

    return Array.isArray(value) ? isSubset((0, _ramda.mergeAll)(value), (0, _ramda.mergeAll)(received[prop])) : received[prop] === value;
  }), _ramda.toPairs)(expected);
}

function mergeAllStyles(styles) {
  return (0, _ramda.compose)(_ramda.mergeAll, _ramda.flatten)(styles);
}

function printoutStyles(styles) {
  return Object.keys(styles).sort().map(function (prop) {
    return Array.isArray(styles[prop]) ? prop + ": " + JSON.stringify(styles[prop], null, 2) + ";" : prop + ": " + styles[prop] + ";";
  }).join('\n');
}

function narrow(expected, received) {
  return Object.keys(received).filter(function (prop) {
    return expected[prop];
  }).reduce(function (obj, prop) {
    return (0, _extends3.default)(obj, (0, _defineProperty2.default)({}, prop, Array.isArray(expected[prop]) && Array.isArray(received[prop]) ? expected[prop].map(function (_, i) {
      return narrow(expected[prop][i], received[prop][i]);
    }) : received[prop]));
  }, {});
}

function expectedDiff(expected, elementStyles) {
  var received = narrow(expected, elementStyles);
  var diffOutput = (0, _jestDiff.default)(printoutStyles(expected), printoutStyles(received));
  return diffOutput.replace(_chalk.default.red('+ Received') + "\n", '');
}

function toHaveStyle(element, style) {
  var _element$props$style,
      _this = this;

  (0, _utils.checkReactElement)(element, toHaveStyle, this);
  var elementStyle = (_element$props$style = element.props.style) != null ? _element$props$style : {};
  var expected = Array.isArray(style) ? mergeAllStyles(style) : style;
  var received = Array.isArray(elementStyle) ? mergeAllStyles(elementStyle) : elementStyle;
  return {
    pass: isSubset(expected, received),
    message: function message() {
      var matcher = (_this.isNot ? '.not' : '') + ".toHaveStyle";
      return [(0, _jestMatcherUtils.matcherHint)(matcher, 'element', ''), expectedDiff(expected, received)].join('\n\n');
    }
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvLWhhdmUtc3R5bGUuanMiXSwibmFtZXMiOlsiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInRvSGF2ZVN0eWxlIiwiX2RlZmluZVByb3BlcnR5MiIsIl9leHRlbmRzMyIsIl9zbGljZWRUb0FycmF5MiIsIl9qZXN0TWF0Y2hlclV0aWxzIiwiX2plc3REaWZmIiwiX2NoYWxrIiwiX3JhbWRhIiwiX3V0aWxzIiwiaXNTdWJzZXQiLCJleHBlY3RlZCIsInJlY2VpdmVkIiwiY29tcG9zZSIsImFsbCIsIl9yZWYiLCJfcmVmMiIsImRlZmF1bHQiLCJwcm9wIiwiQXJyYXkiLCJpc0FycmF5IiwibWVyZ2VBbGwiLCJ0b1BhaXJzIiwibWVyZ2VBbGxTdHlsZXMiLCJzdHlsZXMiLCJmbGF0dGVuIiwicHJpbnRvdXRTdHlsZXMiLCJrZXlzIiwic29ydCIsIm1hcCIsIkpTT04iLCJzdHJpbmdpZnkiLCJqb2luIiwibmFycm93IiwiZmlsdGVyIiwicmVkdWNlIiwib2JqIiwiXyIsImkiLCJleHBlY3RlZERpZmYiLCJlbGVtZW50U3R5bGVzIiwiZGlmZk91dHB1dCIsInJlcGxhY2UiLCJyZWQiLCJlbGVtZW50Iiwic3R5bGUiLCJfZWxlbWVudCRwcm9wcyRzdHlsZSIsIl90aGlzIiwiY2hlY2tSZWFjdEVsZW1lbnQiLCJlbGVtZW50U3R5bGUiLCJwcm9wcyIsInBhc3MiLCJtZXNzYWdlIiwibWF0Y2hlciIsImlzTm90IiwibWF0Y2hlckhpbnQiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLHNCQUFzQixHQUFHQyxPQUFPLENBQUMsOENBQUQsQ0FBcEM7O0FBRUFDLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsRUFBK0IsWUFBL0IsRUFBNkM7QUFDM0NDLEVBQUFBLEtBQUssRUFBRTtBQURvQyxDQUE3QztBQUdBRCxPQUFPLENBQUNFLFdBQVIsR0FBc0JBLFdBQXRCOztB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QyxLQUFLLEdBQUcsSUFEWjs7QUFHQSxHQUFDLEdBQUd0QyxNQUFNLENBQUN1QyxpQkFBWCxFQUE4QkosT0FBOUIsRUFBdUMzQyxXQUF2QyxFQUFvRCxJQUFwRDtBQUNBLE1BQUlnRCxZQUFZLEdBQUcsQ0FBQ0gsb0JBQW9CLEdBQUdGLE9BQU8sQ0FBQ00sS0FBUixDQUFjTCxLQUF0QyxLQUFnRCxJQUFoRCxHQUF1REMsb0JBQXZELEdBQThFLEVBQWpHO0FBQ0EsTUFBSW5DLFFBQVEsR0FBR1EsS0FBSyxDQUFDQyxPQUFOLENBQWN5QixLQUFkLElBQXVCdEIsY0FBYyxDQUFDc0IsS0FBRCxDQUFyQyxHQUErQ0EsS0FBOUQ7QUFDQSxNQUFJakMsUUFBUSxHQUFHTyxLQUFLLENBQUNDLE9BQU4sQ0FBYzZCLFlBQWQsSUFBOEIxQixjQUFjLENBQUMwQixZQUFELENBQTVDLEdBQTZEQSxZQUE1RTtBQUNBLFNBQU87QUFDTEUsSUFBQUEsSUFBSSxFQUFFekMsUUFBUSxDQUFDQyxRQUFELEVBQVdDLFFBQVgsQ0FEVDtBQUVMd0MsSUFBQUEsT0FBTyxFQUFFLFNBQVNBLE9BQVQsR0FBbUI7QUFDMUIsVUFBSUMsT0FBTyxHQUFHLENBQUNOLEtBQUssQ0FBQ08sS0FBTixHQUFjLE1BQWQsR0FBdUIsRUFBeEIsSUFBOEIsY0FBNUM7QUFDQSxhQUFPLENBQUMsQ0FBQyxHQUFHakQsaUJBQWlCLENBQUNrRCxXQUF0QixFQUFtQ0YsT0FBbkMsRUFBNEMsU0FBNUMsRUFBdUQsRUFBdkQsQ0FBRCxFQUE2RGQsWUFBWSxDQUFDNUIsUUFBRCxFQUFXQyxRQUFYLENBQXpFLEVBQStGb0IsSUFBL0YsQ0FBb0csTUFBcEcsQ0FBUDtBQUNEO0FBTEksR0FBUDtBQU9EIiwic291cmNlc0NvbnRlbnQiOlsidmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHRcIik7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLnRvSGF2ZVN0eWxlID0gdG9IYXZlU3R5bGU7XG5cbnZhciBfZGVmaW5lUHJvcGVydHkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9kZWZpbmVQcm9wZXJ0eVwiKSk7XG5cbnZhciBfZXh0ZW5kczMgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJAYmFiZWwvcnVudGltZS9oZWxwZXJzL2V4dGVuZHNcIikpO1xuXG52YXIgX3NsaWNlZFRvQXJyYXkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiQGJhYmVsL3J1bnRpbWUvaGVscGVycy9zbGljZWRUb0FycmF5XCIpKTtcblxudmFyIF9qZXN0TWF0Y2hlclV0aWxzID0gcmVxdWlyZShcImplc3QtbWF0Y2hlci11dGlsc1wiKTtcblxudmFyIF9qZXN0RGlmZiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcImplc3QtZGlmZlwiKSk7XG5cbnZhciBfY2hhbGsgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCJjaGFsa1wiKSk7XG5cbnZhciBfcmFtZGEgPSByZXF1aXJlKFwicmFtZGFcIik7XG5cbnZhciBfdXRpbHMgPSByZXF1aXJlKFwiLi91dGlsc1wiKTtcblxuZnVuY3Rpb24gaXNTdWJzZXQoZXhwZWN0ZWQsIHJlY2VpdmVkKSB7XG4gIHJldHVybiAoMCwgX3JhbWRhLmNvbXBvc2UpKCgwLCBfcmFtZGEuYWxsKShmdW5jdGlvbiAoX3JlZikge1xuICAgIHZhciBfcmVmMiA9ICgwLCBfc2xpY2VkVG9BcnJheTIuZGVmYXVsdCkoX3JlZiwgMiksXG4gICAgICAgIHByb3AgPSBfcmVmMlswXSxcbiAgICAgICAgdmFsdWUgPSBfcmVmMlsxXTtcblxuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKSA/IGlzU3Vic2V0KCgwLCBfcmFtZGEubWVyZ2VBbGwpKHZhbHVlKSwgKDAsIF9yYW1kYS5tZXJnZUFsbCkocmVjZWl2ZWRbcHJvcF0pKSA6IHJlY2VpdmVkW3Byb3BdID09PSB2YWx1ZTtcbiAgfSksIF9yYW1kYS50b1BhaXJzKShleHBlY3RlZCk7XG59XG5cbmZ1bmN0aW9uIG1lcmdlQWxsU3R5bGVzKHN0eWxlcykge1xuICByZXR1cm4gKDAsIF9yYW1kYS5jb21wb3NlKShfcmFtZGEubWVyZ2VBbGwsIF9yYW1kYS5mbGF0dGVuKShzdHlsZXMpO1xufVxuXG5mdW5jdGlvbiBwcmludG91dFN0eWxlcyhzdHlsZXMpIHtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKHN0eWxlcykuc29ydCgpLm1hcChmdW5jdGlvbiAocHJvcCkge1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHN0eWxlc1twcm9wXSkgPyBwcm9wICsgXCI6IFwiICsgSlNPTi5zdHJpbmdpZnkoc3R5bGVzW3Byb3BdLCBudWxsLCAyKSArIFwiO1wiIDogcHJvcCArIFwiOiBcIiArIHN0eWxlc1twcm9wXSArIFwiO1wiO1xuICB9KS5qb2luKCdcXG4nKTtcbn1cblxuZnVuY3Rpb24gbmFycm93KGV4cGVjdGVkLCByZWNlaXZlZCkge1xuICByZXR1cm4gT2JqZWN0LmtleXMocmVjZWl2ZWQpLmZpbHRlcihmdW5jdGlvbiAocHJvcCkge1xuICAgIHJldHVybiBleHBlY3RlZFtwcm9wXTtcbiAgfSkucmVkdWNlKGZ1bmN0aW9uIChvYmosIHByb3ApIHtcbiAgICByZXR1cm4gKDAsIF9leHRlbmRzMy5kZWZhdWx0KShvYmosICgwLCBfZGVmaW5lUHJvcGVydHkyLmRlZmF1bHQpKHt9LCBwcm9wLCBBcnJheS5pc0FycmF5KGV4cGVjdGVkW3Byb3BdKSAmJiBBcnJheS5pc0FycmF5KHJlY2VpdmVkW3Byb3BdKSA/IGV4cGVjdGVkW3Byb3BdLm1hcChmdW5jdGlvbiAoXywgaSkge1xuICAgICAgcmV0dXJuIG5hcnJvdyhleHBlY3RlZFtwcm9wXVtpXSwgcmVjZWl2ZWRbcHJvcF1baV0pO1xuICAgIH0pIDogcmVjZWl2ZWRbcHJvcF0pKTtcbiAgfSwge30pO1xufVxuXG5mdW5jdGlvbiBleHBlY3RlZERpZmYoZXhwZWN0ZWQsIGVsZW1lbnRTdHlsZXMpIHtcbiAgdmFyIHJlY2VpdmVkID0gbmFycm93KGV4cGVjdGVkLCBlbGVtZW50U3R5bGVzKTtcbiAgdmFyIGRpZmZPdXRwdXQgPSAoMCwgX2plc3REaWZmLmRlZmF1bHQpKHByaW50b3V0U3R5bGVzKGV4cGVjdGVkKSwgcHJpbnRvdXRTdHlsZXMocmVjZWl2ZWQpKTtcbiAgcmV0dXJuIGRpZmZPdXRwdXQucmVwbGFjZShfY2hhbGsuZGVmYXVsdC5yZWQoJysgUmVjZWl2ZWQnKSArIFwiXFxuXCIsICcnKTtcbn1cblxuZnVuY3Rpb24gdG9IYXZlU3R5bGUoZWxlbWVudCwgc3R5bGUpIHtcbiAgdmFyIF9lbGVtZW50JHByb3BzJHN0eWxlLFxuICAgICAgX3RoaXMgPSB0aGlzO1xuXG4gICgwLCBfdXRpbHMuY2hlY2tSZWFjdEVsZW1lbnQpKGVsZW1lbnQsIHRvSGF2ZVN0eWxlLCB0aGlzKTtcbiAgdmFyIGVsZW1lbnRTdHlsZSA9IChfZWxlbWVudCRwcm9wcyRzdHlsZSA9IGVsZW1lbnQucHJvcHMuc3R5bGUpICE9IG51bGwgPyBfZWxlbWVudCRwcm9wcyRzdHlsZSA6IHt9O1xuICB2YXIgZXhwZWN0ZWQgPSBBcnJheS5pc0FycmF5KHN0eWxlKSA/IG1lcmdlQWxsU3R5bGVzKHN0eWxlKSA6IHN0eWxlO1xuICB2YXIgcmVjZWl2ZWQgPSBBcnJheS5pc0FycmF5KGVsZW1lbnRTdHlsZSkgPyBtZXJnZUFsbFN0eWxlcyhlbGVtZW50U3R5bGUpIDogZWxlbWVudFN0eWxlO1xuICByZXR1cm4ge1xuICAgIHBhc3M6IGlzU3Vic2V0KGV4cGVjdGVkLCByZWNlaXZlZCksXG4gICAgbWVzc2FnZTogZnVuY3Rpb24gbWVzc2FnZSgpIHtcbiAgICAgIHZhciBtYXRjaGVyID0gKF90aGlzLmlzTm90ID8gJy5ub3QnIDogJycpICsgXCIudG9IYXZlU3R5bGVcIjtcbiAgICAgIHJldHVybiBbKDAsIF9qZXN0TWF0Y2hlclV0aWxzLm1hdGNoZXJIaW50KShtYXRjaGVyLCAnZWxlbWVudCcsICcnKSwgZXhwZWN0ZWREaWZmKGV4cGVjdGVkLCByZWNlaXZlZCldLmpvaW4oJ1xcblxcbicpO1xuICAgIH1cbiAgfTtcbn0iXX0=